(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();/**
* @vue/shared v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function L_(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const gn={},_c=[],Zs=()=>{},_T=()=>!1,Bp=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),A_=n=>n.startsWith("onUpdate:"),Xi=Object.assign,C_=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},bN=Object.prototype.hasOwnProperty,an=(n,e)=>bN.call(n,e),bt=Array.isArray,vc=n=>kh(n)==="[object Map]",Hp=n=>kh(n)==="[object Set]",dw=n=>kh(n)==="[object Date]",Et=n=>typeof n=="function",Qn=n=>typeof n=="string",Ts=n=>typeof n=="symbol",_n=n=>n!==null&&typeof n=="object",vT=n=>(_n(n)||Et(n))&&Et(n.then)&&Et(n.catch),bT=Object.prototype.toString,kh=n=>bT.call(n),xN=n=>kh(n).slice(8,-1),xT=n=>kh(n)==="[object Object]",R_=n=>Qn(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Ku=L_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Zp=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},wN=/-\w/g,ts=Zp(n=>n.replace(wN,e=>e.slice(1).toUpperCase())),SN=/\B([A-Z])/g,bl=Zp(n=>n.replace(SN,"-$1").toLowerCase()),Xp=Zp(n=>n.charAt(0).toUpperCase()+n.slice(1)),Dg=Zp(n=>n?`on${Xp(n)}`:""),_a=(n,e)=>!Object.is(n,e),np=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},wT=(n,e,t,i=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:i,value:t})},P_=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let fw;const jp=()=>fw||(fw=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function I_(n){if(bt(n)){const e={};for(let t=0;t<n.length;t++){const i=n[t],r=Qn(i)?LN(i):I_(i);if(r)for(const s in r)e[s]=r[s]}return e}else if(Qn(n)||_n(n))return n}const MN=/;(?![^(]*\))/g,TN=/:([^]+)/,EN=/\/\*[^]*?\*\//g;function LN(n){const e={};return n.replace(EN,"").split(MN).forEach(t=>{if(t){const i=t.split(TN);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Dr(n){let e="";if(Qn(n))e=n;else if(bt(n))for(let t=0;t<n.length;t++){const i=Dr(n[t]);i&&(e+=i+" ")}else if(_n(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const AN="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",CN=L_(AN);function ST(n){return!!n||n===""}function RN(n,e){if(n.length!==e.length)return!1;let t=!0;for(let i=0;t&&i<n.length;i++)t=Yp(n[i],e[i]);return t}function Yp(n,e){if(n===e)return!0;let t=dw(n),i=dw(e);if(t||i)return t&&i?n.getTime()===e.getTime():!1;if(t=Ts(n),i=Ts(e),t||i)return n===e;if(t=bt(n),i=bt(e),t||i)return t&&i?RN(n,e):!1;if(t=_n(n),i=_n(e),t||i){if(!t||!i)return!1;const r=Object.keys(n).length,s=Object.keys(e).length;if(r!==s)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Yp(n[o],e[o]))return!1}}return String(n)===String(e)}function MT(n,e){return n.findIndex(t=>Yp(t,e))}const TT=n=>!!(n&&n.__v_isRef===!0),Ze=n=>Qn(n)?n:n==null?"":bt(n)||_n(n)&&(n.toString===bT||!Et(n.toString))?TT(n)?Ze(n.value):JSON.stringify(n,ET,2):String(n),ET=(n,e)=>TT(e)?ET(n,e.value):vc(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[i,r],s)=>(t[Ng(i,s)+" =>"]=r,t),{})}:Hp(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Ng(t))}:Ts(e)?Ng(e):_n(e)&&!bt(e)&&!xT(e)?String(e):e,Ng=(n,e="")=>{var t;return Ts(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let gr;class LT{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=gr,!e&&gr&&(this.index=(gr.scopes||(gr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=gr;try{return gr=this,e()}finally{gr=t}}}on(){++this._on===1&&(this.prevScope=gr,gr=this)}off(){this._on>0&&--this._on===0&&(gr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(this.effects.length=0,t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function PN(n){return new LT(n)}function IN(){return gr}let bn;const Og=new WeakSet;class AT{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,gr&&gr.active&&gr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Og.has(this)&&(Og.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||RT(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,pw(this),PT(this);const e=bn,t=ws;bn=this,ws=!0;try{return this.fn()}finally{IT(this),bn=e,ws=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)O_(e);this.deps=this.depsTail=void 0,pw(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Og.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){i0(this)&&this.run()}get dirty(){return i0(this)}}let CT=0,Ju,Qu;function RT(n,e=!1){if(n.flags|=8,e){n.next=Qu,Qu=n;return}n.next=Ju,Ju=n}function D_(){CT++}function N_(){if(--CT>0)return;if(Qu){let e=Qu;for(Qu=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Ju;){let e=Ju;for(Ju=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){n||(n=i)}e=t}}if(n)throw n}function PT(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function IT(n){let e,t=n.depsTail,i=t;for(;i;){const r=i.prevDep;i.version===-1?(i===t&&(t=r),O_(i),DN(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}n.deps=e,n.depsTail=t}function i0(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(DT(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function DT(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ch)||(n.globalVersion=ch,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!i0(n))))return;n.flags|=2;const e=n.dep,t=bn,i=ws;bn=n,ws=!0;try{PT(n);const r=n.fn(n._value);(e.version===0||_a(r,n._value))&&(n.flags|=128,n._value=r,e.version++)}catch(r){throw e.version++,r}finally{bn=t,ws=i,IT(n),n.flags&=-3}}function O_(n,e=!1){const{dep:t,prevSub:i,nextSub:r}=n;if(i&&(i.nextSub=r,n.prevSub=void 0),r&&(r.prevSub=i,n.nextSub=void 0),t.subs===n&&(t.subs=i,!i&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)O_(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function DN(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let ws=!0;const NT=[];function No(){NT.push(ws),ws=!1}function Oo(){const n=NT.pop();ws=n===void 0?!0:n}function pw(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=bn;bn=void 0;try{e()}finally{bn=t}}}let ch=0;class NN{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class k_{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!bn||!ws||bn===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==bn)t=this.activeLink=new NN(bn,this),bn.deps?(t.prevDep=bn.depsTail,bn.depsTail.nextDep=t,bn.depsTail=t):bn.deps=bn.depsTail=t,OT(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const i=t.nextDep;i.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=i),t.prevDep=bn.depsTail,t.nextDep=void 0,bn.depsTail.nextDep=t,bn.depsTail=t,bn.deps===t&&(bn.deps=i)}return t}trigger(e){this.version++,ch++,this.notify(e)}notify(e){D_();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{N_()}}}function OT(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)OT(i)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const r0=new WeakMap,ll=Symbol(""),s0=Symbol(""),uh=Symbol("");function Gi(n,e,t){if(ws&&bn){let i=r0.get(n);i||r0.set(n,i=new Map);let r=i.get(t);r||(i.set(t,r=new k_),r.map=i,r.key=t),r.track()}}function To(n,e,t,i,r,s){const o=r0.get(n);if(!o){ch++;return}const a=l=>{l&&l.trigger()};if(D_(),e==="clear")o.forEach(a);else{const l=bt(n),c=l&&R_(t);if(l&&t==="length"){const h=Number(i);o.forEach((d,p)=>{(p==="length"||p===uh||!Ts(p)&&p>=h)&&a(d)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(uh)),e){case"add":l?c&&a(o.get("length")):(a(o.get(ll)),vc(n)&&a(o.get(s0)));break;case"delete":l||(a(o.get(ll)),vc(n)&&a(o.get(s0)));break;case"set":vc(n)&&a(o.get(ll));break}}N_()}function Gl(n){const e=on(n);return e===n?e:(Gi(e,"iterate",uh),qr(n)?e:e.map(Es))}function Kp(n){return Gi(n=on(n),"iterate",uh),n}function la(n,e){return ko(n)?cl(n)?Ac(Es(e)):Ac(e):Es(e)}const ON={__proto__:null,[Symbol.iterator](){return kg(this,Symbol.iterator,n=>la(this,n))},concat(...n){return Gl(this).concat(...n.map(e=>bt(e)?Gl(e):e))},entries(){return kg(this,"entries",n=>(n[1]=la(this,n[1]),n))},every(n,e){return fo(this,"every",n,e,void 0,arguments)},filter(n,e){return fo(this,"filter",n,e,t=>t.map(i=>la(this,i)),arguments)},find(n,e){return fo(this,"find",n,e,t=>la(this,t),arguments)},findIndex(n,e){return fo(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return fo(this,"findLast",n,e,t=>la(this,t),arguments)},findLastIndex(n,e){return fo(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return fo(this,"forEach",n,e,void 0,arguments)},includes(...n){return Fg(this,"includes",n)},indexOf(...n){return Fg(this,"indexOf",n)},join(n){return Gl(this).join(n)},lastIndexOf(...n){return Fg(this,"lastIndexOf",n)},map(n,e){return fo(this,"map",n,e,void 0,arguments)},pop(){return gu(this,"pop")},push(...n){return gu(this,"push",n)},reduce(n,...e){return mw(this,"reduce",n,e)},reduceRight(n,...e){return mw(this,"reduceRight",n,e)},shift(){return gu(this,"shift")},some(n,e){return fo(this,"some",n,e,void 0,arguments)},splice(...n){return gu(this,"splice",n)},toReversed(){return Gl(this).toReversed()},toSorted(n){return Gl(this).toSorted(n)},toSpliced(...n){return Gl(this).toSpliced(...n)},unshift(...n){return gu(this,"unshift",n)},values(){return kg(this,"values",n=>la(this,n))}};function kg(n,e,t){const i=Kp(n),r=i[e]();return i!==n&&!qr(n)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.done||(s.value=t(s.value)),s}),r}const kN=Array.prototype;function fo(n,e,t,i,r,s){const o=Kp(n),a=o!==n&&!qr(n),l=o[e];if(l!==kN[e]){const d=l.apply(n,s);return a?Es(d):d}let c=t;o!==n&&(a?c=function(d,p){return t.call(this,la(n,d),p,n)}:t.length>2&&(c=function(d,p){return t.call(this,d,p,n)}));const h=l.call(o,c,i);return a&&r?r(h):h}function mw(n,e,t,i){const r=Kp(n);let s=t;return r!==n&&(qr(n)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,n)}):s=function(o,a,l){return t.call(this,o,la(n,a),l,n)}),r[e](s,...i)}function Fg(n,e,t){const i=on(n);Gi(i,"iterate",uh);const r=i[e](...t);return(r===-1||r===!1)&&z_(t[0])?(t[0]=on(t[0]),i[e](...t)):r}function gu(n,e,t=[]){No(),D_();const i=on(n)[e].apply(n,t);return N_(),Oo(),i}const FN=L_("__proto__,__v_isRef,__isVue"),kT=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ts));function UN(n){Ts(n)||(n=String(n));const e=on(this);return Gi(e,"has",n),e.hasOwnProperty(n)}class FT{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,i){if(t==="__v_skip")return e.__v_skip;const r=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return s;if(t==="__v_raw")return i===(r?s?YN:VT:s?WT:zT).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=bt(e);if(!r){let l;if(o&&(l=ON[t]))return l;if(t==="hasOwnProperty")return UN}const a=Reflect.get(e,t,Pi(e)?e:i);if((Ts(t)?kT.has(t):FN(t))||(r||Gi(e,"get",t),s))return a;if(Pi(a)){const l=o&&R_(t)?a:a.value;return r&&_n(l)?a0(l):l}return _n(a)?r?a0(a):xl(a):a}}class UT extends FT{constructor(e=!1){super(!1,e)}set(e,t,i,r){let s=e[t];const o=bt(e)&&R_(t);if(!this._isShallow){const c=ko(s);if(!qr(i)&&!ko(i)&&(s=on(s),i=on(i)),!o&&Pi(s)&&!Pi(i))return c||(s.value=i),!0}const a=o?Number(t)<e.length:an(e,t),l=Reflect.set(e,t,i,Pi(e)?e:r);return e===on(r)&&(a?_a(i,s)&&To(e,"set",t,i):To(e,"add",t,i)),l}deleteProperty(e,t){const i=an(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&i&&To(e,"delete",t,void 0),r}has(e,t){const i=Reflect.has(e,t);return(!Ts(t)||!kT.has(t))&&Gi(e,"has",t),i}ownKeys(e){return Gi(e,"iterate",bt(e)?"length":ll),Reflect.ownKeys(e)}}class zN extends FT{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const WN=new UT,VN=new zN,GN=new UT(!0);const o0=n=>n,Hd=n=>Reflect.getPrototypeOf(n);function BN(n,e,t){return function(...i){const r=this.__v_raw,s=on(r),o=vc(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=r[n](...i),h=t?o0:e?Ac:Es;return!e&&Gi(s,"iterate",l?s0:ll),{next(){const{value:d,done:p}=c.next();return p?{value:d,done:p}:{value:a?[h(d[0]),h(d[1])]:h(d),done:p}},[Symbol.iterator](){return this}}}}function Zd(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function HN(n,e){const t={get(r){const s=this.__v_raw,o=on(s),a=on(r);n||(_a(r,a)&&Gi(o,"get",r),Gi(o,"get",a));const{has:l}=Hd(o),c=e?o0:n?Ac:Es;if(l.call(o,r))return c(s.get(r));if(l.call(o,a))return c(s.get(a));s!==o&&s.get(r)},get size(){const r=this.__v_raw;return!n&&Gi(on(r),"iterate",ll),r.size},has(r){const s=this.__v_raw,o=on(s),a=on(r);return n||(_a(r,a)&&Gi(o,"has",r),Gi(o,"has",a)),r===a?s.has(r):s.has(r)||s.has(a)},forEach(r,s){const o=this,a=o.__v_raw,l=on(a),c=e?o0:n?Ac:Es;return!n&&Gi(l,"iterate",ll),a.forEach((h,d)=>r.call(s,c(h),c(d),o))}};return Xi(t,n?{add:Zd("add"),set:Zd("set"),delete:Zd("delete"),clear:Zd("clear")}:{add(r){!e&&!qr(r)&&!ko(r)&&(r=on(r));const s=on(this);return Hd(s).has.call(s,r)||(s.add(r),To(s,"add",r,r)),this},set(r,s){!e&&!qr(s)&&!ko(s)&&(s=on(s));const o=on(this),{has:a,get:l}=Hd(o);let c=a.call(o,r);c||(r=on(r),c=a.call(o,r));const h=l.call(o,r);return o.set(r,s),c?_a(s,h)&&To(o,"set",r,s):To(o,"add",r,s),this},delete(r){const s=on(this),{has:o,get:a}=Hd(s);let l=o.call(s,r);l||(r=on(r),l=o.call(s,r)),a&&a.call(s,r);const c=s.delete(r);return l&&To(s,"delete",r,void 0),c},clear(){const r=on(this),s=r.size!==0,o=r.clear();return s&&To(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=BN(r,n,e)}),t}function F_(n,e){const t=HN(n,e);return(i,r,s)=>r==="__v_isReactive"?!n:r==="__v_isReadonly"?n:r==="__v_raw"?i:Reflect.get(an(t,r)&&r in i?t:i,r,s)}const ZN={get:F_(!1,!1)},XN={get:F_(!1,!0)},jN={get:F_(!0,!1)};const zT=new WeakMap,WT=new WeakMap,VT=new WeakMap,YN=new WeakMap;function KN(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function JN(n){return n.__v_skip||!Object.isExtensible(n)?0:KN(xN(n))}function xl(n){return ko(n)?n:U_(n,!1,WN,ZN,zT)}function GT(n){return U_(n,!1,GN,XN,WT)}function a0(n){return U_(n,!0,VN,jN,VT)}function U_(n,e,t,i,r){if(!_n(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=JN(n);if(s===0)return n;const o=r.get(n);if(o)return o;const a=new Proxy(n,s===2?i:t);return r.set(n,a),a}function cl(n){return ko(n)?cl(n.__v_raw):!!(n&&n.__v_isReactive)}function ko(n){return!!(n&&n.__v_isReadonly)}function qr(n){return!!(n&&n.__v_isShallow)}function z_(n){return n?!!n.__v_raw:!1}function on(n){const e=n&&n.__v_raw;return e?on(e):n}function QN(n){return!an(n,"__v_skip")&&Object.isExtensible(n)&&wT(n,"__v_skip",!0),n}const Es=n=>_n(n)?xl(n):n,Ac=n=>_n(n)?a0(n):n;function Pi(n){return n?n.__v_isRef===!0:!1}function zt(n){return HT(n,!1)}function BT(n){return HT(n,!0)}function HT(n,e){return Pi(n)?n:new $N(n,e)}class $N{constructor(e,t){this.dep=new k_,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:on(e),this._value=t?e:Es(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,i=this.__v_isShallow||qr(e)||ko(e);e=i?e:on(e),_a(e,t)&&(this._rawValue=e,this._value=i?e:Es(e),this.dep.trigger())}}function Re(n){return Pi(n)?n.value:n}const qN={get:(n,e,t)=>e==="__v_raw"?n:Re(Reflect.get(n,e,t)),set:(n,e,t,i)=>{const r=n[e];return Pi(r)&&!Pi(t)?(r.value=t,!0):Reflect.set(n,e,t,i)}};function ZT(n){return cl(n)?n:new Proxy(n,qN)}class eO{constructor(e,t,i){this.fn=e,this.setter=t,this._value=void 0,this.dep=new k_(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ch-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&bn!==this)return RT(this,!0),!0}get value(){const e=this.dep.track();return DT(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function tO(n,e,t=!1){let i,r;return Et(n)?i=n:(i=n.get,r=n.set),new eO(i,r,t)}const Xd={},_p=new WeakMap;let $a;function nO(n,e=!1,t=$a){if(t){let i=_p.get(t);i||_p.set(t,i=[]),i.push(n)}}function iO(n,e,t=gn){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=t,c=S=>r?S:qr(S)||r===!1||r===0?Eo(S,1):Eo(S);let h,d,p,m,y=!1,b=!1;if(Pi(n)?(d=()=>n.value,y=qr(n)):cl(n)?(d=()=>c(n),y=!0):bt(n)?(b=!0,y=n.some(S=>cl(S)||qr(S)),d=()=>n.map(S=>{if(Pi(S))return S.value;if(cl(S))return c(S);if(Et(S))return l?l(S,2):S()})):Et(n)?e?d=l?()=>l(n,2):n:d=()=>{if(p){No();try{p()}finally{Oo()}}const S=$a;$a=h;try{return l?l(n,3,[m]):n(m)}finally{$a=S}}:d=Zs,e&&r){const S=d,C=r===!0?1/0:r;d=()=>Eo(S(),C)}const v=IN(),g=()=>{h.stop(),v&&v.active&&C_(v.effects,h)};if(s&&e){const S=e;e=(...C)=>{S(...C),g()}}let x=b?new Array(n.length).fill(Xd):Xd;const w=S=>{if(!(!(h.flags&1)||!h.dirty&&!S))if(e){const C=h.run();if(r||y||(b?C.some((A,E)=>_a(A,x[E])):_a(C,x))){p&&p();const A=$a;$a=h;try{const E=[C,x===Xd?void 0:b&&x[0]===Xd?[]:x,m];x=C,l?l(e,3,E):e(...E)}finally{$a=A}}}else h.run()};return a&&a(w),h=new AT(d),h.scheduler=o?()=>o(w,!1):w,m=S=>nO(S,!1,h),p=h.onStop=()=>{const S=_p.get(h);if(S){if(l)l(S,4);else for(const C of S)C();_p.delete(h)}},e?i?w(!0):x=h.run():o?o(w.bind(null,!0),!0):h.run(),g.pause=h.pause.bind(h),g.resume=h.resume.bind(h),g.stop=g,g}function Eo(n,e=1/0,t){if(e<=0||!_n(n)||n.__v_skip||(t=t||new Map,(t.get(n)||0)>=e))return n;if(t.set(n,e),e--,Pi(n))Eo(n.value,e,t);else if(bt(n))for(let i=0;i<n.length;i++)Eo(n[i],e,t);else if(Hp(n)||vc(n))n.forEach(i=>{Eo(i,e,t)});else if(xT(n)){for(const i in n)Eo(n[i],e,t);for(const i of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,i)&&Eo(n[i],e,t)}return n}/**
* @vue/runtime-core v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fh(n,e,t,i){try{return i?n(...i):n()}catch(r){Jp(r,e,t)}}function Js(n,e,t,i){if(Et(n)){const r=Fh(n,e,t,i);return r&&vT(r)&&r.catch(s=>{Jp(s,e,t)}),r}if(bt(n)){const r=[];for(let s=0;s<n.length;s++)r.push(Js(n[s],e,t,i));return r}}function Jp(n,e,t,i=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||gn;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](n,l,c)===!1)return}a=a.parent}if(s){No(),Fh(s,null,10,[n,l,c]),Oo();return}}rO(n,t,r,i,o)}function rO(n,e,t,i=!0,r=!1){if(r)throw n;console.error(n)}const nr=[];let zs=-1;const bc=[];let ca=null,uc=0;const XT=Promise.resolve();let vp=null;function jT(n){const e=vp||XT;return n?e.then(this?n.bind(this):n):e}function sO(n){let e=zs+1,t=nr.length;for(;e<t;){const i=e+t>>>1,r=nr[i],s=hh(r);s<n||s===n&&r.flags&2?e=i+1:t=i}return e}function W_(n){if(!(n.flags&1)){const e=hh(n),t=nr[nr.length-1];!t||!(n.flags&2)&&e>=hh(t)?nr.push(n):nr.splice(sO(e),0,n),n.flags|=1,YT()}}function YT(){vp||(vp=XT.then(JT))}function oO(n){bt(n)?bc.push(...n):ca&&n.id===-1?ca.splice(uc+1,0,n):n.flags&1||(bc.push(n),n.flags|=1),YT()}function gw(n,e,t=zs+1){for(;t<nr.length;t++){const i=nr[t];if(i&&i.flags&2){if(n&&i.id!==n.uid)continue;nr.splice(t,1),t--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function KT(n){if(bc.length){const e=[...new Set(bc)].sort((t,i)=>hh(t)-hh(i));if(bc.length=0,ca){ca.push(...e);return}for(ca=e,uc=0;uc<ca.length;uc++){const t=ca[uc];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}ca=null,uc=0}}const hh=n=>n.id==null?n.flags&2?-1:1/0:n.id;function JT(n){try{for(zs=0;zs<nr.length;zs++){const e=nr[zs];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Fh(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;zs<nr.length;zs++){const e=nr[zs];e&&(e.flags&=-2)}zs=-1,nr.length=0,KT(),vp=null,(nr.length||bc.length)&&JT()}}let Ci=null,QT=null;function bp(n){const e=Ci;return Ci=n,QT=n&&n.type.__scopeId||null,e}function yn(n,e=Ci,t){if(!e||n._n)return n;const i=(...r)=>{i._d&&Sp(-1);const s=bp(e);let o;try{o=n(...r)}finally{bp(s),i._d&&Sp(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Yn(n,e){if(Ci===null)return n;const t=em(Ci),i=n.dirs||(n.dirs=[]);for(let r=0;r<e.length;r++){let[s,o,a,l=gn]=e[r];s&&(Et(s)&&(s={mounted:s,updated:s}),s.deep&&Eo(o),i.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Wa(n,e,t,i){const r=n.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(No(),Js(l,t,8,[n.el,a,n,e]),Oo())}}function ip(n,e){if(Bi){let t=Bi.provides;const i=Bi.parent&&Bi.parent.provides;i===t&&(t=Bi.provides=Object.create(i)),t[n]=e}}function Ss(n,e,t=!1){const i=TE();if(i||wc){let r=wc?wc._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&n in r)return r[n];if(arguments.length>1)return t&&Et(e)?e.call(i&&i.proxy):e}}const aO=Symbol.for("v-scx"),lO=()=>Ss(aO);function li(n,e,t){return $T(n,e,t)}function $T(n,e,t=gn){const{immediate:i,deep:r,flush:s,once:o}=t,a=Xi({},t),l=e&&i||!e&&s!=="post";let c;if(ph){if(s==="sync"){const m=lO();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=Zs,m.resume=Zs,m.pause=Zs,m}}const h=Bi;a.call=(m,y,b)=>Js(m,h,y,b);let d=!1;s==="post"?a.scheduler=m=>{Cr(m,h&&h.suspense)}:s!=="sync"&&(d=!0,a.scheduler=(m,y)=>{y?m():W_(m)}),a.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,h&&(m.id=h.uid,m.i=h))};const p=iO(n,e,a);return ph&&(c?c.push(p):l&&p()),p}function cO(n,e,t){const i=this.proxy,r=Qn(n)?n.includes(".")?qT(i,n):()=>i[n]:n.bind(i,i);let s;Et(e)?s=e:(s=e.handler,t=e);const o=Wh(this),a=$T(r,s.bind(i),t);return o(),a}function qT(n,e){const t=e.split(".");return()=>{let i=n;for(let r=0;r<t.length&&i;r++)i=i[t[r]];return i}}const uO=Symbol("_vte"),hO=n=>n.__isTeleport,dO=Symbol("_leaveCb");function V_(n,e){n.shapeFlag&6&&n.component?(n.transition=e,V_(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function gt(n,e){return Et(n)?Xi({name:n.name},e,{setup:n}):n}function eE(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const xp=new WeakMap;function $u(n,e,t,i,r=!1){if(bt(n)){n.forEach((y,b)=>$u(y,e&&(bt(e)?e[b]:e),t,i,r));return}if(xc(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&$u(n,e,t,i.component.subTree);return}const s=i.shapeFlag&4?em(i.component):i.el,o=r?null:s,{i:a,r:l}=n,c=e&&e.r,h=a.refs===gn?a.refs={}:a.refs,d=a.setupState,p=on(d),m=d===gn?_T:y=>an(p,y);if(c!=null&&c!==l){if(yw(e),Qn(c))h[c]=null,m(c)&&(d[c]=null);else if(Pi(c)){c.value=null;const y=e;y.k&&(h[y.k]=null)}}if(Et(l))Fh(l,a,12,[o,h]);else{const y=Qn(l),b=Pi(l);if(y||b){const v=()=>{if(n.f){const g=y?m(l)?d[l]:h[l]:l.value;if(r)bt(g)&&C_(g,s);else if(bt(g))g.includes(s)||g.push(s);else if(y)h[l]=[s],m(l)&&(d[l]=h[l]);else{const x=[s];l.value=x,n.k&&(h[n.k]=x)}}else y?(h[l]=o,m(l)&&(d[l]=o)):b&&(l.value=o,n.k&&(h[n.k]=o))};if(o){const g=()=>{v(),xp.delete(n)};g.id=-1,xp.set(n,g),Cr(g,t)}else yw(n),v()}}}function yw(n){const e=xp.get(n);e&&(e.flags|=8,xp.delete(n))}jp().requestIdleCallback;jp().cancelIdleCallback;const xc=n=>!!n.type.__asyncLoader,tE=n=>n.type.__isKeepAlive;function fO(n,e){nE(n,"a",e)}function pO(n,e){nE(n,"da",e)}function nE(n,e,t=Bi){const i=n.__wdc||(n.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return n()});if(Qp(e,i,t),t){let r=t.parent;for(;r&&r.parent;)tE(r.parent.vnode)&&mO(i,e,t,r),r=r.parent}}function mO(n,e,t,i){const r=Qp(e,n,i,!0);G_(()=>{C_(i[e],r)},t)}function Qp(n,e,t=Bi,i=!1){if(t){const r=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{No();const a=Wh(t),l=Js(e,t,n,o);return a(),Oo(),l});return i?r.unshift(s):r.push(s),s}}const Vo=n=>(e,t=Bi)=>{(!ph||n==="sp")&&Qp(n,(...i)=>e(...i),t)},gO=Vo("bm"),Dn=Vo("m"),yO=Vo("bu"),_O=Vo("u"),Vn=Vo("bum"),G_=Vo("um"),vO=Vo("sp"),bO=Vo("rtg"),xO=Vo("rtc");function wO(n,e=Bi){Qp("ec",n,e)}const iE="components";function Uh(n,e){return sE(iE,n,!0,e)||n}const rE=Symbol.for("v-ndc");function SO(n){return Qn(n)?sE(iE,n,!1)||n:n||rE}function sE(n,e,t=!0,i=!1){const r=Ci||Bi;if(r){const s=r.type;{const a=ck(s,!1);if(a&&(a===e||a===ts(e)||a===Xp(ts(e))))return s}const o=_w(r[n]||s[n],e)||_w(r.appContext[n],e);return!o&&i?s:o}}function _w(n,e){return n&&(n[e]||n[ts(e)]||n[Xp(ts(e))])}function Cc(n,e,t,i){let r;const s=t,o=bt(n);if(o||Qn(n)){const a=o&&cl(n);let l=!1,c=!1;a&&(l=!qr(n),c=ko(n),n=Kp(n)),r=new Array(n.length);for(let h=0,d=n.length;h<d;h++)r[h]=e(l?c?Ac(Es(n[h])):Es(n[h]):n[h],h,void 0,s)}else if(typeof n=="number"){r=new Array(n);for(let a=0;a<n;a++)r[a]=e(a+1,a,void 0,s)}else if(_n(n))if(n[Symbol.iterator])r=Array.from(n,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(n);r=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];r[l]=e(n[h],h,l,s)}}else r=[];return r}function MO(n,e,t={},i,r){if(Ci.ce||Ci.parent&&xc(Ci.parent)&&Ci.parent.ce){const c=Object.keys(t).length>0;return ot(),Cn(Un,null,[xt("slot",t,i)],c?-2:64)}let s=n[e];s&&s._c&&(s._d=!1),ot();const o=s&&oE(s(t)),a=t.key||o&&o.key,l=Cn(Un,{key:(a&&!Ts(a)?a:`_${e}`)+(!o&&i?"_fb":"")},o||[],o&&n._===1?64:-2);return s&&s._c&&(s._d=!0),l}function oE(n){return n.some(e=>fh(e)?!(e.type===Fo||e.type===Un&&!oE(e.children)):!0)?n:null}const l0=n=>n?EE(n)?em(n):l0(n.parent):null,qu=Xi(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>l0(n.parent),$root:n=>l0(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>lE(n),$forceUpdate:n=>n.f||(n.f=()=>{W_(n.update)}),$nextTick:n=>n.n||(n.n=jT.bind(n.proxy)),$watch:n=>cO.bind(n)}),Ug=(n,e)=>n!==gn&&!n.__isScriptSetup&&an(n,e),TO={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=n;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return i[e];case 2:return r[e];case 4:return t[e];case 3:return s[e]}else{if(Ug(i,e))return o[e]=1,i[e];if(r!==gn&&an(r,e))return o[e]=2,r[e];if(an(s,e))return o[e]=3,s[e];if(t!==gn&&an(t,e))return o[e]=4,t[e];c0&&(o[e]=0)}}const c=qu[e];let h,d;if(c)return e==="$attrs"&&Gi(n.attrs,"get",""),c(n);if((h=a.__cssModules)&&(h=h[e]))return h;if(t!==gn&&an(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,an(d,e))return d[e]},set({_:n},e,t){const{data:i,setupState:r,ctx:s}=n;return Ug(r,e)?(r[e]=t,!0):i!==gn&&an(i,e)?(i[e]=t,!0):an(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:i,appContext:r,props:s,type:o}},a){let l;return!!(t[a]||n!==gn&&a[0]!=="$"&&an(n,a)||Ug(e,a)||an(s,a)||an(i,a)||an(qu,a)||an(r.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:an(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function vw(n){return bt(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let c0=!0;function EO(n){const e=lE(n),t=n.proxy,i=n.ctx;c0=!1,e.beforeCreate&&bw(e.beforeCreate,n,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:d,mounted:p,beforeUpdate:m,updated:y,activated:b,deactivated:v,beforeDestroy:g,beforeUnmount:x,destroyed:w,unmounted:S,render:C,renderTracked:A,renderTriggered:E,errorCaptured:O,serverPrefetch:R,expose:T,inheritAttrs:k,components:Y,directives:$,filters:re}=e;if(c&&LO(c,i,null),o)for(const te in o){const J=o[te];Et(J)&&(i[te]=J.bind(t))}if(r){const te=r.call(t,t);_n(te)&&(n.data=xl(te))}if(c0=!0,s)for(const te in s){const J=s[te],pe=Et(J)?J.bind(t,t):Et(J.get)?J.get.bind(t,t):Zs,Te=!Et(J)&&Et(J.set)?J.set.bind(t):Zs,Le=ci({get:pe,set:Te});Object.defineProperty(i,te,{enumerable:!0,configurable:!0,get:()=>Le.value,set:Ue=>Le.value=Ue})}if(a)for(const te in a)aE(a[te],i,t,te);if(l){const te=Et(l)?l.call(t):l;Reflect.ownKeys(te).forEach(J=>{ip(J,te[J])})}h&&bw(h,n,"c");function V(te,J){bt(J)?J.forEach(pe=>te(pe.bind(t))):J&&te(J.bind(t))}if(V(gO,d),V(Dn,p),V(yO,m),V(_O,y),V(fO,b),V(pO,v),V(wO,O),V(xO,A),V(bO,E),V(Vn,x),V(G_,S),V(vO,R),bt(T))if(T.length){const te=n.exposed||(n.exposed={});T.forEach(J=>{Object.defineProperty(te,J,{get:()=>t[J],set:pe=>t[J]=pe,enumerable:!0})})}else n.exposed||(n.exposed={});C&&n.render===Zs&&(n.render=C),k!=null&&(n.inheritAttrs=k),Y&&(n.components=Y),$&&(n.directives=$),R&&eE(n)}function LO(n,e,t=Zs){bt(n)&&(n=u0(n));for(const i in n){const r=n[i];let s;_n(r)?"default"in r?s=Ss(r.from||i,r.default,!0):s=Ss(r.from||i):s=Ss(r),Pi(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function bw(n,e,t){Js(bt(n)?n.map(i=>i.bind(e.proxy)):n.bind(e.proxy),e,t)}function aE(n,e,t,i){let r=i.includes(".")?qT(t,i):()=>t[i];if(Qn(n)){const s=e[n];Et(s)&&li(r,s)}else if(Et(n))li(r,n.bind(t));else if(_n(n))if(bt(n))n.forEach(s=>aE(s,e,t,i));else{const s=Et(n.handler)?n.handler.bind(t):e[n.handler];Et(s)&&li(r,s,n)}}function lE(n){const e=n.type,{mixins:t,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!t&&!i?l=e:(l={},r.length&&r.forEach(c=>wp(l,c,o,!0)),wp(l,e,o)),_n(e)&&s.set(e,l),l}function wp(n,e,t,i=!1){const{mixins:r,extends:s}=e;s&&wp(n,s,t,!0),r&&r.forEach(o=>wp(n,o,t,!0));for(const o in e)if(!(i&&o==="expose")){const a=AO[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const AO={data:xw,props:ww,emits:ww,methods:Vu,computed:Vu,beforeCreate:qi,created:qi,beforeMount:qi,mounted:qi,beforeUpdate:qi,updated:qi,beforeDestroy:qi,beforeUnmount:qi,destroyed:qi,unmounted:qi,activated:qi,deactivated:qi,errorCaptured:qi,serverPrefetch:qi,components:Vu,directives:Vu,watch:RO,provide:xw,inject:CO};function xw(n,e){return e?n?function(){return Xi(Et(n)?n.call(this,this):n,Et(e)?e.call(this,this):e)}:e:n}function CO(n,e){return Vu(u0(n),u0(e))}function u0(n){if(bt(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function qi(n,e){return n?[...new Set([].concat(n,e))]:e}function Vu(n,e){return n?Xi(Object.create(null),n,e):e}function ww(n,e){return n?bt(n)&&bt(e)?[...new Set([...n,...e])]:Xi(Object.create(null),vw(n),vw(e??{})):e}function RO(n,e){if(!n)return e;if(!e)return n;const t=Xi(Object.create(null),n);for(const i in e)t[i]=qi(n[i],e[i]);return t}function cE(){return{app:null,config:{isNativeTag:_T,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let PO=0;function IO(n,e){return function(i,r=null){Et(i)||(i=Xi({},i)),r!=null&&!_n(r)&&(r=null);const s=cE(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:PO++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:hk,get config(){return s.config},set config(h){},use(h,...d){return o.has(h)||(h&&Et(h.install)?(o.add(h),h.install(c,...d)):Et(h)&&(o.add(h),h(c,...d))),c},mixin(h){return s.mixins.includes(h)||s.mixins.push(h),c},component(h,d){return d?(s.components[h]=d,c):s.components[h]},directive(h,d){return d?(s.directives[h]=d,c):s.directives[h]},mount(h,d,p){if(!l){const m=c._ceVNode||xt(i,r);return m.appContext=s,p===!0?p="svg":p===!1&&(p=void 0),n(m,h,p),l=!0,c._container=h,h.__vue_app__=c,em(m.component)}},onUnmount(h){a.push(h)},unmount(){l&&(Js(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(h,d){return s.provides[h]=d,c},runWithContext(h){const d=wc;wc=c;try{return h()}finally{wc=d}}};return c}}let wc=null;const DO=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${ts(e)}Modifiers`]||n[`${bl(e)}Modifiers`];function NO(n,e,...t){if(n.isUnmounted)return;const i=n.vnode.props||gn;let r=t;const s=e.startsWith("update:"),o=s&&DO(i,e.slice(7));o&&(o.trim&&(r=t.map(h=>Qn(h)?h.trim():h)),o.number&&(r=t.map(P_)));let a,l=i[a=Dg(e)]||i[a=Dg(ts(e))];!l&&s&&(l=i[a=Dg(bl(e))]),l&&Js(l,n,6,r);const c=i[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Js(c,n,6,r)}}const OO=new WeakMap;function uE(n,e,t=!1){const i=t?OO:e.emitsCache,r=i.get(n);if(r!==void 0)return r;const s=n.emits;let o={},a=!1;if(!Et(n)){const l=c=>{const h=uE(c,e,!0);h&&(a=!0,Xi(o,h))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(_n(n)&&i.set(n,null),null):(bt(s)?s.forEach(l=>o[l]=null):Xi(o,s),_n(n)&&i.set(n,o),o)}function $p(n,e){return!n||!Bp(e)?!1:(e=e.slice(2).replace(/Once$/,""),an(n,e[0].toLowerCase()+e.slice(1))||an(n,bl(e))||an(n,e))}function Sw(n){const{type:e,vnode:t,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:d,data:p,setupState:m,ctx:y,inheritAttrs:b}=n,v=bp(n);let g,x;try{if(t.shapeFlag&4){const S=r||i,C=S;g=Ws(c.call(C,S,h,d,m,p,y)),x=a}else{const S=e;g=Ws(S.length>1?S(d,{attrs:a,slots:o,emit:l}):S(d,null)),x=e.props?a:kO(a)}}catch(S){eh.length=0,Jp(S,n,1),g=xt(Fo)}let w=g;if(x&&b!==!1){const S=Object.keys(x),{shapeFlag:C}=w;S.length&&C&7&&(s&&S.some(A_)&&(x=FO(x,s)),w=Rc(w,x,!1,!0))}return t.dirs&&(w=Rc(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(t.dirs):t.dirs),t.transition&&V_(w,t.transition),g=w,bp(v),g}const kO=n=>{let e;for(const t in n)(t==="class"||t==="style"||Bp(t))&&((e||(e={}))[t]=n[t]);return e},FO=(n,e)=>{const t={};for(const i in n)(!A_(i)||!(i.slice(9)in e))&&(t[i]=n[i]);return t};function UO(n,e,t){const{props:i,children:r,component:s}=n,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return i?Mw(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let d=0;d<h.length;d++){const p=h[d];if(o[p]!==i[p]&&!$p(c,p))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?Mw(i,o,c):!0:!!o;return!1}function Mw(n,e,t){const i=Object.keys(e);if(i.length!==Object.keys(n).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==n[s]&&!$p(t,s))return!0}return!1}function zO({vnode:n,parent:e},t){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===n&&(i.el=n.el),i===n)(n=e.vnode).el=t,e=e.parent;else break}}const hE={},dE=()=>Object.create(hE),fE=n=>Object.getPrototypeOf(n)===hE;function WO(n,e,t,i=!1){const r={},s=dE();n.propsDefaults=Object.create(null),pE(n,e,r,s);for(const o in n.propsOptions[0])o in r||(r[o]=void 0);t?n.props=i?r:GT(r):n.type.props?n.props=r:n.props=s,n.attrs=s}function VO(n,e,t,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=n,a=on(r),[l]=n.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=n.vnode.dynamicProps;for(let d=0;d<h.length;d++){let p=h[d];if($p(n.emitsOptions,p))continue;const m=e[p];if(l)if(an(s,p))m!==s[p]&&(s[p]=m,c=!0);else{const y=ts(p);r[y]=h0(l,a,y,m,n,!1)}else m!==s[p]&&(s[p]=m,c=!0)}}}else{pE(n,e,r,s)&&(c=!0);let h;for(const d in a)(!e||!an(e,d)&&((h=bl(d))===d||!an(e,h)))&&(l?t&&(t[d]!==void 0||t[h]!==void 0)&&(r[d]=h0(l,a,d,void 0,n,!0)):delete r[d]);if(s!==a)for(const d in s)(!e||!an(e,d))&&(delete s[d],c=!0)}c&&To(n.attrs,"set","")}function pE(n,e,t,i){const[r,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Ku(l))continue;const c=e[l];let h;r&&an(r,h=ts(l))?!s||!s.includes(h)?t[h]=c:(a||(a={}))[h]=c:$p(n.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=on(t),c=a||gn;for(let h=0;h<s.length;h++){const d=s[h];t[d]=h0(r,l,d,c[d],n,!an(c,d))}}return o}function h0(n,e,t,i,r,s){const o=n[t];if(o!=null){const a=an(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Et(l)){const{propsDefaults:c}=r;if(t in c)i=c[t];else{const h=Wh(r);i=c[t]=l.call(null,e),h()}}else i=l;r.ce&&r.ce._setProp(t,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===bl(t))&&(i=!0))}return i}const GO=new WeakMap;function mE(n,e,t=!1){const i=t?GO:e.propsCache,r=i.get(n);if(r)return r;const s=n.props,o={},a=[];let l=!1;if(!Et(n)){const h=d=>{l=!0;const[p,m]=mE(d,e,!0);Xi(o,p),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!s&&!l)return _n(n)&&i.set(n,_c),_c;if(bt(s))for(let h=0;h<s.length;h++){const d=ts(s[h]);Tw(d)&&(o[d]=gn)}else if(s)for(const h in s){const d=ts(h);if(Tw(d)){const p=s[h],m=o[d]=bt(p)||Et(p)?{type:p}:Xi({},p),y=m.type;let b=!1,v=!0;if(bt(y))for(let g=0;g<y.length;++g){const x=y[g],w=Et(x)&&x.name;if(w==="Boolean"){b=!0;break}else w==="String"&&(v=!1)}else b=Et(y)&&y.name==="Boolean";m[0]=b,m[1]=v,(b||an(m,"default"))&&a.push(d)}}const c=[o,a];return _n(n)&&i.set(n,c),c}function Tw(n){return n[0]!=="$"&&!Ku(n)}const B_=n=>n==="_"||n==="_ctx"||n==="$stable",H_=n=>bt(n)?n.map(Ws):[Ws(n)],BO=(n,e,t)=>{if(e._n)return e;const i=yn((...r)=>H_(e(...r)),t);return i._c=!1,i},gE=(n,e,t)=>{const i=n._ctx;for(const r in n){if(B_(r))continue;const s=n[r];if(Et(s))e[r]=BO(r,s,i);else if(s!=null){const o=H_(s);e[r]=()=>o}}},yE=(n,e)=>{const t=H_(e);n.slots.default=()=>t},_E=(n,e,t)=>{for(const i in e)(t||!B_(i))&&(n[i]=e[i])},HO=(n,e,t)=>{const i=n.slots=dE();if(n.vnode.shapeFlag&32){const r=e._;r?(_E(i,e,t),t&&wT(i,"_",r,!0)):gE(e,i)}else e&&yE(n,e)},ZO=(n,e,t)=>{const{vnode:i,slots:r}=n;let s=!0,o=gn;if(i.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:_E(r,e,t):(s=!e.$stable,gE(e,r)),o=e}else e&&(yE(n,e),o={default:1});if(s)for(const a in r)!B_(a)&&o[a]==null&&delete r[a]},Cr=JO;function XO(n){return jO(n)}function jO(n,e){const t=jp();t.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:d,nextSibling:p,setScopeId:m=Zs,insertStaticContent:y}=n,b=(H,X,D,ge=null,me=null,fe=null,N=void 0,B=null,j=!!X.dynamicChildren)=>{if(H===X)return;H&&!yu(H,X)&&(ge=se(H),Ue(H,me,fe,!0),H=null),X.patchFlag===-2&&(j=!1,X.dynamicChildren=null);const{type:L,ref:P,shapeFlag:Z}=X;switch(L){case zh:v(H,X,D,ge);break;case Fo:g(H,X,D,ge);break;case rp:H==null&&x(X,D,ge,N);break;case Un:Y(H,X,D,ge,me,fe,N,B,j);break;default:Z&1?C(H,X,D,ge,me,fe,N,B,j):Z&6?$(H,X,D,ge,me,fe,N,B,j):(Z&64||Z&128)&&L.process(H,X,D,ge,me,fe,N,B,j,De)}P!=null&&me?$u(P,H&&H.ref,fe,X||H,!X):P==null&&H&&H.ref!=null&&$u(H.ref,null,fe,H,!0)},v=(H,X,D,ge)=>{if(H==null)i(X.el=a(X.children),D,ge);else{const me=X.el=H.el;X.children!==H.children&&c(me,X.children)}},g=(H,X,D,ge)=>{H==null?i(X.el=l(X.children||""),D,ge):X.el=H.el},x=(H,X,D,ge)=>{[H.el,H.anchor]=y(H.children,X,D,ge,H.el,H.anchor)},w=({el:H,anchor:X},D,ge)=>{let me;for(;H&&H!==X;)me=p(H),i(H,D,ge),H=me;i(X,D,ge)},S=({el:H,anchor:X})=>{let D;for(;H&&H!==X;)D=p(H),r(H),H=D;r(X)},C=(H,X,D,ge,me,fe,N,B,j)=>{if(X.type==="svg"?N="svg":X.type==="math"&&(N="mathml"),H==null)A(X,D,ge,me,fe,N,B,j);else{const L=H.el&&H.el._isVueCE?H.el:null;try{L&&L._beginPatch(),R(H,X,me,fe,N,B,j)}finally{L&&L._endPatch()}}},A=(H,X,D,ge,me,fe,N,B)=>{let j,L;const{props:P,shapeFlag:Z,transition:G,dirs:Q}=H;if(j=H.el=o(H.type,fe,P&&P.is,P),Z&8?h(j,H.children):Z&16&&O(H.children,j,null,ge,me,zg(H,fe),N,B),Q&&Wa(H,null,ge,"created"),E(j,H,H.scopeId,N,ge),P){for(const de in P)de!=="value"&&!Ku(de)&&s(j,de,null,P[de],fe,ge);"value"in P&&s(j,"value",null,P.value,fe),(L=P.onVnodeBeforeMount)&&Is(L,ge,H)}Q&&Wa(H,null,ge,"beforeMount");const K=YO(me,G);K&&G.beforeEnter(j),i(j,X,D),((L=P&&P.onVnodeMounted)||K||Q)&&Cr(()=>{L&&Is(L,ge,H),K&&G.enter(j),Q&&Wa(H,null,ge,"mounted")},me)},E=(H,X,D,ge,me)=>{if(D&&m(H,D),ge)for(let fe=0;fe<ge.length;fe++)m(H,ge[fe]);if(me){let fe=me.subTree;if(X===fe||wE(fe.type)&&(fe.ssContent===X||fe.ssFallback===X)){const N=me.vnode;E(H,N,N.scopeId,N.slotScopeIds,me.parent)}}},O=(H,X,D,ge,me,fe,N,B,j=0)=>{for(let L=j;L<H.length;L++){const P=H[L]=B?ua(H[L]):Ws(H[L]);b(null,P,X,D,ge,me,fe,N,B)}},R=(H,X,D,ge,me,fe,N)=>{const B=X.el=H.el;let{patchFlag:j,dynamicChildren:L,dirs:P}=X;j|=H.patchFlag&16;const Z=H.props||gn,G=X.props||gn;let Q;if(D&&Va(D,!1),(Q=G.onVnodeBeforeUpdate)&&Is(Q,D,X,H),P&&Wa(X,H,D,"beforeUpdate"),D&&Va(D,!0),(Z.innerHTML&&G.innerHTML==null||Z.textContent&&G.textContent==null)&&h(B,""),L?T(H.dynamicChildren,L,B,D,ge,zg(X,me),fe):N||J(H,X,B,null,D,ge,zg(X,me),fe,!1),j>0){if(j&16)k(B,Z,G,D,me);else if(j&2&&Z.class!==G.class&&s(B,"class",null,G.class,me),j&4&&s(B,"style",Z.style,G.style,me),j&8){const K=X.dynamicProps;for(let de=0;de<K.length;de++){const ye=K[de],Pe=Z[ye],Qe=G[ye];(Qe!==Pe||ye==="value")&&s(B,ye,Pe,Qe,me,D)}}j&1&&H.children!==X.children&&h(B,X.children)}else!N&&L==null&&k(B,Z,G,D,me);((Q=G.onVnodeUpdated)||P)&&Cr(()=>{Q&&Is(Q,D,X,H),P&&Wa(X,H,D,"updated")},ge)},T=(H,X,D,ge,me,fe,N)=>{for(let B=0;B<X.length;B++){const j=H[B],L=X[B],P=j.el&&(j.type===Un||!yu(j,L)||j.shapeFlag&198)?d(j.el):D;b(j,L,P,null,ge,me,fe,N,!0)}},k=(H,X,D,ge,me)=>{if(X!==D){if(X!==gn)for(const fe in X)!Ku(fe)&&!(fe in D)&&s(H,fe,X[fe],null,me,ge);for(const fe in D){if(Ku(fe))continue;const N=D[fe],B=X[fe];N!==B&&fe!=="value"&&s(H,fe,B,N,me,ge)}"value"in D&&s(H,"value",X.value,D.value,me)}},Y=(H,X,D,ge,me,fe,N,B,j)=>{const L=X.el=H?H.el:a(""),P=X.anchor=H?H.anchor:a("");let{patchFlag:Z,dynamicChildren:G,slotScopeIds:Q}=X;Q&&(B=B?B.concat(Q):Q),H==null?(i(L,D,ge),i(P,D,ge),O(X.children||[],D,P,me,fe,N,B,j)):Z>0&&Z&64&&G&&H.dynamicChildren&&H.dynamicChildren.length===G.length?(T(H.dynamicChildren,G,D,me,fe,N,B),(X.key!=null||me&&X===me.subTree)&&vE(H,X,!0)):J(H,X,D,P,me,fe,N,B,j)},$=(H,X,D,ge,me,fe,N,B,j)=>{X.slotScopeIds=B,H==null?X.shapeFlag&512?me.ctx.activate(X,D,ge,N,j):re(X,D,ge,me,fe,N,j):ae(H,X,j)},re=(H,X,D,ge,me,fe,N)=>{const B=H.component=rk(H,ge,me);if(tE(H)&&(B.ctx.renderer=De),sk(B,!1,N),B.asyncDep){if(me&&me.registerDep(B,V,N),!H.el){const j=B.subTree=xt(Fo);g(null,j,X,D),H.placeholder=j.el}}else V(B,H,X,D,me,fe,N)},ae=(H,X,D)=>{const ge=X.component=H.component;if(UO(H,X,D))if(ge.asyncDep&&!ge.asyncResolved){te(ge,X,D);return}else ge.next=X,ge.update();else X.el=H.el,ge.vnode=X},V=(H,X,D,ge,me,fe,N)=>{const B=()=>{if(H.isMounted){let{next:Z,bu:G,u:Q,parent:K,vnode:de}=H;{const je=bE(H);if(je){Z&&(Z.el=de.el,te(H,Z,N)),je.asyncDep.then(()=>{H.isUnmounted||B()});return}}let ye=Z,Pe;Va(H,!1),Z?(Z.el=de.el,te(H,Z,N)):Z=de,G&&np(G),(Pe=Z.props&&Z.props.onVnodeBeforeUpdate)&&Is(Pe,K,Z,de),Va(H,!0);const Qe=Sw(H),Ne=H.subTree;H.subTree=Qe,b(Ne,Qe,d(Ne.el),se(Ne),H,me,fe),Z.el=Qe.el,ye===null&&zO(H,Qe.el),Q&&Cr(Q,me),(Pe=Z.props&&Z.props.onVnodeUpdated)&&Cr(()=>Is(Pe,K,Z,de),me)}else{let Z;const{el:G,props:Q}=X,{bm:K,m:de,parent:ye,root:Pe,type:Qe}=H,Ne=xc(X);Va(H,!1),K&&np(K),!Ne&&(Z=Q&&Q.onVnodeBeforeMount)&&Is(Z,ye,X),Va(H,!0);{Pe.ce&&Pe.ce._def.shadowRoot!==!1&&Pe.ce._injectChildStyle(Qe);const je=H.subTree=Sw(H);b(null,je,D,ge,H,me,fe),X.el=je.el}if(de&&Cr(de,me),!Ne&&(Z=Q&&Q.onVnodeMounted)){const je=X;Cr(()=>Is(Z,ye,je),me)}(X.shapeFlag&256||ye&&xc(ye.vnode)&&ye.vnode.shapeFlag&256)&&H.a&&Cr(H.a,me),H.isMounted=!0,X=D=ge=null}};H.scope.on();const j=H.effect=new AT(B);H.scope.off();const L=H.update=j.run.bind(j),P=H.job=j.runIfDirty.bind(j);P.i=H,P.id=H.uid,j.scheduler=()=>W_(P),Va(H,!0),L()},te=(H,X,D)=>{X.component=H;const ge=H.vnode.props;H.vnode=X,H.next=null,VO(H,X.props,ge,D),ZO(H,X.children,D),No(),gw(H),Oo()},J=(H,X,D,ge,me,fe,N,B,j=!1)=>{const L=H&&H.children,P=H?H.shapeFlag:0,Z=X.children,{patchFlag:G,shapeFlag:Q}=X;if(G>0){if(G&128){Te(L,Z,D,ge,me,fe,N,B,j);return}else if(G&256){pe(L,Z,D,ge,me,fe,N,B,j);return}}Q&8?(P&16&&We(L,me,fe),Z!==L&&h(D,Z)):P&16?Q&16?Te(L,Z,D,ge,me,fe,N,B,j):We(L,me,fe,!0):(P&8&&h(D,""),Q&16&&O(Z,D,ge,me,fe,N,B,j))},pe=(H,X,D,ge,me,fe,N,B,j)=>{H=H||_c,X=X||_c;const L=H.length,P=X.length,Z=Math.min(L,P);let G;for(G=0;G<Z;G++){const Q=X[G]=j?ua(X[G]):Ws(X[G]);b(H[G],Q,D,null,me,fe,N,B,j)}L>P?We(H,me,fe,!0,!1,Z):O(X,D,ge,me,fe,N,B,j,Z)},Te=(H,X,D,ge,me,fe,N,B,j)=>{let L=0;const P=X.length;let Z=H.length-1,G=P-1;for(;L<=Z&&L<=G;){const Q=H[L],K=X[L]=j?ua(X[L]):Ws(X[L]);if(yu(Q,K))b(Q,K,D,null,me,fe,N,B,j);else break;L++}for(;L<=Z&&L<=G;){const Q=H[Z],K=X[G]=j?ua(X[G]):Ws(X[G]);if(yu(Q,K))b(Q,K,D,null,me,fe,N,B,j);else break;Z--,G--}if(L>Z){if(L<=G){const Q=G+1,K=Q<P?X[Q].el:ge;for(;L<=G;)b(null,X[L]=j?ua(X[L]):Ws(X[L]),D,K,me,fe,N,B,j),L++}}else if(L>G)for(;L<=Z;)Ue(H[L],me,fe,!0),L++;else{const Q=L,K=L,de=new Map;for(L=K;L<=G;L++){const Xe=X[L]=j?ua(X[L]):Ws(X[L]);Xe.key!=null&&de.set(Xe.key,L)}let ye,Pe=0;const Qe=G-K+1;let Ne=!1,je=0;const lt=new Array(Qe);for(L=0;L<Qe;L++)lt[L]=0;for(L=Q;L<=Z;L++){const Xe=H[L];if(Pe>=Qe){Ue(Xe,me,fe,!0);continue}let ne;if(Xe.key!=null)ne=de.get(Xe.key);else for(ye=K;ye<=G;ye++)if(lt[ye-K]===0&&yu(Xe,X[ye])){ne=ye;break}ne===void 0?Ue(Xe,me,fe,!0):(lt[ne-K]=L+1,ne>=je?je=ne:Ne=!0,b(Xe,X[ne],D,null,me,fe,N,B,j),Pe++)}const ut=Ne?KO(lt):_c;for(ye=ut.length-1,L=Qe-1;L>=0;L--){const Xe=K+L,ne=X[Xe],Ee=X[Xe+1],Ke=Xe+1<P?Ee.el||xE(Ee):ge;lt[L]===0?b(null,ne,D,Ke,me,fe,N,B,j):Ne&&(ye<0||L!==ut[ye]?Le(ne,D,Ke,2):ye--)}}},Le=(H,X,D,ge,me=null)=>{const{el:fe,type:N,transition:B,children:j,shapeFlag:L}=H;if(L&6){Le(H.component.subTree,X,D,ge);return}if(L&128){H.suspense.move(X,D,ge);return}if(L&64){N.move(H,X,D,De);return}if(N===Un){i(fe,X,D);for(let Z=0;Z<j.length;Z++)Le(j[Z],X,D,ge);i(H.anchor,X,D);return}if(N===rp){w(H,X,D);return}if(ge!==2&&L&1&&B)if(ge===0)B.beforeEnter(fe),i(fe,X,D),Cr(()=>B.enter(fe),me);else{const{leave:Z,delayLeave:G,afterLeave:Q}=B,K=()=>{H.ctx.isUnmounted?r(fe):i(fe,X,D)},de=()=>{fe._isLeaving&&fe[dO](!0),Z(fe,()=>{K(),Q&&Q()})};G?G(fe,K,de):de()}else i(fe,X,D)},Ue=(H,X,D,ge=!1,me=!1)=>{const{type:fe,props:N,ref:B,children:j,dynamicChildren:L,shapeFlag:P,patchFlag:Z,dirs:G,cacheIndex:Q}=H;if(Z===-2&&(me=!1),B!=null&&(No(),$u(B,null,D,H,!0),Oo()),Q!=null&&(X.renderCache[Q]=void 0),P&256){X.ctx.deactivate(H);return}const K=P&1&&G,de=!xc(H);let ye;if(de&&(ye=N&&N.onVnodeBeforeUnmount)&&Is(ye,X,H),P&6)Ae(H.component,D,ge);else{if(P&128){H.suspense.unmount(D,ge);return}K&&Wa(H,null,X,"beforeUnmount"),P&64?H.type.remove(H,X,D,De,ge):L&&!L.hasOnce&&(fe!==Un||Z>0&&Z&64)?We(L,X,D,!1,!0):(fe===Un&&Z&384||!me&&P&16)&&We(j,X,D),ge&&tt(H)}(de&&(ye=N&&N.onVnodeUnmounted)||K)&&Cr(()=>{ye&&Is(ye,X,H),K&&Wa(H,null,X,"unmounted")},D)},tt=H=>{const{type:X,el:D,anchor:ge,transition:me}=H;if(X===Un){_e(D,ge);return}if(X===rp){S(H);return}const fe=()=>{r(D),me&&!me.persisted&&me.afterLeave&&me.afterLeave()};if(H.shapeFlag&1&&me&&!me.persisted){const{leave:N,delayLeave:B}=me,j=()=>N(D,fe);B?B(H.el,fe,j):j()}else fe()},_e=(H,X)=>{let D;for(;H!==X;)D=p(H),r(H),H=D;r(X)},Ae=(H,X,D)=>{const{bum:ge,scope:me,job:fe,subTree:N,um:B,m:j,a:L}=H;Ew(j),Ew(L),ge&&np(ge),me.stop(),fe&&(fe.flags|=8,Ue(N,H,X,D)),B&&Cr(B,X),Cr(()=>{H.isUnmounted=!0},X)},We=(H,X,D,ge=!1,me=!1,fe=0)=>{for(let N=fe;N<H.length;N++)Ue(H[N],X,D,ge,me)},se=H=>{if(H.shapeFlag&6)return se(H.component.subTree);if(H.shapeFlag&128)return H.suspense.next();const X=p(H.anchor||H.el),D=X&&X[uO];return D?p(D):X};let Se=!1;const Me=(H,X,D)=>{let ge;H==null?X._vnode&&(Ue(X._vnode,null,null,!0),ge=X._vnode.component):b(X._vnode||null,H,X,null,null,null,D),X._vnode=H,Se||(Se=!0,gw(ge),KT(),Se=!1)},De={p:b,um:Ue,m:Le,r:tt,mt:re,mc:O,pc:J,pbc:T,n:se,o:n};return{render:Me,hydrate:void 0,createApp:IO(Me)}}function zg({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Va({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function YO(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function vE(n,e,t=!1){const i=n.children,r=e.children;if(bt(i)&&bt(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=ua(r[s]),a.el=o.el),!t&&a.patchFlag!==-2&&vE(o,a)),a.type===zh&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=s+(n.type===Un?1:0)),a.type===Fo&&!a.el&&(a.el=o.el)}}function KO(n){const e=n.slice(),t=[0];let i,r,s,o,a;const l=n.length;for(i=0;i<l;i++){const c=n[i];if(c!==0){if(r=t[t.length-1],n[r]<c){e[i]=r,t.push(i);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<c?s=a+1:o=a;c<n[t[s]]&&(s>0&&(e[i]=t[s-1]),t[s]=i)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function bE(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:bE(e)}function Ew(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}function xE(n){if(n.placeholder)return n.placeholder;const e=n.component;return e?xE(e.subTree):null}const wE=n=>n.__isSuspense;function JO(n,e){e&&e.pendingBranch?bt(n)?e.effects.push(...n):e.effects.push(n):oO(n)}const Un=Symbol.for("v-fgt"),zh=Symbol.for("v-txt"),Fo=Symbol.for("v-cmt"),rp=Symbol.for("v-stc"),eh=[];let Rr=null;function ot(n=!1){eh.push(Rr=n?null:[])}function QO(){eh.pop(),Rr=eh[eh.length-1]||null}let dh=1;function Sp(n,e=!1){dh+=n,n<0&&Rr&&e&&(Rr.hasOnce=!0)}function SE(n){return n.dynamicChildren=dh>0?Rr||_c:null,QO(),dh>0&&Rr&&Rr.push(n),n}function At(n,e,t,i,r,s){return SE(ee(n,e,t,i,r,s,!0))}function Cn(n,e,t,i,r){return SE(xt(n,e,t,i,r,!0))}function fh(n){return n?n.__v_isVNode===!0:!1}function yu(n,e){return n.type===e.type&&n.key===e.key}const ME=({key:n})=>n??null,sp=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Qn(n)||Pi(n)||Et(n)?{i:Ci,r:n,k:e,f:!!t}:n:null);function ee(n,e=null,t=null,i=0,r=null,s=n===Un?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&ME(e),ref:e&&sp(e),scopeId:QT,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Ci};return a?(Z_(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=Qn(t)?8:16),dh>0&&!o&&Rr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Rr.push(l),l}const xt=$O;function $O(n,e=null,t=null,i=0,r=null,s=!1){if((!n||n===rE)&&(n=Fo),fh(n)){const a=Rc(n,e,!0);return t&&Z_(a,t),dh>0&&!s&&Rr&&(a.shapeFlag&6?Rr[Rr.indexOf(n)]=a:Rr.push(a)),a.patchFlag=-2,a}if(uk(n)&&(n=n.__vccOpts),e){e=qO(e);let{class:a,style:l}=e;a&&!Qn(a)&&(e.class=Dr(a)),_n(l)&&(z_(l)&&!bt(l)&&(l=Xi({},l)),e.style=I_(l))}const o=Qn(n)?1:wE(n)?128:hO(n)?64:_n(n)?4:Et(n)?2:0;return ee(n,e,t,i,r,o,s,!0)}function qO(n){return n?z_(n)||fE(n)?Xi({},n):n:null}function Rc(n,e,t=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=n,c=e?tk(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&ME(c),ref:e&&e.ref?t&&s?bt(s)?s.concat(sp(e)):[s,sp(e)]:sp(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Un?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Rc(n.ssContent),ssFallback:n.ssFallback&&Rc(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&i&&V_(h,l.clone(h)),h}function ul(n=" ",e=0){return xt(zh,null,n,e)}function ek(n,e){const t=xt(rp,null,n);return t.staticCount=e,t}function qp(n="",e=!1){return e?(ot(),Cn(Fo,null,n)):xt(Fo,null,n)}function Ws(n){return n==null||typeof n=="boolean"?xt(Fo):bt(n)?xt(Un,null,n.slice()):fh(n)?ua(n):xt(zh,null,String(n))}function ua(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Rc(n)}function Z_(n,e){let t=0;const{shapeFlag:i}=n;if(e==null)e=null;else if(bt(e))t=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),Z_(n,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!fE(e)?e._ctx=Ci:r===3&&Ci&&(Ci.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Et(e)?(e={default:e,_ctx:Ci},t=32):(e=String(e),i&64?(t=16,e=[ul(e)]):t=8);n.children=e,n.shapeFlag|=t}function tk(...n){const e={};for(let t=0;t<n.length;t++){const i=n[t];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=Dr([e.class,i.class]));else if(r==="style")e.style=I_([e.style,i.style]);else if(Bp(r)){const s=e[r],o=i[r];o&&s!==o&&!(bt(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function Is(n,e,t,i=null){Js(n,e,7,[t,i])}const nk=cE();let ik=0;function rk(n,e,t){const i=n.type,r=(e?e.appContext:n.appContext)||nk,s={uid:ik++,vnode:n,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new LT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:mE(i,r),emitsOptions:uE(i,r),emit:null,emitted:null,propsDefaults:gn,inheritAttrs:i.inheritAttrs,ctx:gn,data:gn,props:gn,attrs:gn,slots:gn,refs:gn,setupState:gn,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=NO.bind(null,s),n.ce&&n.ce(s),s}let Bi=null;const TE=()=>Bi||Ci;let Mp,d0;{const n=jp(),e=(t,i)=>{let r;return(r=n[t])||(r=n[t]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};Mp=e("__VUE_INSTANCE_SETTERS__",t=>Bi=t),d0=e("__VUE_SSR_SETTERS__",t=>ph=t)}const Wh=n=>{const e=Bi;return Mp(n),n.scope.on(),()=>{n.scope.off(),Mp(e)}},Lw=()=>{Bi&&Bi.scope.off(),Mp(null)};function EE(n){return n.vnode.shapeFlag&4}let ph=!1;function sk(n,e=!1,t=!1){e&&d0(e);const{props:i,children:r}=n.vnode,s=EE(n);WO(n,i,s,e),HO(n,r,t||e);const o=s?ok(n,e):void 0;return e&&d0(!1),o}function ok(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,TO);const{setup:i}=t;if(i){No();const r=n.setupContext=i.length>1?lk(n):null,s=Wh(n),o=Fh(i,n,0,[n.props,r]),a=vT(o);if(Oo(),s(),(a||n.sp)&&!xc(n)&&eE(n),a){if(o.then(Lw,Lw),e)return o.then(l=>{Aw(n,l)}).catch(l=>{Jp(l,n,0)});n.asyncDep=o}else Aw(n,o)}else LE(n)}function Aw(n,e,t){Et(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:_n(e)&&(n.setupState=ZT(e)),LE(n)}function LE(n,e,t){const i=n.type;n.render||(n.render=i.render||Zs);{const r=Wh(n);No();try{EO(n)}finally{Oo(),r()}}}const ak={get(n,e){return Gi(n,"get",""),n[e]}};function lk(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,ak),slots:n.slots,emit:n.emit,expose:e}}function em(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(ZT(QN(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in qu)return qu[t](n)},has(e,t){return t in e||t in qu}})):n.proxy}function ck(n,e=!0){return Et(n)?n.displayName||n.name:n.name||e&&n.__name}function uk(n){return Et(n)&&"__vccOpts"in n}const ci=(n,e)=>tO(n,e,ph);function tm(n,e,t){try{Sp(-1);const i=arguments.length;return i===2?_n(e)&&!bt(e)?fh(e)?xt(n,null,[e]):xt(n,e):xt(n,null,e):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&fh(t)&&(t=[t]),xt(n,e,t))}finally{Sp(1)}}const hk="3.5.26";/**
* @vue/runtime-dom v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let f0;const Cw=typeof window<"u"&&window.trustedTypes;if(Cw)try{f0=Cw.createPolicy("vue",{createHTML:n=>n})}catch{}const AE=f0?n=>f0.createHTML(n):n=>n,dk="http://www.w3.org/2000/svg",fk="http://www.w3.org/1998/Math/MathML",So=typeof document<"u"?document:null,Rw=So&&So.createElement("template"),pk={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,i)=>{const r=e==="svg"?So.createElementNS(dk,n):e==="mathml"?So.createElementNS(fk,n):t?So.createElement(n,{is:t}):So.createElement(n);return n==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:n=>So.createTextNode(n),createComment:n=>So.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>So.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,i,r,s){const o=t?t.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===s||!(r=r.nextSibling)););else{Rw.innerHTML=AE(i==="svg"?`<svg>${n}</svg>`:i==="mathml"?`<math>${n}</math>`:n);const a=Rw.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},mk=Symbol("_vtc");function gk(n,e,t){const i=n[mk];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Tp=Symbol("_vod"),CE=Symbol("_vsh"),Pw={name:"show",beforeMount(n,{value:e},{transition:t}){n[Tp]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):_u(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:i}){!e!=!t&&(i?e?(i.beforeEnter(n),_u(n,!0),i.enter(n)):i.leave(n,()=>{_u(n,!1)}):_u(n,e))},beforeUnmount(n,{value:e}){_u(n,e)}};function _u(n,e){n.style.display=e?n[Tp]:"none",n[CE]=!e}const yk=Symbol(""),_k=/(?:^|;)\s*display\s*:/;function vk(n,e,t){const i=n.style,r=Qn(t);let s=!1;if(t&&!r){if(e)if(Qn(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&op(i,a,"")}else for(const o in e)t[o]==null&&op(i,o,"");for(const o in t)o==="display"&&(s=!0),op(i,o,t[o])}else if(r){if(e!==t){const o=i[yk];o&&(t+=";"+o),i.cssText=t,s=_k.test(t)}}else e&&n.removeAttribute("style");Tp in n&&(n[Tp]=s?i.display:"",n[CE]&&(i.display="none"))}const Iw=/\s*!important$/;function op(n,e,t){if(bt(t))t.forEach(i=>op(n,e,i));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const i=bk(n,e);Iw.test(t)?n.setProperty(bl(i),t.replace(Iw,""),"important"):n[i]=t}}const Dw=["Webkit","Moz","ms"],Wg={};function bk(n,e){const t=Wg[e];if(t)return t;let i=ts(e);if(i!=="filter"&&i in n)return Wg[e]=i;i=Xp(i);for(let r=0;r<Dw.length;r++){const s=Dw[r]+i;if(s in n)return Wg[e]=s}return e}const Nw="http://www.w3.org/1999/xlink";function Ow(n,e,t,i,r,s=CN(e)){i&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Nw,e.slice(6,e.length)):n.setAttributeNS(Nw,e,t):t==null||s&&!ST(t)?n.removeAttribute(e):n.setAttribute(e,s?"":Ts(t)?String(t):t)}function kw(n,e,t,i,r){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?AE(t):t);return}const s=n.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=ST(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(r||e)}function tl(n,e,t,i){n.addEventListener(e,t,i)}function xk(n,e,t,i){n.removeEventListener(e,t,i)}const Fw=Symbol("_vei");function wk(n,e,t,i,r=null){const s=n[Fw]||(n[Fw]={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=Sk(e);if(i){const c=s[e]=Ek(i,r);tl(n,a,c,l)}else o&&(xk(n,a,o,l),s[e]=void 0)}}const Uw=/(?:Once|Passive|Capture)$/;function Sk(n){let e;if(Uw.test(n)){e={};let i;for(;i=n.match(Uw);)n=n.slice(0,n.length-i[0].length),e[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):bl(n.slice(2)),e]}let Vg=0;const Mk=Promise.resolve(),Tk=()=>Vg||(Mk.then(()=>Vg=0),Vg=Date.now());function Ek(n,e){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;Js(Lk(i,t.value),e,5,[i])};return t.value=n,t.attached=Tk(),t}function Lk(n,e){if(bt(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const zw=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Ak=(n,e,t,i,r,s)=>{const o=r==="svg";e==="class"?gk(n,i,o):e==="style"?vk(n,t,i):Bp(e)?A_(e)||wk(n,e,t,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Ck(n,e,i,o))?(kw(n,e,i),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ow(n,e,i,o,s,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!Qn(i))?kw(n,ts(e),i,s,e):(e==="true-value"?n._trueValue=i:e==="false-value"&&(n._falseValue=i),Ow(n,e,i,o))};function Ck(n,e,t,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in n&&zw(e)&&Et(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&n.tagName==="IFRAME"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=n.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return zw(e)&&Qn(t)?!1:e in n}const Ep=n=>{const e=n.props["onUpdate:modelValue"]||!1;return bt(e)?t=>np(e,t):e};function Rk(n){n.target.composing=!0}function Ww(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Sc=Symbol("_assign");function Vw(n,e,t){return e&&(n=n.trim()),t&&(n=P_(n)),n}const Hi={created(n,{modifiers:{lazy:e,trim:t,number:i}},r){n[Sc]=Ep(r);const s=i||r.props&&r.props.type==="number";tl(n,e?"change":"input",o=>{o.target.composing||n[Sc](Vw(n.value,t,s))}),(t||s)&&tl(n,"change",()=>{n.value=Vw(n.value,t,s)}),e||(tl(n,"compositionstart",Rk),tl(n,"compositionend",Ww),tl(n,"change",Ww))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:i,trim:r,number:s}},o){if(n[Sc]=Ep(o),n.composing)return;const a=(s||n.type==="number")&&!/^0\d/.test(n.value)?P_(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(i&&e===t||r&&n.value.trim()===l)||(n.value=l))}},p0={deep:!0,created(n,e,t){n[Sc]=Ep(t),tl(n,"change",()=>{const i=n._modelValue,r=Pk(n),s=n.checked,o=n[Sc];if(bt(i)){const a=MT(i,r),l=a!==-1;if(s&&!l)o(i.concat(r));else if(!s&&l){const c=[...i];c.splice(a,1),o(c)}}else if(Hp(i)){const a=new Set(i);s?a.add(r):a.delete(r),o(a)}else o(RE(n,s))})},mounted:Gw,beforeUpdate(n,e,t){n[Sc]=Ep(t),Gw(n,e,t)}};function Gw(n,{value:e,oldValue:t},i){n._modelValue=e;let r;if(bt(e))r=MT(e,i.props.value)>-1;else if(Hp(e))r=e.has(i.props.value);else{if(e===t)return;r=Yp(e,RE(n,!0))}n.checked!==r&&(n.checked=r)}function Pk(n){return"_value"in n?n._value:n.value}function RE(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const Ik=Xi({patchProp:Ak},pk);let Bw;function Dk(){return Bw||(Bw=XO(Ik))}const Nk=(...n)=>{const e=Dk().createApp(...n),{mount:t}=e;return e.mount=i=>{const r=kk(i);if(!r)return;const s=e._component;!Et(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=t(r,!1,Ok(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Ok(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function kk(n){return Qn(n)?document.querySelector(n):n}const Vh=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t},Fk={};function Uk(n,e){const t=Uh("router-view");return ot(),Cn(t)}const zk=Vh(Fk,[["render",Uk]]);/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const hc=typeof document<"u";function PE(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function Wk(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&PE(n.default)}const rn=Object.assign;function Gg(n,e){const t={};for(const i in e){const r=e[i];t[i]=Ls(r)?r.map(n):n(r)}return t}const th=()=>{},Ls=Array.isArray;function Hw(n,e){const t={};for(const i in n)t[i]=i in e?e[i]:n[i];return t}const IE=/#/g,Vk=/&/g,Gk=/\//g,Bk=/=/g,Hk=/\?/g,DE=/\+/g,Zk=/%5B/g,Xk=/%5D/g,NE=/%5E/g,jk=/%60/g,OE=/%7B/g,Yk=/%7C/g,kE=/%7D/g,Kk=/%20/g;function X_(n){return n==null?"":encodeURI(""+n).replace(Yk,"|").replace(Zk,"[").replace(Xk,"]")}function Jk(n){return X_(n).replace(OE,"{").replace(kE,"}").replace(NE,"^")}function m0(n){return X_(n).replace(DE,"%2B").replace(Kk,"+").replace(IE,"%23").replace(Vk,"%26").replace(jk,"`").replace(OE,"{").replace(kE,"}").replace(NE,"^")}function Qk(n){return m0(n).replace(Bk,"%3D")}function $k(n){return X_(n).replace(IE,"%23").replace(Hk,"%3F")}function qk(n){return $k(n).replace(Gk,"%2F")}function mh(n){if(n==null)return null;try{return decodeURIComponent(""+n)}catch{}return""+n}const eF=/\/$/,tF=n=>n.replace(eF,"");function Bg(n,e,t="/"){let i,r={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return l=a>=0&&l>a?-1:l,l>=0&&(i=e.slice(0,l),s=e.slice(l,a>0?a:e.length),r=n(s.slice(1))),a>=0&&(i=i||e.slice(0,a),o=e.slice(a,e.length)),i=sF(i??e,t),{fullPath:i+s+o,path:i,query:r,hash:mh(o)}}function nF(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Zw(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function iF(n,e,t){const i=e.matched.length-1,r=t.matched.length-1;return i>-1&&i===r&&Pc(e.matched[i],t.matched[r])&&FE(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Pc(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function FE(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(var t in n)if(!rF(n[t],e[t]))return!1;return!0}function rF(n,e){return Ls(n)?Xw(n,e):Ls(e)?Xw(e,n):(n==null?void 0:n.valueOf())===(e==null?void 0:e.valueOf())}function Xw(n,e){return Ls(e)?n.length===e.length&&n.every((t,i)=>t===e[i]):n.length===1&&n[0]===e}function sF(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),i=n.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let s=t.length-1,o,a;for(o=0;o<i.length;o++)if(a=i[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+i.slice(o).join("/")}const Qo={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let g0=function(n){return n.pop="pop",n.push="push",n}({}),Hg=function(n){return n.back="back",n.forward="forward",n.unknown="",n}({});function oF(n){if(!n)if(hc){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),tF(n)}const aF=/^[^#]+#/;function lF(n,e){return n.replace(aF,"#")+e}function cF(n,e){const t=document.documentElement.getBoundingClientRect(),i=n.getBoundingClientRect();return{behavior:e.behavior,left:i.left-t.left-(e.left||0),top:i.top-t.top-(e.top||0)}}const nm=()=>({left:window.scrollX,top:window.scrollY});function uF(n){let e;if("el"in n){const t=n.el,i=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?i?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;e=cF(r,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function jw(n,e){return(history.state?history.state.position-e:-1)+n}const y0=new Map;function hF(n,e){y0.set(n,e)}function dF(n){const e=y0.get(n);return y0.delete(n),e}function fF(n){return typeof n=="string"||n&&typeof n=="object"}function UE(n){return typeof n=="string"||typeof n=="symbol"}let Fn=function(n){return n[n.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",n[n.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",n[n.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",n[n.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",n[n.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",n}({});const zE=Symbol("");Fn.MATCHER_NOT_FOUND+"",Fn.NAVIGATION_GUARD_REDIRECT+"",Fn.NAVIGATION_ABORTED+"",Fn.NAVIGATION_CANCELLED+"",Fn.NAVIGATION_DUPLICATED+"";function Ic(n,e){return rn(new Error,{type:n,[zE]:!0},e)}function po(n,e){return n instanceof Error&&zE in n&&(e==null||!!(n.type&e))}const pF=["params","query","hash"];function mF(n){if(typeof n=="string")return n;if(n.path!=null)return n.path;const e={};for(const t of pF)t in n&&(e[t]=n[t]);return JSON.stringify(e,null,2)}function gF(n){const e={};if(n===""||n==="?")return e;const t=(n[0]==="?"?n.slice(1):n).split("&");for(let i=0;i<t.length;++i){const r=t[i].replace(DE," "),s=r.indexOf("="),o=mh(s<0?r:r.slice(0,s)),a=s<0?null:mh(r.slice(s+1));if(o in e){let l=e[o];Ls(l)||(l=e[o]=[l]),l.push(a)}else e[o]=a}return e}function Yw(n){let e="";for(let t in n){const i=n[t];if(t=Qk(t),i==null){i!==void 0&&(e+=(e.length?"&":"")+t);continue}(Ls(i)?i.map(r=>r&&m0(r)):[i&&m0(i)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+t,r!=null&&(e+="="+r))})}return e}function yF(n){const e={};for(const t in n){const i=n[t];i!==void 0&&(e[t]=Ls(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return e}const _F=Symbol(""),Kw=Symbol(""),j_=Symbol(""),Y_=Symbol(""),_0=Symbol("");function vu(){let n=[];function e(i){return n.push(i),()=>{const r=n.indexOf(i);r>-1&&n.splice(r,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ha(n,e,t,i,r,s=o=>o()){const o=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((a,l)=>{const c=p=>{p===!1?l(Ic(Fn.NAVIGATION_ABORTED,{from:t,to:e})):p instanceof Error?l(p):fF(p)?l(Ic(Fn.NAVIGATION_GUARD_REDIRECT,{from:e,to:p})):(o&&i.enterCallbacks[r]===o&&typeof p=="function"&&o.push(p),a())},h=s(()=>n.call(i&&i.instances[r],e,t,c));let d=Promise.resolve(h);n.length<3&&(d=d.then(c)),d.catch(p=>l(p))})}function Zg(n,e,t,i,r=s=>s()){const s=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(PE(l)){const c=(l.__vccOpts||l)[e];c&&s.push(ha(c,t,i,o,a,r))}else{let c=l();s.push(()=>c.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=Wk(h)?h.default:h;o.mods[a]=h,o.components[a]=d;const p=(d.__vccOpts||d)[e];return p&&ha(p,t,i,o,a,r)()}))}}return s}function vF(n,e){const t=[],i=[],r=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(n.matched.find(c=>Pc(c,a))?i.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>Pc(c,l))||r.push(l))}return[t,i,r]}/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let bF=()=>location.protocol+"//"+location.host;function WE(n,e){const{pathname:t,search:i,hash:r}=e,s=n.indexOf("#");if(s>-1){let o=r.includes(n.slice(s))?n.slice(s).length:1,a=r.slice(o);return a[0]!=="/"&&(a="/"+a),Zw(a,"")}return Zw(t,n)+i+r}function xF(n,e,t,i){let r=[],s=[],o=null;const a=({state:p})=>{const m=WE(n,location),y=t.value,b=e.value;let v=0;if(p){if(t.value=m,e.value=p,o&&o===y){o=null;return}v=b?p.position-b.position:0}else i(m);r.forEach(g=>{g(t.value,y,{delta:v,type:g0.pop,direction:v?v>0?Hg.forward:Hg.back:Hg.unknown})})};function l(){o=t.value}function c(p){r.push(p);const m=()=>{const y=r.indexOf(p);y>-1&&r.splice(y,1)};return s.push(m),m}function h(){if(document.visibilityState==="hidden"){const{history:p}=window;if(!p.state)return;p.replaceState(rn({},p.state,{scroll:nm()}),"")}}function d(){for(const p of s)p();s=[],window.removeEventListener("popstate",a),window.removeEventListener("pagehide",h),document.removeEventListener("visibilitychange",h)}return window.addEventListener("popstate",a),window.addEventListener("pagehide",h),document.addEventListener("visibilitychange",h),{pauseListeners:l,listen:c,destroy:d}}function Jw(n,e,t,i=!1,r=!1){return{back:n,current:e,forward:t,replaced:i,position:window.history.length,scroll:r?nm():null}}function wF(n){const{history:e,location:t}=window,i={value:WE(n,t)},r={value:e.state};r.value||s(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,h){const d=n.indexOf("#"),p=d>-1?(t.host&&document.querySelector("base")?n:n.slice(d))+l:bF()+n+l;try{e[h?"replaceState":"pushState"](c,"",p),r.value=c}catch(m){console.error(m),t[h?"replace":"assign"](p)}}function o(l,c){s(l,rn({},e.state,Jw(r.value.back,l,r.value.forward,!0),c,{position:r.value.position}),!0),i.value=l}function a(l,c){const h=rn({},r.value,e.state,{forward:l,scroll:nm()});s(h.current,h,!0),s(l,rn({},Jw(i.value,l,null),{position:h.position+1},c),!1),i.value=l}return{location:i,state:r,push:a,replace:o}}function SF(n){n=oF(n);const e=wF(n),t=xF(n,e.state,e.location,e.replace);function i(s,o=!0){o||t.pauseListeners(),history.go(s)}const r=rn({location:"",base:n,go:i,createHref:lF.bind(null,n)},e,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}let rl=function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.Group=2]="Group",n}({});var ai=function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.ParamRegExp=2]="ParamRegExp",n[n.ParamRegExpEnd=3]="ParamRegExpEnd",n[n.EscapeNext=4]="EscapeNext",n}(ai||{});const MF={type:rl.Static,value:""},TF=/[a-zA-Z0-9_]/;function EF(n){if(!n)return[[]];if(n==="/")return[[MF]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(m){throw new Error(`ERR (${t})/"${c}": ${m}`)}let t=ai.Static,i=t;const r=[];let s;function o(){s&&r.push(s),s=[]}let a=0,l,c="",h="";function d(){c&&(t===ai.Static?s.push({type:rl.Static,value:c}):t===ai.Param||t===ai.ParamRegExp||t===ai.ParamRegExpEnd?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:rl.Param,value:c,regexp:h,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function p(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==ai.ParamRegExp){i=t,t=ai.EscapeNext;continue}switch(t){case ai.Static:l==="/"?(c&&d(),o()):l===":"?(d(),t=ai.Param):p();break;case ai.EscapeNext:p(),t=i;break;case ai.Param:l==="("?t=ai.ParamRegExp:TF.test(l)?p():(d(),t=ai.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case ai.ParamRegExp:l===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+l:t=ai.ParamRegExpEnd:h+=l;break;case ai.ParamRegExpEnd:d(),t=ai.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--,h="";break;default:e("Unknown state");break}}return t===ai.ParamRegExp&&e(`Unfinished custom RegExp for param "${c}"`),d(),o(),r}const Qw="[^/]+?",LF={sensitive:!1,strict:!1,start:!0,end:!0};var tr=function(n){return n[n._multiplier=10]="_multiplier",n[n.Root=90]="Root",n[n.Segment=40]="Segment",n[n.SubSegment=30]="SubSegment",n[n.Static=40]="Static",n[n.Dynamic=20]="Dynamic",n[n.BonusCustomRegExp=10]="BonusCustomRegExp",n[n.BonusWildcard=-50]="BonusWildcard",n[n.BonusRepeatable=-20]="BonusRepeatable",n[n.BonusOptional=-8]="BonusOptional",n[n.BonusStrict=.7000000000000001]="BonusStrict",n[n.BonusCaseSensitive=.25]="BonusCaseSensitive",n}(tr||{});const AF=/[.+*?^${}()[\]/\\]/g;function CF(n,e){const t=rn({},LF,e),i=[];let r=t.start?"^":"";const s=[];for(const c of n){const h=c.length?[]:[tr.Root];t.strict&&!c.length&&(r+="/");for(let d=0;d<c.length;d++){const p=c[d];let m=tr.Segment+(t.sensitive?tr.BonusCaseSensitive:0);if(p.type===rl.Static)d||(r+="/"),r+=p.value.replace(AF,"\\$&"),m+=tr.Static;else if(p.type===rl.Param){const{value:y,repeatable:b,optional:v,regexp:g}=p;s.push({name:y,repeatable:b,optional:v});const x=g||Qw;if(x!==Qw){m+=tr.BonusCustomRegExp;try{`${x}`}catch(S){throw new Error(`Invalid custom RegExp for param "${y}" (${x}): `+S.message)}}let w=b?`((?:${x})(?:/(?:${x}))*)`:`(${x})`;d||(w=v&&c.length<2?`(?:/${w})`:"/"+w),v&&(w+="?"),r+=w,m+=tr.Dynamic,v&&(m+=tr.BonusOptional),b&&(m+=tr.BonusRepeatable),x===".*"&&(m+=tr.BonusWildcard)}h.push(m)}i.push(h)}if(t.strict&&t.end){const c=i.length-1;i[c][i[c].length-1]+=tr.BonusStrict}t.strict||(r+="/?"),t.end?r+="$":t.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,t.sensitive?"":"i");function a(c){const h=c.match(o),d={};if(!h)return null;for(let p=1;p<h.length;p++){const m=h[p]||"",y=s[p-1];d[y.name]=m&&y.repeatable?m.split("/"):m}return d}function l(c){let h="",d=!1;for(const p of n){(!d||!h.endsWith("/"))&&(h+="/"),d=!1;for(const m of p)if(m.type===rl.Static)h+=m.value;else if(m.type===rl.Param){const{value:y,repeatable:b,optional:v}=m,g=y in c?c[y]:"";if(Ls(g)&&!b)throw new Error(`Provided param "${y}" is an array but it is not repeatable (* or + modifiers)`);const x=Ls(g)?g.join("/"):g;if(!x)if(v)p.length<2&&(h.endsWith("/")?h=h.slice(0,-1):d=!0);else throw new Error(`Missing required param "${y}"`);h+=x}}return h||"/"}return{re:o,score:i,keys:s,parse:a,stringify:l}}function RF(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=e[t]-n[t];if(i)return i;t++}return n.length<e.length?n.length===1&&n[0]===tr.Static+tr.Segment?-1:1:n.length>e.length?e.length===1&&e[0]===tr.Static+tr.Segment?1:-1:0}function VE(n,e){let t=0;const i=n.score,r=e.score;for(;t<i.length&&t<r.length;){const s=RF(i[t],r[t]);if(s)return s;t++}if(Math.abs(r.length-i.length)===1){if($w(i))return 1;if($w(r))return-1}return r.length-i.length}function $w(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const PF={strict:!1,end:!0,sensitive:!1};function IF(n,e,t){const i=CF(EF(n.path),t),r=rn(i,{record:n,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function DF(n,e){const t=[],i=new Map;e=Hw(PF,e);function r(d){return i.get(d)}function s(d,p,m){const y=!m,b=e1(d);b.aliasOf=m&&m.record;const v=Hw(e,d),g=[b];if("alias"in d){const S=typeof d.alias=="string"?[d.alias]:d.alias;for(const C of S)g.push(e1(rn({},b,{components:m?m.record.components:b.components,path:C,aliasOf:m?m.record:b})))}let x,w;for(const S of g){const{path:C}=S;if(p&&C[0]!=="/"){const A=p.record.path,E=A[A.length-1]==="/"?"":"/";S.path=p.record.path+(C&&E+C)}if(x=IF(S,p,v),m?m.alias.push(x):(w=w||x,w!==x&&w.alias.push(x),y&&d.name&&!t1(x)&&o(d.name)),GE(x)&&l(x),b.children){const A=b.children;for(let E=0;E<A.length;E++)s(A[E],x,m&&m.children[E])}m=m||x}return w?()=>{o(w)}:th}function o(d){if(UE(d)){const p=i.get(d);p&&(i.delete(d),t.splice(t.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=t.indexOf(d);p>-1&&(t.splice(p,1),d.record.name&&i.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return t}function l(d){const p=kF(d,t);t.splice(p,0,d),d.record.name&&!t1(d)&&i.set(d.record.name,d)}function c(d,p){let m,y={},b,v;if("name"in d&&d.name){if(m=i.get(d.name),!m)throw Ic(Fn.MATCHER_NOT_FOUND,{location:d});v=m.record.name,y=rn(qw(p.params,m.keys.filter(w=>!w.optional).concat(m.parent?m.parent.keys.filter(w=>w.optional):[]).map(w=>w.name)),d.params&&qw(d.params,m.keys.map(w=>w.name))),b=m.stringify(y)}else if(d.path!=null)b=d.path,m=t.find(w=>w.re.test(b)),m&&(y=m.parse(b),v=m.record.name);else{if(m=p.name?i.get(p.name):t.find(w=>w.re.test(p.path)),!m)throw Ic(Fn.MATCHER_NOT_FOUND,{location:d,currentLocation:p});v=m.record.name,y=rn({},p.params,d.params),b=m.stringify(y)}const g=[];let x=m;for(;x;)g.unshift(x.record),x=x.parent;return{name:v,path:b,params:y,matched:g,meta:OF(g)}}n.forEach(d=>s(d));function h(){t.length=0,i.clear()}return{addRoute:s,resolve:c,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:r}}function qw(n,e){const t={};for(const i of e)i in n&&(t[i]=n[i]);return t}function e1(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:NF(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function NF(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const i in n.components)e[i]=typeof t=="object"?t[i]:t;return e}function t1(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function OF(n){return n.reduce((e,t)=>rn(e,t.meta),{})}function kF(n,e){let t=0,i=e.length;for(;t!==i;){const s=t+i>>1;VE(n,e[s])<0?i=s:t=s+1}const r=FF(n);return r&&(i=e.lastIndexOf(r,i-1)),i}function FF(n){let e=n;for(;e=e.parent;)if(GE(e)&&VE(n,e)===0)return e}function GE({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function n1(n){const e=Ss(j_),t=Ss(Y_),i=ci(()=>{const l=Re(n.to);return e.resolve(l)}),r=ci(()=>{const{matched:l}=i.value,{length:c}=l,h=l[c-1],d=t.matched;if(!h||!d.length)return-1;const p=d.findIndex(Pc.bind(null,h));if(p>-1)return p;const m=i1(l[c-2]);return c>1&&i1(h)===m&&d[d.length-1].path!==m?d.findIndex(Pc.bind(null,l[c-2])):p}),s=ci(()=>r.value>-1&&GF(t.params,i.value.params)),o=ci(()=>r.value>-1&&r.value===t.matched.length-1&&FE(t.params,i.value.params));function a(l={}){if(VF(l)){const c=e[Re(n.replace)?"replace":"push"](Re(n.to)).catch(th);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:i,href:ci(()=>i.value.href),isActive:s,isExactActive:o,navigate:a}}function UF(n){return n.length===1?n[0]:n}const zF=gt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:n1,setup(n,{slots:e}){const t=xl(n1(n)),{options:i}=Ss(j_),r=ci(()=>({[r1(n.activeClass,i.linkActiveClass,"router-link-active")]:t.isActive,[r1(n.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&UF(e.default(t));return n.custom?s:tm("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},s)}}}),WF=zF;function VF(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function GF(n,e){for(const t in e){const i=e[t],r=n[t];if(typeof i=="string"){if(i!==r)return!1}else if(!Ls(r)||r.length!==i.length||i.some((s,o)=>s.valueOf()!==r[o].valueOf()))return!1}return!0}function i1(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const r1=(n,e,t)=>n??e??t,BF=gt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const i=Ss(_0),r=ci(()=>n.route||i.value),s=Ss(Kw,0),o=ci(()=>{let c=Re(s);const{matched:h}=r.value;let d;for(;(d=h[c])&&!d.components;)c++;return c}),a=ci(()=>r.value.matched[o.value]);ip(Kw,ci(()=>o.value+1)),ip(_F,a),ip(_0,r);const l=zt();return li(()=>[l.value,a.value,n.name],([c,h,d],[p,m,y])=>{h&&(h.instances[d]=c,m&&m!==h&&c&&c===p&&(h.leaveGuards.size||(h.leaveGuards=m.leaveGuards),h.updateGuards.size||(h.updateGuards=m.updateGuards))),c&&h&&(!m||!Pc(h,m)||!p)&&(h.enterCallbacks[d]||[]).forEach(b=>b(c))},{flush:"post"}),()=>{const c=r.value,h=n.name,d=a.value,p=d&&d.components[h];if(!p)return s1(t.default,{Component:p,route:c});const m=d.props[h],y=m?m===!0?c.params:typeof m=="function"?m(c):m:null,v=tm(p,rn({},y,e,{onVnodeUnmounted:g=>{g.component.isUnmounted&&(d.instances[h]=null)},ref:l}));return s1(t.default,{Component:v,route:c})||v}}});function s1(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const HF=BF;function ZF(n){const e=DF(n.routes,n),t=n.parseQuery||gF,i=n.stringifyQuery||Yw,r=n.history,s=vu(),o=vu(),a=vu(),l=BT(Qo);let c=Qo;hc&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=Gg.bind(null,se=>""+se),d=Gg.bind(null,qk),p=Gg.bind(null,mh);function m(se,Se){let Me,De;return UE(se)?(Me=e.getRecordMatcher(se),De=Se):De=se,e.addRoute(De,Me)}function y(se){const Se=e.getRecordMatcher(se);Se&&e.removeRoute(Se)}function b(){return e.getRoutes().map(se=>se.record)}function v(se){return!!e.getRecordMatcher(se)}function g(se,Se){if(Se=rn({},Se||l.value),typeof se=="string"){const D=Bg(t,se,Se.path),ge=e.resolve({path:D.path},Se),me=r.createHref(D.fullPath);return rn(D,ge,{params:p(ge.params),hash:mh(D.hash),redirectedFrom:void 0,href:me})}let Me;if(se.path!=null)Me=rn({},se,{path:Bg(t,se.path,Se.path).path});else{const D=rn({},se.params);for(const ge in D)D[ge]==null&&delete D[ge];Me=rn({},se,{params:d(D)}),Se.params=d(Se.params)}const De=e.resolve(Me,Se),Be=se.hash||"";De.params=h(p(De.params));const H=nF(i,rn({},se,{hash:Jk(Be),path:De.path})),X=r.createHref(H);return rn({fullPath:H,hash:Be,query:i===Yw?yF(se.query):se.query||{}},De,{redirectedFrom:void 0,href:X})}function x(se){return typeof se=="string"?Bg(t,se,l.value.path):rn({},se)}function w(se,Se){if(c!==se)return Ic(Fn.NAVIGATION_CANCELLED,{from:Se,to:se})}function S(se){return E(se)}function C(se){return S(rn(x(se),{replace:!0}))}function A(se,Se){const Me=se.matched[se.matched.length-1];if(Me&&Me.redirect){const{redirect:De}=Me;let Be=typeof De=="function"?De(se,Se):De;return typeof Be=="string"&&(Be=Be.includes("?")||Be.includes("#")?Be=x(Be):{path:Be},Be.params={}),rn({query:se.query,hash:se.hash,params:Be.path!=null?{}:se.params},Be)}}function E(se,Se){const Me=c=g(se),De=l.value,Be=se.state,H=se.force,X=se.replace===!0,D=A(Me,De);if(D)return E(rn(x(D),{state:typeof D=="object"?rn({},Be,D.state):Be,force:H,replace:X}),Se||Me);const ge=Me;ge.redirectedFrom=Se;let me;return!H&&iF(i,De,Me)&&(me=Ic(Fn.NAVIGATION_DUPLICATED,{to:ge,from:De}),Le(De,De,!0,!1)),(me?Promise.resolve(me):T(ge,De)).catch(fe=>po(fe)?po(fe,Fn.NAVIGATION_GUARD_REDIRECT)?fe:Te(fe):J(fe,ge,De)).then(fe=>{if(fe){if(po(fe,Fn.NAVIGATION_GUARD_REDIRECT))return E(rn({replace:X},x(fe.to),{state:typeof fe.to=="object"?rn({},Be,fe.to.state):Be,force:H}),Se||ge)}else fe=Y(ge,De,!0,X,Be);return k(ge,De,fe),fe})}function O(se,Se){const Me=w(se,Se);return Me?Promise.reject(Me):Promise.resolve()}function R(se){const Se=_e.values().next().value;return Se&&typeof Se.runWithContext=="function"?Se.runWithContext(se):se()}function T(se,Se){let Me;const[De,Be,H]=vF(se,Se);Me=Zg(De.reverse(),"beforeRouteLeave",se,Se);for(const D of De)D.leaveGuards.forEach(ge=>{Me.push(ha(ge,se,Se))});const X=O.bind(null,se,Se);return Me.push(X),We(Me).then(()=>{Me=[];for(const D of s.list())Me.push(ha(D,se,Se));return Me.push(X),We(Me)}).then(()=>{Me=Zg(Be,"beforeRouteUpdate",se,Se);for(const D of Be)D.updateGuards.forEach(ge=>{Me.push(ha(ge,se,Se))});return Me.push(X),We(Me)}).then(()=>{Me=[];for(const D of H)if(D.beforeEnter)if(Ls(D.beforeEnter))for(const ge of D.beforeEnter)Me.push(ha(ge,se,Se));else Me.push(ha(D.beforeEnter,se,Se));return Me.push(X),We(Me)}).then(()=>(se.matched.forEach(D=>D.enterCallbacks={}),Me=Zg(H,"beforeRouteEnter",se,Se,R),Me.push(X),We(Me))).then(()=>{Me=[];for(const D of o.list())Me.push(ha(D,se,Se));return Me.push(X),We(Me)}).catch(D=>po(D,Fn.NAVIGATION_CANCELLED)?D:Promise.reject(D))}function k(se,Se,Me){a.list().forEach(De=>R(()=>De(se,Se,Me)))}function Y(se,Se,Me,De,Be){const H=w(se,Se);if(H)return H;const X=Se===Qo,D=hc?history.state:{};Me&&(De||X?r.replace(se.fullPath,rn({scroll:X&&D&&D.scroll},Be)):r.push(se.fullPath,Be)),l.value=se,Le(se,Se,Me,X),Te()}let $;function re(){$||($=r.listen((se,Se,Me)=>{if(!Ae.listening)return;const De=g(se),Be=A(De,Ae.currentRoute.value);if(Be){E(rn(Be,{replace:!0,force:!0}),De).catch(th);return}c=De;const H=l.value;hc&&hF(jw(H.fullPath,Me.delta),nm()),T(De,H).catch(X=>po(X,Fn.NAVIGATION_ABORTED|Fn.NAVIGATION_CANCELLED)?X:po(X,Fn.NAVIGATION_GUARD_REDIRECT)?(E(rn(x(X.to),{force:!0}),De).then(D=>{po(D,Fn.NAVIGATION_ABORTED|Fn.NAVIGATION_DUPLICATED)&&!Me.delta&&Me.type===g0.pop&&r.go(-1,!1)}).catch(th),Promise.reject()):(Me.delta&&r.go(-Me.delta,!1),J(X,De,H))).then(X=>{X=X||Y(De,H,!1),X&&(Me.delta&&!po(X,Fn.NAVIGATION_CANCELLED)?r.go(-Me.delta,!1):Me.type===g0.pop&&po(X,Fn.NAVIGATION_ABORTED|Fn.NAVIGATION_DUPLICATED)&&r.go(-1,!1)),k(De,H,X)}).catch(th)}))}let ae=vu(),V=vu(),te;function J(se,Se,Me){Te(se);const De=V.list();return De.length?De.forEach(Be=>Be(se,Se,Me)):console.error(se),Promise.reject(se)}function pe(){return te&&l.value!==Qo?Promise.resolve():new Promise((se,Se)=>{ae.add([se,Se])})}function Te(se){return te||(te=!se,re(),ae.list().forEach(([Se,Me])=>se?Me(se):Se()),ae.reset()),se}function Le(se,Se,Me,De){const{scrollBehavior:Be}=n;if(!hc||!Be)return Promise.resolve();const H=!Me&&dF(jw(se.fullPath,0))||(De||!Me)&&history.state&&history.state.scroll||null;return jT().then(()=>Be(se,Se,H)).then(X=>X&&uF(X)).catch(X=>J(X,se,Se))}const Ue=se=>r.go(se);let tt;const _e=new Set,Ae={currentRoute:l,listening:!0,addRoute:m,removeRoute:y,clearRoutes:e.clearRoutes,hasRoute:v,getRoutes:b,resolve:g,options:n,push:S,replace:C,go:Ue,back:()=>Ue(-1),forward:()=>Ue(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:V.add,isReady:pe,install(se){se.component("RouterLink",WF),se.component("RouterView",HF),se.config.globalProperties.$router=Ae,Object.defineProperty(se.config.globalProperties,"$route",{enumerable:!0,get:()=>Re(l)}),hc&&!tt&&l.value===Qo&&(tt=!0,S(r.location).catch(De=>{}));const Se={};for(const De in Qo)Object.defineProperty(Se,De,{get:()=>l.value[De],enumerable:!0});se.provide(j_,Ae),se.provide(Y_,GT(Se)),se.provide(_0,l);const Me=se.unmount;_e.add(se),se.unmount=function(){_e.delete(se),_e.size<1&&(c=Qo,$&&$(),$=null,l.value=Qo,tt=!1,te=!1),Me()}}};function We(se){return se.reduce((Se,Me)=>Se.then(()=>R(Me)),Promise.resolve())}return Ae}function BE(n){return Ss(Y_)}const HE="/favicon/favicon-32x32.png";/*!
  * shared v11.2.8
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function XF(n,e){typeof console<"u"&&(console.warn("[intlify] "+n),e&&console.warn(e.stack))}const Lp=typeof window<"u",Ea=(n,e=!1)=>e?Symbol.for(n):Symbol(n),jF=(n,e,t)=>YF({l:n,k:e,s:t}),YF=n=>JSON.stringify(n).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),ii=n=>typeof n=="number"&&isFinite(n),KF=n=>K_(n)==="[object Date]",Dc=n=>K_(n)==="[object RegExp]",im=n=>Ut(n)&&Object.keys(n).length===0,hi=Object.assign,JF=Object.create,dn=(n=null)=>JF(n);let o1;const sl=()=>o1||(o1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:dn());function a1(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\//g,"&#x2F;").replace(/=/g,"&#x3D;")}function l1(n){return n.replace(/&(?![a-zA-Z0-9#]{2,6};)/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function QF(n){return n=n.replace(/(\w+)\s*=\s*"([^"]*)"/g,(i,r,s)=>`${r}="${l1(s)}"`),n=n.replace(/(\w+)\s*=\s*'([^']*)'/g,(i,r,s)=>`${r}='${l1(s)}'`),/\s*on\w+\s*=\s*["']?[^"'>]+["']?/gi.test(n)&&(n=n.replace(/(\s+)(on)(\w+\s*=)/gi,"$1&#111;n$3")),[/(\s+(?:href|src|action|formaction)\s*=\s*["']?)\s*javascript:/gi,/(style\s*=\s*["'][^"']*url\s*\(\s*)javascript:/gi].forEach(i=>{n=n.replace(i,"$1javascript&#58;")}),n}const $F=Object.prototype.hasOwnProperty;function bs(n,e){return $F.call(n,e)}const zn=Array.isArray,Tn=n=>typeof n=="function",it=n=>typeof n=="string",Qt=n=>typeof n=="boolean",en=n=>n!==null&&typeof n=="object",qF=n=>en(n)&&Tn(n.then)&&Tn(n.catch),ZE=Object.prototype.toString,K_=n=>ZE.call(n),Ut=n=>K_(n)==="[object Object]",eU=n=>n==null?"":zn(n)||Ut(n)&&n.toString===ZE?JSON.stringify(n,null,2):String(n);function J_(n,e=""){return n.reduce((t,i,r)=>r===0?t+i:t+e+i,"")}const jd=n=>!en(n)||zn(n);function ap(n,e){if(jd(n)||jd(e))throw new Error("Invalid value");const t=[{src:n,des:e}];for(;t.length;){const{src:i,des:r}=t.pop();Object.keys(i).forEach(s=>{s!=="__proto__"&&(en(i[s])&&!en(r[s])&&(r[s]=Array.isArray(i[s])?[]:dn()),jd(r[s])||jd(i[s])?r[s]=i[s]:t.push({src:i[s],des:r[s]}))})}}/*!
  * message-compiler v11.2.8
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function tU(n,e,t){return{line:n,column:e,offset:t}}function v0(n,e,t){return{start:n,end:e}}const sn={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14},nU=17;function rm(n,e,t={}){const{domain:i,messages:r,args:s}=t,o=n,a=new SyntaxError(String(o));return a.code=n,e&&(a.location=e),a.domain=i,a}function iU(n){throw n}const Ds=" ",rU="\r",Wi=`
`,sU="\u2028",oU="\u2029";function aU(n){const e=n;let t=0,i=1,r=1,s=0;const o=E=>e[E]===rU&&e[E+1]===Wi,a=E=>e[E]===Wi,l=E=>e[E]===oU,c=E=>e[E]===sU,h=E=>o(E)||a(E)||l(E)||c(E),d=()=>t,p=()=>i,m=()=>r,y=()=>s,b=E=>o(E)||l(E)||c(E)?Wi:e[E],v=()=>b(t),g=()=>b(t+s);function x(){return s=0,h(t)&&(i++,r=0),o(t)&&t++,t++,r++,e[t]}function w(){return o(t+s)&&s++,s++,e[t+s]}function S(){t=0,i=1,r=1,s=0}function C(E=0){s=E}function A(){const E=t+s;for(;E!==t;)x();s=0}return{index:d,line:p,column:m,peekOffset:y,charAt:b,currentChar:v,currentPeek:g,next:x,peek:w,reset:S,resetPeek:C,skipToPeek:A}}const mo=void 0,lU=".",c1="'",cU="tokenizer";function uU(n,e={}){const t=e.location!==!1,i=aU(n),r=()=>i.index(),s=()=>tU(i.line(),i.column(),i.index()),o=s(),a=r(),l={currentType:13,offset:a,startLoc:o,endLoc:o,lastType:13,lastOffset:a,lastStartLoc:o,lastEndLoc:o,braceNest:0,inLinked:!1,text:""},c=()=>l,{onError:h}=e;function d(N,B,j,...L){const P=c();if(B.column+=j,B.offset+=j,h){const Z=t?v0(P.startLoc,B):null,G=rm(N,Z,{domain:cU,args:L});h(G)}}function p(N,B,j){N.endLoc=s(),N.currentType=B;const L={type:B};return t&&(L.loc=v0(N.startLoc,N.endLoc)),j!=null&&(L.value=j),L}const m=N=>p(N,13);function y(N,B){return N.currentChar()===B?(N.next(),B):(d(sn.EXPECTED_TOKEN,s(),0,B),"")}function b(N){let B="";for(;N.currentPeek()===Ds||N.currentPeek()===Wi;)B+=N.currentPeek(),N.peek();return B}function v(N){const B=b(N);return N.skipToPeek(),B}function g(N){if(N===mo)return!1;const B=N.charCodeAt(0);return B>=97&&B<=122||B>=65&&B<=90||B===95}function x(N){if(N===mo)return!1;const B=N.charCodeAt(0);return B>=48&&B<=57}function w(N,B){const{currentType:j}=B;if(j!==2)return!1;b(N);const L=g(N.currentPeek());return N.resetPeek(),L}function S(N,B){const{currentType:j}=B;if(j!==2)return!1;b(N);const L=N.currentPeek()==="-"?N.peek():N.currentPeek(),P=x(L);return N.resetPeek(),P}function C(N,B){const{currentType:j}=B;if(j!==2)return!1;b(N);const L=N.currentPeek()===c1;return N.resetPeek(),L}function A(N,B){const{currentType:j}=B;if(j!==7)return!1;b(N);const L=N.currentPeek()===".";return N.resetPeek(),L}function E(N,B){const{currentType:j}=B;if(j!==8)return!1;b(N);const L=g(N.currentPeek());return N.resetPeek(),L}function O(N,B){const{currentType:j}=B;if(!(j===7||j===11))return!1;b(N);const L=N.currentPeek()===":";return N.resetPeek(),L}function R(N,B){const{currentType:j}=B;if(j!==9)return!1;const L=()=>{const Z=N.currentPeek();return Z==="{"?g(N.peek()):Z==="@"||Z==="|"||Z===":"||Z==="."||Z===Ds||!Z?!1:Z===Wi?(N.peek(),L()):k(N,!1)},P=L();return N.resetPeek(),P}function T(N){b(N);const B=N.currentPeek()==="|";return N.resetPeek(),B}function k(N,B=!0){const j=(P=!1,Z="")=>{const G=N.currentPeek();return G==="{"||G==="@"||!G?P:G==="|"?!(Z===Ds||Z===Wi):G===Ds?(N.peek(),j(!0,Ds)):G===Wi?(N.peek(),j(!0,Wi)):!0},L=j();return B&&N.resetPeek(),L}function Y(N,B){const j=N.currentChar();return j===mo?mo:B(j)?(N.next(),j):null}function $(N){const B=N.charCodeAt(0);return B>=97&&B<=122||B>=65&&B<=90||B>=48&&B<=57||B===95||B===36}function re(N){return Y(N,$)}function ae(N){const B=N.charCodeAt(0);return B>=97&&B<=122||B>=65&&B<=90||B>=48&&B<=57||B===95||B===36||B===45}function V(N){return Y(N,ae)}function te(N){const B=N.charCodeAt(0);return B>=48&&B<=57}function J(N){return Y(N,te)}function pe(N){const B=N.charCodeAt(0);return B>=48&&B<=57||B>=65&&B<=70||B>=97&&B<=102}function Te(N){return Y(N,pe)}function Le(N){let B="",j="";for(;B=J(N);)j+=B;return j}function Ue(N){let B="";for(;;){const j=N.currentChar();if(j==="{"||j==="}"||j==="@"||j==="|"||!j)break;if(j===Ds||j===Wi)if(k(N))B+=j,N.next();else{if(T(N))break;B+=j,N.next()}else B+=j,N.next()}return B}function tt(N){v(N);let B="",j="";for(;B=V(N);)j+=B;const L=N.currentChar();if(L&&L!=="}"&&L!==mo&&L!==Ds&&L!==Wi&&L!==""){const P=De(N);return d(sn.INVALID_TOKEN_IN_PLACEHOLDER,s(),0,j+P),j+P}return N.currentChar()===mo&&d(sn.UNTERMINATED_CLOSING_BRACE,s(),0),j}function _e(N){v(N);let B="";return N.currentChar()==="-"?(N.next(),B+=`-${Le(N)}`):B+=Le(N),N.currentChar()===mo&&d(sn.UNTERMINATED_CLOSING_BRACE,s(),0),B}function Ae(N){return N!==c1&&N!==Wi}function We(N){v(N),y(N,"'");let B="",j="";for(;B=Y(N,Ae);)B==="\\"?j+=se(N):j+=B;const L=N.currentChar();return L===Wi||L===mo?(d(sn.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,s(),0),L===Wi&&(N.next(),y(N,"'")),j):(y(N,"'"),j)}function se(N){const B=N.currentChar();switch(B){case"\\":case"'":return N.next(),`\\${B}`;case"u":return Se(N,B,4);case"U":return Se(N,B,6);default:return d(sn.UNKNOWN_ESCAPE_SEQUENCE,s(),0,B),""}}function Se(N,B,j){y(N,B);let L="";for(let P=0;P<j;P++){const Z=Te(N);if(!Z){d(sn.INVALID_UNICODE_ESCAPE_SEQUENCE,s(),0,`\\${B}${L}${N.currentChar()}`);break}L+=Z}return`\\${B}${L}`}function Me(N){return N!=="{"&&N!=="}"&&N!==Ds&&N!==Wi}function De(N){v(N);let B="",j="";for(;B=Y(N,Me);)j+=B;return j}function Be(N){let B="",j="";for(;B=re(N);)j+=B;return j}function H(N){const B=j=>{const L=N.currentChar();return L==="{"||L==="@"||L==="|"||L==="("||L===")"||!L||L===Ds?j:(j+=L,N.next(),B(j))};return B("")}function X(N){v(N);const B=y(N,"|");return v(N),B}function D(N,B){let j=null;switch(N.currentChar()){case"{":return B.braceNest>=1&&d(sn.NOT_ALLOW_NEST_PLACEHOLDER,s(),0),N.next(),j=p(B,2,"{"),v(N),B.braceNest++,j;case"}":return B.braceNest>0&&B.currentType===2&&d(sn.EMPTY_PLACEHOLDER,s(),0),N.next(),j=p(B,3,"}"),B.braceNest--,B.braceNest>0&&v(N),B.inLinked&&B.braceNest===0&&(B.inLinked=!1),j;case"@":return B.braceNest>0&&d(sn.UNTERMINATED_CLOSING_BRACE,s(),0),j=ge(N,B)||m(B),B.braceNest=0,j;default:{let P=!0,Z=!0,G=!0;if(T(N))return B.braceNest>0&&d(sn.UNTERMINATED_CLOSING_BRACE,s(),0),j=p(B,1,X(N)),B.braceNest=0,B.inLinked=!1,j;if(B.braceNest>0&&(B.currentType===4||B.currentType===5||B.currentType===6))return d(sn.UNTERMINATED_CLOSING_BRACE,s(),0),B.braceNest=0,me(N,B);if(P=w(N,B))return j=p(B,4,tt(N)),v(N),j;if(Z=S(N,B))return j=p(B,5,_e(N)),v(N),j;if(G=C(N,B))return j=p(B,6,We(N)),v(N),j;if(!P&&!Z&&!G)return j=p(B,12,De(N)),d(sn.INVALID_TOKEN_IN_PLACEHOLDER,s(),0,j.value),v(N),j;break}}return j}function ge(N,B){const{currentType:j}=B;let L=null;const P=N.currentChar();switch((j===7||j===8||j===11||j===9)&&(P===Wi||P===Ds)&&d(sn.INVALID_LINKED_FORMAT,s(),0),P){case"@":return N.next(),L=p(B,7,"@"),B.inLinked=!0,L;case".":return v(N),N.next(),p(B,8,".");case":":return v(N),N.next(),p(B,9,":");default:return T(N)?(L=p(B,1,X(N)),B.braceNest=0,B.inLinked=!1,L):A(N,B)||O(N,B)?(v(N),ge(N,B)):E(N,B)?(v(N),p(B,11,Be(N))):R(N,B)?(v(N),P==="{"?D(N,B)||L:p(B,10,H(N))):(j===7&&d(sn.INVALID_LINKED_FORMAT,s(),0),B.braceNest=0,B.inLinked=!1,me(N,B))}}function me(N,B){let j={type:13};if(B.braceNest>0)return D(N,B)||m(B);if(B.inLinked)return ge(N,B)||m(B);switch(N.currentChar()){case"{":return D(N,B)||m(B);case"}":return d(sn.UNBALANCED_CLOSING_BRACE,s(),0),N.next(),p(B,3,"}");case"@":return ge(N,B)||m(B);default:{if(T(N))return j=p(B,1,X(N)),B.braceNest=0,B.inLinked=!1,j;if(k(N))return p(B,0,Ue(N));break}}return j}function fe(){const{currentType:N,offset:B,startLoc:j,endLoc:L}=l;return l.lastType=N,l.lastOffset=B,l.lastStartLoc=j,l.lastEndLoc=L,l.offset=r(),l.startLoc=s(),i.currentChar()===mo?p(l,13):me(i,l)}return{nextToken:fe,currentOffset:r,currentPosition:s,context:c}}const hU="parser",dU=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function fU(n,e,t){switch(n){case"\\\\":return"\\";case"\\'":return"'";default:{const i=parseInt(e||t,16);return i<=55295||i>=57344?String.fromCodePoint(i):""}}}function pU(n={}){const e=n.location!==!1,{onError:t}=n;function i(g,x,w,S,...C){const A=g.currentPosition();if(A.offset+=S,A.column+=S,t){const E=e?v0(w,A):null,O=rm(x,E,{domain:hU,args:C});t(O)}}function r(g,x,w){const S={type:g};return e&&(S.start=x,S.end=x,S.loc={start:w,end:w}),S}function s(g,x,w,S){e&&(g.end=x,g.loc&&(g.loc.end=w))}function o(g,x){const w=g.context(),S=r(3,w.offset,w.startLoc);return S.value=x,s(S,g.currentOffset(),g.currentPosition()),S}function a(g,x){const w=g.context(),{lastOffset:S,lastStartLoc:C}=w,A=r(5,S,C);return A.index=parseInt(x,10),g.nextToken(),s(A,g.currentOffset(),g.currentPosition()),A}function l(g,x){const w=g.context(),{lastOffset:S,lastStartLoc:C}=w,A=r(4,S,C);return A.key=x,g.nextToken(),s(A,g.currentOffset(),g.currentPosition()),A}function c(g,x){const w=g.context(),{lastOffset:S,lastStartLoc:C}=w,A=r(9,S,C);return A.value=x.replace(dU,fU),g.nextToken(),s(A,g.currentOffset(),g.currentPosition()),A}function h(g){const x=g.nextToken(),w=g.context(),{lastOffset:S,lastStartLoc:C}=w,A=r(8,S,C);return x.type!==11?(i(g,sn.UNEXPECTED_EMPTY_LINKED_MODIFIER,w.lastStartLoc,0),A.value="",s(A,S,C),{nextConsumeToken:x,node:A}):(x.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,w.lastStartLoc,0,Ns(x)),A.value=x.value||"",s(A,g.currentOffset(),g.currentPosition()),{node:A})}function d(g,x){const w=g.context(),S=r(7,w.offset,w.startLoc);return S.value=x,s(S,g.currentOffset(),g.currentPosition()),S}function p(g){const x=g.context(),w=r(6,x.offset,x.startLoc);let S=g.nextToken();if(S.type===8){const C=h(g);w.modifier=C.node,S=C.nextConsumeToken||g.nextToken()}switch(S.type!==9&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(S)),S=g.nextToken(),S.type===2&&(S=g.nextToken()),S.type){case 10:S.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(S)),w.key=d(g,S.value||"");break;case 4:S.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(S)),w.key=l(g,S.value||"");break;case 5:S.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(S)),w.key=a(g,S.value||"");break;case 6:S.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(S)),w.key=c(g,S.value||"");break;default:{i(g,sn.UNEXPECTED_EMPTY_LINKED_KEY,x.lastStartLoc,0);const C=g.context(),A=r(7,C.offset,C.startLoc);return A.value="",s(A,C.offset,C.startLoc),w.key=A,s(w,C.offset,C.startLoc),{nextConsumeToken:S,node:w}}}return s(w,g.currentOffset(),g.currentPosition()),{node:w}}function m(g){const x=g.context(),w=x.currentType===1?g.currentOffset():x.offset,S=x.currentType===1?x.endLoc:x.startLoc,C=r(2,w,S);C.items=[];let A=null;do{const R=A||g.nextToken();switch(A=null,R.type){case 0:R.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(R)),C.items.push(o(g,R.value||""));break;case 5:R.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(R)),C.items.push(a(g,R.value||""));break;case 4:R.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(R)),C.items.push(l(g,R.value||""));break;case 6:R.value==null&&i(g,sn.UNEXPECTED_LEXICAL_ANALYSIS,x.lastStartLoc,0,Ns(R)),C.items.push(c(g,R.value||""));break;case 7:{const T=p(g);C.items.push(T.node),A=T.nextConsumeToken||null;break}}}while(x.currentType!==13&&x.currentType!==1);const E=x.currentType===1?x.lastOffset:g.currentOffset(),O=x.currentType===1?x.lastEndLoc:g.currentPosition();return s(C,E,O),C}function y(g,x,w,S){const C=g.context();let A=S.items.length===0;const E=r(1,x,w);E.cases=[],E.cases.push(S);do{const O=m(g);A||(A=O.items.length===0),E.cases.push(O)}while(C.currentType!==13);return A&&i(g,sn.MUST_HAVE_MESSAGES_IN_PLURAL,w,0),s(E,g.currentOffset(),g.currentPosition()),E}function b(g){const x=g.context(),{offset:w,startLoc:S}=x,C=m(g);return x.currentType===13?C:y(g,w,S,C)}function v(g){const x=uU(g,hi({},n)),w=x.context(),S=r(0,w.offset,w.startLoc);return e&&S.loc&&(S.loc.source=g),S.body=b(x),n.onCacheKey&&(S.cacheKey=n.onCacheKey(g)),w.currentType!==13&&i(x,sn.UNEXPECTED_LEXICAL_ANALYSIS,w.lastStartLoc,0,g[w.offset]||""),s(S,x.currentOffset(),x.currentPosition()),S}return{parse:v}}function Ns(n){if(n.type===13)return"EOF";const e=(n.value||"").replace(/\r?\n/gu,"\\n");return e.length>10?e.slice(0,9)+"":e}function mU(n,e={}){const t={ast:n,helpers:new Set};return{context:()=>t,helper:s=>(t.helpers.add(s),s)}}function u1(n,e){for(let t=0;t<n.length;t++)Q_(n[t],e)}function Q_(n,e){switch(n.type){case 1:u1(n.cases,e),e.helper("plural");break;case 2:u1(n.items,e);break;case 6:{Q_(n.key,e),e.helper("linked"),e.helper("type");break}case 5:e.helper("interpolate"),e.helper("list");break;case 4:e.helper("interpolate"),e.helper("named");break}}function gU(n,e={}){const t=mU(n);t.helper("normalize"),n.body&&Q_(n.body,t);const i=t.context();n.helpers=Array.from(i.helpers)}function yU(n){const e=n.body;return e.type===2?h1(e):e.cases.forEach(t=>h1(t)),n}function h1(n){if(n.items.length===1){const e=n.items[0];(e.type===3||e.type===9)&&(n.static=e.value,delete e.value)}else{const e=[];for(let t=0;t<n.items.length;t++){const i=n.items[t];if(!(i.type===3||i.type===9)||i.value==null)break;e.push(i.value)}if(e.length===n.items.length){n.static=J_(e);for(let t=0;t<n.items.length;t++){const i=n.items[t];(i.type===3||i.type===9)&&delete i.value}}}}function dc(n){switch(n.t=n.type,n.type){case 0:{const e=n;dc(e.body),e.b=e.body,delete e.body;break}case 1:{const e=n,t=e.cases;for(let i=0;i<t.length;i++)dc(t[i]);e.c=t,delete e.cases;break}case 2:{const e=n,t=e.items;for(let i=0;i<t.length;i++)dc(t[i]);e.i=t,delete e.items,e.static&&(e.s=e.static,delete e.static);break}case 3:case 9:case 8:case 7:{const e=n;e.value&&(e.v=e.value,delete e.value);break}case 6:{const e=n;dc(e.key),e.k=e.key,delete e.key,e.modifier&&(dc(e.modifier),e.m=e.modifier,delete e.modifier);break}case 5:{const e=n;e.i=e.index,delete e.index;break}case 4:{const e=n;e.k=e.key,delete e.key;break}}delete n.type}function _U(n,e){const{filename:t,breakLineCode:i,needIndent:r}=e,s=e.location!==!1,o={filename:t,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:i,needIndent:r,indentLevel:0};s&&n.loc&&(o.source=n.loc.source);const a=()=>o;function l(b,v){o.code+=b}function c(b,v=!0){const g=v?i:"";l(r?g+"  ".repeat(b):g)}function h(b=!0){const v=++o.indentLevel;b&&c(v)}function d(b=!0){const v=--o.indentLevel;b&&c(v)}function p(){c(o.indentLevel)}return{context:a,push:l,indent:h,deindent:d,newline:p,helper:b=>`_${b}`,needIndent:()=>o.needIndent}}function vU(n,e){const{helper:t}=n;n.push(`${t("linked")}(`),Nc(n,e.key),e.modifier?(n.push(", "),Nc(n,e.modifier),n.push(", _type")):n.push(", undefined, _type"),n.push(")")}function bU(n,e){const{helper:t,needIndent:i}=n;n.push(`${t("normalize")}([`),n.indent(i());const r=e.items.length;for(let s=0;s<r&&(Nc(n,e.items[s]),s!==r-1);s++)n.push(", ");n.deindent(i()),n.push("])")}function xU(n,e){const{helper:t,needIndent:i}=n;if(e.cases.length>1){n.push(`${t("plural")}([`),n.indent(i());const r=e.cases.length;for(let s=0;s<r&&(Nc(n,e.cases[s]),s!==r-1);s++)n.push(", ");n.deindent(i()),n.push("])")}}function wU(n,e){e.body?Nc(n,e.body):n.push("null")}function Nc(n,e){const{helper:t}=n;switch(e.type){case 0:wU(n,e);break;case 1:xU(n,e);break;case 2:bU(n,e);break;case 6:vU(n,e);break;case 8:n.push(JSON.stringify(e.value),e);break;case 7:n.push(JSON.stringify(e.value),e);break;case 5:n.push(`${t("interpolate")}(${t("list")}(${e.index}))`,e);break;case 4:n.push(`${t("interpolate")}(${t("named")}(${JSON.stringify(e.key)}))`,e);break;case 9:n.push(JSON.stringify(e.value),e);break;case 3:n.push(JSON.stringify(e.value),e);break}}const SU=(n,e={})=>{const t=it(e.mode)?e.mode:"normal",i=it(e.filename)?e.filename:"message.intl";e.sourceMap;const r=e.breakLineCode!=null?e.breakLineCode:t==="arrow"?";":`
`,s=e.needIndent?e.needIndent:t!=="arrow",o=n.helpers||[],a=_U(n,{filename:i,breakLineCode:r,needIndent:s});a.push(t==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),a.indent(s),o.length>0&&(a.push(`const { ${J_(o.map(h=>`${h}: _${h}`),", ")} } = ctx`),a.newline()),a.push("return "),Nc(a,n),a.deindent(s),a.push("}"),delete n.helpers;const{code:l,map:c}=a.context();return{ast:n,code:l,map:c?c.toJSON():void 0}};function MU(n,e={}){const t=hi({},e),i=!!t.jit,r=!!t.minify,s=t.optimize==null?!0:t.optimize,a=pU(t).parse(n);return i?(s&&yU(a),r&&dc(a),{ast:a,code:""}):(gU(a,t),SU(a,t))}/*!
  * core-base v11.2.8
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */function TU(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(sl().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(sl().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}function Xs(n){return en(n)&&$_(n)===0&&(bs(n,"b")||bs(n,"body"))}const XE=["b","body"];function EU(n){return La(n,XE)}const jE=["c","cases"];function LU(n){return La(n,jE,[])}const YE=["s","static"];function AU(n){return La(n,YE)}const KE=["i","items"];function CU(n){return La(n,KE,[])}const JE=["t","type"];function $_(n){return La(n,JE)}const QE=["v","value"];function Yd(n,e){const t=La(n,QE);if(t!=null)return t;throw gh(e)}const $E=["m","modifier"];function RU(n){return La(n,$E)}const qE=["k","key"];function PU(n){const e=La(n,qE);if(e)return e;throw gh(6)}function La(n,e,t){for(let i=0;i<e.length;i++){const r=e[i];if(bs(n,r)&&n[r]!=null)return n[r]}return t}const eL=[...XE,...jE,...YE,...KE,...qE,...$E,...QE,...JE];function gh(n){return new Error(`unhandled node type: ${n}`)}function Xg(n){return t=>IU(t,n)}function IU(n,e){const t=EU(e);if(t==null)throw gh(0);if($_(t)===1){const s=LU(t);return n.plural(s.reduce((o,a)=>[...o,d1(n,a)],[]))}else return d1(n,t)}function d1(n,e){const t=AU(e);if(t!=null)return n.type==="text"?t:n.normalize([t]);{const i=CU(e).reduce((r,s)=>[...r,b0(n,s)],[]);return n.normalize(i)}}function b0(n,e){const t=$_(e);switch(t){case 3:return Yd(e,t);case 9:return Yd(e,t);case 4:{const i=e;if(bs(i,"k")&&i.k)return n.interpolate(n.named(i.k));if(bs(i,"key")&&i.key)return n.interpolate(n.named(i.key));throw gh(t)}case 5:{const i=e;if(bs(i,"i")&&ii(i.i))return n.interpolate(n.list(i.i));if(bs(i,"index")&&ii(i.index))return n.interpolate(n.list(i.index));throw gh(t)}case 6:{const i=e,r=RU(i),s=PU(i);return n.linked(b0(n,s),r?b0(n,r):void 0,n.type)}case 7:return Yd(e,t);case 8:return Yd(e,t);default:throw new Error(`unhandled node on format message part: ${t}`)}}const DU=n=>n;let Kd=dn();function NU(n,e={}){let t=!1;const i=e.onError||iU;return e.onError=r=>{t=!0,i(r)},{...MU(n,e),detectError:t}}function OU(n,e){if(!__INTLIFY_DROP_MESSAGE_COMPILER__&&it(n)){Qt(e.warnHtmlMessage)&&e.warnHtmlMessage;const i=(e.onCacheKey||DU)(n),r=Kd[i];if(r)return r;const{ast:s,detectError:o}=NU(n,{...e,location:!1,jit:!0}),a=Xg(s);return o?a:Kd[i]=a}else{const t=n.cacheKey;if(t){const i=Kd[t];return i||(Kd[t]=Xg(n))}else return Xg(n)}}let yh=null;function kU(n){yh=n}function FU(n,e,t){yh&&yh.emit("i18n:init",{timestamp:Date.now(),i18n:n,version:e,meta:t})}const UU=zU("function:translate");function zU(n){return e=>yh&&yh.emit(n,e)}const Ao={INVALID_ARGUMENT:nU,INVALID_DATE_ARGUMENT:18,INVALID_ISO_DATE_ARGUMENT:19,NOT_SUPPORT_LOCALE_PROMISE_VALUE:21,NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:22,NOT_SUPPORT_LOCALE_TYPE:23},WU=24;function Co(n){return rm(n,null,void 0)}function q_(n,e){return e.locale!=null?f1(e.locale):f1(n.locale)}let jg;function f1(n){if(it(n))return n;if(Tn(n)){if(n.resolvedOnce&&jg!=null)return jg;if(n.constructor.name==="Function"){const e=n();if(qF(e))throw Co(Ao.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return jg=e}else throw Co(Ao.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw Co(Ao.NOT_SUPPORT_LOCALE_TYPE)}function VU(n,e,t){return[...new Set([t,...zn(e)?e:en(e)?Object.keys(e):it(e)?[e]:[t]])]}function tL(n,e,t){const i=it(t)?t:_h,r=n;r.__localeChainCache||(r.__localeChainCache=new Map);let s=r.__localeChainCache.get(i);if(!s){s=[];let o=[t];for(;zn(o);)o=p1(s,o,e);const a=zn(e)||!Ut(e)?e:e.default?e.default:null;o=it(a)?[a]:a,zn(o)&&p1(s,o,!1),r.__localeChainCache.set(i,s)}return s}function p1(n,e,t){let i=!0;for(let r=0;r<e.length&&Qt(i);r++){const s=e[r];it(s)&&(i=GU(n,e[r],t))}return i}function GU(n,e,t){let i;const r=e.split("-");do{const s=r.join("-");i=BU(n,s,t),r.splice(-1,1)}while(r.length&&i===!0);return i}function BU(n,e,t){let i=!1;if(!n.includes(e)&&(i=!0,e)){i=e[e.length-1]!=="!";const r=e.replace(/!/g,"");n.push(r),(zn(t)||Ut(t))&&t[r]&&(i=t[r])}return i}const Aa=[];Aa[0]={w:[0],i:[3,0],"[":[4],o:[7]};Aa[1]={w:[1],".":[2],"[":[4],o:[7]};Aa[2]={w:[2],i:[3,0],0:[3,0]};Aa[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};Aa[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};Aa[5]={"'":[4,0],o:8,l:[5,0]};Aa[6]={'"':[4,0],o:8,l:[6,0]};const HU=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function ZU(n){return HU.test(n)}function XU(n){const e=n.charCodeAt(0),t=n.charCodeAt(n.length-1);return e===t&&(e===34||e===39)?n.slice(1,-1):n}function jU(n){if(n==null)return"o";switch(n.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return n;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function YU(n){const e=n.trim();return n.charAt(0)==="0"&&isNaN(parseInt(n))?!1:ZU(e)?XU(e):"*"+e}function KU(n){const e=[];let t=-1,i=0,r=0,s,o,a,l,c,h,d;const p=[];p[0]=()=>{o===void 0?o=a:o+=a},p[1]=()=>{o!==void 0&&(e.push(o),o=void 0)},p[2]=()=>{p[0](),r++},p[3]=()=>{if(r>0)r--,i=4,p[0]();else{if(r=0,o===void 0||(o=YU(o),o===!1))return!1;p[1]()}};function m(){const y=n[t+1];if(i===5&&y==="'"||i===6&&y==='"')return t++,a="\\"+y,p[0](),!0}for(;i!==null;)if(t++,s=n[t],!(s==="\\"&&m())){if(l=jU(s),d=Aa[i],c=d[l]||d.l||8,c===8||(i=c[0],c[1]!==void 0&&(h=p[c[1]],h&&(a=s,h()===!1))))return;if(i===7)return e}}const m1=new Map;function JU(n,e){return en(n)?n[e]:null}function QU(n,e){if(!en(n))return null;let t=m1.get(e);if(t||(t=KU(e),t&&m1.set(e,t)),!t)return null;const i=t.length;let r=n,s=0;for(;s<i;){const o=t[s];if(eL.includes(o)&&Xs(r))return null;const a=r[o];if(a===void 0||Tn(r))return null;r=a,s++}return r}const $U="11.2.8",sm=-1,_h="en-US",g1="",y1=n=>`${n.charAt(0).toLocaleUpperCase()}${n.substr(1)}`;function qU(){return{upper:(n,e)=>e==="text"&&it(n)?n.toUpperCase():e==="vnode"&&en(n)&&"__v_isVNode"in n?n.children.toUpperCase():n,lower:(n,e)=>e==="text"&&it(n)?n.toLowerCase():e==="vnode"&&en(n)&&"__v_isVNode"in n?n.children.toLowerCase():n,capitalize:(n,e)=>e==="text"&&it(n)?y1(n):e==="vnode"&&en(n)&&"__v_isVNode"in n?y1(n.children):n}}let nL;function ez(n){nL=n}let iL;function tz(n){iL=n}let rL;function nz(n){rL=n}let sL=null;const iz=n=>{sL=n},rz=()=>sL;let oL=null;const _1=n=>{oL=n},sz=()=>oL;let v1=0;function oz(n={}){const e=Tn(n.onWarn)?n.onWarn:XF,t=it(n.version)?n.version:$U,i=it(n.locale)||Tn(n.locale)?n.locale:_h,r=Tn(i)?_h:i,s=zn(n.fallbackLocale)||Ut(n.fallbackLocale)||it(n.fallbackLocale)||n.fallbackLocale===!1?n.fallbackLocale:r,o=Ut(n.messages)?n.messages:Yg(r),a=Ut(n.datetimeFormats)?n.datetimeFormats:Yg(r),l=Ut(n.numberFormats)?n.numberFormats:Yg(r),c=hi(dn(),n.modifiers,qU()),h=n.pluralRules||dn(),d=Tn(n.missing)?n.missing:null,p=Qt(n.missingWarn)||Dc(n.missingWarn)?n.missingWarn:!0,m=Qt(n.fallbackWarn)||Dc(n.fallbackWarn)?n.fallbackWarn:!0,y=!!n.fallbackFormat,b=!!n.unresolving,v=Tn(n.postTranslation)?n.postTranslation:null,g=Ut(n.processor)?n.processor:null,x=Qt(n.warnHtmlMessage)?n.warnHtmlMessage:!0,w=!!n.escapeParameter,S=Tn(n.messageCompiler)?n.messageCompiler:nL,C=Tn(n.messageResolver)?n.messageResolver:iL||JU,A=Tn(n.localeFallbacker)?n.localeFallbacker:rL||VU,E=en(n.fallbackContext)?n.fallbackContext:void 0,O=n,R=en(O.__datetimeFormatters)?O.__datetimeFormatters:new Map,T=en(O.__numberFormatters)?O.__numberFormatters:new Map,k=en(O.__meta)?O.__meta:{};v1++;const Y={version:t,cid:v1,locale:i,fallbackLocale:s,messages:o,modifiers:c,pluralRules:h,missing:d,missingWarn:p,fallbackWarn:m,fallbackFormat:y,unresolving:b,postTranslation:v,processor:g,warnHtmlMessage:x,escapeParameter:w,messageCompiler:S,messageResolver:C,localeFallbacker:A,fallbackContext:E,onWarn:e,__meta:k};return Y.datetimeFormats=a,Y.numberFormats=l,Y.__datetimeFormatters=R,Y.__numberFormatters=T,__INTLIFY_PROD_DEVTOOLS__&&FU(Y,t,k),Y}const Yg=n=>({[n]:dn()});function ev(n,e,t,i,r){const{missing:s,onWarn:o}=n;if(s!==null){const a=s(n,t,e,r);return it(a)?a:e}else return e}function bu(n,e,t){const i=n;i.__localeChainCache=new Map,n.localeFallbacker(n,t,e)}function az(n,e){return n===e?!1:n.split("-")[0]===e.split("-")[0]}function lz(n,e){const t=e.indexOf(n);if(t===-1)return!1;for(let i=t+1;i<e.length;i++)if(az(n,e[i]))return!0;return!1}function b1(n,...e){const{datetimeFormats:t,unresolving:i,fallbackLocale:r,onWarn:s,localeFallbacker:o}=n,{__datetimeFormatters:a}=n,[l,c,h,d]=x0(...e),p=Qt(h.missingWarn)?h.missingWarn:n.missingWarn;Qt(h.fallbackWarn)?h.fallbackWarn:n.fallbackWarn;const m=!!h.part,y=q_(n,h),b=o(n,r,y);if(!it(l)||l==="")return new Intl.DateTimeFormat(y,d).format(c);let v={},g,x=null;const w="datetime format";for(let A=0;A<b.length&&(g=b[A],v=t[g]||{},x=v[l],!Ut(x));A++)ev(n,l,g,p,w);if(!Ut(x)||!it(g))return i?sm:l;let S=`${g}__${l}`;im(d)||(S=`${S}__${JSON.stringify(d)}`);let C=a.get(S);return C||(C=new Intl.DateTimeFormat(g,hi({},x,d)),a.set(S,C)),m?C.formatToParts(c):C.format(c)}const aL=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function x0(...n){const[e,t,i,r]=n,s=dn();let o=dn(),a;if(it(e)){const l=e.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!l)throw Co(Ao.INVALID_ISO_DATE_ARGUMENT);const c=l[3]?l[3].trim().startsWith("T")?`${l[1].trim()}${l[3].trim()}`:`${l[1].trim()}T${l[3].trim()}`:l[1].trim();a=new Date(c);try{a.toISOString()}catch{throw Co(Ao.INVALID_ISO_DATE_ARGUMENT)}}else if(KF(e)){if(isNaN(e.getTime()))throw Co(Ao.INVALID_DATE_ARGUMENT);a=e}else if(ii(e))a=e;else throw Co(Ao.INVALID_ARGUMENT);return it(t)?s.key=t:Ut(t)&&Object.keys(t).forEach(l=>{aL.includes(l)?o[l]=t[l]:s[l]=t[l]}),it(i)?s.locale=i:Ut(i)&&(o=i),Ut(r)&&(o=r),[s.key||"",a,s,o]}function x1(n,e,t){const i=n;for(const r in t){const s=`${e}__${r}`;i.__datetimeFormatters.has(s)&&i.__datetimeFormatters.delete(s)}}function w1(n,...e){const{numberFormats:t,unresolving:i,fallbackLocale:r,onWarn:s,localeFallbacker:o}=n,{__numberFormatters:a}=n,[l,c,h,d]=w0(...e),p=Qt(h.missingWarn)?h.missingWarn:n.missingWarn;Qt(h.fallbackWarn)?h.fallbackWarn:n.fallbackWarn;const m=!!h.part,y=q_(n,h),b=o(n,r,y);if(!it(l)||l==="")return new Intl.NumberFormat(y,d).format(c);let v={},g,x=null;const w="number format";for(let A=0;A<b.length&&(g=b[A],v=t[g]||{},x=v[l],!Ut(x));A++)ev(n,l,g,p,w);if(!Ut(x)||!it(g))return i?sm:l;let S=`${g}__${l}`;im(d)||(S=`${S}__${JSON.stringify(d)}`);let C=a.get(S);return C||(C=new Intl.NumberFormat(g,hi({},x,d)),a.set(S,C)),m?C.formatToParts(c):C.format(c)}const lL=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function w0(...n){const[e,t,i,r]=n,s=dn();let o=dn();if(!ii(e))throw Co(Ao.INVALID_ARGUMENT);const a=e;return it(t)?s.key=t:Ut(t)&&Object.keys(t).forEach(l=>{lL.includes(l)?o[l]=t[l]:s[l]=t[l]}),it(i)?s.locale=i:Ut(i)&&(o=i),Ut(r)&&(o=r),[s.key||"",a,s,o]}function S1(n,e,t){const i=n;for(const r in t){const s=`${e}__${r}`;i.__numberFormatters.has(s)&&i.__numberFormatters.delete(s)}}const cz=n=>n,uz=n=>"",hz="text",dz=n=>n.length===0?"":J_(n),fz=eU;function M1(n,e){return n=Math.abs(n),e===2?n?n>1?1:0:1:n?Math.min(n,2):0}function pz(n){const e=ii(n.pluralIndex)?n.pluralIndex:-1;return n.named&&(ii(n.named.count)||ii(n.named.n))?ii(n.named.count)?n.named.count:ii(n.named.n)?n.named.n:e:e}function mz(n,e){e.count||(e.count=n),e.n||(e.n=n)}function gz(n={}){const e=n.locale,t=pz(n),i=en(n.pluralRules)&&it(e)&&Tn(n.pluralRules[e])?n.pluralRules[e]:M1,r=en(n.pluralRules)&&it(e)&&Tn(n.pluralRules[e])?M1:void 0,s=g=>g[i(t,g.length,r)],o=n.list||[],a=g=>o[g],l=n.named||dn();ii(n.pluralIndex)&&mz(t,l);const c=g=>l[g];function h(g,x){const w=Tn(n.messages)?n.messages(g,!!x):en(n.messages)?n.messages[g]:!1;return w||(n.parent?n.parent.message(g):uz)}const d=g=>n.modifiers?n.modifiers[g]:cz,p=Ut(n.processor)&&Tn(n.processor.normalize)?n.processor.normalize:dz,m=Ut(n.processor)&&Tn(n.processor.interpolate)?n.processor.interpolate:fz,y=Ut(n.processor)&&it(n.processor.type)?n.processor.type:hz,v={list:a,named:c,plural:s,linked:(g,...x)=>{const[w,S]=x;let C="text",A="";x.length===1?en(w)?(A=w.modifier||A,C=w.type||C):it(w)&&(A=w||A):x.length===2&&(it(w)&&(A=w||A),it(S)&&(C=S||C));const E=h(g,!0)(v),O=C==="vnode"&&zn(E)&&A?E[0]:E;return A?d(A)(O,C):O},message:h,type:y,interpolate:m,normalize:p,values:hi(dn(),o,l)};return v}const T1=()=>"",jr=n=>Tn(n);function E1(n,...e){const{fallbackFormat:t,postTranslation:i,unresolving:r,messageCompiler:s,fallbackLocale:o,messages:a}=n,[l,c]=S0(...e),h=Qt(c.missingWarn)?c.missingWarn:n.missingWarn,d=Qt(c.fallbackWarn)?c.fallbackWarn:n.fallbackWarn,p=Qt(c.escapeParameter)?c.escapeParameter:n.escapeParameter,m=!!c.resolvedMessage,y=it(c.default)||Qt(c.default)?Qt(c.default)?s?l:()=>l:c.default:t?s?l:()=>l:null,b=t||y!=null&&(it(y)||Tn(y)),v=q_(n,c);p&&yz(c);let[g,x,w]=m?[l,v,a[v]||dn()]:cL(n,l,v,o,d,h),S=g,C=l;if(!m&&!(it(S)||Xs(S)||jr(S))&&b&&(S=y,C=S),!m&&(!(it(S)||Xs(S)||jr(S))||!it(x)))return r?sm:l;let A=!1;const E=()=>{A=!0},O=jr(S)?S:uL(n,l,x,S,C,E);if(A)return S;const R=bz(n,x,w,c),T=gz(R),k=_z(n,O,T);let Y=i?i(k,l):k;if(p&&it(Y)&&(Y=QF(Y)),__INTLIFY_PROD_DEVTOOLS__){const $={timestamp:Date.now(),key:it(l)?l:jr(S)?S.key:"",locale:x||(jr(S)?S.locale:""),format:it(S)?S:jr(S)?S.source:"",message:Y};$.meta=hi({},n.__meta,rz()||{}),UU($)}return Y}function yz(n){zn(n.list)?n.list=n.list.map(e=>it(e)?a1(e):e):en(n.named)&&Object.keys(n.named).forEach(e=>{it(n.named[e])&&(n.named[e]=a1(n.named[e]))})}function cL(n,e,t,i,r,s){const{messages:o,onWarn:a,messageResolver:l,localeFallbacker:c}=n,h=c(n,i,t);let d=dn(),p,m=null;const y="translate";for(let b=0;b<h.length&&(p=h[b],d=o[p]||dn(),(m=l(d,e))===null&&(m=d[e]),!(it(m)||Xs(m)||jr(m)));b++)if(!lz(p,h)){const v=ev(n,e,p,s,y);v!==e&&(m=v)}return[m,p,d]}function uL(n,e,t,i,r,s){const{messageCompiler:o,warnHtmlMessage:a}=n;if(jr(i)){const c=i;return c.locale=c.locale||t,c.key=c.key||e,c}if(o==null){const c=()=>i;return c.locale=t,c.key=e,c}const l=o(i,vz(n,t,r,i,a,s));return l.locale=t,l.key=e,l.source=i,l}function _z(n,e,t){return e(t)}function S0(...n){const[e,t,i]=n,r=dn();if(!it(e)&&!ii(e)&&!jr(e)&&!Xs(e))throw Co(Ao.INVALID_ARGUMENT);const s=ii(e)?String(e):(jr(e),e);return ii(t)?r.plural=t:it(t)?r.default=t:Ut(t)&&!im(t)?r.named=t:zn(t)&&(r.list=t),ii(i)?r.plural=i:it(i)?r.default=i:Ut(i)&&hi(r,i),[s,r]}function vz(n,e,t,i,r,s){return{locale:e,key:t,warnHtmlMessage:r,onError:o=>{throw s&&s(o),o},onCacheKey:o=>jF(e,t,o)}}function bz(n,e,t,i){const{modifiers:r,pluralRules:s,messageResolver:o,fallbackLocale:a,fallbackWarn:l,missingWarn:c,fallbackContext:h}=n,p={locale:e,modifiers:r,pluralRules:s,messages:(m,y)=>{let b=o(t,m);if(b==null&&(h||y)){const[,,v]=cL(h||n,m,e,a,l,c);b=o(v,m)}if(it(b)||Xs(b)){let v=!1;const x=uL(n,m,e,b,m,()=>{v=!0});return v?T1:x}else return jr(b)?b:T1}};return n.processor&&(p.processor=n.processor),i.list&&(p.list=i.list),i.named&&(p.named=i.named),ii(i.plural)&&(p.pluralIndex=i.plural),p}TU();/*!
  * vue-i18n v11.2.8
  * (c) 2025 kazuya kawaguchi
  * Released under the MIT License.
  */const xz="11.2.8";function wz(){typeof __VUE_I18N_FULL_INSTALL__!="boolean"&&(sl().__VUE_I18N_FULL_INSTALL__=!0),typeof __VUE_I18N_LEGACY_API__!="boolean"&&(sl().__VUE_I18N_LEGACY_API__=!0),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(sl().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(sl().__INTLIFY_PROD_DEVTOOLS__=!1)}const vr={UNEXPECTED_RETURN_TYPE:WU,INVALID_ARGUMENT:25,MUST_BE_CALL_SETUP_TOP:26,NOT_INSTALLED:27,REQUIRED_VALUE:28,INVALID_VALUE:29,NOT_INSTALLED_WITH_PROVIDE:31,UNEXPECTED_ERROR:32};function Or(n,...e){return rm(n,null,void 0)}const M0=Ea("__translateVNode"),T0=Ea("__datetimeParts"),E0=Ea("__numberParts"),hL=Ea("__setPluralRules"),dL=Ea("__injectWithOption"),L0=Ea("__dispose");function vh(n){if(!en(n)||Xs(n))return n;for(const e in n)if(bs(n,e))if(!e.includes("."))en(n[e])&&vh(n[e]);else{const t=e.split("."),i=t.length-1;let r=n,s=!1;for(let o=0;o<i;o++){if(t[o]==="__proto__")throw new Error(`unsafe key: ${t[o]}`);if(t[o]in r||(r[t[o]]=dn()),!en(r[t[o]])){s=!0;break}r=r[t[o]]}if(s||(Xs(r)?eL.includes(t[i])||delete n[e]:(r[t[i]]=n[e],delete n[e])),!Xs(r)){const o=r[t[i]];en(o)&&vh(o)}}return n}function tv(n,e){const{messages:t,__i18n:i,messageResolver:r,flatJson:s}=e,o=Ut(t)?t:zn(i)?dn():{[n]:dn()};if(zn(i)&&i.forEach(a=>{if("locale"in a&&"resource"in a){const{locale:l,resource:c}=a;l?(o[l]=o[l]||dn(),ap(c,o[l])):ap(c,o)}else it(a)&&ap(JSON.parse(a),o)}),r==null&&s)for(const a in o)bs(o,a)&&vh(o[a]);return o}function fL(n){return n.type}function pL(n,e,t){let i=en(e.messages)?e.messages:dn();"__i18nGlobal"in t&&(i=tv(n.locale.value,{messages:i,__i18n:t.__i18nGlobal}));const r=Object.keys(i);r.length&&r.forEach(s=>{n.mergeLocaleMessage(s,i[s])});{if(en(e.datetimeFormats)){const s=Object.keys(e.datetimeFormats);s.length&&s.forEach(o=>{n.mergeDateTimeFormat(o,e.datetimeFormats[o])})}if(en(e.numberFormats)){const s=Object.keys(e.numberFormats);s.length&&s.forEach(o=>{n.mergeNumberFormat(o,e.numberFormats[o])})}}}function L1(n){return xt(zh,null,n,0)}function bh(){return TE()}const A1="__INTLIFY_META__",C1=()=>[],Sz=()=>!1;let R1=0;function P1(n){return(e,t,i,r)=>n(t,i,bh()||void 0,r)}const Mz=()=>{const n=bh();let e=null;return n&&(e=fL(n)[A1])?{[A1]:e}:null};function nv(n={}){const{__root:e,__injectWithOption:t}=n,i=e===void 0,r=n.flatJson,s=Lp?zt:BT;let o=Qt(n.inheritLocale)?n.inheritLocale:!0;const a=s(e&&o?e.locale.value:it(n.locale)?n.locale:_h),l=s(e&&o?e.fallbackLocale.value:it(n.fallbackLocale)||zn(n.fallbackLocale)||Ut(n.fallbackLocale)||n.fallbackLocale===!1?n.fallbackLocale:a.value),c=s(tv(a.value,n)),h=s(Ut(n.datetimeFormats)?n.datetimeFormats:{[a.value]:{}}),d=s(Ut(n.numberFormats)?n.numberFormats:{[a.value]:{}});let p=e?e.missingWarn:Qt(n.missingWarn)||Dc(n.missingWarn)?n.missingWarn:!0,m=e?e.fallbackWarn:Qt(n.fallbackWarn)||Dc(n.fallbackWarn)?n.fallbackWarn:!0,y=e?e.fallbackRoot:Qt(n.fallbackRoot)?n.fallbackRoot:!0,b=!!n.fallbackFormat,v=Tn(n.missing)?n.missing:null,g=Tn(n.missing)?P1(n.missing):null,x=Tn(n.postTranslation)?n.postTranslation:null,w=e?e.warnHtmlMessage:Qt(n.warnHtmlMessage)?n.warnHtmlMessage:!0,S=!!n.escapeParameter;const C=e?e.modifiers:Ut(n.modifiers)?n.modifiers:{};let A=n.pluralRules||e&&e.pluralRules,E;E=(()=>{i&&_1(null);const G={version:xz,locale:a.value,fallbackLocale:l.value,messages:c.value,modifiers:C,pluralRules:A,missing:g===null?void 0:g,missingWarn:p,fallbackWarn:m,fallbackFormat:b,unresolving:!0,postTranslation:x===null?void 0:x,warnHtmlMessage:w,escapeParameter:S,messageResolver:n.messageResolver,messageCompiler:n.messageCompiler,__meta:{framework:"vue"}};G.datetimeFormats=h.value,G.numberFormats=d.value,G.__datetimeFormatters=Ut(E)?E.__datetimeFormatters:void 0,G.__numberFormatters=Ut(E)?E.__numberFormatters:void 0;const Q=oz(G);return i&&_1(Q),Q})(),bu(E,a.value,l.value);function R(){return[a.value,l.value,c.value,h.value,d.value]}const T=ci({get:()=>a.value,set:G=>{E.locale=G,a.value=G}}),k=ci({get:()=>l.value,set:G=>{E.fallbackLocale=G,l.value=G,bu(E,a.value,G)}}),Y=ci(()=>c.value),$=ci(()=>h.value),re=ci(()=>d.value);function ae(){return Tn(x)?x:null}function V(G){x=G,E.postTranslation=G}function te(){return v}function J(G){G!==null&&(g=P1(G)),v=G,E.missing=g}const pe=(G,Q,K,de,ye,Pe)=>{R();let Qe;try{__INTLIFY_PROD_DEVTOOLS__,i||(E.fallbackContext=e?sz():void 0),Qe=G(E)}finally{__INTLIFY_PROD_DEVTOOLS__,i||(E.fallbackContext=void 0)}if(K!=="translate exists"&&ii(Qe)&&Qe===sm||K==="translate exists"&&!Qe){const[Ne,je]=Q();return e&&y?de(e):ye(Ne)}else{if(Pe(Qe))return Qe;throw Or(vr.UNEXPECTED_RETURN_TYPE)}};function Te(...G){return pe(Q=>Reflect.apply(E1,null,[Q,...G]),()=>S0(...G),"translate",Q=>Reflect.apply(Q.t,Q,[...G]),Q=>Q,Q=>it(Q))}function Le(...G){const[Q,K,de]=G;if(de&&!en(de))throw Or(vr.INVALID_ARGUMENT);return Te(Q,K,hi({resolvedMessage:!0},de||{}))}function Ue(...G){return pe(Q=>Reflect.apply(b1,null,[Q,...G]),()=>x0(...G),"datetime format",Q=>Reflect.apply(Q.d,Q,[...G]),()=>g1,Q=>it(Q)||zn(Q))}function tt(...G){return pe(Q=>Reflect.apply(w1,null,[Q,...G]),()=>w0(...G),"number format",Q=>Reflect.apply(Q.n,Q,[...G]),()=>g1,Q=>it(Q)||zn(Q))}function _e(G){return G.map(Q=>it(Q)||ii(Q)||Qt(Q)?L1(String(Q)):Q)}const We={normalize:_e,interpolate:G=>G,type:"vnode"};function se(...G){return pe(Q=>{let K;const de=Q;try{de.processor=We,K=Reflect.apply(E1,null,[de,...G])}finally{de.processor=null}return K},()=>S0(...G),"translate",Q=>Q[M0](...G),Q=>[L1(Q)],Q=>zn(Q))}function Se(...G){return pe(Q=>Reflect.apply(w1,null,[Q,...G]),()=>w0(...G),"number format",Q=>Q[E0](...G),C1,Q=>it(Q)||zn(Q))}function Me(...G){return pe(Q=>Reflect.apply(b1,null,[Q,...G]),()=>x0(...G),"datetime format",Q=>Q[T0](...G),C1,Q=>it(Q)||zn(Q))}function De(G){A=G,E.pluralRules=A}function Be(G,Q){return pe(()=>{if(!G)return!1;const K=it(Q)?Q:a.value,de=D(K),ye=E.messageResolver(de,G);return Xs(ye)||jr(ye)||it(ye)},()=>[G],"translate exists",K=>Reflect.apply(K.te,K,[G,Q]),Sz,K=>Qt(K))}function H(G){let Q=null;const K=tL(E,l.value,a.value);for(let de=0;de<K.length;de++){const ye=c.value[K[de]]||{},Pe=E.messageResolver(ye,G);if(Pe!=null){Q=Pe;break}}return Q}function X(G){const Q=H(G);return Q??(e?e.tm(G)||{}:{})}function D(G){return c.value[G]||{}}function ge(G,Q){if(r){const K={[G]:Q};for(const de in K)bs(K,de)&&vh(K[de]);Q=K[G]}c.value[G]=Q,E.messages=c.value}function me(G,Q){c.value[G]=c.value[G]||{};const K={[G]:Q};if(r)for(const de in K)bs(K,de)&&vh(K[de]);Q=K[G],ap(Q,c.value[G]),E.messages=c.value}function fe(G){return h.value[G]||{}}function N(G,Q){h.value[G]=Q,E.datetimeFormats=h.value,x1(E,G,Q)}function B(G,Q){h.value[G]=hi(h.value[G]||{},Q),E.datetimeFormats=h.value,x1(E,G,Q)}function j(G){return d.value[G]||{}}function L(G,Q){d.value[G]=Q,E.numberFormats=d.value,S1(E,G,Q)}function P(G,Q){d.value[G]=hi(d.value[G]||{},Q),E.numberFormats=d.value,S1(E,G,Q)}R1++,e&&Lp&&(li(e.locale,G=>{o&&(a.value=G,E.locale=G,bu(E,a.value,l.value))}),li(e.fallbackLocale,G=>{o&&(l.value=G,E.fallbackLocale=G,bu(E,a.value,l.value))}));const Z={id:R1,locale:T,fallbackLocale:k,get inheritLocale(){return o},set inheritLocale(G){o=G,G&&e&&(a.value=e.locale.value,l.value=e.fallbackLocale.value,bu(E,a.value,l.value))},get availableLocales(){return Object.keys(c.value).sort()},messages:Y,get modifiers(){return C},get pluralRules(){return A||{}},get isGlobal(){return i},get missingWarn(){return p},set missingWarn(G){p=G,E.missingWarn=p},get fallbackWarn(){return m},set fallbackWarn(G){m=G,E.fallbackWarn=m},get fallbackRoot(){return y},set fallbackRoot(G){y=G},get fallbackFormat(){return b},set fallbackFormat(G){b=G,E.fallbackFormat=b},get warnHtmlMessage(){return w},set warnHtmlMessage(G){w=G,E.warnHtmlMessage=G},get escapeParameter(){return S},set escapeParameter(G){S=G,E.escapeParameter=G},t:Te,getLocaleMessage:D,setLocaleMessage:ge,mergeLocaleMessage:me,getPostTranslationHandler:ae,setPostTranslationHandler:V,getMissingHandler:te,setMissingHandler:J,[hL]:De};return Z.datetimeFormats=$,Z.numberFormats=re,Z.rt=Le,Z.te=Be,Z.tm=X,Z.d=Ue,Z.n=tt,Z.getDateTimeFormat=fe,Z.setDateTimeFormat=N,Z.mergeDateTimeFormat=B,Z.getNumberFormat=j,Z.setNumberFormat=L,Z.mergeNumberFormat=P,Z[dL]=t,Z[M0]=se,Z[T0]=Me,Z[E0]=Se,Z}function Tz(n){const e=it(n.locale)?n.locale:_h,t=it(n.fallbackLocale)||zn(n.fallbackLocale)||Ut(n.fallbackLocale)||n.fallbackLocale===!1?n.fallbackLocale:e,i=Tn(n.missing)?n.missing:void 0,r=Qt(n.silentTranslationWarn)||Dc(n.silentTranslationWarn)?!n.silentTranslationWarn:!0,s=Qt(n.silentFallbackWarn)||Dc(n.silentFallbackWarn)?!n.silentFallbackWarn:!0,o=Qt(n.fallbackRoot)?n.fallbackRoot:!0,a=!!n.formatFallbackMessages,l=Ut(n.modifiers)?n.modifiers:{},c=n.pluralizationRules,h=Tn(n.postTranslation)?n.postTranslation:void 0,d=it(n.warnHtmlInMessage)?n.warnHtmlInMessage!=="off":!0,p=!!n.escapeParameterHtml,m=Qt(n.sync)?n.sync:!0;let y=n.messages;if(Ut(n.sharedMessages)){const C=n.sharedMessages;y=Object.keys(C).reduce((E,O)=>{const R=E[O]||(E[O]={});return hi(R,C[O]),E},y||{})}const{__i18n:b,__root:v,__injectWithOption:g}=n,x=n.datetimeFormats,w=n.numberFormats,S=n.flatJson;return{locale:e,fallbackLocale:t,messages:y,flatJson:S,datetimeFormats:x,numberFormats:w,missing:i,missingWarn:r,fallbackWarn:s,fallbackRoot:o,fallbackFormat:a,modifiers:l,pluralRules:c,postTranslation:h,warnHtmlMessage:d,escapeParameter:p,messageResolver:n.messageResolver,inheritLocale:m,__i18n:b,__root:v,__injectWithOption:g}}function A0(n={}){const e=nv(Tz(n)),{__extender:t}=n,i={id:e.id,get locale(){return e.locale.value},set locale(r){e.locale.value=r},get fallbackLocale(){return e.fallbackLocale.value},set fallbackLocale(r){e.fallbackLocale.value=r},get messages(){return e.messages.value},get datetimeFormats(){return e.datetimeFormats.value},get numberFormats(){return e.numberFormats.value},get availableLocales(){return e.availableLocales},get missing(){return e.getMissingHandler()},set missing(r){e.setMissingHandler(r)},get silentTranslationWarn(){return Qt(e.missingWarn)?!e.missingWarn:e.missingWarn},set silentTranslationWarn(r){e.missingWarn=Qt(r)?!r:r},get silentFallbackWarn(){return Qt(e.fallbackWarn)?!e.fallbackWarn:e.fallbackWarn},set silentFallbackWarn(r){e.fallbackWarn=Qt(r)?!r:r},get modifiers(){return e.modifiers},get formatFallbackMessages(){return e.fallbackFormat},set formatFallbackMessages(r){e.fallbackFormat=r},get postTranslation(){return e.getPostTranslationHandler()},set postTranslation(r){e.setPostTranslationHandler(r)},get sync(){return e.inheritLocale},set sync(r){e.inheritLocale=r},get warnHtmlInMessage(){return e.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(r){e.warnHtmlMessage=r!=="off"},get escapeParameterHtml(){return e.escapeParameter},set escapeParameterHtml(r){e.escapeParameter=r},get pluralizationRules(){return e.pluralRules||{}},__composer:e,t(...r){return Reflect.apply(e.t,e,[...r])},rt(...r){return Reflect.apply(e.rt,e,[...r])},te(r,s){return e.te(r,s)},tm(r){return e.tm(r)},getLocaleMessage(r){return e.getLocaleMessage(r)},setLocaleMessage(r,s){e.setLocaleMessage(r,s)},mergeLocaleMessage(r,s){e.mergeLocaleMessage(r,s)},d(...r){return Reflect.apply(e.d,e,[...r])},getDateTimeFormat(r){return e.getDateTimeFormat(r)},setDateTimeFormat(r,s){e.setDateTimeFormat(r,s)},mergeDateTimeFormat(r,s){e.mergeDateTimeFormat(r,s)},n(...r){return Reflect.apply(e.n,e,[...r])},getNumberFormat(r){return e.getNumberFormat(r)},setNumberFormat(r,s){e.setNumberFormat(r,s)},mergeNumberFormat(r,s){e.mergeNumberFormat(r,s)}};return i.__extender=t,i}function Ez(n,e,t){return{beforeCreate(){const i=bh();if(!i)throw Or(vr.UNEXPECTED_ERROR);const r=this.$options;if(r.i18n){const s=r.i18n;if(r.__i18n&&(s.__i18n=r.__i18n),s.__root=e,this===this.$root)this.$i18n=I1(n,s);else{s.__injectWithOption=!0,s.__extender=t.__vueI18nExtend,this.$i18n=A0(s);const o=this.$i18n;o.__extender&&(o.__disposer=o.__extender(this.$i18n))}}else if(r.__i18n)if(this===this.$root)this.$i18n=I1(n,r);else{this.$i18n=A0({__i18n:r.__i18n,__injectWithOption:!0,__extender:t.__vueI18nExtend,__root:e});const s=this.$i18n;s.__extender&&(s.__disposer=s.__extender(this.$i18n))}else this.$i18n=n;r.__i18nGlobal&&pL(e,r,r),this.$t=(...s)=>this.$i18n.t(...s),this.$rt=(...s)=>this.$i18n.rt(...s),this.$te=(s,o)=>this.$i18n.te(s,o),this.$d=(...s)=>this.$i18n.d(...s),this.$n=(...s)=>this.$i18n.n(...s),this.$tm=s=>this.$i18n.tm(s),t.__setInstance(i,this.$i18n)},mounted(){},unmounted(){const i=bh();if(!i)throw Or(vr.UNEXPECTED_ERROR);const r=this.$i18n;delete this.$t,delete this.$rt,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,r.__disposer&&(r.__disposer(),delete r.__disposer,delete r.__extender),t.__deleteInstance(i),delete this.$i18n}}}function I1(n,e){n.locale=e.locale||n.locale,n.fallbackLocale=e.fallbackLocale||n.fallbackLocale,n.missing=e.missing||n.missing,n.silentTranslationWarn=e.silentTranslationWarn||n.silentFallbackWarn,n.silentFallbackWarn=e.silentFallbackWarn||n.silentFallbackWarn,n.formatFallbackMessages=e.formatFallbackMessages||n.formatFallbackMessages,n.postTranslation=e.postTranslation||n.postTranslation,n.warnHtmlInMessage=e.warnHtmlInMessage||n.warnHtmlInMessage,n.escapeParameterHtml=e.escapeParameterHtml||n.escapeParameterHtml,n.sync=e.sync||n.sync,n.__composer[hL](e.pluralizationRules||n.pluralizationRules);const t=tv(n.locale,{messages:e.messages,__i18n:e.__i18n});return Object.keys(t).forEach(i=>n.mergeLocaleMessage(i,t[i])),e.datetimeFormats&&Object.keys(e.datetimeFormats).forEach(i=>n.mergeDateTimeFormat(i,e.datetimeFormats[i])),e.numberFormats&&Object.keys(e.numberFormats).forEach(i=>n.mergeNumberFormat(i,e.numberFormats[i])),n}const iv={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:n=>n==="parent"||n==="global",default:"parent"},i18n:{type:Object}};function Lz({slots:n},e){return e.length===1&&e[0]==="default"?(n.default?n.default():[]).reduce((i,r)=>[...i,...r.type===Un?r.children:[r]],[]):e.reduce((t,i)=>{const r=n[i];return r&&(t[i]=r()),t},dn())}function mL(){return Un}const Az=gt({name:"i18n-t",props:hi({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:n=>ii(n)||!isNaN(n)}},iv),setup(n,e){const{slots:t,attrs:i}=e,r=n.i18n||Ht({useScope:n.scope,__useComponent:!0});return()=>{const s=Object.keys(t).filter(d=>d[0]!=="_"),o=dn();n.locale&&(o.locale=n.locale),n.plural!==void 0&&(o.plural=it(n.plural)?+n.plural:n.plural);const a=Lz(e,s),l=r[M0](n.keypath,a,o),c=hi(dn(),i),h=it(n.tag)||en(n.tag)?n.tag:mL();return tm(h,c,l)}}}),D1=Az;function Cz(n){return zn(n)&&!it(n[0])}function gL(n,e,t,i){const{slots:r,attrs:s}=e;return()=>{const o={part:!0};let a=dn();n.locale&&(o.locale=n.locale),it(n.format)?o.key=n.format:en(n.format)&&(it(n.format.key)&&(o.key=n.format.key),a=Object.keys(n.format).reduce((p,m)=>t.includes(m)?hi(dn(),p,{[m]:n.format[m]}):p,dn()));const l=i(n.value,o,a);let c=[o.key];zn(l)?c=l.map((p,m)=>{const y=r[p.type],b=y?y({[p.type]:p.value,index:m,parts:l}):[p.value];return Cz(b)&&(b[0].key=`${p.type}-${m}`),b}):it(l)&&(c=[l]);const h=hi(dn(),s),d=it(n.tag)||en(n.tag)?n.tag:mL();return tm(d,h,c)}}const Rz=gt({name:"i18n-n",props:hi({value:{type:Number,required:!0},format:{type:[String,Object]}},iv),setup(n,e){const t=n.i18n||Ht({useScope:n.scope,__useComponent:!0});return gL(n,e,lL,(...i)=>t[E0](...i))}}),N1=Rz;function Pz(n,e){const t=n;if(n.mode==="composition")return t.__getInstance(e)||n.global;{const i=t.__getInstance(e);return i!=null?i.__composer:n.global.__composer}}function Iz(n){const e=o=>{const{instance:a,value:l}=o;if(!a||!a.$)throw Or(vr.UNEXPECTED_ERROR);const c=Pz(n,a.$),h=O1(l);return[Reflect.apply(c.t,c,[...k1(h)]),c]};return{created:(o,a)=>{const[l,c]=e(a);Lp&&n.global===c&&(o.__i18nWatcher=li(c.locale,()=>{a.instance&&a.instance.$forceUpdate()})),o.__composer=c,o.textContent=l},unmounted:o=>{Lp&&o.__i18nWatcher&&(o.__i18nWatcher(),o.__i18nWatcher=void 0,delete o.__i18nWatcher),o.__composer&&(o.__composer=void 0,delete o.__composer)},beforeUpdate:(o,{value:a})=>{if(o.__composer){const l=o.__composer,c=O1(a);o.textContent=Reflect.apply(l.t,l,[...k1(c)])}},getSSRProps:o=>{const[a]=e(o);return{textContent:a}}}}function O1(n){if(it(n))return{path:n};if(Ut(n)){if(!("path"in n))throw Or(vr.REQUIRED_VALUE,"path");return n}else throw Or(vr.INVALID_VALUE)}function k1(n){const{path:e,locale:t,args:i,choice:r,plural:s}=n,o={},a=i||{};return it(t)&&(o.locale=t),ii(r)&&(o.plural=r),ii(s)&&(o.plural=s),[e,a,o]}function Dz(n,e,...t){const i=Ut(t[0])?t[0]:{};(Qt(i.globalInstall)?i.globalInstall:!0)&&([D1.name,"I18nT"].forEach(s=>n.component(s,D1)),[N1.name,"I18nN"].forEach(s=>n.component(s,N1)),[U1.name,"I18nD"].forEach(s=>n.component(s,U1))),n.directive("t",Iz(e))}const Nz=Ea("global-vue-i18n");function Oz(n={}){const e=__VUE_I18N_LEGACY_API__&&Qt(n.legacy)?n.legacy:__VUE_I18N_LEGACY_API__,t=Qt(n.globalInjection)?n.globalInjection:!0,i=new Map,[r,s]=kz(n,e),o=Ea("");function a(d){return i.get(d)||null}function l(d,p){i.set(d,p)}function c(d){i.delete(d)}const h={get mode(){return __VUE_I18N_LEGACY_API__&&e?"legacy":"composition"},async install(d,...p){if(d.__VUE_I18N_SYMBOL__=o,d.provide(d.__VUE_I18N_SYMBOL__,h),Ut(p[0])){const b=p[0];h.__composerExtend=b.__composerExtend,h.__vueI18nExtend=b.__vueI18nExtend}let m=null;!e&&t&&(m=Hz(d,h.global)),__VUE_I18N_FULL_INSTALL__&&Dz(d,h,...p),__VUE_I18N_LEGACY_API__&&e&&d.mixin(Ez(s,s.__composer,h));const y=d.unmount;d.unmount=()=>{m&&m(),h.dispose(),y()}},get global(){return s},dispose(){r.stop()},__instances:i,__getInstance:a,__setInstance:l,__deleteInstance:c};return h}function Ht(n={}){const e=bh();if(e==null)throw Or(vr.MUST_BE_CALL_SETUP_TOP);if(!e.isCE&&e.appContext.app!=null&&!e.appContext.app.__VUE_I18N_SYMBOL__)throw Or(vr.NOT_INSTALLED);const t=Fz(e),i=zz(t),r=fL(e),s=Uz(n,r);if(s==="global")return pL(i,n,r),i;if(s==="parent"){let l=Wz(t,e,n.__useComponent);return l==null&&(l=i),l}const o=t;let a=o.__getInstance(e);if(a==null){const l=hi({},n);"__i18n"in r&&(l.__i18n=r.__i18n),i&&(l.__root=i),a=nv(l),o.__composerExtend&&(a[L0]=o.__composerExtend(a)),Gz(o,e,a),o.__setInstance(e,a)}return a}function kz(n,e){const t=PN(),i=__VUE_I18N_LEGACY_API__&&e?t.run(()=>A0(n)):t.run(()=>nv(n));if(i==null)throw Or(vr.UNEXPECTED_ERROR);return[t,i]}function Fz(n){const e=Ss(n.isCE?Nz:n.appContext.app.__VUE_I18N_SYMBOL__);if(!e)throw Or(n.isCE?vr.NOT_INSTALLED_WITH_PROVIDE:vr.UNEXPECTED_ERROR);return e}function Uz(n,e){return im(n)?"__i18n"in e?"local":"global":n.useScope?n.useScope:"local"}function zz(n){return n.mode==="composition"?n.global:n.global.__composer}function Wz(n,e,t=!1){let i=null;const r=e.root;let s=Vz(e,t);for(;s!=null;){const o=n;if(n.mode==="composition")i=o.__getInstance(s);else if(__VUE_I18N_LEGACY_API__){const a=o.__getInstance(s);a!=null&&(i=a.__composer,t&&i&&!i[dL]&&(i=null))}if(i!=null||r===s)break;s=s.parent}return i}function Vz(n,e=!1){return n==null?null:e&&n.vnode.ctx||n.parent}function Gz(n,e,t){Dn(()=>{},e),G_(()=>{const i=t;n.__deleteInstance(e);const r=i[L0];r&&(r(),delete i[L0])},e)}const Bz=["locale","fallbackLocale","availableLocales"],F1=["t","rt","d","n","tm","te"];function Hz(n,e){const t=Object.create(null);return Bz.forEach(r=>{const s=Object.getOwnPropertyDescriptor(e,r);if(!s)throw Or(vr.UNEXPECTED_ERROR);const o=Pi(s.value)?{get(){return s.value.value},set(a){s.value.value=a}}:{get(){return s.get&&s.get()}};Object.defineProperty(t,r,o)}),n.config.globalProperties.$i18n=t,F1.forEach(r=>{const s=Object.getOwnPropertyDescriptor(e,r);if(!s||!s.value)throw Or(vr.UNEXPECTED_ERROR);Object.defineProperty(n.config.globalProperties,`$${r}`,s)}),()=>{delete n.config.globalProperties.$i18n,F1.forEach(r=>{delete n.config.globalProperties[`$${r}`]})}}const Zz=gt({name:"i18n-d",props:hi({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},iv),setup(n,e){const t=n.i18n||Ht({useScope:n.scope,__useComponent:!0});return gL(n,e,aL,(...i)=>t[T0](...i))}}),U1=Zz;wz();ez(OU);tz(QU);nz(tL);if(__INTLIFY_PROD_DEVTOOLS__){const n=sl();n.__INTLIFY__=!0,kU(n.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}const Xz=["title"],C0=gt({__name:"LanguageSwitcher",setup(n){const{locale:e}=Ht(),t=()=>{e.value=e.value==="en"?"zh":"en"};return(i,r)=>(ot(),At("button",{onClick:t,class:"flex items-center gap-1 px-2 py-1 rounded text-xs font-medium text-gray-400 hover:text-white transition-colors border border-transparent hover:border-gray-700",title:Re(e)==="en"?"Switch to Chinese":"Switch to English"},[r[0]||(r[0]=ee("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4"},[ee("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.546-3.131 1.518-4.335"})],-1)),ee("span",null,Ze(Re(e)==="en"?"EN":"ZH"),1)],8,Xz))}}),jz={class:"p-4 border-b border-gray-700"},Yz={class:"flex items-center justify-between"},Kz={class:"flex items-center gap-2 min-w-0"},Jz={class:"text-lg font-bold text-white tracking-tight flex items-center gap-1.5 min-w-0"},Qz={class:"text-blue-500 flex-shrink-0"},$z={class:"truncate hidden sm:inline"},qz={class:"mt-2 md:hidden"},eW={class:"hidden md:block absolute right-4 top-4"},tW={class:"flex-1 overflow-y-auto py-4"},nW={class:"px-3 mb-4"},iW={class:"px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider"},rW={class:"space-y-1 px-3"},sW={class:"font-medium text-sm"},oW={class:"p-4 border-t border-gray-700 text-xs text-gray-500 text-center"},aW=gt({__name:"Sidebar",props:{isOpen:{type:Boolean}},emits:["close"],setup(n,{emit:e}){const t=BE(),{t:i}=Ht(),r=e,s=()=>{r("close")},o=ci(()=>[{category:i("sidebar.categories.mapControl"),items:[{title:i("examples.basicMap.title"),path:"/examples/basic-map",description:i("examples.basicMap.description")},{title:i("examples.mapEvents.title"),path:"/examples/map-events",description:i("examples.mapEvents.description")},{title:i("examples.cameraControl.title"),path:"/examples/camera-control",description:i("examples.cameraControl.description")}]},{category:i("sidebar.categories.layers"),items:[{title:i("examples.tileLayer.title"),path:"/examples/tile-layer",description:i("examples.tileLayer.description")},{title:i("examples.layerManagement.title"),path:"/examples/layer-management",description:i("examples.layerManagement.description")},{title:i("examples.layerOperations.title"),path:"/examples/layer-operations",description:i("examples.layerOperations.description")},{title:i("examples.layerProperties.title"),path:"/examples/layer-properties",description:i("examples.layerProperties.description")}]},{category:i("sidebar.categories.geometryInteraction"),items:[{title:i("examples.markerExample.title"),path:"/examples/marker-example",description:i("examples.markerExample.description")},{title:i("examples.markerStyles.title"),path:"/examples/marker-styles",description:i("examples.markerStyles.description")},{title:i("examples.vectorShapes.title"),path:"/examples/vector-shapes",description:i("examples.vectorShapes.description")},{title:i("examples.geometryStyles.title"),path:"/examples/geometry-styles",description:i("examples.geometryStyles.description")},{title:i("examples.drawTool.title"),path:"/examples/draw-tool",description:i("examples.drawTool.description")},{title:i("examples.uiComponents.title"),path:"/examples/ui-components",description:i("examples.uiComponents.description")},{title:i("examples.labelExample.title"),path:"/examples/label-example",description:i("examples.labelExample.description")}]},{category:i("sidebar.categories.advancedVisuals"),items:[{title:i("examples.pipelineNetwork.title"),path:"/examples/pipeline-network",description:i("examples.pipelineNetwork.description")},{title:i("examples.modelLayer.title"),path:"/examples/model-layer",description:i("examples.modelLayer.description")},{title:i("examples.realisticWater.title"),path:"/examples/realistic-water",description:i("examples.realisticWater.description")},{title:i("examples.volumetricClouds.title"),path:"/examples/volumetric-clouds",description:i("examples.volumetricClouds.description")},{title:i("examples.zhengzhouNight.title"),path:"/examples/zhengzhou-night",description:i("examples.zhengzhouNight.description")}]}]);return(a,l)=>{const c=Uh("router-link");return ot(),At(Un,null,[n.isOpen?(ot(),At("div",{key:0,class:"md:hidden fixed inset-0 bg-black/50 z-30 backdrop-blur-sm",onClick:s})):qp("",!0),ee("aside",{class:Dr(["fixed md:static inset-y-0 left-0 w-64 h-full bg-gray-800 border-r border-gray-700 flex flex-col z-40 transform transition-transform duration-300 ease-in-out md:transform-none",n.isOpen?"translate-x-0":"-translate-x-full"])},[ee("div",jz,[ee("div",Yz,[ee("div",Kz,[l[0]||(l[0]=ee("img",{src:HE,alt:"Logo",class:"w-6 h-6 flex-shrink-0"},null,-1)),ee("h1",Jz,[ee("span",Qz,Ze(Re(i)("sidebar.title")),1),ee("span",$z,Ze(Re(i)("sidebar.subtitle")),1)])]),ee("button",{class:"md:hidden text-gray-400 hover:text-white",onClick:s},[...l[1]||(l[1]=[ee("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[ee("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),ee("div",qz,[xt(C0)]),ee("div",eW,[xt(C0)])]),ee("nav",tW,[ee("div",nW,[xt(c,{to:"/",class:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",onClick:s},{default:yn(()=>[l[2]||(l[2]=ee("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[ee("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),ul(" "+Ze(Re(i)("sidebar.backToHome")),1)]),_:1})]),(ot(!0),At(Un,null,Cc(o.value,h=>(ot(),At("div",{key:h.category,class:"mb-4"},[ee("div",iW,Ze(h.category),1),ee("ul",rW,[(ot(!0),At(Un,null,Cc(h.items,d=>(ot(),At("li",{key:d.path},[xt(c,{to:d.path,class:Dr(["block px-4 py-2.5 rounded-lg transition-colors group",Re(t).path===d.path?"bg-blue-600/20 text-blue-400 border border-blue-600/30":"text-gray-400 hover:bg-gray-700 hover:text-white"]),onClick:s},{default:yn(()=>[ee("div",sW,Ze(d.title),1)]),_:2},1032,["to","class"])]))),128))])]))),128))]),ee("div",oW,Ze(Re(i)("sidebar.footer")),1)],2)],64)}}}),lW={class:"flex flex-col md:flex-row h-screen w-full bg-gray-900 overflow-hidden"},cW={class:"md:hidden h-14 bg-gray-800 border-b border-gray-700 flex items-center px-4 flex-shrink-0 z-20 justify-between"},uW={class:"flex items-center gap-3"},hW={class:"flex-1 h-full overflow-hidden relative"},dW=gt({__name:"MainLayout",setup(n){const e=zt(!1);return(t,i)=>{const r=Uh("router-view");return ot(),At("div",lW,[ee("header",cW,[ee("div",uW,[ee("button",{onClick:i[0]||(i[0]=s=>e.value=!0),class:"p-2 text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg"},[...i[2]||(i[2]=[ee("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[ee("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])]),i[3]||(i[3]=ee("span",{class:"text-lg font-bold text-white tracking-tight"},[ee("span",{class:"text-blue-500"},"Terra"),ul("-GL ")],-1))])]),xt(aW,{"is-open":e.value,onClose:i[1]||(i[1]=s=>e.value=!1)},null,8,["is-open"]),ee("main",hW,[xt(r,null,{default:yn(({Component:s})=>[(ot(),Cn(SO(s),{key:t.$route.fullPath}))]),_:1})])])}}}),fW={class:"flex items-center gap-4 md:gap-8"},pW={class:"flex items-center gap-4 md:gap-6 bg-gray-800/50 backdrop-blur px-4 md:px-6 py-2 rounded-full border border-gray-700/50"},mW=gt({__name:"Navbar",setup(n){const{t:e}=Ht(),t=BE(),i=r=>t.path===r;return(r,s)=>{const o=Uh("router-link");return ot(),At("nav",{class:Dr(["w-full px-4 md:px-8 py-4 md:py-6 flex flex-col md:flex-row justify-between items-center z-10 gap-4 md:gap-0",r.$attrs.class||"absolute top-0"])},[xt(o,{to:"/",class:"flex items-center gap-3 hover:opacity-80 transition-opacity"},{default:yn(()=>[...s[0]||(s[0]=[ee("img",{src:HE,alt:"Terra-GL Logo",class:"w-8 h-8"},null,-1),ee("span",{class:"text-2xl font-bold tracking-tighter"},[ee("span",{class:"text-blue-500"},"Terra"),ul("-GL ")],-1)])]),_:1}),ee("div",fW,[ee("div",pW,[xt(o,{to:"/",class:Dr(["text-sm font-medium transition-colors",i("/")?"text-blue-400":"text-gray-300 hover:text-white"])},{default:yn(()=>[ul(Ze(Re(e)("nav.home")),1)]),_:1},8,["class"]),xt(o,{to:"/examples/basic-map",class:Dr(["text-sm font-medium transition-colors",i("/examples/basic-map")||i("/gallery")?"text-blue-400":"text-gray-300 hover:text-white"])},{default:yn(()=>[ul(Ze(Re(e)("nav.examples")),1)]),_:1},8,["class"])]),xt(C0)])],2)}}});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Gh="171",yr={ROTATE:0,DOLLY:1,PAN:2},_r={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},gW=0,z1=1,yW=2,yL=1,_L=2,wo=3,ns=0,Zi=1,Yr=2,va=0,ba=1,xh=2,W1=3,V1=4,_W=5,nl=100,vW=101,bW=102,xW=103,wW=104,SW=200,MW=201,TW=202,EW=203,R0=204,P0=205,LW=206,AW=207,CW=208,RW=209,PW=210,IW=211,DW=212,NW=213,OW=214,I0=0,D0=1,N0=2,Oc=3,O0=4,k0=5,F0=6,U0=7,om=0,kW=1,FW=2,xa=0,UW=1,zW=2,WW=3,rv=4,VW=5,GW=6,BW=7,G1="attached",HW="detached",vL=300,kc=301,Fc=302,Ap=303,z0=304,am=306,is=1e3,Qr=1001,Cp=1002,or=1003,bL=1004,Gu=1005,ui=1006,lp=1007,Pr=1008,Uo=1009,xL=1010,wL=1011,wh=1012,sv=1013,ml=1014,rr=1015,Ro=1016,ov=1017,av=1018,Uc=1020,SL=35902,ML=1021,TL=1022,$r=1023,EL=1024,LL=1025,Mc=1026,zc=1027,lv=1028,cv=1029,AL=1030,uv=1031,hv=1033,cp=33776,up=33777,hp=33778,dp=33779,W0=35840,V0=35841,G0=35842,B0=35843,H0=36196,Z0=37492,X0=37496,j0=37808,Y0=37809,K0=37810,J0=37811,Q0=37812,$0=37813,q0=37814,e_=37815,t_=37816,n_=37817,i_=37818,r_=37819,s_=37820,o_=37821,fp=36492,a_=36494,l_=36495,CL=36283,c_=36284,u_=36285,h_=36286,RL=2200,PL=2201,ZW=2202,Sh=2300,Mh=2301,Kg=2302,pc=2400,mc=2401,Rp=2402,dv=2500,XW=2501,jW=0,IL=1,d_=2,YW=3200,KW=3201,lm=0,JW=1,da="",Li="srgb",Wc="srgb-linear",Pp="linear",un="srgb",Bl=7680,B1=519,QW=512,$W=513,qW=514,DL=515,eV=516,tV=517,nV=518,iV=519,f_=35044,H1=35048,Z1="300 es",Po=2e3,Ip=2001;class qs{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Fi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let X1=1234567;const nh=Math.PI/180,Vc=180/Math.PI;function es(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Fi[n&255]+Fi[n>>8&255]+Fi[n>>16&255]+Fi[n>>24&255]+"-"+Fi[e&255]+Fi[e>>8&255]+"-"+Fi[e>>16&15|64]+Fi[e>>24&255]+"-"+Fi[t&63|128]+Fi[t>>8&255]+"-"+Fi[t>>16&255]+Fi[t>>24&255]+Fi[i&255]+Fi[i>>8&255]+Fi[i>>16&255]+Fi[i>>24&255]).toLowerCase()}function Tt(n,e,t){return Math.max(e,Math.min(t,n))}function fv(n,e){return(n%e+e)%e}function rV(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function sV(n,e,t){return n!==e?(t-n)/(e-n):0}function ih(n,e,t){return(1-t)*n+t*e}function oV(n,e,t,i){return ih(n,e,1-Math.exp(-t*i))}function aV(n,e=1){return e-Math.abs(fv(n,e*2)-e)}function lV(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function cV(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function uV(n,e){return n+Math.floor(Math.random()*(e-n+1))}function hV(n,e){return n+Math.random()*(e-n)}function dV(n){return n*(.5-Math.random())}function fV(n){n!==void 0&&(X1=n);let e=X1+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function pV(n){return n*nh}function mV(n){return n*Vc}function gV(n){return(n&n-1)===0&&n!==0}function yV(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function _V(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function vV(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),h=o((e+i)/2),d=s((e-i)/2),p=o((e-i)/2),m=s((i-e)/2),y=o((i-e)/2);switch(r){case"XYX":n.set(a*h,l*d,l*p,a*c);break;case"YZY":n.set(l*p,a*h,l*d,a*c);break;case"ZXZ":n.set(l*d,l*p,a*h,a*c);break;case"XZX":n.set(a*h,l*y,l*m,a*c);break;case"YXY":n.set(l*m,a*h,l*y,a*c);break;case"ZYZ":n.set(l*y,l*m,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function vs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function cn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Ai={DEG2RAD:nh,RAD2DEG:Vc,generateUUID:es,clamp:Tt,euclideanModulo:fv,mapLinear:rV,inverseLerp:sV,lerp:ih,damp:oV,pingpong:aV,smoothstep:lV,smootherstep:cV,randInt:uV,randFloat:hV,randFloatSpread:dV,seededRandom:fV,degToRad:pV,radToDeg:mV,isPowerOfTwo:gV,ceilPowerOfTwo:yV,floorPowerOfTwo:_V,setQuaternionFromProperEuler:vV,normalize:cn,denormalize:vs};class Ie{constructor(e=0,t=0){Ie.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Tt(this.x,e.x,t.x),this.y=Tt(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Tt(this.x,e,t),this.y=Tt(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Tt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Tt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Lt{constructor(e,t,i,r,s,o,a,l,c){Lt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=t,h[4]=s,h[5]=l,h[6]=i,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],h=i[4],d=i[7],p=i[2],m=i[5],y=i[8],b=r[0],v=r[3],g=r[6],x=r[1],w=r[4],S=r[7],C=r[2],A=r[5],E=r[8];return s[0]=o*b+a*x+l*C,s[3]=o*v+a*w+l*A,s[6]=o*g+a*S+l*E,s[1]=c*b+h*x+d*C,s[4]=c*v+h*w+d*A,s[7]=c*g+h*S+d*E,s[2]=p*b+m*x+y*C,s[5]=p*v+m*w+y*A,s[8]=p*g+m*S+y*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8];return t*o*h-t*a*c-i*s*h+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=h*o-a*c,p=a*l-h*s,m=c*s-o*l,y=t*d+i*p+r*m;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/y;return e[0]=d*b,e[1]=(r*c-h*i)*b,e[2]=(a*i-r*o)*b,e[3]=p*b,e[4]=(h*t-r*l)*b,e[5]=(r*s-a*t)*b,e[6]=m*b,e[7]=(i*l-c*t)*b,e[8]=(o*t-i*s)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Jg.makeScale(e,t)),this}rotate(e){return this.premultiply(Jg.makeRotation(-e)),this}translate(e,t){return this.premultiply(Jg.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Jg=new Lt;function NL(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Th(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function bV(){const n=Th("canvas");return n.style.display="block",n}const j1={};function fc(n){n in j1||(j1[n]=!0,console.warn(n))}function xV(n,e,t){return new Promise(function(i,r){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}}setTimeout(s,t)})}function wV(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function SV(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const Y1=new Lt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),K1=new Lt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function MV(){const n={enabled:!0,workingColorSpace:Wc,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===un&&(r.r=Io(r.r),r.g=Io(r.g),r.b=Io(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===un&&(r.r=Tc(r.r),r.g=Tc(r.g),r.b=Tc(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===da?Pp:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Wc]:{primaries:e,whitePoint:i,transfer:Pp,toXYZ:Y1,fromXYZ:K1,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Li},outputColorSpaceConfig:{drawingBufferColorSpace:Li}},[Li]:{primaries:e,whitePoint:i,transfer:un,toXYZ:Y1,fromXYZ:K1,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Li}}}),n}const Jt=MV();function Io(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Tc(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Hl;class TV{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Hl===void 0&&(Hl=Th("canvas")),Hl.width=e.width,Hl.height=e.height;const i=Hl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Hl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Th("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Io(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Io(t[i]/255)*255):t[i]=Io(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let EV=0;class OL{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:EV++}),this.uuid=es(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Qg(r[o].image)):s.push(Qg(r[o]))}else s=Qg(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Qg(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?TV.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let LV=0;class In extends qs{constructor(e=In.DEFAULT_IMAGE,t=In.DEFAULT_MAPPING,i=Qr,r=Qr,s=ui,o=Pr,a=$r,l=Uo,c=In.DEFAULT_ANISOTROPY,h=da){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:LV++}),this.uuid=es(),this.name="",this.source=new OL(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ie(0,0),this.repeat=new Ie(1,1),this.center=new Ie(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Lt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vL)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case is:e.x=e.x-Math.floor(e.x);break;case Qr:e.x=e.x<0?0:1;break;case Cp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case is:e.y=e.y-Math.floor(e.y);break;case Qr:e.y=e.y<0?0:1;break;case Cp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}In.DEFAULT_IMAGE=null;In.DEFAULT_MAPPING=vL;In.DEFAULT_ANISOTROPY=1;class Ct{constructor(e=0,t=0,i=0,r=1){Ct.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],h=l[4],d=l[8],p=l[1],m=l[5],y=l[9],b=l[2],v=l[6],g=l[10];if(Math.abs(h-p)<.01&&Math.abs(d-b)<.01&&Math.abs(y-v)<.01){if(Math.abs(h+p)<.1&&Math.abs(d+b)<.1&&Math.abs(y+v)<.1&&Math.abs(c+m+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const w=(c+1)/2,S=(m+1)/2,C=(g+1)/2,A=(h+p)/4,E=(d+b)/4,O=(y+v)/4;return w>S&&w>C?w<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(w),r=A/i,s=E/i):S>C?S<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(S),i=A/r,s=O/r):C<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(C),i=E/s,r=O/s),this.set(i,r,s,t),this}let x=Math.sqrt((v-y)*(v-y)+(d-b)*(d-b)+(p-h)*(p-h));return Math.abs(x)<.001&&(x=1),this.x=(v-y)/x,this.y=(d-b)/x,this.z=(p-h)/x,this.w=Math.acos((c+m+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Tt(this.x,e.x,t.x),this.y=Tt(this.y,e.y,t.y),this.z=Tt(this.z,e.z,t.z),this.w=Tt(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Tt(this.x,e,t),this.y=Tt(this.y,e,t),this.z=Tt(this.z,e,t),this.w=Tt(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Tt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class AV extends qs{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ct(0,0,e,t),this.scissorTest=!1,this.viewport=new Ct(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ui,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const s=new In(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new OL(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ma extends AV{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class kL extends In{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=or,this.minFilter=or,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class CV extends In{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=or,this.minFilter=or,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Wn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],h=i[r+2],d=i[r+3];const p=s[o+0],m=s[o+1],y=s[o+2],b=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=h,e[t+3]=d;return}if(a===1){e[t+0]=p,e[t+1]=m,e[t+2]=y,e[t+3]=b;return}if(d!==b||l!==p||c!==m||h!==y){let v=1-a;const g=l*p+c*m+h*y+d*b,x=g>=0?1:-1,w=1-g*g;if(w>Number.EPSILON){const C=Math.sqrt(w),A=Math.atan2(C,g*x);v=Math.sin(v*A)/C,a=Math.sin(a*A)/C}const S=a*x;if(l=l*v+p*S,c=c*v+m*S,h=h*v+y*S,d=d*v+b*S,v===1-a){const C=1/Math.sqrt(l*l+c*c+h*h+d*d);l*=C,c*=C,h*=C,d*=C}}e[t]=l,e[t+1]=c,e[t+2]=h,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],h=i[r+3],d=s[o],p=s[o+1],m=s[o+2],y=s[o+3];return e[t]=a*y+h*d+l*m-c*p,e[t+1]=l*y+h*p+c*d-a*m,e[t+2]=c*y+h*m+a*p-l*d,e[t+3]=h*y-a*d-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),h=a(r/2),d=a(s/2),p=l(i/2),m=l(r/2),y=l(s/2);switch(o){case"XYZ":this._x=p*h*d+c*m*y,this._y=c*m*d-p*h*y,this._z=c*h*y+p*m*d,this._w=c*h*d-p*m*y;break;case"YXZ":this._x=p*h*d+c*m*y,this._y=c*m*d-p*h*y,this._z=c*h*y-p*m*d,this._w=c*h*d+p*m*y;break;case"ZXY":this._x=p*h*d-c*m*y,this._y=c*m*d+p*h*y,this._z=c*h*y+p*m*d,this._w=c*h*d-p*m*y;break;case"ZYX":this._x=p*h*d-c*m*y,this._y=c*m*d+p*h*y,this._z=c*h*y-p*m*d,this._w=c*h*d+p*m*y;break;case"YZX":this._x=p*h*d+c*m*y,this._y=c*m*d+p*h*y,this._z=c*h*y-p*m*d,this._w=c*h*d-p*m*y;break;case"XZY":this._x=p*h*d-c*m*y,this._y=c*m*d-p*h*y,this._z=c*h*y+p*m*d,this._w=c*h*d+p*m*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],h=t[6],d=t[10],p=i+a+d;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(h-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(i>a&&i>d){const m=2*Math.sqrt(1+i-a-d);this._w=(h-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>d){const m=2*Math.sqrt(1+a-i-d);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+h)/m}else{const m=2*Math.sqrt(1+d-i-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+h)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Tt(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,h=t._w;return this._x=i*h+o*a+r*c-s*l,this._y=r*h+o*l+s*a-i*c,this._z=s*h+o*c+i*l-r*a,this._w=o*h-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),d=Math.sin((1-t)*h)/c,p=Math.sin(t*h)/c;return this._w=o*d+this._w*p,this._x=i*d+this._x*p,this._y=r*d+this._y*p,this._z=s*d+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class U{constructor(e=0,t=0,i=0){U.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(J1.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(J1.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*i),h=2*(a*t-s*r),d=2*(s*i-o*t);return this.x=t+l*c+o*d-a*h,this.y=i+l*h+a*c-s*d,this.z=r+l*d+s*h-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Tt(this.x,e.x,t.x),this.y=Tt(this.y,e.y,t.y),this.z=Tt(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Tt(this.x,e,t),this.y=Tt(this.y,e,t),this.z=Tt(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Tt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return $g.copy(this).projectOnVector(e),this.sub($g)}reflect(e){return this.sub($g.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Tt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $g=new U,J1=new Wn;class ji{constructor(e=new U(1/0,1/0,1/0),t=new U(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(ps.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(ps.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=ps.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,ps):ps.fromBufferAttribute(s,o),ps.applyMatrix4(e.matrixWorld),this.expandByPoint(ps);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Jd.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Jd.copy(i.boundingBox)),Jd.applyMatrix4(e.matrixWorld),this.union(Jd)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ps),ps.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(xu),Qd.subVectors(this.max,xu),Zl.subVectors(e.a,xu),Xl.subVectors(e.b,xu),jl.subVectors(e.c,xu),$o.subVectors(Xl,Zl),qo.subVectors(jl,Xl),Ga.subVectors(Zl,jl);let t=[0,-$o.z,$o.y,0,-qo.z,qo.y,0,-Ga.z,Ga.y,$o.z,0,-$o.x,qo.z,0,-qo.x,Ga.z,0,-Ga.x,-$o.y,$o.x,0,-qo.y,qo.x,0,-Ga.y,Ga.x,0];return!qg(t,Zl,Xl,jl,Qd)||(t=[1,0,0,0,1,0,0,0,1],!qg(t,Zl,Xl,jl,Qd))?!1:($d.crossVectors($o,qo),t=[$d.x,$d.y,$d.z],qg(t,Zl,Xl,jl,Qd))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ps).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ps).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(go[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),go[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),go[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),go[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),go[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),go[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),go[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),go[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(go),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const go=[new U,new U,new U,new U,new U,new U,new U,new U],ps=new U,Jd=new ji,Zl=new U,Xl=new U,jl=new U,$o=new U,qo=new U,Ga=new U,xu=new U,Qd=new U,$d=new U,Ba=new U;function qg(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Ba.fromArray(n,s);const a=r.x*Math.abs(Ba.x)+r.y*Math.abs(Ba.y)+r.z*Math.abs(Ba.z),l=e.dot(Ba),c=t.dot(Ba),h=i.dot(Ba);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const RV=new ji,wu=new U,ey=new U;class ss{constructor(e=new U,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):RV.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;wu.subVectors(e,this.center);const t=wu.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(wu,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ey.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(wu.copy(e.center).add(ey)),this.expandByPoint(wu.copy(e.center).sub(ey))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const yo=new U,ty=new U,qd=new U,ea=new U,ny=new U,ef=new U,iy=new U;class wl{constructor(e=new U,t=new U(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,yo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=yo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(yo.copy(this.origin).addScaledVector(this.direction,t),yo.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){ty.copy(e).add(t).multiplyScalar(.5),qd.copy(t).sub(e).normalize(),ea.copy(this.origin).sub(ty);const s=e.distanceTo(t)*.5,o=-this.direction.dot(qd),a=ea.dot(this.direction),l=-ea.dot(qd),c=ea.lengthSq(),h=Math.abs(1-o*o);let d,p,m,y;if(h>0)if(d=o*l-a,p=o*a-l,y=s*h,d>=0)if(p>=-y)if(p<=y){const b=1/h;d*=b,p*=b,m=d*(d+o*p+2*a)+p*(o*d+p+2*l)+c}else p=s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;else p=-s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;else p<=-y?(d=Math.max(0,-(-o*s+a)),p=d>0?-s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c):p<=y?(d=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(d=Math.max(0,-(o*s+a)),p=d>0?s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c);else p=o>0?-s:s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(ty).addScaledVector(qd,p),m}intersectSphere(e,t){yo.subVectors(e.center,this.origin);const i=yo.dot(this.direction),r=yo.dot(yo)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,d=1/this.direction.z,p=this.origin;return c>=0?(i=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(i=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),h>=0?(s=(e.min.y-p.y)*h,o=(e.max.y-p.y)*h):(s=(e.max.y-p.y)*h,o=(e.min.y-p.y)*h),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-p.z)*d,l=(e.max.z-p.z)*d):(a=(e.max.z-p.z)*d,l=(e.min.z-p.z)*d),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,yo)!==null}intersectTriangle(e,t,i,r,s){ny.subVectors(t,e),ef.subVectors(i,e),iy.crossVectors(ny,ef);let o=this.direction.dot(iy),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;ea.subVectors(this.origin,e);const l=a*this.direction.dot(ef.crossVectors(ea,ef));if(l<0)return null;const c=a*this.direction.dot(ny.cross(ea));if(c<0||l+c>o)return null;const h=-a*ea.dot(iy);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class nt{constructor(e,t,i,r,s,o,a,l,c,h,d,p,m,y,b,v){nt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c,h,d,p,m,y,b,v)}set(e,t,i,r,s,o,a,l,c,h,d,p,m,y,b,v){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=c,g[6]=h,g[10]=d,g[14]=p,g[3]=m,g[7]=y,g[11]=b,g[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new nt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Yl.setFromMatrixColumn(e,0).length(),s=1/Yl.setFromMatrixColumn(e,1).length(),o=1/Yl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const p=o*h,m=o*d,y=a*h,b=a*d;t[0]=l*h,t[4]=-l*d,t[8]=c,t[1]=m+y*c,t[5]=p-b*c,t[9]=-a*l,t[2]=b-p*c,t[6]=y+m*c,t[10]=o*l}else if(e.order==="YXZ"){const p=l*h,m=l*d,y=c*h,b=c*d;t[0]=p+b*a,t[4]=y*a-m,t[8]=o*c,t[1]=o*d,t[5]=o*h,t[9]=-a,t[2]=m*a-y,t[6]=b+p*a,t[10]=o*l}else if(e.order==="ZXY"){const p=l*h,m=l*d,y=c*h,b=c*d;t[0]=p-b*a,t[4]=-o*d,t[8]=y+m*a,t[1]=m+y*a,t[5]=o*h,t[9]=b-p*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const p=o*h,m=o*d,y=a*h,b=a*d;t[0]=l*h,t[4]=y*c-m,t[8]=p*c+b,t[1]=l*d,t[5]=b*c+p,t[9]=m*c-y,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const p=o*l,m=o*c,y=a*l,b=a*c;t[0]=l*h,t[4]=b-p*d,t[8]=y*d+m,t[1]=d,t[5]=o*h,t[9]=-a*h,t[2]=-c*h,t[6]=m*d+y,t[10]=p-b*d}else if(e.order==="XZY"){const p=o*l,m=o*c,y=a*l,b=a*c;t[0]=l*h,t[4]=-d,t[8]=c*h,t[1]=p*d+b,t[5]=o*h,t[9]=m*d-y,t[2]=y*d-m,t[6]=a*h,t[10]=b*d+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(PV,e,IV)}lookAt(e,t,i){const r=this.elements;return Er.subVectors(e,t),Er.lengthSq()===0&&(Er.z=1),Er.normalize(),ta.crossVectors(i,Er),ta.lengthSq()===0&&(Math.abs(i.z)===1?Er.x+=1e-4:Er.z+=1e-4,Er.normalize(),ta.crossVectors(i,Er)),ta.normalize(),tf.crossVectors(Er,ta),r[0]=ta.x,r[4]=tf.x,r[8]=Er.x,r[1]=ta.y,r[5]=tf.y,r[9]=Er.y,r[2]=ta.z,r[6]=tf.z,r[10]=Er.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],h=i[1],d=i[5],p=i[9],m=i[13],y=i[2],b=i[6],v=i[10],g=i[14],x=i[3],w=i[7],S=i[11],C=i[15],A=r[0],E=r[4],O=r[8],R=r[12],T=r[1],k=r[5],Y=r[9],$=r[13],re=r[2],ae=r[6],V=r[10],te=r[14],J=r[3],pe=r[7],Te=r[11],Le=r[15];return s[0]=o*A+a*T+l*re+c*J,s[4]=o*E+a*k+l*ae+c*pe,s[8]=o*O+a*Y+l*V+c*Te,s[12]=o*R+a*$+l*te+c*Le,s[1]=h*A+d*T+p*re+m*J,s[5]=h*E+d*k+p*ae+m*pe,s[9]=h*O+d*Y+p*V+m*Te,s[13]=h*R+d*$+p*te+m*Le,s[2]=y*A+b*T+v*re+g*J,s[6]=y*E+b*k+v*ae+g*pe,s[10]=y*O+b*Y+v*V+g*Te,s[14]=y*R+b*$+v*te+g*Le,s[3]=x*A+w*T+S*re+C*J,s[7]=x*E+w*k+S*ae+C*pe,s[11]=x*O+w*Y+S*V+C*Te,s[15]=x*R+w*$+S*te+C*Le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],d=e[6],p=e[10],m=e[14],y=e[3],b=e[7],v=e[11],g=e[15];return y*(+s*l*d-r*c*d-s*a*p+i*c*p+r*a*m-i*l*m)+b*(+t*l*m-t*c*p+s*o*p-r*o*m+r*c*h-s*l*h)+v*(+t*c*d-t*a*m-s*o*d+i*o*m+s*a*h-i*c*h)+g*(-r*a*h-t*l*d+t*a*p+r*o*d-i*o*p+i*l*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],m=e[11],y=e[12],b=e[13],v=e[14],g=e[15],x=d*v*c-b*p*c+b*l*m-a*v*m-d*l*g+a*p*g,w=y*p*c-h*v*c-y*l*m+o*v*m+h*l*g-o*p*g,S=h*b*c-y*d*c+y*a*m-o*b*m-h*a*g+o*d*g,C=y*d*l-h*b*l-y*a*p+o*b*p+h*a*v-o*d*v,A=t*x+i*w+r*S+s*C;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/A;return e[0]=x*E,e[1]=(b*p*s-d*v*s-b*r*m+i*v*m+d*r*g-i*p*g)*E,e[2]=(a*v*s-b*l*s+b*r*c-i*v*c-a*r*g+i*l*g)*E,e[3]=(d*l*s-a*p*s-d*r*c+i*p*c+a*r*m-i*l*m)*E,e[4]=w*E,e[5]=(h*v*s-y*p*s+y*r*m-t*v*m-h*r*g+t*p*g)*E,e[6]=(y*l*s-o*v*s-y*r*c+t*v*c+o*r*g-t*l*g)*E,e[7]=(o*p*s-h*l*s+h*r*c-t*p*c-o*r*m+t*l*m)*E,e[8]=S*E,e[9]=(y*d*s-h*b*s-y*i*m+t*b*m+h*i*g-t*d*g)*E,e[10]=(o*b*s-y*a*s+y*i*c-t*b*c-o*i*g+t*a*g)*E,e[11]=(h*a*s-o*d*s-h*i*c+t*d*c+o*i*m-t*a*m)*E,e[12]=C*E,e[13]=(h*b*r-y*d*r+y*i*p-t*b*p-h*i*v+t*d*v)*E,e[14]=(y*a*r-o*b*r-y*i*l+t*b*l+o*i*v-t*a*v)*E,e[15]=(o*d*r-h*a*r+h*i*l-t*d*l-o*i*p+t*a*p)*E,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+i,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,h=o+o,d=a+a,p=s*c,m=s*h,y=s*d,b=o*h,v=o*d,g=a*d,x=l*c,w=l*h,S=l*d,C=i.x,A=i.y,E=i.z;return r[0]=(1-(b+g))*C,r[1]=(m+S)*C,r[2]=(y-w)*C,r[3]=0,r[4]=(m-S)*A,r[5]=(1-(p+g))*A,r[6]=(v+x)*A,r[7]=0,r[8]=(y+w)*E,r[9]=(v-x)*E,r[10]=(1-(p+b))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Yl.set(r[0],r[1],r[2]).length();const o=Yl.set(r[4],r[5],r[6]).length(),a=Yl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ms.copy(this);const c=1/s,h=1/o,d=1/a;return ms.elements[0]*=c,ms.elements[1]*=c,ms.elements[2]*=c,ms.elements[4]*=h,ms.elements[5]*=h,ms.elements[6]*=h,ms.elements[8]*=d,ms.elements[9]*=d,ms.elements[10]*=d,t.setFromRotationMatrix(ms),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Po){const l=this.elements,c=2*s/(t-e),h=2*s/(i-r),d=(t+e)/(t-e),p=(i+r)/(i-r);let m,y;if(a===Po)m=-(o+s)/(o-s),y=-2*o*s/(o-s);else if(a===Ip)m=-o/(o-s),y=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=h,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=y,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Po){const l=this.elements,c=1/(t-e),h=1/(i-r),d=1/(o-s),p=(t+e)*c,m=(i+r)*h;let y,b;if(a===Po)y=(o+s)*d,b=-2*d;else if(a===Ip)y=s*d,b=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=b,l[14]=-y,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Yl=new U,ms=new nt,PV=new U(0,0,0),IV=new U(1,1,1),ta=new U,tf=new U,Er=new U,Q1=new nt,$1=new Wn;class Ri{constructor(e=0,t=0,i=0,r=Ri.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],h=r[9],d=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(Tt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Tt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(Tt(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Tt(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Tt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-Tt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return Q1.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Q1,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return $1.setFromEuler(this),this.setFromQuaternion($1,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ri.DEFAULT_ORDER="XYZ";class pv{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let DV=0;const q1=new U,Kl=new Wn,_o=new nt,nf=new U,Su=new U,NV=new U,OV=new Wn,eS=new U(1,0,0),tS=new U(0,1,0),nS=new U(0,0,1),iS={type:"added"},kV={type:"removed"},Jl={type:"childadded",child:null},ry={type:"childremoved",child:null};class jt extends qs{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:DV++}),this.uuid=es(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=jt.DEFAULT_UP.clone();const e=new U,t=new Ri,i=new Wn,r=new U(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new nt},normalMatrix:{value:new Lt}}),this.matrix=new nt,this.matrixWorld=new nt,this.matrixAutoUpdate=jt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=jt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new pv,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Kl.setFromAxisAngle(e,t),this.quaternion.multiply(Kl),this}rotateOnWorldAxis(e,t){return Kl.setFromAxisAngle(e,t),this.quaternion.premultiply(Kl),this}rotateX(e){return this.rotateOnAxis(eS,e)}rotateY(e){return this.rotateOnAxis(tS,e)}rotateZ(e){return this.rotateOnAxis(nS,e)}translateOnAxis(e,t){return q1.copy(e).applyQuaternion(this.quaternion),this.position.add(q1.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(eS,e)}translateY(e){return this.translateOnAxis(tS,e)}translateZ(e){return this.translateOnAxis(nS,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_o.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?nf.copy(e):nf.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Su.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_o.lookAt(Su,nf,this.up):_o.lookAt(nf,Su,this.up),this.quaternion.setFromRotationMatrix(_o),r&&(_o.extractRotation(r.matrixWorld),Kl.setFromRotationMatrix(_o),this.quaternion.premultiply(Kl.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(iS),Jl.child=e,this.dispatchEvent(Jl),Jl.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(kV),ry.child=e,this.dispatchEvent(ry),ry.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),_o.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),_o.multiply(e.parent.matrixWorld)),e.applyMatrix4(_o),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(iS),Jl.child=e,this.dispatchEvent(Jl),Jl.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Su,e,NV),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Su,OV,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),h=o(e.images),d=o(e.shapes),p=o(e.skeletons),m=o(e.animations),y=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),h.length>0&&(i.images=h),d.length>0&&(i.shapes=d),p.length>0&&(i.skeletons=p),m.length>0&&(i.animations=m),y.length>0&&(i.nodes=y)}return i.object=r,i;function o(a){const l=[];for(const c in a){const h=a[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}jt.DEFAULT_UP=new U(0,1,0);jt.DEFAULT_MATRIX_AUTO_UPDATE=!0;jt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const gs=new U,vo=new U,sy=new U,bo=new U,Ql=new U,$l=new U,rS=new U,oy=new U,ay=new U,ly=new U,cy=new Ct,uy=new Ct,hy=new Ct;class Kr{constructor(e=new U,t=new U,i=new U){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),gs.subVectors(e,t),r.cross(gs);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){gs.subVectors(r,t),vo.subVectors(i,t),sy.subVectors(e,t);const o=gs.dot(gs),a=gs.dot(vo),l=gs.dot(sy),c=vo.dot(vo),h=vo.dot(sy),d=o*c-a*a;if(d===0)return s.set(0,0,0),null;const p=1/d,m=(c*l-a*h)*p,y=(o*h-a*l)*p;return s.set(1-m-y,y,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,bo)===null?!1:bo.x>=0&&bo.y>=0&&bo.x+bo.y<=1}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,bo)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,bo.x),l.addScaledVector(o,bo.y),l.addScaledVector(a,bo.z),l)}static getInterpolatedAttribute(e,t,i,r,s,o){return cy.setScalar(0),uy.setScalar(0),hy.setScalar(0),cy.fromBufferAttribute(e,t),uy.fromBufferAttribute(e,i),hy.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(cy,s.x),o.addScaledVector(uy,s.y),o.addScaledVector(hy,s.z),o}static isFrontFacing(e,t,i,r){return gs.subVectors(i,t),vo.subVectors(e,t),gs.cross(vo).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return gs.subVectors(this.c,this.b),vo.subVectors(this.a,this.b),gs.cross(vo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Kr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Kr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return Kr.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Kr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Kr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Ql.subVectors(r,i),$l.subVectors(s,i),oy.subVectors(e,i);const l=Ql.dot(oy),c=$l.dot(oy);if(l<=0&&c<=0)return t.copy(i);ay.subVectors(e,r);const h=Ql.dot(ay),d=$l.dot(ay);if(h>=0&&d<=h)return t.copy(r);const p=l*d-h*c;if(p<=0&&l>=0&&h<=0)return o=l/(l-h),t.copy(i).addScaledVector(Ql,o);ly.subVectors(e,s);const m=Ql.dot(ly),y=$l.dot(ly);if(y>=0&&m<=y)return t.copy(s);const b=m*c-l*y;if(b<=0&&c>=0&&y<=0)return a=c/(c-y),t.copy(i).addScaledVector($l,a);const v=h*y-m*d;if(v<=0&&d-h>=0&&m-y>=0)return rS.subVectors(s,r),a=(d-h)/(d-h+(m-y)),t.copy(r).addScaledVector(rS,a);const g=1/(v+b+p);return o=b*g,a=p*g,t.copy(i).addScaledVector(Ql,o).addScaledVector($l,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const FL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},na={h:0,s:0,l:0},rf={h:0,s:0,l:0};function dy(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Ge{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Li){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Jt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Jt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Jt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Jt.workingColorSpace){if(e=fv(e,1),t=Tt(t,0,1),i=Tt(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=dy(o,s,e+1/3),this.g=dy(o,s,e),this.b=dy(o,s,e-1/3)}return Jt.toWorkingColorSpace(this,r),this}setStyle(e,t=Li){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Li){const i=FL[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Io(e.r),this.g=Io(e.g),this.b=Io(e.b),this}copyLinearToSRGB(e){return this.r=Tc(e.r),this.g=Tc(e.g),this.b=Tc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Li){return Jt.fromWorkingColorSpace(Ui.copy(this),e),Math.round(Tt(Ui.r*255,0,255))*65536+Math.round(Tt(Ui.g*255,0,255))*256+Math.round(Tt(Ui.b*255,0,255))}getHexString(e=Li){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Jt.workingColorSpace){Jt.fromWorkingColorSpace(Ui.copy(this),t);const i=Ui.r,r=Ui.g,s=Ui.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=h<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,t=Jt.workingColorSpace){return Jt.fromWorkingColorSpace(Ui.copy(this),t),e.r=Ui.r,e.g=Ui.g,e.b=Ui.b,e}getStyle(e=Li){Jt.fromWorkingColorSpace(Ui.copy(this),e);const t=Ui.r,i=Ui.g,r=Ui.b;return e!==Li?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(na),this.setHSL(na.h+e,na.s+t,na.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(na),e.getHSL(rf);const i=ih(na.h,rf.h,t),r=ih(na.s,rf.s,t),s=ih(na.l,rf.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ui=new Ge;Ge.NAMES=FL;let FV=0;class Nr extends qs{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:FV++}),this.uuid=es(),this.name="",this.type="Material",this.blending=ba,this.side=ns,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=R0,this.blendDst=P0,this.blendEquation=nl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ge(0,0,0),this.blendAlpha=0,this.depthFunc=Oc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=B1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Bl,this.stencilZFail=Bl,this.stencilZPass=Bl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==ba&&(i.blending=this.blending),this.side!==ns&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==R0&&(i.blendSrc=this.blendSrc),this.blendDst!==P0&&(i.blendDst=this.blendDst),this.blendEquation!==nl&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Oc&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==B1&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Bl&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Bl&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Bl&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Ir extends Nr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ri,this.combine=om,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Lo=UV();function UV(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;!(c&8388608);)c<<=1,h-=8388608;c&=-8388609,h+=947912704,s[l]=c|h}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function zV(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Tt(n,-65504,65504),Lo.floatView[0]=n;const e=Lo.uint32View[0],t=e>>23&511;return Lo.baseTable[t]+((e&8388607)>>Lo.shiftTable[t])}function WV(n){const e=n>>10;return Lo.uint32View[0]=Lo.mantissaTable[Lo.offsetTable[e]+(n&1023)]+Lo.exponentTable[e],Lo.floatView[0]}const sf={toHalfFloat:zV,fromHalfFloat:WV},ti=new U,of=new Ie;class Ln{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=f_,this.updateRanges=[],this.gpuType=rr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)of.fromBufferAttribute(this,t),of.applyMatrix3(e),this.setXY(t,of.x,of.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)ti.fromBufferAttribute(this,t),ti.applyMatrix3(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)ti.fromBufferAttribute(this,t),ti.applyMatrix4(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ti.fromBufferAttribute(this,t),ti.applyNormalMatrix(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ti.fromBufferAttribute(this,t),ti.transformDirection(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=vs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=cn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=vs(t,this.array)),t}setX(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=vs(t,this.array)),t}setY(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=vs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=vs(t,this.array)),t}setW(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),i=cn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),i=cn(i,this.array),r=cn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),i=cn(i,this.array),r=cn(r,this.array),s=cn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==f_&&(e.usage=this.usage),e}}class mv extends Ln{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class UL extends Ln{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class $t extends Ln{constructor(e,t,i){super(new Float32Array(e),t,i)}}let VV=0;const Hr=new nt,fy=new jt,ql=new U,Lr=new ji,Mu=new ji,yi=new U;class fn extends qs{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:VV++}),this.uuid=es(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(NL(e)?UL:mv)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Lt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Hr.makeRotationFromQuaternion(e),this.applyMatrix4(Hr),this}rotateX(e){return Hr.makeRotationX(e),this.applyMatrix4(Hr),this}rotateY(e){return Hr.makeRotationY(e),this.applyMatrix4(Hr),this}rotateZ(e){return Hr.makeRotationZ(e),this.applyMatrix4(Hr),this}translate(e,t,i){return Hr.makeTranslation(e,t,i),this.applyMatrix4(Hr),this}scale(e,t,i){return Hr.makeScale(e,t,i),this.applyMatrix4(Hr),this}lookAt(e){return fy.lookAt(e),fy.updateMatrix(),this.applyMatrix4(fy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ql).negate(),this.translate(ql.x,ql.y,ql.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new $t(i,3))}else{const i=Math.min(e.length,t.count);for(let r=0;r<i;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ji);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new U(-1/0,-1/0,-1/0),new U(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];Lr.setFromBufferAttribute(s),this.morphTargetsRelative?(yi.addVectors(this.boundingBox.min,Lr.min),this.boundingBox.expandByPoint(yi),yi.addVectors(this.boundingBox.max,Lr.max),this.boundingBox.expandByPoint(yi)):(this.boundingBox.expandByPoint(Lr.min),this.boundingBox.expandByPoint(Lr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ss);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new U,1/0);return}if(e){const i=this.boundingSphere.center;if(Lr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Mu.setFromBufferAttribute(a),this.morphTargetsRelative?(yi.addVectors(Lr.min,Mu.min),Lr.expandByPoint(yi),yi.addVectors(Lr.max,Mu.max),Lr.expandByPoint(yi)):(Lr.expandByPoint(Mu.min),Lr.expandByPoint(Mu.max))}Lr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)yi.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(yi));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)yi.fromBufferAttribute(a,c),l&&(ql.fromBufferAttribute(e,c),yi.add(ql)),r=Math.max(r,i.distanceToSquared(yi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ln(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let O=0;O<i.count;O++)a[O]=new U,l[O]=new U;const c=new U,h=new U,d=new U,p=new Ie,m=new Ie,y=new Ie,b=new U,v=new U;function g(O,R,T){c.fromBufferAttribute(i,O),h.fromBufferAttribute(i,R),d.fromBufferAttribute(i,T),p.fromBufferAttribute(s,O),m.fromBufferAttribute(s,R),y.fromBufferAttribute(s,T),h.sub(c),d.sub(c),m.sub(p),y.sub(p);const k=1/(m.x*y.y-y.x*m.y);isFinite(k)&&(b.copy(h).multiplyScalar(y.y).addScaledVector(d,-m.y).multiplyScalar(k),v.copy(d).multiplyScalar(m.x).addScaledVector(h,-y.x).multiplyScalar(k),a[O].add(b),a[R].add(b),a[T].add(b),l[O].add(v),l[R].add(v),l[T].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let O=0,R=x.length;O<R;++O){const T=x[O],k=T.start,Y=T.count;for(let $=k,re=k+Y;$<re;$+=3)g(e.getX($+0),e.getX($+1),e.getX($+2))}const w=new U,S=new U,C=new U,A=new U;function E(O){C.fromBufferAttribute(r,O),A.copy(C);const R=a[O];w.copy(R),w.sub(C.multiplyScalar(C.dot(R))).normalize(),S.crossVectors(A,R);const k=S.dot(l[O])<0?-1:1;o.setXYZW(O,w.x,w.y,w.z,k)}for(let O=0,R=x.length;O<R;++O){const T=x[O],k=T.start,Y=T.count;for(let $=k,re=k+Y;$<re;$+=3)E(e.getX($+0)),E(e.getX($+1)),E(e.getX($+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ln(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new U,s=new U,o=new U,a=new U,l=new U,c=new U,h=new U,d=new U;if(e)for(let p=0,m=e.count;p<m;p+=3){const y=e.getX(p+0),b=e.getX(p+1),v=e.getX(p+2);r.fromBufferAttribute(t,y),s.fromBufferAttribute(t,b),o.fromBufferAttribute(t,v),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),a.fromBufferAttribute(i,y),l.fromBufferAttribute(i,b),c.fromBufferAttribute(i,v),a.add(h),l.add(h),c.add(h),i.setXYZ(y,a.x,a.y,a.z),i.setXYZ(b,l.x,l.y,l.z),i.setXYZ(v,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),i.setXYZ(p+0,h.x,h.y,h.z),i.setXYZ(p+1,h.x,h.y,h.z),i.setXYZ(p+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)yi.fromBufferAttribute(e,t),yi.normalize(),e.setXYZ(t,yi.x,yi.y,yi.z)}toNonIndexed(){function e(a,l){const c=a.array,h=a.itemSize,d=a.normalized,p=new c.constructor(l.length*h);let m=0,y=0;for(let b=0,v=l.length;b<v;b++){a.isInterleavedBufferAttribute?m=l[b]*a.data.stride+a.offset:m=l[b]*h;for(let g=0;g<h;g++)p[y++]=c[m++]}return new Ln(p,h,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new fn,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let h=0,d=c.length;h<d;h++){const p=c[h],m=e(p,i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let d=0,p=c.length;d<p;d++){const m=c[d];h.push(m.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r){const h=r[c];this.setAttribute(c,h.clone(t))}const s=e.morphAttributes;for(const c in s){const h=[],d=s[c];for(let p=0,m=d.length;p<m;p++)h.push(d[p].clone(t));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,h=o.length;c<h;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const sS=new nt,Ha=new wl,af=new ss,oS=new U,lf=new U,cf=new U,uf=new U,py=new U,hf=new U,aS=new U,df=new U;class Xt extends jt{constructor(e=new fn,t=new Ir){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){hf.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const h=a[l],d=s[l];h!==0&&(py.fromBufferAttribute(d,e),o?hf.addScaledVector(py,h):hf.addScaledVector(py.sub(t),h))}t.add(hf)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),af.copy(i.boundingSphere),af.applyMatrix4(s),Ha.copy(e.ray).recast(e.near),!(af.containsPoint(Ha.origin)===!1&&(Ha.intersectSphere(af,oS)===null||Ha.origin.distanceToSquared(oS)>(e.far-e.near)**2))&&(sS.copy(s).invert(),Ha.copy(e.ray).applyMatrix4(sS),!(i.boundingBox!==null&&Ha.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Ha)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,h=s.attributes.uv1,d=s.attributes.normal,p=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let y=0,b=p.length;y<b;y++){const v=p[y],g=o[v.materialIndex],x=Math.max(v.start,m.start),w=Math.min(a.count,Math.min(v.start+v.count,m.start+m.count));for(let S=x,C=w;S<C;S+=3){const A=a.getX(S),E=a.getX(S+1),O=a.getX(S+2);r=ff(this,g,e,i,c,h,d,A,E,O),r&&(r.faceIndex=Math.floor(S/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{const y=Math.max(0,m.start),b=Math.min(a.count,m.start+m.count);for(let v=y,g=b;v<g;v+=3){const x=a.getX(v),w=a.getX(v+1),S=a.getX(v+2);r=ff(this,o,e,i,c,h,d,x,w,S),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let y=0,b=p.length;y<b;y++){const v=p[y],g=o[v.materialIndex],x=Math.max(v.start,m.start),w=Math.min(l.count,Math.min(v.start+v.count,m.start+m.count));for(let S=x,C=w;S<C;S+=3){const A=S,E=S+1,O=S+2;r=ff(this,g,e,i,c,h,d,A,E,O),r&&(r.faceIndex=Math.floor(S/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{const y=Math.max(0,m.start),b=Math.min(l.count,m.start+m.count);for(let v=y,g=b;v<g;v+=3){const x=v,w=v+1,S=v+2;r=ff(this,o,e,i,c,h,d,x,w,S),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}}}function GV(n,e,t,i,r,s,o,a){let l;if(e.side===Zi?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===ns,a),l===null)return null;df.copy(a),df.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(df);return c<t.near||c>t.far?null:{distance:c,point:df.clone(),object:n}}function ff(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,lf),n.getVertexPosition(l,cf),n.getVertexPosition(c,uf);const h=GV(n,e,t,i,lf,cf,uf,aS);if(h){const d=new U;Kr.getBarycoord(aS,lf,cf,uf,d),r&&(h.uv=Kr.getInterpolatedAttribute(r,a,l,c,d,new Ie)),s&&(h.uv1=Kr.getInterpolatedAttribute(s,a,l,c,d,new Ie)),o&&(h.normal=Kr.getInterpolatedAttribute(o,a,l,c,d,new U),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const p={a,b:l,c,normal:new U,materialIndex:0};Kr.getNormal(lf,cf,uf,p.normal),h.face=p,h.barycoord=d}return h}class Bh extends fn{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],h=[],d=[];let p=0,m=0;y("z","y","x",-1,-1,i,t,e,o,s,0),y("z","y","x",1,-1,i,t,-e,o,s,1),y("x","z","y",1,1,e,i,t,r,o,2),y("x","z","y",1,-1,e,i,-t,r,o,3),y("x","y","z",1,-1,e,t,i,r,s,4),y("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new $t(c,3)),this.setAttribute("normal",new $t(h,3)),this.setAttribute("uv",new $t(d,2));function y(b,v,g,x,w,S,C,A,E,O,R){const T=S/E,k=C/O,Y=S/2,$=C/2,re=A/2,ae=E+1,V=O+1;let te=0,J=0;const pe=new U;for(let Te=0;Te<V;Te++){const Le=Te*k-$;for(let Ue=0;Ue<ae;Ue++){const tt=Ue*T-Y;pe[b]=tt*x,pe[v]=Le*w,pe[g]=re,c.push(pe.x,pe.y,pe.z),pe[b]=0,pe[v]=0,pe[g]=A>0?1:-1,h.push(pe.x,pe.y,pe.z),d.push(Ue/E),d.push(1-Te/O),te+=1}}for(let Te=0;Te<O;Te++)for(let Le=0;Le<E;Le++){const Ue=p+Le+ae*Te,tt=p+Le+ae*(Te+1),_e=p+(Le+1)+ae*(Te+1),Ae=p+(Le+1)+ae*Te;l.push(Ue,tt,Ae),l.push(tt,_e,Ae),J+=6}a.addGroup(m,J,R),m+=J,p+=te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Gc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function er(n){const e={};for(let t=0;t<n.length;t++){const i=Gc(n[t]);for(const r in i)e[r]=i[r]}return e}function BV(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function zL(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Jt.workingColorSpace}const Eh={clone:Gc,merge:er};var HV=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ZV=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class rs extends Nr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=HV,this.fragmentShader=ZV,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Gc(e.uniforms),this.uniformsGroups=BV(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class gv extends jt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new nt,this.projectionMatrix=new nt,this.projectionMatrixInverse=new nt,this.coordinateSystem=Po}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const ia=new U,lS=new Ie,cS=new Ie;class Kn extends gv{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Vc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(nh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Vc*2*Math.atan(Math.tan(nh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){ia.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(ia.x,ia.y).multiplyScalar(-e/ia.z),ia.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(ia.x,ia.y).multiplyScalar(-e/ia.z)}getViewSize(e,t){return this.getViewBounds(e,lS,cS),t.subVectors(cS,lS)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(nh*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const ec=-90,tc=1;class XV extends jt{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Kn(ec,tc,e,t);r.layers=this.layers,this.add(r);const s=new Kn(ec,tc,e,t);s.layers=this.layers,this.add(s);const o=new Kn(ec,tc,e,t);o.layers=this.layers,this.add(o);const a=new Kn(ec,tc,e,t);a.layers=this.layers,this.add(a);const l=new Kn(ec,tc,e,t);l.layers=this.layers,this.add(l);const c=new Kn(ec,tc,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Po)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Ip)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,h]=this.children,d=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const b=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=b,e.setRenderTarget(i,5,r),e.render(t,h),e.setRenderTarget(d,p,m),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}}class yv extends In{constructor(e,t,i,r,s,o,a,l,c,h){e=e!==void 0?e:[],t=t!==void 0?t:kc,super(e,t,i,r,s,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class jV extends Ma{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new yv(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:ui}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Bh(5,5,5),s=new rs({name:"CubemapFromEquirect",uniforms:Gc(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Zi,blending:va});s.uniforms.tEquirect.value=t;const o=new Xt(r,s),a=t.minFilter;return t.minFilter===Pr&&(t.minFilter=ui),new XV(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}class Lh{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ge(e),this.density=t}clone(){return new Lh(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class WL extends jt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ri,this.environmentIntensity=1,this.environmentRotation=new Ri,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class _v{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=f_,this.updateRanges=[],this.version=0,this.uuid=es()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=es()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=es()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const $i=new U;class xs{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix4(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.applyNormalMatrix(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.transformDirection(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=vs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=cn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=vs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=vs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=vs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=vs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=cn(t,this.array),i=cn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=cn(t,this.array),i=cn(i,this.array),r=cn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=cn(t,this.array),i=cn(i,this.array),r=cn(r,this.array),s=cn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Ln(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xs(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Hh extends Nr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ge(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let nc;const Tu=new U,ic=new U,rc=new U,sc=new Ie,Eu=new Ie,VL=new nt,pf=new U,Lu=new U,mf=new U,uS=new Ie,my=new Ie,hS=new Ie;class Zh extends jt{constructor(e=new Hh){if(super(),this.isSprite=!0,this.type="Sprite",nc===void 0){nc=new fn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new _v(t,5);nc.setIndex([0,1,2,0,2,3]),nc.setAttribute("position",new xs(i,3,0,!1)),nc.setAttribute("uv",new xs(i,2,3,!1))}this.geometry=nc,this.material=e,this.center=new Ie(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ic.setFromMatrixScale(this.matrixWorld),VL.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),rc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ic.multiplyScalar(-rc.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;gf(pf.set(-.5,-.5,0),rc,o,ic,r,s),gf(Lu.set(.5,-.5,0),rc,o,ic,r,s),gf(mf.set(.5,.5,0),rc,o,ic,r,s),uS.set(0,0),my.set(1,0),hS.set(1,1);let a=e.ray.intersectTriangle(pf,Lu,mf,!1,Tu);if(a===null&&(gf(Lu.set(-.5,.5,0),rc,o,ic,r,s),my.set(0,1),a=e.ray.intersectTriangle(pf,mf,Lu,!1,Tu),a===null))return;const l=e.ray.origin.distanceTo(Tu);l<e.near||l>e.far||t.push({distance:l,point:Tu.clone(),uv:Kr.getInterpolation(Tu,pf,Lu,mf,uS,my,hS,new Ie),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function gf(n,e,t,i,r,s){sc.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(Eu.x=s*sc.x-r*sc.y,Eu.y=r*sc.x+s*sc.y):Eu.copy(sc),n.copy(e),n.x+=Eu.x,n.y+=Eu.y,n.applyMatrix4(VL)}const dS=new U,fS=new Ct,pS=new Ct,YV=new U,mS=new nt,yf=new U,gy=new ss,gS=new nt,yy=new wl;class GL extends Xt{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=G1,this.bindMatrix=new nt,this.bindMatrixInverse=new nt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ji),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,yf),this.boundingBox.expandByPoint(yf)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ss),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,yf),this.boundingSphere.expandByPoint(yf)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),gy.copy(this.boundingSphere),gy.applyMatrix4(r),e.ray.intersectsSphere(gy)!==!1&&(gS.copy(r).invert(),yy.copy(e.ray).applyMatrix4(gS),!(this.boundingBox!==null&&yy.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,yy)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ct,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===G1?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===HW?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;fS.fromBufferAttribute(r.attributes.skinIndex,e),pS.fromBufferAttribute(r.attributes.skinWeight,e),dS.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=pS.getComponent(s);if(o!==0){const a=fS.getComponent(s);mS.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(YV.copy(dS).applyMatrix4(mS),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Dp extends jt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class vv extends In{constructor(e=null,t=1,i=1,r,s,o,a,l,c=or,h=or,d,p){super(null,o,a,l,c,h,r,s,d,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const yS=new nt,KV=new nt;class cm{constructor(e=[],t=[]){this.uuid=es(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new nt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new nt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:KV;yS.multiplyMatrices(a,t[s]),yS.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new cm(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new vv(t,e,e,$r,rr);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Dp),this.bones.push(o),this.boneInverses.push(new nt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Ah extends Ln{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const oc=new nt,_S=new nt,_f=[],vS=new ji,JV=new nt,Au=new Xt,Cu=new ss;class bv extends Xt{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ah(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,JV)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ji),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,oc),vS.copy(e.boundingBox).applyMatrix4(oc),this.boundingBox.union(vS)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new ss),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,oc),Cu.copy(e.boundingSphere).applyMatrix4(oc),this.boundingSphere.union(Cu)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,o=e*s+1;for(let a=0;a<i.length;a++)i[a]=r[o+a]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Au.geometry=this.geometry,Au.material=this.material,Au.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Cu.copy(this.boundingSphere),Cu.applyMatrix4(i),e.ray.intersectsSphere(Cu)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,oc),_S.multiplyMatrices(i,oc),Au.matrixWorld=_S,Au.raycast(e,_f);for(let o=0,a=_f.length;o<a;o++){const l=_f[o];l.instanceId=s,l.object=this,t.push(l)}_f.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Ah(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new vv(new Float32Array(r*this.count),r,this.count,lv,rr));const s=this.morphTexture.source.data.data;let o=0;for(let c=0;c<i.length;c++)o+=i[c];const a=this.geometry.morphTargetsRelative?1:1-o,l=r*e;s[l]=a,s.set(i,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}const _y=new U,QV=new U,$V=new Lt;class Vs{constructor(e=new U(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=_y.subVectors(i,t).cross(QV.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(_y),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||$V.getNormalMatrix(e),r=this.coplanarPoint(_y).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Za=new ss,vf=new U;class um{constructor(e=new Vs,t=new Vs,i=new Vs,r=new Vs,s=new Vs,o=new Vs){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Po){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],h=r[5],d=r[6],p=r[7],m=r[8],y=r[9],b=r[10],v=r[11],g=r[12],x=r[13],w=r[14],S=r[15];if(i[0].setComponents(l-s,p-c,v-m,S-g).normalize(),i[1].setComponents(l+s,p+c,v+m,S+g).normalize(),i[2].setComponents(l+o,p+h,v+y,S+x).normalize(),i[3].setComponents(l-o,p-h,v-y,S-x).normalize(),i[4].setComponents(l-a,p-d,v-b,S-w).normalize(),t===Po)i[5].setComponents(l+a,p+d,v+b,S+w).normalize();else if(t===Ip)i[5].setComponents(a,d,b,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Za.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Za.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Za)}intersectsSprite(e){return Za.center.set(0,0,0),Za.radius=.7071067811865476,Za.applyMatrix4(e.matrixWorld),this.intersectsSphere(Za)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(vf.x=r.normal.x>0?e.max.x:e.min.x,vf.y=r.normal.y>0?e.max.y:e.min.y,vf.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(vf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class hm extends Nr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ge(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Np=new U,Op=new U,bS=new nt,Ru=new wl,bf=new ss,vy=new U,xS=new U;class dm extends jt{constructor(e=new fn,t=new hm){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)Np.fromBufferAttribute(t,r-1),Op.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Np.distanceTo(Op);e.setAttribute("lineDistance",new $t(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),bf.copy(i.boundingSphere),bf.applyMatrix4(r),bf.radius+=s,e.ray.intersectsSphere(bf)===!1)return;bS.copy(r).invert(),Ru.copy(e.ray).applyMatrix4(bS);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=this.isLineSegments?2:1,h=i.index,p=i.attributes.position;if(h!==null){const m=Math.max(0,o.start),y=Math.min(h.count,o.start+o.count);for(let b=m,v=y-1;b<v;b+=c){const g=h.getX(b),x=h.getX(b+1),w=xf(this,e,Ru,l,g,x);w&&t.push(w)}if(this.isLineLoop){const b=h.getX(y-1),v=h.getX(m),g=xf(this,e,Ru,l,b,v);g&&t.push(g)}}else{const m=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let b=m,v=y-1;b<v;b+=c){const g=xf(this,e,Ru,l,b,b+1);g&&t.push(g)}if(this.isLineLoop){const b=xf(this,e,Ru,l,y-1,m);b&&t.push(b)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function xf(n,e,t,i,r,s){const o=n.geometry.attributes.position;if(Np.fromBufferAttribute(o,r),Op.fromBufferAttribute(o,s),t.distanceSqToSegment(Np,Op,vy,xS)>i)return;vy.applyMatrix4(n.matrixWorld);const l=e.ray.origin.distanceTo(vy);if(!(l<e.near||l>e.far))return{distance:l,point:xS.clone().applyMatrix4(n.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:n}}const wS=new U,SS=new U;class BL extends dm{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)wS.fromBufferAttribute(t,r),SS.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+wS.distanceTo(SS);e.setAttribute("lineDistance",new $t(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class qV extends dm{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Zc extends Nr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ge(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const MS=new nt,p_=new wl,wf=new ss,Sf=new U;class Xc extends jt{constructor(e=new fn,t=new Zc){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),wf.copy(i.boundingSphere),wf.applyMatrix4(r),wf.radius+=s,e.ray.intersectsSphere(wf)===!1)return;MS.copy(r).invert(),p_.copy(e.ray).applyMatrix4(MS);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(c!==null){const p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);for(let y=p,b=m;y<b;y++){const v=c.getX(y);Sf.fromBufferAttribute(d,v),TS(Sf,v,l,r,e,t,this)}}else{const p=Math.max(0,o.start),m=Math.min(d.count,o.start+o.count);for(let y=p,b=m;y<b;y++)Sf.fromBufferAttribute(d,y),TS(Sf,y,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function TS(n,e,t,i,r,s,o){const a=p_.distanceSqToPoint(n);if(a<t){const l=new U;p_.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class sr extends jt{constructor(){super(),this.isGroup=!0,this.type="Group"}}class xv extends In{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class HL extends In{constructor(e,t,i,r,s,o,a,l,c,h=Mc){if(h!==Mc&&h!==zc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===Mc&&(i=ml),i===void 0&&h===zc&&(i=Uc),super(null,r,s,o,a,l,h,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:or,this.minFilter=l!==void 0?l:or,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class As{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const h=i[r],p=i[r+1]-h,m=(o-h)/p;return(r+m)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new Ie:new U);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new U,r=[],s=[],o=[],a=new U,l=new nt;for(let m=0;m<=e;m++){const y=m/e;r[m]=this.getTangentAt(y,new U)}s[0]=new U,o[0]=new U;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),d=Math.abs(r[0].y),p=Math.abs(r[0].z);h<=c&&(c=h,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),p<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();const y=Math.acos(Tt(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,y))}o[m].crossVectors(r[m],s[m])}if(t===!0){let m=Math.acos(Tt(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let y=1;y<=e;y++)s[y].applyMatrix4(l.makeRotationAxis(r[y],m*y)),o[y].crossVectors(r[y],s[y])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class wv extends As{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new Ie){const i=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),d=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*h-m*d+this.aX,c=p*d+m*h+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class eG extends wv{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function Sv(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,d){let p=(o-s)/c-(a-s)/(c+h)+(a-o)/h,m=(a-o)/h-(l-o)/(h+d)+(l-a)/d;p*=h,m*=h,r(o,a,p,m)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const Mf=new U,by=new Sv,xy=new Sv,wy=new Sv;class tG extends As{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new U){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,h;this.closed||a>0?c=r[(a-1)%s]:(Mf.subVectors(r[0],r[1]).add(r[0]),c=Mf);const d=r[a%s],p=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(Mf.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=Mf),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let y=Math.pow(c.distanceToSquared(d),m),b=Math.pow(d.distanceToSquared(p),m),v=Math.pow(p.distanceToSquared(h),m);b<1e-4&&(b=1),y<1e-4&&(y=b),v<1e-4&&(v=b),by.initNonuniformCatmullRom(c.x,d.x,p.x,h.x,y,b,v),xy.initNonuniformCatmullRom(c.y,d.y,p.y,h.y,y,b,v),wy.initNonuniformCatmullRom(c.z,d.z,p.z,h.z,y,b,v)}else this.curveType==="catmullrom"&&(by.initCatmullRom(c.x,d.x,p.x,h.x,this.tension),xy.initCatmullRom(c.y,d.y,p.y,h.y,this.tension),wy.initCatmullRom(c.z,d.z,p.z,h.z,this.tension));return i.set(by.calc(l),xy.calc(l),wy.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new U().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function ES(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function nG(n,e){const t=1-n;return t*t*e}function iG(n,e){return 2*(1-n)*n*e}function rG(n,e){return n*n*e}function rh(n,e,t,i){return nG(n,e)+iG(n,t)+rG(n,i)}function sG(n,e){const t=1-n;return t*t*t*e}function oG(n,e){const t=1-n;return 3*t*t*n*e}function aG(n,e){return 3*(1-n)*n*n*e}function lG(n,e){return n*n*n*e}function sh(n,e,t,i,r){return sG(n,e)+oG(n,t)+aG(n,i)+lG(n,r)}class ZL extends As{constructor(e=new Ie,t=new Ie,i=new Ie,r=new Ie){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Ie){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(sh(e,r.x,s.x,o.x,a.x),sh(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class XL extends As{constructor(e=new U,t=new U,i=new U,r=new U){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new U){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(sh(e,r.x,s.x,o.x,a.x),sh(e,r.y,s.y,o.y,a.y),sh(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class jL extends As{constructor(e=new Ie,t=new Ie){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ie){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ie){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class cG extends As{constructor(e=new U,t=new U){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new U){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new U){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class YL extends As{constructor(e=new Ie,t=new Ie,i=new Ie){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Ie){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(rh(e,r.x,s.x,o.x),rh(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class uG extends As{constructor(e=new U,t=new U,i=new U){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new U){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(rh(e,r.x,s.x,o.x),rh(e,r.y,s.y,o.y),rh(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class KL extends As{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ie){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],h=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(ES(a,l.x,c.x,h.x,d.x),ES(a,l.y,c.y,h.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new Ie().fromArray(r))}return this}}var LS=Object.freeze({__proto__:null,ArcCurve:eG,CatmullRomCurve3:tG,CubicBezierCurve:ZL,CubicBezierCurve3:XL,EllipseCurve:wv,LineCurve:jL,LineCurve3:cG,QuadraticBezierCurve:YL,QuadraticBezierCurve3:uG,SplineCurve:KL});class hG extends As{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new LS[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const h=l[c];i&&i.equals(h)||(t.push(h),i=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new LS[r.type]().fromJSON(r))}return this}}class AS extends hG{constructor(e){super(),this.type="Path",this.currentPoint=new Ie,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new jL(this.currentPoint.clone(),new Ie(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new YL(this.currentPoint.clone(),new Ie(e,t),new Ie(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new ZL(this.currentPoint.clone(),new Ie(e,t),new Ie(i,r),new Ie(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new KL(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,t+h,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new wv(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Mv extends fn{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const h=[],d=[],p=[],m=[];let y=0;const b=[],v=i/2;let g=0;x(),o===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(h),this.setAttribute("position",new $t(d,3)),this.setAttribute("normal",new $t(p,3)),this.setAttribute("uv",new $t(m,2));function x(){const S=new U,C=new U;let A=0;const E=(t-e)/i;for(let O=0;O<=s;O++){const R=[],T=O/s,k=T*(t-e)+e;for(let Y=0;Y<=r;Y++){const $=Y/r,re=$*l+a,ae=Math.sin(re),V=Math.cos(re);C.x=k*ae,C.y=-T*i+v,C.z=k*V,d.push(C.x,C.y,C.z),S.set(ae,E,V).normalize(),p.push(S.x,S.y,S.z),m.push($,1-T),R.push(y++)}b.push(R)}for(let O=0;O<r;O++)for(let R=0;R<s;R++){const T=b[R][O],k=b[R+1][O],Y=b[R+1][O+1],$=b[R][O+1];(e>0||R!==0)&&(h.push(T,k,$),A+=3),(t>0||R!==s-1)&&(h.push(k,Y,$),A+=3)}c.addGroup(g,A,0),g+=A}function w(S){const C=y,A=new Ie,E=new U;let O=0;const R=S===!0?e:t,T=S===!0?1:-1;for(let Y=1;Y<=r;Y++)d.push(0,v*T,0),p.push(0,T,0),m.push(.5,.5),y++;const k=y;for(let Y=0;Y<=r;Y++){const re=Y/r*l+a,ae=Math.cos(re),V=Math.sin(re);E.x=R*V,E.y=v*T,E.z=R*ae,d.push(E.x,E.y,E.z),p.push(0,T,0),A.x=ae*.5+.5,A.y=V*.5*T+.5,m.push(A.x,A.y),y++}for(let Y=0;Y<r;Y++){const $=C+Y,re=k+Y;S===!0?h.push(re,re+1,$):h.push(re+1,re,$),O+=3}c.addGroup(g,O,S===!0?1:2),g+=O}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mv(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class JL extends AS{constructor(e){super(e),this.uuid=es(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new AS().fromJSON(r))}return this}}const dG={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=QL(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,d,p,m;if(i&&(s=yG(n,e,s,t)),n.length>80*t){a=c=n[0],l=h=n[1];for(let y=t;y<r;y+=t)d=n[y],p=n[y+1],d<a&&(a=d),p<l&&(l=p),d>c&&(c=d),p>h&&(h=p);m=Math.max(c-a,h-l),m=m!==0?32767/m:0}return Ch(s,o,t,a,l,m,0),o}};function QL(n,e,t,i,r){let s,o;if(r===AG(n,e,t,i)>0)for(s=e;s<t;s+=i)o=CS(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=CS(s,n[s],n[s+1],o);return o&&fm(o,o.next)&&(Ph(o),o=o.next),o}function gl(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(fm(t,t.next)||Pn(t.prev,t,t.next)===0)){if(Ph(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Ch(n,e,t,i,r,s,o){if(!n)return;!o&&s&&wG(n,i,r,s);let a=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,s?pG(n,i,r,s):fG(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),Ph(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=mG(gl(n),e,t),Ch(n,e,t,i,r,s,2)):o===2&&gG(n,e,t,i,r,s):Ch(gl(n),e,t,i,r,s,1);break}}}function fG(n){const e=n.prev,t=n,i=n.next;if(Pn(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,h=r<s?r<o?r:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,p=r>s?r>o?r:o:s>o?s:o,m=a>l?a>c?a:c:l>c?l:c;let y=i.next;for(;y!==e;){if(y.x>=h&&y.x<=p&&y.y>=d&&y.y<=m&&gc(r,a,s,l,o,c,y.x,y.y)&&Pn(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function pG(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Pn(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,h=r.y,d=s.y,p=o.y,m=a<l?a<c?a:c:l<c?l:c,y=h<d?h<p?h:p:d<p?d:p,b=a>l?a>c?a:c:l>c?l:c,v=h>d?h>p?h:p:d>p?d:p,g=m_(m,y,e,t,i),x=m_(b,v,e,t,i);let w=n.prevZ,S=n.nextZ;for(;w&&w.z>=g&&S&&S.z<=x;){if(w.x>=m&&w.x<=b&&w.y>=y&&w.y<=v&&w!==r&&w!==o&&gc(a,h,l,d,c,p,w.x,w.y)&&Pn(w.prev,w,w.next)>=0||(w=w.prevZ,S.x>=m&&S.x<=b&&S.y>=y&&S.y<=v&&S!==r&&S!==o&&gc(a,h,l,d,c,p,S.x,S.y)&&Pn(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;w&&w.z>=g;){if(w.x>=m&&w.x<=b&&w.y>=y&&w.y<=v&&w!==r&&w!==o&&gc(a,h,l,d,c,p,w.x,w.y)&&Pn(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=x;){if(S.x>=m&&S.x<=b&&S.y>=y&&S.y<=v&&S!==r&&S!==o&&gc(a,h,l,d,c,p,S.x,S.y)&&Pn(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function mG(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!fm(r,s)&&$L(r,i,i.next,s)&&Rh(r,s)&&Rh(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Ph(i),Ph(i.next),i=n=s),i=i.next}while(i!==n);return gl(i)}function gG(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&TG(o,a)){let l=qL(o,a);o=gl(o,o.next),l=gl(l,l.next),Ch(o,e,t,i,r,s,0),Ch(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function yG(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=QL(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(MG(c));for(r.sort(_G),s=0;s<r.length;s++)t=vG(r[s],t);return t}function _G(n,e){return n.x-e.x}function vG(n,e){const t=bG(n,e);if(!t)return e;const i=qL(t,n);return gl(i,i.next),gl(t,t.next)}function bG(n,e){let t=e,i=-1/0,r;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=s&&p>i&&(i=p,r=t.x<t.next.x?t:t.next,p===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let h=1/0,d;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&gc(o<c?s:i,o,l,c,o<c?i:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),Rh(t,n)&&(d<h||d===h&&(t.x>r.x||t.x===r.x&&xG(r,t)))&&(r=t,h=d)),t=t.next;while(t!==a);return r}function xG(n,e){return Pn(n.prev,n,e.prev)<0&&Pn(e.next,n,n.next)<0}function wG(n,e,t,i){let r=n;do r.z===0&&(r.z=m_(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,SG(r)}function SG(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1);return n}function m_(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function MG(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function gc(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function TG(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!EG(n,e)&&(Rh(n,e)&&Rh(e,n)&&LG(n,e)&&(Pn(n.prev,n,e.prev)||Pn(n,e.prev,e))||fm(n,e)&&Pn(n.prev,n,n.next)>0&&Pn(e.prev,e,e.next)>0)}function Pn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function fm(n,e){return n.x===e.x&&n.y===e.y}function $L(n,e,t,i){const r=Ef(Pn(n,e,t)),s=Ef(Pn(n,e,i)),o=Ef(Pn(t,i,n)),a=Ef(Pn(t,i,e));return!!(r!==s&&o!==a||r===0&&Tf(n,t,e)||s===0&&Tf(n,i,e)||o===0&&Tf(t,n,i)||a===0&&Tf(t,e,i))}function Tf(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Ef(n){return n>0?1:n<0?-1:0}function EG(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&$L(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Rh(n,e){return Pn(n.prev,n,n.next)<0?Pn(n,e,n.next)>=0&&Pn(n,n.prev,e)>=0:Pn(n,e,n.prev)<0||Pn(n,n.next,e)<0}function LG(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function qL(n,e){const t=new g_(n.i,n.x,n.y),i=new g_(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function CS(n,e,t,i){const r=new g_(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ph(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function g_(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function AG(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class oh{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return oh.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];RS(e),PS(i,e);let o=e.length;t.forEach(RS);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,PS(i,t[l]);const a=dG.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function RS(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function PS(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class js extends fn{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,h=l+1,d=e/a,p=t/l,m=[],y=[],b=[],v=[];for(let g=0;g<h;g++){const x=g*p-o;for(let w=0;w<c;w++){const S=w*d-s;y.push(S,-x,0),b.push(0,0,1),v.push(w/a),v.push(1-g/l)}}for(let g=0;g<l;g++)for(let x=0;x<a;x++){const w=x+c*g,S=x+c*(g+1),C=x+1+c*(g+1),A=x+1+c*g;m.push(w,S,A),m.push(S,C,A)}this.setIndex(m),this.setAttribute("position",new $t(y,3)),this.setAttribute("normal",new $t(b,3)),this.setAttribute("uv",new $t(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new js(e.width,e.height,e.widthSegments,e.heightSegments)}}class Tv extends fn{constructor(e=new JL([new Ie(0,.5),new Ie(-.5,-.5),new Ie(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new $t(r,3)),this.setAttribute("normal",new $t(s,3)),this.setAttribute("uv",new $t(o,2));function c(h){const d=r.length/3,p=h.extractPoints(t);let m=p.shape;const y=p.holes;oh.isClockWise(m)===!1&&(m=m.reverse());for(let v=0,g=y.length;v<g;v++){const x=y[v];oh.isClockWise(x)===!0&&(y[v]=x.reverse())}const b=oh.triangulateShape(m,y);for(let v=0,g=y.length;v<g;v++){const x=y[v];m=m.concat(x)}for(let v=0,g=m.length;v<g;v++){const x=m[v];r.push(x.x,x.y,0),s.push(0,0,1),o.push(x.x,x.y)}for(let v=0,g=b.length;v<g;v++){const x=b[v],w=x[0]+d,S=x[1]+d,C=x[2]+d;i.push(w,S,C),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return CG(t,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];i.push(o)}return new Tv(i,e.curveSegments)}}function CG(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class kp extends fn{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const h=[],d=new U,p=new U,m=[],y=[],b=[],v=[];for(let g=0;g<=i;g++){const x=[],w=g/i;let S=0;g===0&&o===0?S=.5/t:g===i&&l===Math.PI&&(S=-.5/t);for(let C=0;C<=t;C++){const A=C/t;d.x=-e*Math.cos(r+A*s)*Math.sin(o+w*a),d.y=e*Math.cos(o+w*a),d.z=e*Math.sin(r+A*s)*Math.sin(o+w*a),y.push(d.x,d.y,d.z),p.copy(d).normalize(),b.push(p.x,p.y,p.z),v.push(A+S,1-w),x.push(c++)}h.push(x)}for(let g=0;g<i;g++)for(let x=0;x<t;x++){const w=h[g][x+1],S=h[g][x],C=h[g+1][x],A=h[g+1][x+1];(g!==0||o>0)&&m.push(w,S,A),(g!==i-1||l<Math.PI)&&m.push(S,C,A)}this.setIndex(m),this.setAttribute("position",new $t(y,3)),this.setAttribute("normal",new $t(b,3)),this.setAttribute("uv",new $t(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kp(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Ev extends fn{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],h=new U,d=new U,p=new U;for(let m=0;m<=i;m++)for(let y=0;y<=r;y++){const b=y/r*s,v=m/i*Math.PI*2;d.x=(e+t*Math.cos(v))*Math.cos(b),d.y=(e+t*Math.cos(v))*Math.sin(b),d.z=t*Math.sin(v),a.push(d.x,d.y,d.z),h.x=e*Math.cos(b),h.y=e*Math.sin(b),p.subVectors(d,h).normalize(),l.push(p.x,p.y,p.z),c.push(y/r),c.push(m/i)}for(let m=1;m<=i;m++)for(let y=1;y<=r;y++){const b=(r+1)*m+y-1,v=(r+1)*(m-1)+y-1,g=(r+1)*(m-1)+y,x=(r+1)*m+y;o.push(b,v,x),o.push(v,g,x)}this.setIndex(o),this.setAttribute("position",new $t(a,3)),this.setAttribute("normal",new $t(l,3)),this.setAttribute("uv",new $t(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ev(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class RG extends fn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new U,s=new U;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const d=l[c],p=d.start,m=d.count;for(let y=p,b=p+m;y<b;y+=3)for(let v=0;v<3;v++){const g=a.getX(y+v),x=a.getX(y+(v+1)%3);r.fromBufferAttribute(o,g),s.fromBufferAttribute(o,x),IS(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+c,d=3*a+(c+1)%3;r.fromBufferAttribute(o,h),s.fromBufferAttribute(o,d),IS(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new $t(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function IS(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}class Sl extends Nr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ge(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lm,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ri,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eo extends Sl{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ie(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Tt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ge(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ge(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ge(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class pp extends Nr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ge(16777215),this.specular=new Ge(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lm,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ri,this.combine=om,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eA extends Nr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lm,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ri,this.combine=om,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class PG extends Nr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=YW,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class IG extends Nr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Lf(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function DG(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function NG(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function DS(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function tA(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}class Xh{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class OG extends Xh{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:pc,endingEnd:pc}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case mc:s=e,a=2*t-i;break;case Rp:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case mc:o=e,l=2*i-t;break;case Rp:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=(i-t)*.5,h=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=this._offsetPrev,d=this._offsetNext,p=this._weightPrev,m=this._weightNext,y=(i-t)/(r-t),b=y*y,v=b*y,g=-p*v+2*p*b-p*y,x=(1+p)*v+(-1.5-2*p)*b+(-.5+p)*y+1,w=(-1-m)*v+(1.5+m)*b+.5*y,S=m*v-m*b;for(let C=0;C!==a;++C)s[C]=g*o[h+C]+x*o[c+C]+w*o[l+C]+S*o[d+C];return s}}class nA extends Xh{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=(i-t)/(r-t),d=1-h;for(let p=0;p!==a;++p)s[p]=o[c+p]*d+o[l+p]*h;return s}}class kG extends Xh{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class to{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Lf(t,this.TimeBufferType),this.values=Lf(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Lf(e.times,Array),values:Lf(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new kG(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new nA(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new OG(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Sh:t=this.InterpolantFactoryMethodDiscrete;break;case Mh:t=this.InterpolantFactoryMethodLinear;break;case Kg:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Sh;case this.InterpolantFactoryMethodLinear:return Mh;case this.InterpolantFactoryMethodSmooth:return Kg}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&DG(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===Kg,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],h=e[a+1];if(c!==h&&(a!==1||c!==e[0]))if(r)l=!0;else{const d=a*i,p=d-i,m=d+i;for(let y=0;y!==i;++y){const b=t[d+y];if(b!==t[p+y]||b!==t[m+y]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,p=o*i;for(let m=0;m!==i;++m)t[p+m]=t[d+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}to.prototype.TimeBufferType=Float32Array;to.prototype.ValueBufferType=Float32Array;to.prototype.DefaultInterpolation=Mh;class jc extends to{constructor(e,t,i){super(e,t,i)}}jc.prototype.ValueTypeName="bool";jc.prototype.ValueBufferType=Array;jc.prototype.DefaultInterpolation=Sh;jc.prototype.InterpolantFactoryMethodLinear=void 0;jc.prototype.InterpolantFactoryMethodSmooth=void 0;class iA extends to{}iA.prototype.ValueTypeName="color";class yl extends to{}yl.prototype.ValueTypeName="number";class FG extends Xh{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let h=c+a;c!==h;c+=4)Wn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class _l extends to{InterpolantFactoryMethodLinear(e){return new FG(this.times,this.values,this.getValueSize(),e)}}_l.prototype.ValueTypeName="quaternion";_l.prototype.InterpolantFactoryMethodSmooth=void 0;class Yc extends to{constructor(e,t,i){super(e,t,i)}}Yc.prototype.ValueTypeName="string";Yc.prototype.ValueBufferType=Array;Yc.prototype.DefaultInterpolation=Sh;Yc.prototype.InterpolantFactoryMethodLinear=void 0;Yc.prototype.InterpolantFactoryMethodSmooth=void 0;class vl extends to{}vl.prototype.ValueTypeName="vector";class Fp{constructor(e="",t=-1,i=[],r=dv){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=es(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(zG(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(to.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const h=NG(l);l=DS(l,1,h),c=DS(c,1,h),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new yl(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.name.match(s);if(h&&h.length>1){const d=h[1];let p=r[d];p||(r[d]=p=[]),p.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,p,m,y,b){if(m.length!==0){const v=[],g=[];tA(m,v,g,y),v.length!==0&&b.push(new d(p,v,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const p=c[d].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const m={};let y;for(y=0;y<p.length;y++)if(p[y].morphTargets)for(let b=0;b<p[y].morphTargets.length;b++)m[p[y].morphTargets[b]]=-1;for(const b in m){const v=[],g=[];for(let x=0;x!==p[y].morphTargets.length;++x){const w=p[y];v.push(w.time),g.push(w.morphTarget===b?1:0)}r.push(new yl(".morphTargetInfluence["+b+"]",v,g))}l=m.length*o}else{const m=".bones["+t[d].name+"]";i(vl,m+".position",p,"pos",r),i(_l,m+".quaternion",p,"rot",r),i(vl,m+".scale",p,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UG(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return yl;case"vector":case"vector2":case"vector3":case"vector4":return vl;case"color":return iA;case"quaternion":return _l;case"bool":case"boolean":return jc;case"string":return Yc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function zG(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=UG(n.type);if(n.times===void 0){const t=[],i=[];tA(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const pa={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class rA{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,d){return c.push(h,d),this},this.removeHandler=function(h){const d=c.indexOf(h);return d!==-1&&c.splice(d,2),this},this.getHandler=function(h){for(let d=0,p=c.length;d<p;d+=2){const m=c[d],y=c[d+1];if(m.global&&(m.lastIndex=0),m.test(h))return y}return null}}}const WG=new rA;class no{constructor(e){this.manager=e!==void 0?e:WG,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}no.DEFAULT_MATERIAL_NAME="__DEFAULT";const xo={};class VG extends Error{constructor(e,t){super(e),this.response=t}}class zo extends no{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=pa.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(xo[e]!==void 0){xo[e].push({onLoad:t,onProgress:i,onError:r});return}xo[e]=[],xo[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=xo[e],d=c.body.getReader(),p=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),m=p?parseInt(p):0,y=m!==0;let b=0;const v=new ReadableStream({start(g){x();function x(){d.read().then(({done:w,value:S})=>{if(w)g.close();else{b+=S.byteLength;const C=new ProgressEvent("progress",{lengthComputable:y,loaded:b,total:m});for(let A=0,E=h.length;A<E;A++){const O=h[A];O.onProgress&&O.onProgress(C)}g.enqueue(S),x()}},w=>{g.error(w)})}}});return new Response(v)}else throw new VG(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return c.json();default:if(a===void 0)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),p=d&&d[1]?d[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(y=>m.decode(y))}}}).then(c=>{pa.add(e,c);const h=xo[e];delete xo[e];for(let d=0,p=h.length;d<p;d++){const m=h[d];m.onLoad&&m.onLoad(c)}}).catch(c=>{const h=xo[e];if(h===void 0)throw this.manager.itemError(e),c;delete xo[e];for(let d=0,p=h.length;d<p;d++){const m=h[d];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class pm extends no{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=pa.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Th("img");function l(){h(),pa.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){h(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class GG extends no{constructor(e){super(e)}load(e,t,i,r){const s=new yv;s.colorSpace=Li;const o=new pm(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(h){s.images[c]=h,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class BG extends no{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new vv,a=new zo(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(h){if(r!==void 0)r(h);else{console.error(h);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Qr,o.wrapT=c.wrapT!==void 0?c.wrapT:Qr,o.magFilter=c.magFilter!==void 0?c.magFilter:ui,o.minFilter=c.minFilter!==void 0?c.minFilter:ui,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(o.colorSpace=c.colorSpace),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Pr),c.mipmapCount===1&&(o.minFilter=ui),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},i,r),o}}class jh extends no{constructor(e){super(e)}load(e,t,i,r){const s=new In,o=new pm(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class mm extends jt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ge(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}const Sy=new nt,NS=new U,OS=new U;class Lv{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ie(512,512),this.map=null,this.mapPass=null,this.matrix=new nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new um,this._frameExtents=new Ie(1,1),this._viewportCount=1,this._viewports=[new Ct(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;NS.setFromMatrixPosition(e.matrixWorld),t.position.copy(NS),OS.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(OS),t.updateMatrixWorld(),Sy.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Sy),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Sy)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class HG extends Lv{constructor(){super(new Kn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=Vc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Av extends mm{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(jt.DEFAULT_UP),this.updateMatrix(),this.target=new jt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new HG}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const kS=new nt,Pu=new U,My=new U;class ZG extends Lv{constructor(){super(new Kn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ie(4,2),this._viewportCount=6,this._viewports=[new Ct(2,1,1,1),new Ct(0,1,1,1),new Ct(3,1,1,1),new Ct(1,1,1,1),new Ct(3,0,1,1),new Ct(1,0,1,1)],this._cubeDirections=[new U(1,0,0),new U(-1,0,0),new U(0,0,1),new U(0,0,-1),new U(0,1,0),new U(0,-1,0)],this._cubeUps=[new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,0,1),new U(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Pu.setFromMatrixPosition(e.matrixWorld),i.position.copy(Pu),My.copy(i.position),My.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(My),i.updateMatrixWorld(),r.makeTranslation(-Pu.x,-Pu.y,-Pu.z),kS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kS)}}class y_ extends mm{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new ZG}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class hl extends gv{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class XG extends Lv{constructor(){super(new hl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Ih extends mm{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(jt.DEFAULT_UP),this.updateMatrix(),this.target=new jt,this.shadow=new XG}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Cv extends mm{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ec{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class sA extends fn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class jG extends no{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=pa.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{r&&r(c)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return pa.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){r&&r(c),pa.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});pa.add(e,l),s.manager.itemStart(e)}}class YG extends Kn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class gm{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=FS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=FS();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function FS(){return performance.now()}class KG{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(i,r,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){Wn.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;Wn.multiplyQuaternionsFlat(e,o,e,t,e,i),Wn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const Rv="\\[\\]\\.:\\/",JG=new RegExp("["+Rv+"]","g"),Pv="[^"+Rv+"]",QG="[^"+Rv.replace("\\.","")+"]",$G=/((?:WC+[\/:])*)/.source.replace("WC",Pv),qG=/(WCOD+)?/.source.replace("WCOD",QG),e5=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Pv),t5=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Pv),n5=new RegExp("^"+$G+qG+e5+t5+"$"),i5=["material","materials","bones","map"];class r5{constructor(e,t,i){const r=i||Zt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Zt{constructor(e,t,i){this.path=t,this.parsedPath=i||Zt.parseTrackName(t),this.node=Zt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Zt.Composite(e,t,i):new Zt(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(JG,"")}static parseTrackName(e){const t=n5.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);i5.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=Zt.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Zt.Composite=r5;Zt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Zt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Zt.prototype.GetterByBindingType=[Zt.prototype._getValue_direct,Zt.prototype._getValue_array,Zt.prototype._getValue_arrayElement,Zt.prototype._getValue_toArray];Zt.prototype.SetterByBindingTypeAndVersioning=[[Zt.prototype._setValue_direct,Zt.prototype._setValue_direct_setNeedsUpdate,Zt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_array,Zt.prototype._setValue_array_setNeedsUpdate,Zt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_arrayElement,Zt.prototype._setValue_arrayElement_setNeedsUpdate,Zt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_fromArray,Zt.prototype._setValue_fromArray_setNeedsUpdate,Zt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class s5{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:pc,endingEnd:pc};for(let c=0;c!==o;++c){const h=s[c].createInterpolant(null);a[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=PL,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case XW:for(let h=0,d=l.length;h!==d;++h)l[h].evaluate(o),c[h].accumulateAdditive(a);break;case dv:default:for(let h=0,d=l.length;h!==d;++h)l[h].evaluate(o),c[h].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===ZW;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===RL){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=mc,r.endingEnd=mc):(e?r.endingStart=this.zeroSlopeAtStart?mc:pc:r.endingStart=Rp,t?r.endingEnd=this.zeroSlopeAtEnd?mc:pc:r.endingEnd=Rp)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const o5=new Float32Array(1);class a5 extends qs{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let d=0;d!==s;++d){const p=r[d],m=p.name;let y=h[m];if(y!==void 0)++y.referenceCount,o[d]=y;else{if(y=o[d],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,l,m));continue}const b=t&&t._propertyBindings[d].binding.parsedPath;y=new KG(Zt.create(i,m,b),p.ValueTypeName,p.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,l,m),o[d]=y}a[d].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),e._byClipCacheIndex=null;const d=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete d[p],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new nA(new Float32Array(2),new Float32Array(2),1,o5),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?Fp.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(i===void 0&&(o!==null?i=o.blendMode:i=dv),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===i)return d;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const h=new s5(this,o,t,i);return this._bindAction(h,c),this._addInactiveAction(h,a,s),h}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?Fp.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const h=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=h,t[h]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class __ extends _v{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const US=new nt;class Iv{constructor(e,t,i=0,r=1/0){this.ray=new wl(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new pv,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return US.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(US),this}intersectObject(e,t=!0,i=[]){return v_(e,this,i,t),i.sort(zS),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)v_(e[r],this,i,t);return i.sort(zS),i}}function zS(n,e){return n.distance-e.distance}function v_(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(r=!1),r===!0&&i===!0){const s=n.children;for(let o=0,a=s.length;o<a;o++)v_(s[o],e,t,!0)}}class Up{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Tt(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Tt(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const WS=new Ie;class l5{constructor(e=new Ie(1/0,1/0),t=new Ie(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=WS.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,WS).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const VS=new U,Af=new U;class c5{constructor(e=new U,t=new U){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){VS.subVectors(e,this.start),Af.subVectors(this.end,this.start);const i=Af.dot(Af);let s=Af.dot(VS)/i;return t&&(s=Tt(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Cf=new U,kn=new gv;class u5 extends BL{constructor(e){const t=new fn,i=new hm({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(y,b){l(y),l(b)}function l(y){r.push(0,0,0),s.push(0,0,0),o[y]===void 0&&(o[y]=[]),o[y].push(r.length/3-1)}t.setAttribute("position",new $t(r,3)),t.setAttribute("color",new $t(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new Ge(16755200),h=new Ge(16711680),d=new Ge(43775),p=new Ge(16777215),m=new Ge(3355443);this.setColors(c,h,d,p,m)}setColors(e,t,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;kn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Zn("c",t,e,kn,0,0,-1),Zn("t",t,e,kn,0,0,1),Zn("n1",t,e,kn,-i,-r,-1),Zn("n2",t,e,kn,i,-r,-1),Zn("n3",t,e,kn,-i,r,-1),Zn("n4",t,e,kn,i,r,-1),Zn("f1",t,e,kn,-i,-r,1),Zn("f2",t,e,kn,i,-r,1),Zn("f3",t,e,kn,-i,r,1),Zn("f4",t,e,kn,i,r,1),Zn("u1",t,e,kn,i*.7,r*1.1,-1),Zn("u2",t,e,kn,-i*.7,r*1.1,-1),Zn("u3",t,e,kn,0,r*2,-1),Zn("cf1",t,e,kn,-i,0,1),Zn("cf2",t,e,kn,i,0,1),Zn("cf3",t,e,kn,0,-r,1),Zn("cf4",t,e,kn,0,r,1),Zn("cn1",t,e,kn,-i,0,-1),Zn("cn2",t,e,kn,i,0,-1),Zn("cn3",t,e,kn,0,-r,-1),Zn("cn4",t,e,kn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Zn(n,e,t,i,r,s,o){Cf.set(r,s,o).unproject(i);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],Cf.x,Cf.y,Cf.z)}}class h5 extends qs{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function GS(n,e,t,i){const r=d5(i);switch(t){case ML:return n*e;case EL:return n*e;case LL:return n*e*2;case lv:return n*e/r.components*r.byteLength;case cv:return n*e/r.components*r.byteLength;case AL:return n*e*2/r.components*r.byteLength;case uv:return n*e*2/r.components*r.byteLength;case TL:return n*e*3/r.components*r.byteLength;case $r:return n*e*4/r.components*r.byteLength;case hv:return n*e*4/r.components*r.byteLength;case cp:case up:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case hp:case dp:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case V0:case B0:return Math.max(n,16)*Math.max(e,8)/4;case W0:case G0:return Math.max(n,8)*Math.max(e,8)/2;case H0:case Z0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case X0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case j0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Y0:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case K0:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case J0:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case Q0:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case $0:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case q0:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case e_:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case t_:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case n_:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case i_:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case r_:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case s_:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case o_:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case fp:case a_:case l_:return Math.ceil(n/4)*Math.ceil(e/4)*16;case CL:case c_:return Math.ceil(n/4)*Math.ceil(e/4)*8;case u_:case h_:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function d5(n){switch(n){case Uo:case xL:return{byteLength:1,components:1};case wh:case wL:case Ro:return{byteLength:2,components:1};case ov:case av:return{byteLength:2,components:4};case ml:case sv:case rr:return{byteLength:4,components:1};case SL:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Gh}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Gh);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function oA(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function f5(n){const e=new WeakMap;function t(a,l){const c=a.array,h=a.usage,d=c.byteLength,p=n.createBuffer();n.bindBuffer(l,p),n.bufferData(l,c,h),a.onUploadCallback();let m;if(c instanceof Float32Array)m=n.FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?m=n.HALF_FLOAT:m=n.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=n.SHORT;else if(c instanceof Uint32Array)m=n.UNSIGNED_INT;else if(c instanceof Int32Array)m=n.INT;else if(c instanceof Int8Array)m=n.BYTE;else if(c instanceof Uint8Array)m=n.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:p,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:d}}function i(a,l,c){const h=l.array,d=l.updateRanges;if(n.bindBuffer(c,a),d.length===0)n.bufferSubData(c,0,h);else{d.sort((m,y)=>m.start-y.start);let p=0;for(let m=1;m<d.length;m++){const y=d[p],b=d[m];b.start<=y.start+y.count+1?y.count=Math.max(y.count,b.start+b.count-y.start):(++p,d[p]=b)}d.length=p+1;for(let m=0,y=d.length;m<y;m++){const b=d[m];n.bufferSubData(c,b.start*h.BYTES_PER_ELEMENT,h,b.start,b.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(n.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const h=e.get(a);(!h||h.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const c=e.get(a);if(c===void 0)e.set(a,t(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,a,l),c.version=a.version}}return{get:r,remove:s,update:o}}var p5=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,m5=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,g5=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,y5=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,_5=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,v5=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,b5=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,x5=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,w5=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,S5=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,M5=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,T5=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,E5=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,L5=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,A5=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,C5=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,R5=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,P5=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,I5=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,D5=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,N5=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,O5=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,k5=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,F5=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,U5=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,z5=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,W5=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,V5=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,G5=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,B5=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,H5="gl_FragColor = linearToOutputTexel( gl_FragColor );",Z5=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,X5=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,j5=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Y5=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,K5=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,J5=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Q5=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,$5=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,q5=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,eB=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,tB=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,nB=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,iB=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,rB=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,sB=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,oB=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,aB=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lB=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,cB=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,uB=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hB=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,dB=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,fB=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,pB=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,mB=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,gB=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,yB=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,_B=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,vB=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,bB=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,xB=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,wB=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,SB=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,MB=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,TB=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,EB=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,LB=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,AB=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,CB=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,RB=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,PB=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,IB=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,DB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,NB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,OB=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,kB=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,FB=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,UB=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,zB=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,WB=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,VB=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,GB=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,BB=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,HB=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ZB=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,XB=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,jB=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,YB=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,KB=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,JB=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,QB=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,$B=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,qB=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,e4=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,t4=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,n4=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,i4=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,r4=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,s4=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,o4=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,a4=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,l4=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,c4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,u4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,h4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,d4=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const f4=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,p4=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,m4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,g4=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,y4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_4=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,v4=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,b4=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,x4=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,w4=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,S4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,M4=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,T4=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,E4=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,L4=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,A4=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,C4=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,R4=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,P4=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,I4=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,D4=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,N4=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,O4=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,k4=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,F4=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,U4=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,z4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,W4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,V4=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,G4=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,B4=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,H4=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Z4=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,X4=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,It={alphahash_fragment:p5,alphahash_pars_fragment:m5,alphamap_fragment:g5,alphamap_pars_fragment:y5,alphatest_fragment:_5,alphatest_pars_fragment:v5,aomap_fragment:b5,aomap_pars_fragment:x5,batching_pars_vertex:w5,batching_vertex:S5,begin_vertex:M5,beginnormal_vertex:T5,bsdfs:E5,iridescence_fragment:L5,bumpmap_pars_fragment:A5,clipping_planes_fragment:C5,clipping_planes_pars_fragment:R5,clipping_planes_pars_vertex:P5,clipping_planes_vertex:I5,color_fragment:D5,color_pars_fragment:N5,color_pars_vertex:O5,color_vertex:k5,common:F5,cube_uv_reflection_fragment:U5,defaultnormal_vertex:z5,displacementmap_pars_vertex:W5,displacementmap_vertex:V5,emissivemap_fragment:G5,emissivemap_pars_fragment:B5,colorspace_fragment:H5,colorspace_pars_fragment:Z5,envmap_fragment:X5,envmap_common_pars_fragment:j5,envmap_pars_fragment:Y5,envmap_pars_vertex:K5,envmap_physical_pars_fragment:oB,envmap_vertex:J5,fog_vertex:Q5,fog_pars_vertex:$5,fog_fragment:q5,fog_pars_fragment:eB,gradientmap_pars_fragment:tB,lightmap_pars_fragment:nB,lights_lambert_fragment:iB,lights_lambert_pars_fragment:rB,lights_pars_begin:sB,lights_toon_fragment:aB,lights_toon_pars_fragment:lB,lights_phong_fragment:cB,lights_phong_pars_fragment:uB,lights_physical_fragment:hB,lights_physical_pars_fragment:dB,lights_fragment_begin:fB,lights_fragment_maps:pB,lights_fragment_end:mB,logdepthbuf_fragment:gB,logdepthbuf_pars_fragment:yB,logdepthbuf_pars_vertex:_B,logdepthbuf_vertex:vB,map_fragment:bB,map_pars_fragment:xB,map_particle_fragment:wB,map_particle_pars_fragment:SB,metalnessmap_fragment:MB,metalnessmap_pars_fragment:TB,morphinstance_vertex:EB,morphcolor_vertex:LB,morphnormal_vertex:AB,morphtarget_pars_vertex:CB,morphtarget_vertex:RB,normal_fragment_begin:PB,normal_fragment_maps:IB,normal_pars_fragment:DB,normal_pars_vertex:NB,normal_vertex:OB,normalmap_pars_fragment:kB,clearcoat_normal_fragment_begin:FB,clearcoat_normal_fragment_maps:UB,clearcoat_pars_fragment:zB,iridescence_pars_fragment:WB,opaque_fragment:VB,packing:GB,premultiplied_alpha_fragment:BB,project_vertex:HB,dithering_fragment:ZB,dithering_pars_fragment:XB,roughnessmap_fragment:jB,roughnessmap_pars_fragment:YB,shadowmap_pars_fragment:KB,shadowmap_pars_vertex:JB,shadowmap_vertex:QB,shadowmask_pars_fragment:$B,skinbase_vertex:qB,skinning_pars_vertex:e4,skinning_vertex:t4,skinnormal_vertex:n4,specularmap_fragment:i4,specularmap_pars_fragment:r4,tonemapping_fragment:s4,tonemapping_pars_fragment:o4,transmission_fragment:a4,transmission_pars_fragment:l4,uv_pars_fragment:c4,uv_pars_vertex:u4,uv_vertex:h4,worldpos_vertex:d4,background_vert:f4,background_frag:p4,backgroundCube_vert:m4,backgroundCube_frag:g4,cube_vert:y4,cube_frag:_4,depth_vert:v4,depth_frag:b4,distanceRGBA_vert:x4,distanceRGBA_frag:w4,equirect_vert:S4,equirect_frag:M4,linedashed_vert:T4,linedashed_frag:E4,meshbasic_vert:L4,meshbasic_frag:A4,meshlambert_vert:C4,meshlambert_frag:R4,meshmatcap_vert:P4,meshmatcap_frag:I4,meshnormal_vert:D4,meshnormal_frag:N4,meshphong_vert:O4,meshphong_frag:k4,meshphysical_vert:F4,meshphysical_frag:U4,meshtoon_vert:z4,meshtoon_frag:W4,points_vert:V4,points_frag:G4,shadow_vert:B4,shadow_frag:H4,sprite_vert:Z4,sprite_frag:X4},Je={common:{diffuse:{value:new Ge(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Lt},alphaMap:{value:null},alphaMapTransform:{value:new Lt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Lt}},envmap:{envMap:{value:null},envMapRotation:{value:new Lt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Lt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Lt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Lt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Lt},normalScale:{value:new Ie(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Lt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Lt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Lt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Lt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ge(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ge(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Lt},alphaTest:{value:0},uvTransform:{value:new Lt}},sprite:{diffuse:{value:new Ge(16777215)},opacity:{value:1},center:{value:new Ie(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Lt},alphaMap:{value:null},alphaMapTransform:{value:new Lt},alphaTest:{value:0}}},Gs={basic:{uniforms:er([Je.common,Je.specularmap,Je.envmap,Je.aomap,Je.lightmap,Je.fog]),vertexShader:It.meshbasic_vert,fragmentShader:It.meshbasic_frag},lambert:{uniforms:er([Je.common,Je.specularmap,Je.envmap,Je.aomap,Je.lightmap,Je.emissivemap,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.fog,Je.lights,{emissive:{value:new Ge(0)}}]),vertexShader:It.meshlambert_vert,fragmentShader:It.meshlambert_frag},phong:{uniforms:er([Je.common,Je.specularmap,Je.envmap,Je.aomap,Je.lightmap,Je.emissivemap,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.fog,Je.lights,{emissive:{value:new Ge(0)},specular:{value:new Ge(1118481)},shininess:{value:30}}]),vertexShader:It.meshphong_vert,fragmentShader:It.meshphong_frag},standard:{uniforms:er([Je.common,Je.envmap,Je.aomap,Je.lightmap,Je.emissivemap,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.roughnessmap,Je.metalnessmap,Je.fog,Je.lights,{emissive:{value:new Ge(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:It.meshphysical_vert,fragmentShader:It.meshphysical_frag},toon:{uniforms:er([Je.common,Je.aomap,Je.lightmap,Je.emissivemap,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.gradientmap,Je.fog,Je.lights,{emissive:{value:new Ge(0)}}]),vertexShader:It.meshtoon_vert,fragmentShader:It.meshtoon_frag},matcap:{uniforms:er([Je.common,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.fog,{matcap:{value:null}}]),vertexShader:It.meshmatcap_vert,fragmentShader:It.meshmatcap_frag},points:{uniforms:er([Je.points,Je.fog]),vertexShader:It.points_vert,fragmentShader:It.points_frag},dashed:{uniforms:er([Je.common,Je.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:It.linedashed_vert,fragmentShader:It.linedashed_frag},depth:{uniforms:er([Je.common,Je.displacementmap]),vertexShader:It.depth_vert,fragmentShader:It.depth_frag},normal:{uniforms:er([Je.common,Je.bumpmap,Je.normalmap,Je.displacementmap,{opacity:{value:1}}]),vertexShader:It.meshnormal_vert,fragmentShader:It.meshnormal_frag},sprite:{uniforms:er([Je.sprite,Je.fog]),vertexShader:It.sprite_vert,fragmentShader:It.sprite_frag},background:{uniforms:{uvTransform:{value:new Lt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:It.background_vert,fragmentShader:It.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Lt}},vertexShader:It.backgroundCube_vert,fragmentShader:It.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:It.cube_vert,fragmentShader:It.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:It.equirect_vert,fragmentShader:It.equirect_frag},distanceRGBA:{uniforms:er([Je.common,Je.displacementmap,{referencePosition:{value:new U},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:It.distanceRGBA_vert,fragmentShader:It.distanceRGBA_frag},shadow:{uniforms:er([Je.lights,Je.fog,{color:{value:new Ge(0)},opacity:{value:1}}]),vertexShader:It.shadow_vert,fragmentShader:It.shadow_frag}};Gs.physical={uniforms:er([Gs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Lt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Lt},clearcoatNormalScale:{value:new Ie(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Lt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Lt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Lt},sheen:{value:0},sheenColor:{value:new Ge(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Lt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Lt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Lt},transmissionSamplerSize:{value:new Ie},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Lt},attenuationDistance:{value:0},attenuationColor:{value:new Ge(0)},specularColor:{value:new Ge(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Lt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Lt},anisotropyVector:{value:new Ie},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Lt}}]),vertexShader:It.meshphysical_vert,fragmentShader:It.meshphysical_frag};const Rf={r:0,b:0,g:0},Xa=new Ri,j4=new nt;function Y4(n,e,t,i,r,s,o){const a=new Ge(0);let l=s===!0?0:1,c,h,d=null,p=0,m=null;function y(w){let S=w.isScene===!0?w.background:null;return S&&S.isTexture&&(S=(w.backgroundBlurriness>0?t:e).get(S)),S}function b(w){let S=!1;const C=y(w);C===null?g(a,l):C&&C.isColor&&(g(C,1),S=!0);const A=n.xr.getEnvironmentBlendMode();A==="additive"?i.buffers.color.setClear(0,0,0,1,o):A==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||S)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function v(w,S){const C=y(S);C&&(C.isCubeTexture||C.mapping===am)?(h===void 0&&(h=new Xt(new Bh(1,1,1),new rs({name:"BackgroundCubeMaterial",uniforms:Gc(Gs.backgroundCube.uniforms),vertexShader:Gs.backgroundCube.vertexShader,fragmentShader:Gs.backgroundCube.fragmentShader,side:Zi,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(A,E,O){this.matrixWorld.copyPosition(O.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),Xa.copy(S.backgroundRotation),Xa.x*=-1,Xa.y*=-1,Xa.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(Xa.y*=-1,Xa.z*=-1),h.material.uniforms.envMap.value=C,h.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=S.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,h.material.uniforms.backgroundRotation.value.setFromMatrix4(j4.makeRotationFromEuler(Xa)),h.material.toneMapped=Jt.getTransfer(C.colorSpace)!==un,(d!==C||p!==C.version||m!==n.toneMapping)&&(h.material.needsUpdate=!0,d=C,p=C.version,m=n.toneMapping),h.layers.enableAll(),w.unshift(h,h.geometry,h.material,0,0,null)):C&&C.isTexture&&(c===void 0&&(c=new Xt(new js(2,2),new rs({name:"BackgroundMaterial",uniforms:Gc(Gs.background.uniforms),vertexShader:Gs.background.vertexShader,fragmentShader:Gs.background.fragmentShader,side:ns,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=C,c.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,c.material.toneMapped=Jt.getTransfer(C.colorSpace)!==un,C.matrixAutoUpdate===!0&&C.updateMatrix(),c.material.uniforms.uvTransform.value.copy(C.matrix),(d!==C||p!==C.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,d=C,p=C.version,m=n.toneMapping),c.layers.enableAll(),w.unshift(c,c.geometry,c.material,0,0,null))}function g(w,S){w.getRGB(Rf,zL(n)),i.buffers.color.setClear(Rf.r,Rf.g,Rf.b,S,o)}function x(){h!==void 0&&(h.geometry.dispose(),h.material.dispose()),c!==void 0&&(c.geometry.dispose(),c.material.dispose())}return{getClearColor:function(){return a},setClearColor:function(w,S=1){a.set(w),l=S,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(w){l=w,g(a,l)},render:b,addToRenderList:v,dispose:x}}function K4(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=p(null);let s=r,o=!1;function a(T,k,Y,$,re){let ae=!1;const V=d($,Y,k);s!==V&&(s=V,c(s.object)),ae=m(T,$,Y,re),ae&&y(T,$,Y,re),re!==null&&e.update(re,n.ELEMENT_ARRAY_BUFFER),(ae||o)&&(o=!1,S(T,k,Y,$),re!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(re).buffer))}function l(){return n.createVertexArray()}function c(T){return n.bindVertexArray(T)}function h(T){return n.deleteVertexArray(T)}function d(T,k,Y){const $=Y.wireframe===!0;let re=i[T.id];re===void 0&&(re={},i[T.id]=re);let ae=re[k.id];ae===void 0&&(ae={},re[k.id]=ae);let V=ae[$];return V===void 0&&(V=p(l()),ae[$]=V),V}function p(T){const k=[],Y=[],$=[];for(let re=0;re<t;re++)k[re]=0,Y[re]=0,$[re]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:k,enabledAttributes:Y,attributeDivisors:$,object:T,attributes:{},index:null}}function m(T,k,Y,$){const re=s.attributes,ae=k.attributes;let V=0;const te=Y.getAttributes();for(const J in te)if(te[J].location>=0){const Te=re[J];let Le=ae[J];if(Le===void 0&&(J==="instanceMatrix"&&T.instanceMatrix&&(Le=T.instanceMatrix),J==="instanceColor"&&T.instanceColor&&(Le=T.instanceColor)),Te===void 0||Te.attribute!==Le||Le&&Te.data!==Le.data)return!0;V++}return s.attributesNum!==V||s.index!==$}function y(T,k,Y,$){const re={},ae=k.attributes;let V=0;const te=Y.getAttributes();for(const J in te)if(te[J].location>=0){let Te=ae[J];Te===void 0&&(J==="instanceMatrix"&&T.instanceMatrix&&(Te=T.instanceMatrix),J==="instanceColor"&&T.instanceColor&&(Te=T.instanceColor));const Le={};Le.attribute=Te,Te&&Te.data&&(Le.data=Te.data),re[J]=Le,V++}s.attributes=re,s.attributesNum=V,s.index=$}function b(){const T=s.newAttributes;for(let k=0,Y=T.length;k<Y;k++)T[k]=0}function v(T){g(T,0)}function g(T,k){const Y=s.newAttributes,$=s.enabledAttributes,re=s.attributeDivisors;Y[T]=1,$[T]===0&&(n.enableVertexAttribArray(T),$[T]=1),re[T]!==k&&(n.vertexAttribDivisor(T,k),re[T]=k)}function x(){const T=s.newAttributes,k=s.enabledAttributes;for(let Y=0,$=k.length;Y<$;Y++)k[Y]!==T[Y]&&(n.disableVertexAttribArray(Y),k[Y]=0)}function w(T,k,Y,$,re,ae,V){V===!0?n.vertexAttribIPointer(T,k,Y,re,ae):n.vertexAttribPointer(T,k,Y,$,re,ae)}function S(T,k,Y,$){b();const re=$.attributes,ae=Y.getAttributes(),V=k.defaultAttributeValues;for(const te in ae){const J=ae[te];if(J.location>=0){let pe=re[te];if(pe===void 0&&(te==="instanceMatrix"&&T.instanceMatrix&&(pe=T.instanceMatrix),te==="instanceColor"&&T.instanceColor&&(pe=T.instanceColor)),pe!==void 0){const Te=pe.normalized,Le=pe.itemSize,Ue=e.get(pe);if(Ue===void 0)continue;const tt=Ue.buffer,_e=Ue.type,Ae=Ue.bytesPerElement,We=_e===n.INT||_e===n.UNSIGNED_INT||pe.gpuType===sv;if(pe.isInterleavedBufferAttribute){const se=pe.data,Se=se.stride,Me=pe.offset;if(se.isInstancedInterleavedBuffer){for(let De=0;De<J.locationSize;De++)g(J.location+De,se.meshPerAttribute);T.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=se.meshPerAttribute*se.count)}else for(let De=0;De<J.locationSize;De++)v(J.location+De);n.bindBuffer(n.ARRAY_BUFFER,tt);for(let De=0;De<J.locationSize;De++)w(J.location+De,Le/J.locationSize,_e,Te,Se*Ae,(Me+Le/J.locationSize*De)*Ae,We)}else{if(pe.isInstancedBufferAttribute){for(let se=0;se<J.locationSize;se++)g(J.location+se,pe.meshPerAttribute);T.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=pe.meshPerAttribute*pe.count)}else for(let se=0;se<J.locationSize;se++)v(J.location+se);n.bindBuffer(n.ARRAY_BUFFER,tt);for(let se=0;se<J.locationSize;se++)w(J.location+se,Le/J.locationSize,_e,Te,Le*Ae,Le/J.locationSize*se*Ae,We)}}else if(V!==void 0){const Te=V[te];if(Te!==void 0)switch(Te.length){case 2:n.vertexAttrib2fv(J.location,Te);break;case 3:n.vertexAttrib3fv(J.location,Te);break;case 4:n.vertexAttrib4fv(J.location,Te);break;default:n.vertexAttrib1fv(J.location,Te)}}}}x()}function C(){O();for(const T in i){const k=i[T];for(const Y in k){const $=k[Y];for(const re in $)h($[re].object),delete $[re];delete k[Y]}delete i[T]}}function A(T){if(i[T.id]===void 0)return;const k=i[T.id];for(const Y in k){const $=k[Y];for(const re in $)h($[re].object),delete $[re];delete k[Y]}delete i[T.id]}function E(T){for(const k in i){const Y=i[k];if(Y[T.id]===void 0)continue;const $=Y[T.id];for(const re in $)h($[re].object),delete $[re];delete Y[T.id]}}function O(){R(),o=!0,s!==r&&(s=r,c(s.object))}function R(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:O,resetDefaultState:R,dispose:C,releaseStatesOfGeometry:A,releaseStatesOfProgram:E,initAttributes:b,enableAttribute:v,disableUnusedAttributes:x}}function J4(n,e,t){let i;function r(c){i=c}function s(c,h){n.drawArrays(i,c,h),t.update(h,i,1)}function o(c,h,d){d!==0&&(n.drawArraysInstanced(i,c,h,d),t.update(h,i,d))}function a(c,h,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,h,0,d);let m=0;for(let y=0;y<d;y++)m+=h[y];t.update(m,i,1)}function l(c,h,d,p){if(d===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let y=0;y<c.length;y++)o(c[y],h[y],p[y]);else{m.multiDrawArraysInstancedWEBGL(i,c,0,h,0,p,0,d);let y=0;for(let b=0;b<d;b++)y+=h[b]*p[b];t.update(y,i,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function Q4(n,e,t,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const E=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(E){return!(E!==$r&&i.convert(E)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(E){const O=E===Ro&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(E!==Uo&&i.convert(E)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&E!==rr&&!O)}function l(E){if(E==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const h=l(c);h!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",h,"instead."),c=h);const d=t.logarithmicDepthBuffer===!0,p=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),m=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),y=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),b=n.getParameter(n.MAX_TEXTURE_SIZE),v=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),g=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),w=n.getParameter(n.MAX_VARYING_VECTORS),S=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),C=y>0,A=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:d,reverseDepthBuffer:p,maxTextures:m,maxVertexTextures:y,maxTextureSize:b,maxCubemapSize:v,maxAttributes:g,maxVertexUniforms:x,maxVaryings:w,maxFragmentUniforms:S,vertexTextures:C,maxSamples:A}}function $4(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Vs,a=new Lt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,p){const m=d.length!==0||p||i!==0||r;return r=p,i=d.length,m},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,p){t=h(d,p,0)},this.setState=function(d,p,m){const y=d.clippingPlanes,b=d.clipIntersection,v=d.clipShadows,g=n.get(d);if(!r||y===null||y.length===0||s&&!v)s?h(null):c();else{const x=s?0:i,w=x*4;let S=g.clippingState||null;l.value=S,S=h(y,p,w,m);for(let C=0;C!==w;++C)S[C]=t[C];g.clippingState=S,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(d,p,m,y){const b=d!==null?d.length:0;let v=null;if(b!==0){if(v=l.value,y!==!0||v===null){const g=m+b*4,x=p.matrixWorldInverse;a.getNormalMatrix(x),(v===null||v.length<g)&&(v=new Float32Array(g));for(let w=0,S=m;w!==b;++w,S+=4)o.copy(d[w]).applyMatrix4(x,a),o.normal.toArray(v,S),v[S+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,v}}function q4(n){let e=new WeakMap;function t(o,a){return a===Ap?o.mapping=kc:a===z0&&(o.mapping=Fc),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===Ap||a===z0)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new jV(l.height);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const yc=4,BS=[.125,.215,.35,.446,.526,.582],il=20,Ty=new hl,HS=new Ge;let Ey=null,Ly=0,Ay=0,Cy=!1;const qa=(1+Math.sqrt(5))/2,ac=1/qa,ZS=[new U(-qa,ac,0),new U(qa,ac,0),new U(-ac,0,qa),new U(ac,0,qa),new U(0,qa,-ac),new U(0,qa,ac),new U(-1,1,-1),new U(1,1,-1),new U(-1,1,1),new U(1,1,1)];class XS{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Ey=this._renderer.getRenderTarget(),Ly=this._renderer.getActiveCubeFace(),Ay=this._renderer.getActiveMipmapLevel(),Cy=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=KS(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=YS(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Ey,Ly,Ay),this._renderer.xr.enabled=Cy,e.scissorTest=!1,Pf(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===kc||e.mapping===Fc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Ey=this._renderer.getRenderTarget(),Ly=this._renderer.getActiveCubeFace(),Ay=this._renderer.getActiveMipmapLevel(),Cy=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:ui,minFilter:ui,generateMipmaps:!1,type:Ro,format:$r,colorSpace:Wc,depthBuffer:!1},r=jS(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=jS(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=eH(s)),this._blurMaterial=tH(s,e,t)}return r}_compileMaterial(e){const t=new Xt(this._lodPlanes[0],e);this._renderer.compile(t,Ty)}_sceneToCubeUV(e,t,i,r){const a=new Kn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,p=h.toneMapping;h.getClearColor(HS),h.toneMapping=xa,h.autoClear=!1;const m=new Ir({name:"PMREM.Background",side:Zi,depthWrite:!1,depthTest:!1}),y=new Xt(new Bh,m);let b=!1;const v=e.background;v?v.isColor&&(m.color.copy(v),e.background=null,b=!0):(m.color.copy(HS),b=!0);for(let g=0;g<6;g++){const x=g%3;x===0?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):x===1?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g]));const w=this._cubeSize;Pf(r,x*w,g>2?w:0,w,w),h.setRenderTarget(r),b&&h.render(y,a),h.render(e,a)}y.geometry.dispose(),y.material.dispose(),h.toneMapping=p,h.autoClear=d,e.background=v}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===kc||e.mapping===Fc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=KS()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=YS());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Xt(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Pf(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,Ty)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=ZS[(r-s-1)%ZS.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,d=new Xt(this._lodPlanes[r],c),p=c.uniforms,m=this._sizeLods[i]-1,y=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*il-1),b=s/y,v=isFinite(s)?1+Math.floor(h*b):il;v>il&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${il}`);const g=[];let x=0;for(let E=0;E<il;++E){const O=E/b,R=Math.exp(-O*O/2);g.push(R),E===0?x+=R:E<v&&(x+=2*R)}for(let E=0;E<g.length;E++)g[E]=g[E]/x;p.envMap.value=e.texture,p.samples.value=v,p.weights.value=g,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:w}=this;p.dTheta.value=y,p.mipInt.value=w-i;const S=this._sizeLods[r],C=3*S*(r>w-yc?r-w+yc:0),A=4*(this._cubeSize-S);Pf(t,C,A,3*S,2*S),l.setRenderTarget(t),l.render(d,Ty)}}function eH(n){const e=[],t=[],i=[];let r=n;const s=n-yc+1+BS.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-yc?l=BS[o-n+yc-1]:o===0&&(l=0),i.push(l);const c=1/(a-2),h=-c,d=1+c,p=[h,h,d,h,d,d,h,h,d,d,h,d],m=6,y=6,b=3,v=2,g=1,x=new Float32Array(b*y*m),w=new Float32Array(v*y*m),S=new Float32Array(g*y*m);for(let A=0;A<m;A++){const E=A%3*2/3-1,O=A>2?0:-1,R=[E,O,0,E+2/3,O,0,E+2/3,O+1,0,E,O,0,E+2/3,O+1,0,E,O+1,0];x.set(R,b*y*A),w.set(p,v*y*A);const T=[A,A,A,A,A,A];S.set(T,g*y*A)}const C=new fn;C.setAttribute("position",new Ln(x,b)),C.setAttribute("uv",new Ln(w,v)),C.setAttribute("faceIndex",new Ln(S,g)),e.push(C),r>yc&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function jS(n,e,t){const i=new Ma(n,e,t);return i.texture.mapping=am,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Pf(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function tH(n,e,t){const i=new Float32Array(il),r=new U(0,1,0);return new rs({name:"SphericalGaussianBlur",defines:{n:il,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Dv(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:va,depthTest:!1,depthWrite:!1})}function YS(){return new rs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Dv(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:va,depthTest:!1,depthWrite:!1})}function KS(){return new rs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Dv(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:va,depthTest:!1,depthWrite:!1})}function Dv(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function nH(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===Ap||l===z0,h=l===kc||l===Fc;if(c||h){let d=e.get(a);const p=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==p)return t===null&&(t=new XS(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{const m=a.image;return c&&m&&m.height>0||h&&m&&r(m)?(t===null&&(t=new XS(n)),d=c?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function r(a){let l=0;const c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function iH(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return r===null&&fc("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function rH(n,e,t,i){const r={},s=new WeakMap;function o(d){const p=d.target;p.index!==null&&e.remove(p.index);for(const y in p.attributes)e.remove(p.attributes[y]);p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(d,p){return r[p.id]===!0||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p}function l(d){const p=d.attributes;for(const m in p)e.update(p[m],n.ARRAY_BUFFER)}function c(d){const p=[],m=d.index,y=d.attributes.position;let b=0;if(m!==null){const x=m.array;b=m.version;for(let w=0,S=x.length;w<S;w+=3){const C=x[w+0],A=x[w+1],E=x[w+2];p.push(C,A,A,E,E,C)}}else if(y!==void 0){const x=y.array;b=y.version;for(let w=0,S=x.length/3-1;w<S;w+=3){const C=w+0,A=w+1,E=w+2;p.push(C,A,A,E,E,C)}}else return;const v=new(NL(p)?UL:mv)(p,1);v.version=b;const g=s.get(d);g&&e.remove(g),s.set(d,v)}function h(d){const p=s.get(d);if(p){const m=d.index;m!==null&&p.version<m.version&&c(d)}else c(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:h}}function sH(n,e,t){let i;function r(p){i=p}let s,o;function a(p){s=p.type,o=p.bytesPerElement}function l(p,m){n.drawElements(i,m,s,p*o),t.update(m,i,1)}function c(p,m,y){y!==0&&(n.drawElementsInstanced(i,m,s,p*o,y),t.update(m,i,y))}function h(p,m,y){if(y===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,m,0,s,p,0,y);let v=0;for(let g=0;g<y;g++)v+=m[g];t.update(v,i,1)}function d(p,m,y,b){if(y===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let g=0;g<p.length;g++)c(p[g]/o,m[g],b[g]);else{v.multiDrawElementsInstancedWEBGL(i,m,0,s,p,0,b,0,y);let g=0;for(let x=0;x<y;x++)g+=m[x]*b[x];t.update(g,i,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=h,this.renderMultiDrawInstances=d}function oH(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function aH(n,e,t){const i=new WeakMap,r=new Ct;function s(o,a,l){const c=o.morphTargetInfluences,h=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=h!==void 0?h.length:0;let p=i.get(a);if(p===void 0||p.count!==d){let R=function(){E.dispose(),i.delete(a),a.removeEventListener("dispose",R)};p!==void 0&&p.texture.dispose();const m=a.morphAttributes.position!==void 0,y=a.morphAttributes.normal!==void 0,b=a.morphAttributes.color!==void 0,v=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],x=a.morphAttributes.color||[];let w=0;m===!0&&(w=1),y===!0&&(w=2),b===!0&&(w=3);let S=a.attributes.position.count*w,C=1;S>e.maxTextureSize&&(C=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);const A=new Float32Array(S*C*4*d),E=new kL(A,S,C,d);E.type=rr,E.needsUpdate=!0;const O=w*4;for(let T=0;T<d;T++){const k=v[T],Y=g[T],$=x[T],re=S*C*4*T;for(let ae=0;ae<k.count;ae++){const V=ae*O;m===!0&&(r.fromBufferAttribute(k,ae),A[re+V+0]=r.x,A[re+V+1]=r.y,A[re+V+2]=r.z,A[re+V+3]=0),y===!0&&(r.fromBufferAttribute(Y,ae),A[re+V+4]=r.x,A[re+V+5]=r.y,A[re+V+6]=r.z,A[re+V+7]=0),b===!0&&(r.fromBufferAttribute($,ae),A[re+V+8]=r.x,A[re+V+9]=r.y,A[re+V+10]=r.z,A[re+V+11]=$.itemSize===4?r.w:1)}}p={count:d,texture:E,size:new Ie(S,C)},i.set(a,p),a.addEventListener("dispose",R)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let m=0;for(let b=0;b<c.length;b++)m+=c[b];const y=a.morphTargetsRelative?1:1-m;l.getUniforms().setValue(n,"morphTargetBaseInfluence",y),l.getUniforms().setValue(n,"morphTargetInfluences",c)}l.getUniforms().setValue(n,"morphTargetsTexture",p.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",p.size)}return{update:s}}function lH(n,e,t,i){let r=new WeakMap;function s(l){const c=i.render.frame,h=l.geometry,d=e.get(l,h);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return d}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}const aA=new In,JS=new HL(1,1),lA=new kL,cA=new CV,uA=new yv,QS=[],$S=[],qS=new Float32Array(16),eM=new Float32Array(9),tM=new Float32Array(4);function Kc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=QS[r];if(s===void 0&&(s=new Float32Array(r),QS[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function di(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function fi(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function ym(n,e){let t=$S[e];t===void 0&&(t=new Int32Array(e),$S[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function cH(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function uH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(di(t,e))return;n.uniform2fv(this.addr,e),fi(t,e)}}function hH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(di(t,e))return;n.uniform3fv(this.addr,e),fi(t,e)}}function dH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(di(t,e))return;n.uniform4fv(this.addr,e),fi(t,e)}}function fH(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(di(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),fi(t,e)}else{if(di(t,i))return;tM.set(i),n.uniformMatrix2fv(this.addr,!1,tM),fi(t,i)}}function pH(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(di(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),fi(t,e)}else{if(di(t,i))return;eM.set(i),n.uniformMatrix3fv(this.addr,!1,eM),fi(t,i)}}function mH(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(di(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),fi(t,e)}else{if(di(t,i))return;qS.set(i),n.uniformMatrix4fv(this.addr,!1,qS),fi(t,i)}}function gH(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function yH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(di(t,e))return;n.uniform2iv(this.addr,e),fi(t,e)}}function _H(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(di(t,e))return;n.uniform3iv(this.addr,e),fi(t,e)}}function vH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(di(t,e))return;n.uniform4iv(this.addr,e),fi(t,e)}}function bH(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function xH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(di(t,e))return;n.uniform2uiv(this.addr,e),fi(t,e)}}function wH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(di(t,e))return;n.uniform3uiv(this.addr,e),fi(t,e)}}function SH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(di(t,e))return;n.uniform4uiv(this.addr,e),fi(t,e)}}function MH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s;this.type===n.SAMPLER_2D_SHADOW?(JS.compareFunction=DL,s=JS):s=aA,t.setTexture2D(e||s,r)}function TH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||cA,r)}function EH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||uA,r)}function LH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||lA,r)}function AH(n){switch(n){case 5126:return cH;case 35664:return uH;case 35665:return hH;case 35666:return dH;case 35674:return fH;case 35675:return pH;case 35676:return mH;case 5124:case 35670:return gH;case 35667:case 35671:return yH;case 35668:case 35672:return _H;case 35669:case 35673:return vH;case 5125:return bH;case 36294:return xH;case 36295:return wH;case 36296:return SH;case 35678:case 36198:case 36298:case 36306:case 35682:return MH;case 35679:case 36299:case 36307:return TH;case 35680:case 36300:case 36308:case 36293:return EH;case 36289:case 36303:case 36311:case 36292:return LH}}function CH(n,e){n.uniform1fv(this.addr,e)}function RH(n,e){const t=Kc(e,this.size,2);n.uniform2fv(this.addr,t)}function PH(n,e){const t=Kc(e,this.size,3);n.uniform3fv(this.addr,t)}function IH(n,e){const t=Kc(e,this.size,4);n.uniform4fv(this.addr,t)}function DH(n,e){const t=Kc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function NH(n,e){const t=Kc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function OH(n,e){const t=Kc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function kH(n,e){n.uniform1iv(this.addr,e)}function FH(n,e){n.uniform2iv(this.addr,e)}function UH(n,e){n.uniform3iv(this.addr,e)}function zH(n,e){n.uniform4iv(this.addr,e)}function WH(n,e){n.uniform1uiv(this.addr,e)}function VH(n,e){n.uniform2uiv(this.addr,e)}function GH(n,e){n.uniform3uiv(this.addr,e)}function BH(n,e){n.uniform4uiv(this.addr,e)}function HH(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);di(i,s)||(n.uniform1iv(this.addr,s),fi(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||aA,s[o])}function ZH(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);di(i,s)||(n.uniform1iv(this.addr,s),fi(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||cA,s[o])}function XH(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);di(i,s)||(n.uniform1iv(this.addr,s),fi(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||uA,s[o])}function jH(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);di(i,s)||(n.uniform1iv(this.addr,s),fi(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||lA,s[o])}function YH(n){switch(n){case 5126:return CH;case 35664:return RH;case 35665:return PH;case 35666:return IH;case 35674:return DH;case 35675:return NH;case 35676:return OH;case 5124:case 35670:return kH;case 35667:case 35671:return FH;case 35668:case 35672:return UH;case 35669:case 35673:return zH;case 5125:return WH;case 36294:return VH;case 36295:return GH;case 36296:return BH;case 35678:case 36198:case 36298:case 36306:case 35682:return HH;case 35679:case 36299:case 36307:return ZH;case 35680:case 36300:case 36308:case 36293:return XH;case 36289:case 36303:case 36311:case 36292:return jH}}class KH{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=AH(t.type)}}class JH{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=YH(t.type)}}class QH{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const Ry=/(\w+)(\])?(\[|\.)?/g;function nM(n,e){n.seq.push(e),n.map[e.id]=e}function $H(n,e,t){const i=n.name,r=i.length;for(Ry.lastIndex=0;;){const s=Ry.exec(i),o=Ry.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){nM(t,c===void 0?new KH(a,n,e):new JH(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new QH(a),nM(t,d)),t=d}}}class mp{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);$H(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function iM(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const qH=37297;let eZ=0;function tZ(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}const rM=new Lt;function nZ(n){Jt._getMatrix(rM,Jt.workingColorSpace,n);const e=`mat3( ${rM.elements.map(t=>t.toFixed(4))} )`;switch(Jt.getTransfer(n)){case Pp:return[e,"LinearTransferOETF"];case un:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function sM(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+tZ(n.getShaderSource(e),o)}else return r}function iZ(n,e){const t=nZ(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function rZ(n,e){let t;switch(e){case UW:t="Linear";break;case zW:t="Reinhard";break;case WW:t="Cineon";break;case rv:t="ACESFilmic";break;case GW:t="AgX";break;case BW:t="Neutral";break;case VW:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const If=new U;function sZ(){Jt.getLuminanceCoefficients(If);const n=If.x.toFixed(4),e=If.y.toFixed(4),t=If.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function oZ(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Bu).join(`
`)}function aZ(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function lZ(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Bu(n){return n!==""}function oM(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function aM(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const cZ=/^[ \t]*#include +<([\w\d./]+)>/gm;function b_(n){return n.replace(cZ,hZ)}const uZ=new Map;function hZ(n,e){let t=It[e];if(t===void 0){const i=uZ.get(e);if(i!==void 0)t=It[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return b_(t)}const dZ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lM(n){return n.replace(dZ,fZ)}function fZ(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function cM(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function pZ(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===yL?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===_L?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===wo&&(e="SHADOWMAP_TYPE_VSM"),e}function mZ(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case kc:case Fc:e="ENVMAP_TYPE_CUBE";break;case am:e="ENVMAP_TYPE_CUBE_UV";break}return e}function gZ(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Fc:e="ENVMAP_MODE_REFRACTION";break}return e}function yZ(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case om:e="ENVMAP_BLENDING_MULTIPLY";break;case kW:e="ENVMAP_BLENDING_MIX";break;case FW:e="ENVMAP_BLENDING_ADD";break}return e}function _Z(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function vZ(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=pZ(t),c=mZ(t),h=gZ(t),d=yZ(t),p=_Z(t),m=oZ(t),y=aZ(s),b=r.createProgram();let v,g,x=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(Bu).join(`
`),v.length>0&&(v+=`
`),g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(Bu).join(`
`),g.length>0&&(g+=`
`)):(v=[cM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Bu).join(`
`),g=[cM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==xa?"#define TONE_MAPPING":"",t.toneMapping!==xa?It.tonemapping_pars_fragment:"",t.toneMapping!==xa?rZ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",It.colorspace_pars_fragment,iZ("linearToOutputTexel",t.outputColorSpace),sZ(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Bu).join(`
`)),o=b_(o),o=oM(o,t),o=aM(o,t),a=b_(a),a=oM(a,t),a=aM(a,t),o=lM(o),a=lM(a),t.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,v=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,g=["#define varying in",t.glslVersion===Z1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Z1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const w=x+v+o,S=x+g+a,C=iM(r,r.VERTEX_SHADER,w),A=iM(r,r.FRAGMENT_SHADER,S);r.attachShader(b,C),r.attachShader(b,A),t.index0AttributeName!==void 0?r.bindAttribLocation(b,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(b,0,"position"),r.linkProgram(b);function E(k){if(n.debug.checkShaderErrors){const Y=r.getProgramInfoLog(b).trim(),$=r.getShaderInfoLog(C).trim(),re=r.getShaderInfoLog(A).trim();let ae=!0,V=!0;if(r.getProgramParameter(b,r.LINK_STATUS)===!1)if(ae=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,b,C,A);else{const te=sM(r,C,"vertex"),J=sM(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(b,r.VALIDATE_STATUS)+`

Material Name: `+k.name+`
Material Type: `+k.type+`

Program Info Log: `+Y+`
`+te+`
`+J)}else Y!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Y):($===""||re==="")&&(V=!1);V&&(k.diagnostics={runnable:ae,programLog:Y,vertexShader:{log:$,prefix:v},fragmentShader:{log:re,prefix:g}})}r.deleteShader(C),r.deleteShader(A),O=new mp(r,b),R=lZ(r,b)}let O;this.getUniforms=function(){return O===void 0&&E(this),O};let R;this.getAttributes=function(){return R===void 0&&E(this),R};let T=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return T===!1&&(T=r.getProgramParameter(b,qH)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(b),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=eZ++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=C,this.fragmentShader=A,this}let bZ=0;class xZ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new wZ(e),t.set(e,i)),i}}class wZ{constructor(e){this.id=bZ++,this.code=e,this.usedTimes=0}}function SZ(n,e,t,i,r,s,o){const a=new pv,l=new xZ,c=new Set,h=[],d=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function b(R){return c.add(R),R===0?"uv":`uv${R}`}function v(R,T,k,Y,$){const re=Y.fog,ae=$.geometry,V=R.isMeshStandardMaterial?Y.environment:null,te=(R.isMeshStandardMaterial?t:e).get(R.envMap||V),J=te&&te.mapping===am?te.image.height:null,pe=y[R.type];R.precision!==null&&(m=r.getMaxPrecision(R.precision),m!==R.precision&&console.warn("THREE.WebGLProgram.getParameters:",R.precision,"not supported, using",m,"instead."));const Te=ae.morphAttributes.position||ae.morphAttributes.normal||ae.morphAttributes.color,Le=Te!==void 0?Te.length:0;let Ue=0;ae.morphAttributes.position!==void 0&&(Ue=1),ae.morphAttributes.normal!==void 0&&(Ue=2),ae.morphAttributes.color!==void 0&&(Ue=3);let tt,_e,Ae,We;if(pe){const Nt=Gs[pe];tt=Nt.vertexShader,_e=Nt.fragmentShader}else tt=R.vertexShader,_e=R.fragmentShader,l.update(R),Ae=l.getVertexShaderID(R),We=l.getFragmentShaderID(R);const se=n.getRenderTarget(),Se=n.state.buffers.depth.getReversed(),Me=$.isInstancedMesh===!0,De=$.isBatchedMesh===!0,Be=!!R.map,H=!!R.matcap,X=!!te,D=!!R.aoMap,ge=!!R.lightMap,me=!!R.bumpMap,fe=!!R.normalMap,N=!!R.displacementMap,B=!!R.emissiveMap,j=!!R.metalnessMap,L=!!R.roughnessMap,P=R.anisotropy>0,Z=R.clearcoat>0,G=R.dispersion>0,Q=R.iridescence>0,K=R.sheen>0,de=R.transmission>0,ye=P&&!!R.anisotropyMap,Pe=Z&&!!R.clearcoatMap,Qe=Z&&!!R.clearcoatNormalMap,Ne=Z&&!!R.clearcoatRoughnessMap,je=Q&&!!R.iridescenceMap,lt=Q&&!!R.iridescenceThicknessMap,ut=K&&!!R.sheenColorMap,Xe=K&&!!R.sheenRoughnessMap,ne=!!R.specularMap,Ee=!!R.specularColorMap,Ke=!!R.specularIntensityMap,ie=de&&!!R.transmissionMap,He=de&&!!R.thicknessMap,xe=!!R.gradientMap,ke=!!R.alphaMap,qe=R.alphaTest>0,Ye=!!R.alphaHash,ft=!!R.extensions;let tn=xa;R.toneMapped&&(se===null||se.isXRRenderTarget===!0)&&(tn=n.toneMapping);const wn={shaderID:pe,shaderType:R.type,shaderName:R.name,vertexShader:tt,fragmentShader:_e,defines:R.defines,customVertexShaderID:Ae,customFragmentShaderID:We,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:m,batching:De,batchingColor:De&&$._colorsTexture!==null,instancing:Me,instancingColor:Me&&$.instanceColor!==null,instancingMorph:Me&&$.morphTexture!==null,supportsVertexTextures:p,outputColorSpace:se===null?n.outputColorSpace:se.isXRRenderTarget===!0?se.texture.colorSpace:Wc,alphaToCoverage:!!R.alphaToCoverage,map:Be,matcap:H,envMap:X,envMapMode:X&&te.mapping,envMapCubeUVHeight:J,aoMap:D,lightMap:ge,bumpMap:me,normalMap:fe,displacementMap:p&&N,emissiveMap:B,normalMapObjectSpace:fe&&R.normalMapType===JW,normalMapTangentSpace:fe&&R.normalMapType===lm,metalnessMap:j,roughnessMap:L,anisotropy:P,anisotropyMap:ye,clearcoat:Z,clearcoatMap:Pe,clearcoatNormalMap:Qe,clearcoatRoughnessMap:Ne,dispersion:G,iridescence:Q,iridescenceMap:je,iridescenceThicknessMap:lt,sheen:K,sheenColorMap:ut,sheenRoughnessMap:Xe,specularMap:ne,specularColorMap:Ee,specularIntensityMap:Ke,transmission:de,transmissionMap:ie,thicknessMap:He,gradientMap:xe,opaque:R.transparent===!1&&R.blending===ba&&R.alphaToCoverage===!1,alphaMap:ke,alphaTest:qe,alphaHash:Ye,combine:R.combine,mapUv:Be&&b(R.map.channel),aoMapUv:D&&b(R.aoMap.channel),lightMapUv:ge&&b(R.lightMap.channel),bumpMapUv:me&&b(R.bumpMap.channel),normalMapUv:fe&&b(R.normalMap.channel),displacementMapUv:N&&b(R.displacementMap.channel),emissiveMapUv:B&&b(R.emissiveMap.channel),metalnessMapUv:j&&b(R.metalnessMap.channel),roughnessMapUv:L&&b(R.roughnessMap.channel),anisotropyMapUv:ye&&b(R.anisotropyMap.channel),clearcoatMapUv:Pe&&b(R.clearcoatMap.channel),clearcoatNormalMapUv:Qe&&b(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ne&&b(R.clearcoatRoughnessMap.channel),iridescenceMapUv:je&&b(R.iridescenceMap.channel),iridescenceThicknessMapUv:lt&&b(R.iridescenceThicknessMap.channel),sheenColorMapUv:ut&&b(R.sheenColorMap.channel),sheenRoughnessMapUv:Xe&&b(R.sheenRoughnessMap.channel),specularMapUv:ne&&b(R.specularMap.channel),specularColorMapUv:Ee&&b(R.specularColorMap.channel),specularIntensityMapUv:Ke&&b(R.specularIntensityMap.channel),transmissionMapUv:ie&&b(R.transmissionMap.channel),thicknessMapUv:He&&b(R.thicknessMap.channel),alphaMapUv:ke&&b(R.alphaMap.channel),vertexTangents:!!ae.attributes.tangent&&(fe||P),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!ae.attributes.color&&ae.attributes.color.itemSize===4,pointsUvs:$.isPoints===!0&&!!ae.attributes.uv&&(Be||ke),fog:!!re,useFog:R.fog===!0,fogExp2:!!re&&re.isFogExp2,flatShading:R.flatShading===!0,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:d,reverseDepthBuffer:Se,skinning:$.isSkinnedMesh===!0,morphTargets:ae.morphAttributes.position!==void 0,morphNormals:ae.morphAttributes.normal!==void 0,morphColors:ae.morphAttributes.color!==void 0,morphTargetsCount:Le,morphTextureStride:Ue,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numLightProbes:T.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:R.dithering,shadowMapEnabled:n.shadowMap.enabled&&k.length>0,shadowMapType:n.shadowMap.type,toneMapping:tn,decodeVideoTexture:Be&&R.map.isVideoTexture===!0&&Jt.getTransfer(R.map.colorSpace)===un,decodeVideoTextureEmissive:B&&R.emissiveMap.isVideoTexture===!0&&Jt.getTransfer(R.emissiveMap.colorSpace)===un,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===Yr,flipSided:R.side===Zi,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:ft&&R.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ft&&R.extensions.multiDraw===!0||De)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return wn.vertexUv1s=c.has(1),wn.vertexUv2s=c.has(2),wn.vertexUv3s=c.has(3),c.clear(),wn}function g(R){const T=[];if(R.shaderID?T.push(R.shaderID):(T.push(R.customVertexShaderID),T.push(R.customFragmentShaderID)),R.defines!==void 0)for(const k in R.defines)T.push(k),T.push(R.defines[k]);return R.isRawShaderMaterial===!1&&(x(T,R),w(T,R),T.push(n.outputColorSpace)),T.push(R.customProgramCacheKey),T.join()}function x(R,T){R.push(T.precision),R.push(T.outputColorSpace),R.push(T.envMapMode),R.push(T.envMapCubeUVHeight),R.push(T.mapUv),R.push(T.alphaMapUv),R.push(T.lightMapUv),R.push(T.aoMapUv),R.push(T.bumpMapUv),R.push(T.normalMapUv),R.push(T.displacementMapUv),R.push(T.emissiveMapUv),R.push(T.metalnessMapUv),R.push(T.roughnessMapUv),R.push(T.anisotropyMapUv),R.push(T.clearcoatMapUv),R.push(T.clearcoatNormalMapUv),R.push(T.clearcoatRoughnessMapUv),R.push(T.iridescenceMapUv),R.push(T.iridescenceThicknessMapUv),R.push(T.sheenColorMapUv),R.push(T.sheenRoughnessMapUv),R.push(T.specularMapUv),R.push(T.specularColorMapUv),R.push(T.specularIntensityMapUv),R.push(T.transmissionMapUv),R.push(T.thicknessMapUv),R.push(T.combine),R.push(T.fogExp2),R.push(T.sizeAttenuation),R.push(T.morphTargetsCount),R.push(T.morphAttributeCount),R.push(T.numDirLights),R.push(T.numPointLights),R.push(T.numSpotLights),R.push(T.numSpotLightMaps),R.push(T.numHemiLights),R.push(T.numRectAreaLights),R.push(T.numDirLightShadows),R.push(T.numPointLightShadows),R.push(T.numSpotLightShadows),R.push(T.numSpotLightShadowsWithMaps),R.push(T.numLightProbes),R.push(T.shadowMapType),R.push(T.toneMapping),R.push(T.numClippingPlanes),R.push(T.numClipIntersection),R.push(T.depthPacking)}function w(R,T){a.disableAll(),T.supportsVertexTextures&&a.enable(0),T.instancing&&a.enable(1),T.instancingColor&&a.enable(2),T.instancingMorph&&a.enable(3),T.matcap&&a.enable(4),T.envMap&&a.enable(5),T.normalMapObjectSpace&&a.enable(6),T.normalMapTangentSpace&&a.enable(7),T.clearcoat&&a.enable(8),T.iridescence&&a.enable(9),T.alphaTest&&a.enable(10),T.vertexColors&&a.enable(11),T.vertexAlphas&&a.enable(12),T.vertexUv1s&&a.enable(13),T.vertexUv2s&&a.enable(14),T.vertexUv3s&&a.enable(15),T.vertexTangents&&a.enable(16),T.anisotropy&&a.enable(17),T.alphaHash&&a.enable(18),T.batching&&a.enable(19),T.dispersion&&a.enable(20),T.batchingColor&&a.enable(21),R.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.reverseDepthBuffer&&a.enable(4),T.skinning&&a.enable(5),T.morphTargets&&a.enable(6),T.morphNormals&&a.enable(7),T.morphColors&&a.enable(8),T.premultipliedAlpha&&a.enable(9),T.shadowMapEnabled&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.transmission&&a.enable(15),T.sheen&&a.enable(16),T.opaque&&a.enable(17),T.pointsUvs&&a.enable(18),T.decodeVideoTexture&&a.enable(19),T.decodeVideoTextureEmissive&&a.enable(20),T.alphaToCoverage&&a.enable(21),R.push(a.mask)}function S(R){const T=y[R.type];let k;if(T){const Y=Gs[T];k=Eh.clone(Y.uniforms)}else k=R.uniforms;return k}function C(R,T){let k;for(let Y=0,$=h.length;Y<$;Y++){const re=h[Y];if(re.cacheKey===T){k=re,++k.usedTimes;break}}return k===void 0&&(k=new vZ(n,T,R,s),h.push(k)),k}function A(R){if(--R.usedTimes===0){const T=h.indexOf(R);h[T]=h[h.length-1],h.pop(),R.destroy()}}function E(R){l.remove(R)}function O(){l.dispose()}return{getParameters:v,getProgramCacheKey:g,getUniforms:S,acquireProgram:C,releaseProgram:A,releaseShaderCache:E,programs:h,dispose:O}}function MZ(){let n=new WeakMap;function e(o){return n.has(o)}function t(o){let a=n.get(o);return a===void 0&&(a={},n.set(o,a)),a}function i(o){n.delete(o)}function r(o,a,l){n.get(o)[a]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:i,update:r,dispose:s}}function TZ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function uM(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function hM(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(d,p,m,y,b,v){let g=n[e];return g===void 0?(g={id:d.id,object:d,geometry:p,material:m,groupOrder:y,renderOrder:d.renderOrder,z:b,group:v},n[e]=g):(g.id=d.id,g.object=d,g.geometry=p,g.material=m,g.groupOrder=y,g.renderOrder=d.renderOrder,g.z=b,g.group=v),e++,g}function a(d,p,m,y,b,v){const g=o(d,p,m,y,b,v);m.transmission>0?i.push(g):m.transparent===!0?r.push(g):t.push(g)}function l(d,p,m,y,b,v){const g=o(d,p,m,y,b,v);m.transmission>0?i.unshift(g):m.transparent===!0?r.unshift(g):t.unshift(g)}function c(d,p){t.length>1&&t.sort(d||TZ),i.length>1&&i.sort(p||uM),r.length>1&&r.sort(p||uM)}function h(){for(let d=e,p=n.length;d<p;d++){const m=n[d];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function EZ(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new hM,n.set(i,[o])):r>=s.length?(o=new hM,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function LZ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new U,color:new Ge};break;case"SpotLight":t={position:new U,direction:new U,color:new Ge,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new U,color:new Ge,distance:0,decay:0};break;case"HemisphereLight":t={direction:new U,skyColor:new Ge,groundColor:new Ge};break;case"RectAreaLight":t={color:new Ge,position:new U,halfWidth:new U,halfHeight:new U};break}return n[e.id]=t,t}}}function AZ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let CZ=0;function RZ(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function PZ(n){const e=new LZ,t=AZ(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new U);const r=new U,s=new nt,o=new nt;function a(c){let h=0,d=0,p=0;for(let R=0;R<9;R++)i.probe[R].set(0,0,0);let m=0,y=0,b=0,v=0,g=0,x=0,w=0,S=0,C=0,A=0,E=0;c.sort(RZ);for(let R=0,T=c.length;R<T;R++){const k=c[R],Y=k.color,$=k.intensity,re=k.distance,ae=k.shadow&&k.shadow.map?k.shadow.map.texture:null;if(k.isAmbientLight)h+=Y.r*$,d+=Y.g*$,p+=Y.b*$;else if(k.isLightProbe){for(let V=0;V<9;V++)i.probe[V].addScaledVector(k.sh.coefficients[V],$);E++}else if(k.isDirectionalLight){const V=e.get(k);if(V.color.copy(k.color).multiplyScalar(k.intensity),k.castShadow){const te=k.shadow,J=t.get(k);J.shadowIntensity=te.intensity,J.shadowBias=te.bias,J.shadowNormalBias=te.normalBias,J.shadowRadius=te.radius,J.shadowMapSize=te.mapSize,i.directionalShadow[m]=J,i.directionalShadowMap[m]=ae,i.directionalShadowMatrix[m]=k.shadow.matrix,x++}i.directional[m]=V,m++}else if(k.isSpotLight){const V=e.get(k);V.position.setFromMatrixPosition(k.matrixWorld),V.color.copy(Y).multiplyScalar($),V.distance=re,V.coneCos=Math.cos(k.angle),V.penumbraCos=Math.cos(k.angle*(1-k.penumbra)),V.decay=k.decay,i.spot[b]=V;const te=k.shadow;if(k.map&&(i.spotLightMap[C]=k.map,C++,te.updateMatrices(k),k.castShadow&&A++),i.spotLightMatrix[b]=te.matrix,k.castShadow){const J=t.get(k);J.shadowIntensity=te.intensity,J.shadowBias=te.bias,J.shadowNormalBias=te.normalBias,J.shadowRadius=te.radius,J.shadowMapSize=te.mapSize,i.spotShadow[b]=J,i.spotShadowMap[b]=ae,S++}b++}else if(k.isRectAreaLight){const V=e.get(k);V.color.copy(Y).multiplyScalar($),V.halfWidth.set(k.width*.5,0,0),V.halfHeight.set(0,k.height*.5,0),i.rectArea[v]=V,v++}else if(k.isPointLight){const V=e.get(k);if(V.color.copy(k.color).multiplyScalar(k.intensity),V.distance=k.distance,V.decay=k.decay,k.castShadow){const te=k.shadow,J=t.get(k);J.shadowIntensity=te.intensity,J.shadowBias=te.bias,J.shadowNormalBias=te.normalBias,J.shadowRadius=te.radius,J.shadowMapSize=te.mapSize,J.shadowCameraNear=te.camera.near,J.shadowCameraFar=te.camera.far,i.pointShadow[y]=J,i.pointShadowMap[y]=ae,i.pointShadowMatrix[y]=k.shadow.matrix,w++}i.point[y]=V,y++}else if(k.isHemisphereLight){const V=e.get(k);V.skyColor.copy(k.color).multiplyScalar($),V.groundColor.copy(k.groundColor).multiplyScalar($),i.hemi[g]=V,g++}}v>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Je.LTC_FLOAT_1,i.rectAreaLTC2=Je.LTC_FLOAT_2):(i.rectAreaLTC1=Je.LTC_HALF_1,i.rectAreaLTC2=Je.LTC_HALF_2)),i.ambient[0]=h,i.ambient[1]=d,i.ambient[2]=p;const O=i.hash;(O.directionalLength!==m||O.pointLength!==y||O.spotLength!==b||O.rectAreaLength!==v||O.hemiLength!==g||O.numDirectionalShadows!==x||O.numPointShadows!==w||O.numSpotShadows!==S||O.numSpotMaps!==C||O.numLightProbes!==E)&&(i.directional.length=m,i.spot.length=b,i.rectArea.length=v,i.point.length=y,i.hemi.length=g,i.directionalShadow.length=x,i.directionalShadowMap.length=x,i.pointShadow.length=w,i.pointShadowMap.length=w,i.spotShadow.length=S,i.spotShadowMap.length=S,i.directionalShadowMatrix.length=x,i.pointShadowMatrix.length=w,i.spotLightMatrix.length=S+C-A,i.spotLightMap.length=C,i.numSpotLightShadowsWithMaps=A,i.numLightProbes=E,O.directionalLength=m,O.pointLength=y,O.spotLength=b,O.rectAreaLength=v,O.hemiLength=g,O.numDirectionalShadows=x,O.numPointShadows=w,O.numSpotShadows=S,O.numSpotMaps=C,O.numLightProbes=E,i.version=CZ++)}function l(c,h){let d=0,p=0,m=0,y=0,b=0;const v=h.matrixWorldInverse;for(let g=0,x=c.length;g<x;g++){const w=c[g];if(w.isDirectionalLight){const S=i.directional[d];S.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),S.direction.sub(r),S.direction.transformDirection(v),d++}else if(w.isSpotLight){const S=i.spot[m];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(v),S.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),S.direction.sub(r),S.direction.transformDirection(v),m++}else if(w.isRectAreaLight){const S=i.rectArea[y];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(v),o.identity(),s.copy(w.matrixWorld),s.premultiply(v),o.extractRotation(s),S.halfWidth.set(w.width*.5,0,0),S.halfHeight.set(0,w.height*.5,0),S.halfWidth.applyMatrix4(o),S.halfHeight.applyMatrix4(o),y++}else if(w.isPointLight){const S=i.point[p];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(v),p++}else if(w.isHemisphereLight){const S=i.hemi[b];S.direction.setFromMatrixPosition(w.matrixWorld),S.direction.transformDirection(v),b++}}}return{setup:a,setupView:l,state:i}}function dM(n){const e=new PZ(n),t=[],i=[];function r(h){c.camera=h,t.length=0,i.length=0}function s(h){t.push(h)}function o(h){i.push(h)}function a(){e.setup(t)}function l(h){e.setupView(t,h)}const c={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function IZ(n){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new dM(n),e.set(r,[a])):s>=o.length?(a=new dM(n),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:t,dispose:i}}const DZ=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,NZ=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function OZ(n,e,t){let i=new um;const r=new Ie,s=new Ie,o=new Ct,a=new PG({depthPacking:KW}),l=new IG,c={},h=t.maxTextureSize,d={[ns]:Zi,[Zi]:ns,[Yr]:Yr},p=new rs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ie},radius:{value:4}},vertexShader:DZ,fragmentShader:NZ}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const y=new fn;y.setAttribute("position",new Ln(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new Xt(y,p),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=yL;let g=this.type;this.render=function(A,E,O){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||A.length===0)return;const R=n.getRenderTarget(),T=n.getActiveCubeFace(),k=n.getActiveMipmapLevel(),Y=n.state;Y.setBlending(va),Y.buffers.color.setClear(1,1,1,1),Y.buffers.depth.setTest(!0),Y.setScissorTest(!1);const $=g!==wo&&this.type===wo,re=g===wo&&this.type!==wo;for(let ae=0,V=A.length;ae<V;ae++){const te=A[ae],J=te.shadow;if(J===void 0){console.warn("THREE.WebGLShadowMap:",te,"has no shadow.");continue}if(J.autoUpdate===!1&&J.needsUpdate===!1)continue;r.copy(J.mapSize);const pe=J.getFrameExtents();if(r.multiply(pe),s.copy(J.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/pe.x),r.x=s.x*pe.x,J.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/pe.y),r.y=s.y*pe.y,J.mapSize.y=s.y)),J.map===null||$===!0||re===!0){const Le=this.type!==wo?{minFilter:or,magFilter:or}:{};J.map!==null&&J.map.dispose(),J.map=new Ma(r.x,r.y,Le),J.map.texture.name=te.name+".shadowMap",J.camera.updateProjectionMatrix()}n.setRenderTarget(J.map),n.clear();const Te=J.getViewportCount();for(let Le=0;Le<Te;Le++){const Ue=J.getViewport(Le);o.set(s.x*Ue.x,s.y*Ue.y,s.x*Ue.z,s.y*Ue.w),Y.viewport(o),J.updateMatrices(te,Le),i=J.getFrustum(),S(E,O,J.camera,te,this.type)}J.isPointLightShadow!==!0&&this.type===wo&&x(J,O),J.needsUpdate=!1}g=this.type,v.needsUpdate=!1,n.setRenderTarget(R,T,k)};function x(A,E){const O=e.update(b);p.defines.VSM_SAMPLES!==A.blurSamples&&(p.defines.VSM_SAMPLES=A.blurSamples,m.defines.VSM_SAMPLES=A.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new Ma(r.x,r.y)),p.uniforms.shadow_pass.value=A.map.texture,p.uniforms.resolution.value=A.mapSize,p.uniforms.radius.value=A.radius,n.setRenderTarget(A.mapPass),n.clear(),n.renderBufferDirect(E,null,O,p,b,null),m.uniforms.shadow_pass.value=A.mapPass.texture,m.uniforms.resolution.value=A.mapSize,m.uniforms.radius.value=A.radius,n.setRenderTarget(A.map),n.clear(),n.renderBufferDirect(E,null,O,m,b,null)}function w(A,E,O,R){let T=null;const k=O.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(k!==void 0)T=k;else if(T=O.isPointLight===!0?l:a,n.localClippingEnabled&&E.clipShadows===!0&&Array.isArray(E.clippingPlanes)&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0){const Y=T.uuid,$=E.uuid;let re=c[Y];re===void 0&&(re={},c[Y]=re);let ae=re[$];ae===void 0&&(ae=T.clone(),re[$]=ae,E.addEventListener("dispose",C)),T=ae}if(T.visible=E.visible,T.wireframe=E.wireframe,R===wo?T.side=E.shadowSide!==null?E.shadowSide:E.side:T.side=E.shadowSide!==null?E.shadowSide:d[E.side],T.alphaMap=E.alphaMap,T.alphaTest=E.alphaTest,T.map=E.map,T.clipShadows=E.clipShadows,T.clippingPlanes=E.clippingPlanes,T.clipIntersection=E.clipIntersection,T.displacementMap=E.displacementMap,T.displacementScale=E.displacementScale,T.displacementBias=E.displacementBias,T.wireframeLinewidth=E.wireframeLinewidth,T.linewidth=E.linewidth,O.isPointLight===!0&&T.isMeshDistanceMaterial===!0){const Y=n.properties.get(T);Y.light=O}return T}function S(A,E,O,R,T){if(A.visible===!1)return;if(A.layers.test(E.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&T===wo)&&(!A.frustumCulled||i.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,A.matrixWorld);const $=e.update(A),re=A.material;if(Array.isArray(re)){const ae=$.groups;for(let V=0,te=ae.length;V<te;V++){const J=ae[V],pe=re[J.materialIndex];if(pe&&pe.visible){const Te=w(A,pe,R,T);A.onBeforeShadow(n,A,E,O,$,Te,J),n.renderBufferDirect(O,null,$,Te,A,J),A.onAfterShadow(n,A,E,O,$,Te,J)}}}else if(re.visible){const ae=w(A,re,R,T);A.onBeforeShadow(n,A,E,O,$,ae,null),n.renderBufferDirect(O,null,$,ae,A,null),A.onAfterShadow(n,A,E,O,$,ae,null)}}const Y=A.children;for(let $=0,re=Y.length;$<re;$++)S(Y[$],E,O,R,T)}function C(A){A.target.removeEventListener("dispose",C);for(const O in c){const R=c[O],T=A.target.uuid;T in R&&(R[T].dispose(),delete R[T])}}}const kZ={[I0]:D0,[N0]:F0,[O0]:U0,[Oc]:k0,[D0]:I0,[F0]:N0,[U0]:O0,[k0]:Oc};function FZ(n,e){function t(){let ie=!1;const He=new Ct;let xe=null;const ke=new Ct(0,0,0,0);return{setMask:function(qe){xe!==qe&&!ie&&(n.colorMask(qe,qe,qe,qe),xe=qe)},setLocked:function(qe){ie=qe},setClear:function(qe,Ye,ft,tn,wn){wn===!0&&(qe*=tn,Ye*=tn,ft*=tn),He.set(qe,Ye,ft,tn),ke.equals(He)===!1&&(n.clearColor(qe,Ye,ft,tn),ke.copy(He))},reset:function(){ie=!1,xe=null,ke.set(-1,0,0,0)}}}function i(){let ie=!1,He=!1,xe=null,ke=null,qe=null;return{setReversed:function(Ye){if(He!==Ye){const ft=e.get("EXT_clip_control");He?ft.clipControlEXT(ft.LOWER_LEFT_EXT,ft.ZERO_TO_ONE_EXT):ft.clipControlEXT(ft.LOWER_LEFT_EXT,ft.NEGATIVE_ONE_TO_ONE_EXT);const tn=qe;qe=null,this.setClear(tn)}He=Ye},getReversed:function(){return He},setTest:function(Ye){Ye?se(n.DEPTH_TEST):Se(n.DEPTH_TEST)},setMask:function(Ye){xe!==Ye&&!ie&&(n.depthMask(Ye),xe=Ye)},setFunc:function(Ye){if(He&&(Ye=kZ[Ye]),ke!==Ye){switch(Ye){case I0:n.depthFunc(n.NEVER);break;case D0:n.depthFunc(n.ALWAYS);break;case N0:n.depthFunc(n.LESS);break;case Oc:n.depthFunc(n.LEQUAL);break;case O0:n.depthFunc(n.EQUAL);break;case k0:n.depthFunc(n.GEQUAL);break;case F0:n.depthFunc(n.GREATER);break;case U0:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}ke=Ye}},setLocked:function(Ye){ie=Ye},setClear:function(Ye){qe!==Ye&&(He&&(Ye=1-Ye),n.clearDepth(Ye),qe=Ye)},reset:function(){ie=!1,xe=null,ke=null,qe=null,He=!1}}}function r(){let ie=!1,He=null,xe=null,ke=null,qe=null,Ye=null,ft=null,tn=null,wn=null;return{setTest:function(Nt){ie||(Nt?se(n.STENCIL_TEST):Se(n.STENCIL_TEST))},setMask:function(Nt){He!==Nt&&!ie&&(n.stencilMask(Nt),He=Nt)},setFunc:function(Nt,mi,os){(xe!==Nt||ke!==mi||qe!==os)&&(n.stencilFunc(Nt,mi,os),xe=Nt,ke=mi,qe=os)},setOp:function(Nt,mi,os){(Ye!==Nt||ft!==mi||tn!==os)&&(n.stencilOp(Nt,mi,os),Ye=Nt,ft=mi,tn=os)},setLocked:function(Nt){ie=Nt},setClear:function(Nt){wn!==Nt&&(n.clearStencil(Nt),wn=Nt)},reset:function(){ie=!1,He=null,xe=null,ke=null,qe=null,Ye=null,ft=null,tn=null,wn=null}}}const s=new t,o=new i,a=new r,l=new WeakMap,c=new WeakMap;let h={},d={},p=new WeakMap,m=[],y=null,b=!1,v=null,g=null,x=null,w=null,S=null,C=null,A=null,E=new Ge(0,0,0),O=0,R=!1,T=null,k=null,Y=null,$=null,re=null;const ae=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let V=!1,te=0;const J=n.getParameter(n.VERSION);J.indexOf("WebGL")!==-1?(te=parseFloat(/^WebGL (\d)/.exec(J)[1]),V=te>=1):J.indexOf("OpenGL ES")!==-1&&(te=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),V=te>=2);let pe=null,Te={};const Le=n.getParameter(n.SCISSOR_BOX),Ue=n.getParameter(n.VIEWPORT),tt=new Ct().fromArray(Le),_e=new Ct().fromArray(Ue);function Ae(ie,He,xe,ke){const qe=new Uint8Array(4),Ye=n.createTexture();n.bindTexture(ie,Ye),n.texParameteri(ie,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ie,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let ft=0;ft<xe;ft++)ie===n.TEXTURE_3D||ie===n.TEXTURE_2D_ARRAY?n.texImage3D(He,0,n.RGBA,1,1,ke,0,n.RGBA,n.UNSIGNED_BYTE,qe):n.texImage2D(He+ft,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,qe);return Ye}const We={};We[n.TEXTURE_2D]=Ae(n.TEXTURE_2D,n.TEXTURE_2D,1),We[n.TEXTURE_CUBE_MAP]=Ae(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),We[n.TEXTURE_2D_ARRAY]=Ae(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),We[n.TEXTURE_3D]=Ae(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),se(n.DEPTH_TEST),o.setFunc(Oc),me(!1),fe(z1),se(n.CULL_FACE),D(va);function se(ie){h[ie]!==!0&&(n.enable(ie),h[ie]=!0)}function Se(ie){h[ie]!==!1&&(n.disable(ie),h[ie]=!1)}function Me(ie,He){return d[ie]!==He?(n.bindFramebuffer(ie,He),d[ie]=He,ie===n.DRAW_FRAMEBUFFER&&(d[n.FRAMEBUFFER]=He),ie===n.FRAMEBUFFER&&(d[n.DRAW_FRAMEBUFFER]=He),!0):!1}function De(ie,He){let xe=m,ke=!1;if(ie){xe=p.get(He),xe===void 0&&(xe=[],p.set(He,xe));const qe=ie.textures;if(xe.length!==qe.length||xe[0]!==n.COLOR_ATTACHMENT0){for(let Ye=0,ft=qe.length;Ye<ft;Ye++)xe[Ye]=n.COLOR_ATTACHMENT0+Ye;xe.length=qe.length,ke=!0}}else xe[0]!==n.BACK&&(xe[0]=n.BACK,ke=!0);ke&&n.drawBuffers(xe)}function Be(ie){return y!==ie?(n.useProgram(ie),y=ie,!0):!1}const H={[nl]:n.FUNC_ADD,[vW]:n.FUNC_SUBTRACT,[bW]:n.FUNC_REVERSE_SUBTRACT};H[xW]=n.MIN,H[wW]=n.MAX;const X={[SW]:n.ZERO,[MW]:n.ONE,[TW]:n.SRC_COLOR,[R0]:n.SRC_ALPHA,[PW]:n.SRC_ALPHA_SATURATE,[CW]:n.DST_COLOR,[LW]:n.DST_ALPHA,[EW]:n.ONE_MINUS_SRC_COLOR,[P0]:n.ONE_MINUS_SRC_ALPHA,[RW]:n.ONE_MINUS_DST_COLOR,[AW]:n.ONE_MINUS_DST_ALPHA,[IW]:n.CONSTANT_COLOR,[DW]:n.ONE_MINUS_CONSTANT_COLOR,[NW]:n.CONSTANT_ALPHA,[OW]:n.ONE_MINUS_CONSTANT_ALPHA};function D(ie,He,xe,ke,qe,Ye,ft,tn,wn,Nt){if(ie===va){b===!0&&(Se(n.BLEND),b=!1);return}if(b===!1&&(se(n.BLEND),b=!0),ie!==_W){if(ie!==v||Nt!==R){if((g!==nl||S!==nl)&&(n.blendEquation(n.FUNC_ADD),g=nl,S=nl),Nt)switch(ie){case ba:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case xh:n.blendFunc(n.ONE,n.ONE);break;case W1:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case V1:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ie);break}else switch(ie){case ba:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case xh:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case W1:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case V1:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ie);break}x=null,w=null,C=null,A=null,E.set(0,0,0),O=0,v=ie,R=Nt}return}qe=qe||He,Ye=Ye||xe,ft=ft||ke,(He!==g||qe!==S)&&(n.blendEquationSeparate(H[He],H[qe]),g=He,S=qe),(xe!==x||ke!==w||Ye!==C||ft!==A)&&(n.blendFuncSeparate(X[xe],X[ke],X[Ye],X[ft]),x=xe,w=ke,C=Ye,A=ft),(tn.equals(E)===!1||wn!==O)&&(n.blendColor(tn.r,tn.g,tn.b,wn),E.copy(tn),O=wn),v=ie,R=!1}function ge(ie,He){ie.side===Yr?Se(n.CULL_FACE):se(n.CULL_FACE);let xe=ie.side===Zi;He&&(xe=!xe),me(xe),ie.blending===ba&&ie.transparent===!1?D(va):D(ie.blending,ie.blendEquation,ie.blendSrc,ie.blendDst,ie.blendEquationAlpha,ie.blendSrcAlpha,ie.blendDstAlpha,ie.blendColor,ie.blendAlpha,ie.premultipliedAlpha),o.setFunc(ie.depthFunc),o.setTest(ie.depthTest),o.setMask(ie.depthWrite),s.setMask(ie.colorWrite);const ke=ie.stencilWrite;a.setTest(ke),ke&&(a.setMask(ie.stencilWriteMask),a.setFunc(ie.stencilFunc,ie.stencilRef,ie.stencilFuncMask),a.setOp(ie.stencilFail,ie.stencilZFail,ie.stencilZPass)),B(ie.polygonOffset,ie.polygonOffsetFactor,ie.polygonOffsetUnits),ie.alphaToCoverage===!0?se(n.SAMPLE_ALPHA_TO_COVERAGE):Se(n.SAMPLE_ALPHA_TO_COVERAGE)}function me(ie){T!==ie&&(ie?n.frontFace(n.CW):n.frontFace(n.CCW),T=ie)}function fe(ie){ie!==gW?(se(n.CULL_FACE),ie!==k&&(ie===z1?n.cullFace(n.BACK):ie===yW?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Se(n.CULL_FACE),k=ie}function N(ie){ie!==Y&&(V&&n.lineWidth(ie),Y=ie)}function B(ie,He,xe){ie?(se(n.POLYGON_OFFSET_FILL),($!==He||re!==xe)&&(n.polygonOffset(He,xe),$=He,re=xe)):Se(n.POLYGON_OFFSET_FILL)}function j(ie){ie?se(n.SCISSOR_TEST):Se(n.SCISSOR_TEST)}function L(ie){ie===void 0&&(ie=n.TEXTURE0+ae-1),pe!==ie&&(n.activeTexture(ie),pe=ie)}function P(ie,He,xe){xe===void 0&&(pe===null?xe=n.TEXTURE0+ae-1:xe=pe);let ke=Te[xe];ke===void 0&&(ke={type:void 0,texture:void 0},Te[xe]=ke),(ke.type!==ie||ke.texture!==He)&&(pe!==xe&&(n.activeTexture(xe),pe=xe),n.bindTexture(ie,He||We[ie]),ke.type=ie,ke.texture=He)}function Z(){const ie=Te[pe];ie!==void 0&&ie.type!==void 0&&(n.bindTexture(ie.type,null),ie.type=void 0,ie.texture=void 0)}function G(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Q(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function K(){try{n.texSubImage2D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function de(){try{n.texSubImage3D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ye(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Pe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Qe(){try{n.texStorage2D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Ne(){try{n.texStorage3D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function je(){try{n.texImage2D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function lt(){try{n.texImage3D.apply(n,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ut(ie){tt.equals(ie)===!1&&(n.scissor(ie.x,ie.y,ie.z,ie.w),tt.copy(ie))}function Xe(ie){_e.equals(ie)===!1&&(n.viewport(ie.x,ie.y,ie.z,ie.w),_e.copy(ie))}function ne(ie,He){let xe=c.get(He);xe===void 0&&(xe=new WeakMap,c.set(He,xe));let ke=xe.get(ie);ke===void 0&&(ke=n.getUniformBlockIndex(He,ie.name),xe.set(ie,ke))}function Ee(ie,He){const ke=c.get(He).get(ie);l.get(He)!==ke&&(n.uniformBlockBinding(He,ke,ie.__bindingPointIndex),l.set(He,ke))}function Ke(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),o.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},pe=null,Te={},d={},p=new WeakMap,m=[],y=null,b=!1,v=null,g=null,x=null,w=null,S=null,C=null,A=null,E=new Ge(0,0,0),O=0,R=!1,T=null,k=null,Y=null,$=null,re=null,tt.set(0,0,n.canvas.width,n.canvas.height),_e.set(0,0,n.canvas.width,n.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:se,disable:Se,bindFramebuffer:Me,drawBuffers:De,useProgram:Be,setBlending:D,setMaterial:ge,setFlipSided:me,setCullFace:fe,setLineWidth:N,setPolygonOffset:B,setScissorTest:j,activeTexture:L,bindTexture:P,unbindTexture:Z,compressedTexImage2D:G,compressedTexImage3D:Q,texImage2D:je,texImage3D:lt,updateUBOMapping:ne,uniformBlockBinding:Ee,texStorage2D:Qe,texStorage3D:Ne,texSubImage2D:K,texSubImage3D:de,compressedTexSubImage2D:ye,compressedTexSubImage3D:Pe,scissor:ut,viewport:Xe,reset:Ke}}function UZ(n,e,t,i,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Ie,h=new WeakMap;let d;const p=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(L,P){return m?new OffscreenCanvas(L,P):Th("canvas")}function b(L,P,Z){let G=1;const Q=j(L);if((Q.width>Z||Q.height>Z)&&(G=Z/Math.max(Q.width,Q.height)),G<1)if(typeof HTMLImageElement<"u"&&L instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&L instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&L instanceof ImageBitmap||typeof VideoFrame<"u"&&L instanceof VideoFrame){const K=Math.floor(G*Q.width),de=Math.floor(G*Q.height);d===void 0&&(d=y(K,de));const ye=P?y(K,de):d;return ye.width=K,ye.height=de,ye.getContext("2d").drawImage(L,0,0,K,de),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Q.width+"x"+Q.height+") to ("+K+"x"+de+")."),ye}else return"data"in L&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Q.width+"x"+Q.height+")."),L;return L}function v(L){return L.generateMipmaps}function g(L){n.generateMipmap(L)}function x(L){return L.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:L.isWebGL3DRenderTarget?n.TEXTURE_3D:L.isWebGLArrayRenderTarget||L.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function w(L,P,Z,G,Q=!1){if(L!==null){if(n[L]!==void 0)return n[L];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+L+"'")}let K=P;if(P===n.RED&&(Z===n.FLOAT&&(K=n.R32F),Z===n.HALF_FLOAT&&(K=n.R16F),Z===n.UNSIGNED_BYTE&&(K=n.R8)),P===n.RED_INTEGER&&(Z===n.UNSIGNED_BYTE&&(K=n.R8UI),Z===n.UNSIGNED_SHORT&&(K=n.R16UI),Z===n.UNSIGNED_INT&&(K=n.R32UI),Z===n.BYTE&&(K=n.R8I),Z===n.SHORT&&(K=n.R16I),Z===n.INT&&(K=n.R32I)),P===n.RG&&(Z===n.FLOAT&&(K=n.RG32F),Z===n.HALF_FLOAT&&(K=n.RG16F),Z===n.UNSIGNED_BYTE&&(K=n.RG8)),P===n.RG_INTEGER&&(Z===n.UNSIGNED_BYTE&&(K=n.RG8UI),Z===n.UNSIGNED_SHORT&&(K=n.RG16UI),Z===n.UNSIGNED_INT&&(K=n.RG32UI),Z===n.BYTE&&(K=n.RG8I),Z===n.SHORT&&(K=n.RG16I),Z===n.INT&&(K=n.RG32I)),P===n.RGB_INTEGER&&(Z===n.UNSIGNED_BYTE&&(K=n.RGB8UI),Z===n.UNSIGNED_SHORT&&(K=n.RGB16UI),Z===n.UNSIGNED_INT&&(K=n.RGB32UI),Z===n.BYTE&&(K=n.RGB8I),Z===n.SHORT&&(K=n.RGB16I),Z===n.INT&&(K=n.RGB32I)),P===n.RGBA_INTEGER&&(Z===n.UNSIGNED_BYTE&&(K=n.RGBA8UI),Z===n.UNSIGNED_SHORT&&(K=n.RGBA16UI),Z===n.UNSIGNED_INT&&(K=n.RGBA32UI),Z===n.BYTE&&(K=n.RGBA8I),Z===n.SHORT&&(K=n.RGBA16I),Z===n.INT&&(K=n.RGBA32I)),P===n.RGB&&Z===n.UNSIGNED_INT_5_9_9_9_REV&&(K=n.RGB9_E5),P===n.RGBA){const de=Q?Pp:Jt.getTransfer(G);Z===n.FLOAT&&(K=n.RGBA32F),Z===n.HALF_FLOAT&&(K=n.RGBA16F),Z===n.UNSIGNED_BYTE&&(K=de===un?n.SRGB8_ALPHA8:n.RGBA8),Z===n.UNSIGNED_SHORT_4_4_4_4&&(K=n.RGBA4),Z===n.UNSIGNED_SHORT_5_5_5_1&&(K=n.RGB5_A1)}return(K===n.R16F||K===n.R32F||K===n.RG16F||K===n.RG32F||K===n.RGBA16F||K===n.RGBA32F)&&e.get("EXT_color_buffer_float"),K}function S(L,P){let Z;return L?P===null||P===ml||P===Uc?Z=n.DEPTH24_STENCIL8:P===rr?Z=n.DEPTH32F_STENCIL8:P===wh&&(Z=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):P===null||P===ml||P===Uc?Z=n.DEPTH_COMPONENT24:P===rr?Z=n.DEPTH_COMPONENT32F:P===wh&&(Z=n.DEPTH_COMPONENT16),Z}function C(L,P){return v(L)===!0||L.isFramebufferTexture&&L.minFilter!==or&&L.minFilter!==ui?Math.log2(Math.max(P.width,P.height))+1:L.mipmaps!==void 0&&L.mipmaps.length>0?L.mipmaps.length:L.isCompressedTexture&&Array.isArray(L.image)?P.mipmaps.length:1}function A(L){const P=L.target;P.removeEventListener("dispose",A),O(P),P.isVideoTexture&&h.delete(P)}function E(L){const P=L.target;P.removeEventListener("dispose",E),T(P)}function O(L){const P=i.get(L);if(P.__webglInit===void 0)return;const Z=L.source,G=p.get(Z);if(G){const Q=G[P.__cacheKey];Q.usedTimes--,Q.usedTimes===0&&R(L),Object.keys(G).length===0&&p.delete(Z)}i.remove(L)}function R(L){const P=i.get(L);n.deleteTexture(P.__webglTexture);const Z=L.source,G=p.get(Z);delete G[P.__cacheKey],o.memory.textures--}function T(L){const P=i.get(L);if(L.depthTexture&&(L.depthTexture.dispose(),i.remove(L.depthTexture)),L.isWebGLCubeRenderTarget)for(let G=0;G<6;G++){if(Array.isArray(P.__webglFramebuffer[G]))for(let Q=0;Q<P.__webglFramebuffer[G].length;Q++)n.deleteFramebuffer(P.__webglFramebuffer[G][Q]);else n.deleteFramebuffer(P.__webglFramebuffer[G]);P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer[G])}else{if(Array.isArray(P.__webglFramebuffer))for(let G=0;G<P.__webglFramebuffer.length;G++)n.deleteFramebuffer(P.__webglFramebuffer[G]);else n.deleteFramebuffer(P.__webglFramebuffer);if(P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer),P.__webglMultisampledFramebuffer&&n.deleteFramebuffer(P.__webglMultisampledFramebuffer),P.__webglColorRenderbuffer)for(let G=0;G<P.__webglColorRenderbuffer.length;G++)P.__webglColorRenderbuffer[G]&&n.deleteRenderbuffer(P.__webglColorRenderbuffer[G]);P.__webglDepthRenderbuffer&&n.deleteRenderbuffer(P.__webglDepthRenderbuffer)}const Z=L.textures;for(let G=0,Q=Z.length;G<Q;G++){const K=i.get(Z[G]);K.__webglTexture&&(n.deleteTexture(K.__webglTexture),o.memory.textures--),i.remove(Z[G])}i.remove(L)}let k=0;function Y(){k=0}function $(){const L=k;return L>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+L+" texture units while this GPU supports only "+r.maxTextures),k+=1,L}function re(L){const P=[];return P.push(L.wrapS),P.push(L.wrapT),P.push(L.wrapR||0),P.push(L.magFilter),P.push(L.minFilter),P.push(L.anisotropy),P.push(L.internalFormat),P.push(L.format),P.push(L.type),P.push(L.generateMipmaps),P.push(L.premultiplyAlpha),P.push(L.flipY),P.push(L.unpackAlignment),P.push(L.colorSpace),P.join()}function ae(L,P){const Z=i.get(L);if(L.isVideoTexture&&N(L),L.isRenderTargetTexture===!1&&L.version>0&&Z.__version!==L.version){const G=L.image;if(G===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(G.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{_e(Z,L,P);return}}t.bindTexture(n.TEXTURE_2D,Z.__webglTexture,n.TEXTURE0+P)}function V(L,P){const Z=i.get(L);if(L.version>0&&Z.__version!==L.version){_e(Z,L,P);return}t.bindTexture(n.TEXTURE_2D_ARRAY,Z.__webglTexture,n.TEXTURE0+P)}function te(L,P){const Z=i.get(L);if(L.version>0&&Z.__version!==L.version){_e(Z,L,P);return}t.bindTexture(n.TEXTURE_3D,Z.__webglTexture,n.TEXTURE0+P)}function J(L,P){const Z=i.get(L);if(L.version>0&&Z.__version!==L.version){Ae(Z,L,P);return}t.bindTexture(n.TEXTURE_CUBE_MAP,Z.__webglTexture,n.TEXTURE0+P)}const pe={[is]:n.REPEAT,[Qr]:n.CLAMP_TO_EDGE,[Cp]:n.MIRRORED_REPEAT},Te={[or]:n.NEAREST,[bL]:n.NEAREST_MIPMAP_NEAREST,[Gu]:n.NEAREST_MIPMAP_LINEAR,[ui]:n.LINEAR,[lp]:n.LINEAR_MIPMAP_NEAREST,[Pr]:n.LINEAR_MIPMAP_LINEAR},Le={[QW]:n.NEVER,[iV]:n.ALWAYS,[$W]:n.LESS,[DL]:n.LEQUAL,[qW]:n.EQUAL,[nV]:n.GEQUAL,[eV]:n.GREATER,[tV]:n.NOTEQUAL};function Ue(L,P){if(P.type===rr&&e.has("OES_texture_float_linear")===!1&&(P.magFilter===ui||P.magFilter===lp||P.magFilter===Gu||P.magFilter===Pr||P.minFilter===ui||P.minFilter===lp||P.minFilter===Gu||P.minFilter===Pr)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(L,n.TEXTURE_WRAP_S,pe[P.wrapS]),n.texParameteri(L,n.TEXTURE_WRAP_T,pe[P.wrapT]),(L===n.TEXTURE_3D||L===n.TEXTURE_2D_ARRAY)&&n.texParameteri(L,n.TEXTURE_WRAP_R,pe[P.wrapR]),n.texParameteri(L,n.TEXTURE_MAG_FILTER,Te[P.magFilter]),n.texParameteri(L,n.TEXTURE_MIN_FILTER,Te[P.minFilter]),P.compareFunction&&(n.texParameteri(L,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(L,n.TEXTURE_COMPARE_FUNC,Le[P.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(P.magFilter===or||P.minFilter!==Gu&&P.minFilter!==Pr||P.type===rr&&e.has("OES_texture_float_linear")===!1)return;if(P.anisotropy>1||i.get(P).__currentAnisotropy){const Z=e.get("EXT_texture_filter_anisotropic");n.texParameterf(L,Z.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,r.getMaxAnisotropy())),i.get(P).__currentAnisotropy=P.anisotropy}}}function tt(L,P){let Z=!1;L.__webglInit===void 0&&(L.__webglInit=!0,P.addEventListener("dispose",A));const G=P.source;let Q=p.get(G);Q===void 0&&(Q={},p.set(G,Q));const K=re(P);if(K!==L.__cacheKey){Q[K]===void 0&&(Q[K]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,Z=!0),Q[K].usedTimes++;const de=Q[L.__cacheKey];de!==void 0&&(Q[L.__cacheKey].usedTimes--,de.usedTimes===0&&R(P)),L.__cacheKey=K,L.__webglTexture=Q[K].texture}return Z}function _e(L,P,Z){let G=n.TEXTURE_2D;(P.isDataArrayTexture||P.isCompressedArrayTexture)&&(G=n.TEXTURE_2D_ARRAY),P.isData3DTexture&&(G=n.TEXTURE_3D);const Q=tt(L,P),K=P.source;t.bindTexture(G,L.__webglTexture,n.TEXTURE0+Z);const de=i.get(K);if(K.version!==de.__version||Q===!0){t.activeTexture(n.TEXTURE0+Z);const ye=Jt.getPrimaries(Jt.workingColorSpace),Pe=P.colorSpace===da?null:Jt.getPrimaries(P.colorSpace),Qe=P.colorSpace===da||ye===Pe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qe);let Ne=b(P.image,!1,r.maxTextureSize);Ne=B(P,Ne);const je=s.convert(P.format,P.colorSpace),lt=s.convert(P.type);let ut=w(P.internalFormat,je,lt,P.colorSpace,P.isVideoTexture);Ue(G,P);let Xe;const ne=P.mipmaps,Ee=P.isVideoTexture!==!0,Ke=de.__version===void 0||Q===!0,ie=K.dataReady,He=C(P,Ne);if(P.isDepthTexture)ut=S(P.format===zc,P.type),Ke&&(Ee?t.texStorage2D(n.TEXTURE_2D,1,ut,Ne.width,Ne.height):t.texImage2D(n.TEXTURE_2D,0,ut,Ne.width,Ne.height,0,je,lt,null));else if(P.isDataTexture)if(ne.length>0){Ee&&Ke&&t.texStorage2D(n.TEXTURE_2D,He,ut,ne[0].width,ne[0].height);for(let xe=0,ke=ne.length;xe<ke;xe++)Xe=ne[xe],Ee?ie&&t.texSubImage2D(n.TEXTURE_2D,xe,0,0,Xe.width,Xe.height,je,lt,Xe.data):t.texImage2D(n.TEXTURE_2D,xe,ut,Xe.width,Xe.height,0,je,lt,Xe.data);P.generateMipmaps=!1}else Ee?(Ke&&t.texStorage2D(n.TEXTURE_2D,He,ut,Ne.width,Ne.height),ie&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ne.width,Ne.height,je,lt,Ne.data)):t.texImage2D(n.TEXTURE_2D,0,ut,Ne.width,Ne.height,0,je,lt,Ne.data);else if(P.isCompressedTexture)if(P.isCompressedArrayTexture){Ee&&Ke&&t.texStorage3D(n.TEXTURE_2D_ARRAY,He,ut,ne[0].width,ne[0].height,Ne.depth);for(let xe=0,ke=ne.length;xe<ke;xe++)if(Xe=ne[xe],P.format!==$r)if(je!==null)if(Ee){if(ie)if(P.layerUpdates.size>0){const qe=GS(Xe.width,Xe.height,P.format,P.type);for(const Ye of P.layerUpdates){const ft=Xe.data.subarray(Ye*qe/Xe.data.BYTES_PER_ELEMENT,(Ye+1)*qe/Xe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,xe,0,0,Ye,Xe.width,Xe.height,1,je,ft)}P.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,xe,0,0,0,Xe.width,Xe.height,Ne.depth,je,Xe.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,xe,ut,Xe.width,Xe.height,Ne.depth,0,Xe.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ee?ie&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,xe,0,0,0,Xe.width,Xe.height,Ne.depth,je,lt,Xe.data):t.texImage3D(n.TEXTURE_2D_ARRAY,xe,ut,Xe.width,Xe.height,Ne.depth,0,je,lt,Xe.data)}else{Ee&&Ke&&t.texStorage2D(n.TEXTURE_2D,He,ut,ne[0].width,ne[0].height);for(let xe=0,ke=ne.length;xe<ke;xe++)Xe=ne[xe],P.format!==$r?je!==null?Ee?ie&&t.compressedTexSubImage2D(n.TEXTURE_2D,xe,0,0,Xe.width,Xe.height,je,Xe.data):t.compressedTexImage2D(n.TEXTURE_2D,xe,ut,Xe.width,Xe.height,0,Xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ee?ie&&t.texSubImage2D(n.TEXTURE_2D,xe,0,0,Xe.width,Xe.height,je,lt,Xe.data):t.texImage2D(n.TEXTURE_2D,xe,ut,Xe.width,Xe.height,0,je,lt,Xe.data)}else if(P.isDataArrayTexture)if(Ee){if(Ke&&t.texStorage3D(n.TEXTURE_2D_ARRAY,He,ut,Ne.width,Ne.height,Ne.depth),ie)if(P.layerUpdates.size>0){const xe=GS(Ne.width,Ne.height,P.format,P.type);for(const ke of P.layerUpdates){const qe=Ne.data.subarray(ke*xe/Ne.data.BYTES_PER_ELEMENT,(ke+1)*xe/Ne.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,ke,Ne.width,Ne.height,1,je,lt,qe)}P.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ne.width,Ne.height,Ne.depth,je,lt,Ne.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,ut,Ne.width,Ne.height,Ne.depth,0,je,lt,Ne.data);else if(P.isData3DTexture)Ee?(Ke&&t.texStorage3D(n.TEXTURE_3D,He,ut,Ne.width,Ne.height,Ne.depth),ie&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ne.width,Ne.height,Ne.depth,je,lt,Ne.data)):t.texImage3D(n.TEXTURE_3D,0,ut,Ne.width,Ne.height,Ne.depth,0,je,lt,Ne.data);else if(P.isFramebufferTexture){if(Ke)if(Ee)t.texStorage2D(n.TEXTURE_2D,He,ut,Ne.width,Ne.height);else{let xe=Ne.width,ke=Ne.height;for(let qe=0;qe<He;qe++)t.texImage2D(n.TEXTURE_2D,qe,ut,xe,ke,0,je,lt,null),xe>>=1,ke>>=1}}else if(ne.length>0){if(Ee&&Ke){const xe=j(ne[0]);t.texStorage2D(n.TEXTURE_2D,He,ut,xe.width,xe.height)}for(let xe=0,ke=ne.length;xe<ke;xe++)Xe=ne[xe],Ee?ie&&t.texSubImage2D(n.TEXTURE_2D,xe,0,0,je,lt,Xe):t.texImage2D(n.TEXTURE_2D,xe,ut,je,lt,Xe);P.generateMipmaps=!1}else if(Ee){if(Ke){const xe=j(Ne);t.texStorage2D(n.TEXTURE_2D,He,ut,xe.width,xe.height)}ie&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,je,lt,Ne)}else t.texImage2D(n.TEXTURE_2D,0,ut,je,lt,Ne);v(P)&&g(G),de.__version=K.version,P.onUpdate&&P.onUpdate(P)}L.__version=P.version}function Ae(L,P,Z){if(P.image.length!==6)return;const G=tt(L,P),Q=P.source;t.bindTexture(n.TEXTURE_CUBE_MAP,L.__webglTexture,n.TEXTURE0+Z);const K=i.get(Q);if(Q.version!==K.__version||G===!0){t.activeTexture(n.TEXTURE0+Z);const de=Jt.getPrimaries(Jt.workingColorSpace),ye=P.colorSpace===da?null:Jt.getPrimaries(P.colorSpace),Pe=P.colorSpace===da||de===ye?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Pe);const Qe=P.isCompressedTexture||P.image[0].isCompressedTexture,Ne=P.image[0]&&P.image[0].isDataTexture,je=[];for(let ke=0;ke<6;ke++)!Qe&&!Ne?je[ke]=b(P.image[ke],!0,r.maxCubemapSize):je[ke]=Ne?P.image[ke].image:P.image[ke],je[ke]=B(P,je[ke]);const lt=je[0],ut=s.convert(P.format,P.colorSpace),Xe=s.convert(P.type),ne=w(P.internalFormat,ut,Xe,P.colorSpace),Ee=P.isVideoTexture!==!0,Ke=K.__version===void 0||G===!0,ie=Q.dataReady;let He=C(P,lt);Ue(n.TEXTURE_CUBE_MAP,P);let xe;if(Qe){Ee&&Ke&&t.texStorage2D(n.TEXTURE_CUBE_MAP,He,ne,lt.width,lt.height);for(let ke=0;ke<6;ke++){xe=je[ke].mipmaps;for(let qe=0;qe<xe.length;qe++){const Ye=xe[qe];P.format!==$r?ut!==null?Ee?ie&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe,0,0,Ye.width,Ye.height,ut,Ye.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe,ne,Ye.width,Ye.height,0,Ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ee?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe,0,0,Ye.width,Ye.height,ut,Xe,Ye.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe,ne,Ye.width,Ye.height,0,ut,Xe,Ye.data)}}}else{if(xe=P.mipmaps,Ee&&Ke){xe.length>0&&He++;const ke=j(je[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,He,ne,ke.width,ke.height)}for(let ke=0;ke<6;ke++)if(Ne){Ee?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,je[ke].width,je[ke].height,ut,Xe,je[ke].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,ne,je[ke].width,je[ke].height,0,ut,Xe,je[ke].data);for(let qe=0;qe<xe.length;qe++){const ft=xe[qe].image[ke].image;Ee?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe+1,0,0,ft.width,ft.height,ut,Xe,ft.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe+1,ne,ft.width,ft.height,0,ut,Xe,ft.data)}}else{Ee?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,ut,Xe,je[ke]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,ne,ut,Xe,je[ke]);for(let qe=0;qe<xe.length;qe++){const Ye=xe[qe];Ee?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe+1,0,0,ut,Xe,Ye.image[ke]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,qe+1,ne,ut,Xe,Ye.image[ke])}}}v(P)&&g(n.TEXTURE_CUBE_MAP),K.__version=Q.version,P.onUpdate&&P.onUpdate(P)}L.__version=P.version}function We(L,P,Z,G,Q,K){const de=s.convert(Z.format,Z.colorSpace),ye=s.convert(Z.type),Pe=w(Z.internalFormat,de,ye,Z.colorSpace),Qe=i.get(P),Ne=i.get(Z);if(Ne.__renderTarget=P,!Qe.__hasExternalTextures){const je=Math.max(1,P.width>>K),lt=Math.max(1,P.height>>K);Q===n.TEXTURE_3D||Q===n.TEXTURE_2D_ARRAY?t.texImage3D(Q,K,Pe,je,lt,P.depth,0,de,ye,null):t.texImage2D(Q,K,Pe,je,lt,0,de,ye,null)}t.bindFramebuffer(n.FRAMEBUFFER,L),fe(P)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,G,Q,Ne.__webglTexture,0,me(P)):(Q===n.TEXTURE_2D||Q>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Q<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,G,Q,Ne.__webglTexture,K),t.bindFramebuffer(n.FRAMEBUFFER,null)}function se(L,P,Z){if(n.bindRenderbuffer(n.RENDERBUFFER,L),P.depthBuffer){const G=P.depthTexture,Q=G&&G.isDepthTexture?G.type:null,K=S(P.stencilBuffer,Q),de=P.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ye=me(P);fe(P)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ye,K,P.width,P.height):Z?n.renderbufferStorageMultisample(n.RENDERBUFFER,ye,K,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,K,P.width,P.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,de,n.RENDERBUFFER,L)}else{const G=P.textures;for(let Q=0;Q<G.length;Q++){const K=G[Q],de=s.convert(K.format,K.colorSpace),ye=s.convert(K.type),Pe=w(K.internalFormat,de,ye,K.colorSpace),Qe=me(P);Z&&fe(P)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Qe,Pe,P.width,P.height):fe(P)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Qe,Pe,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,Pe,P.width,P.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Se(L,P){if(P&&P.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,L),!(P.depthTexture&&P.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const G=i.get(P.depthTexture);G.__renderTarget=P,(!G.__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),ae(P.depthTexture,0);const Q=G.__webglTexture,K=me(P);if(P.depthTexture.format===Mc)fe(P)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Q,0,K):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Q,0);else if(P.depthTexture.format===zc)fe(P)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Q,0,K):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Q,0);else throw new Error("Unknown depthTexture format")}function Me(L){const P=i.get(L),Z=L.isWebGLCubeRenderTarget===!0;if(P.__boundDepthTexture!==L.depthTexture){const G=L.depthTexture;if(P.__depthDisposeCallback&&P.__depthDisposeCallback(),G){const Q=()=>{delete P.__boundDepthTexture,delete P.__depthDisposeCallback,G.removeEventListener("dispose",Q)};G.addEventListener("dispose",Q),P.__depthDisposeCallback=Q}P.__boundDepthTexture=G}if(L.depthTexture&&!P.__autoAllocateDepthBuffer){if(Z)throw new Error("target.depthTexture not supported in Cube render targets");Se(P.__webglFramebuffer,L)}else if(Z){P.__webglDepthbuffer=[];for(let G=0;G<6;G++)if(t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[G]),P.__webglDepthbuffer[G]===void 0)P.__webglDepthbuffer[G]=n.createRenderbuffer(),se(P.__webglDepthbuffer[G],L,!1);else{const Q=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,K=P.__webglDepthbuffer[G];n.bindRenderbuffer(n.RENDERBUFFER,K),n.framebufferRenderbuffer(n.FRAMEBUFFER,Q,n.RENDERBUFFER,K)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer),P.__webglDepthbuffer===void 0)P.__webglDepthbuffer=n.createRenderbuffer(),se(P.__webglDepthbuffer,L,!1);else{const G=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Q=P.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,Q),n.framebufferRenderbuffer(n.FRAMEBUFFER,G,n.RENDERBUFFER,Q)}t.bindFramebuffer(n.FRAMEBUFFER,null)}function De(L,P,Z){const G=i.get(L);P!==void 0&&We(G.__webglFramebuffer,L,L.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Z!==void 0&&Me(L)}function Be(L){const P=L.texture,Z=i.get(L),G=i.get(P);L.addEventListener("dispose",E);const Q=L.textures,K=L.isWebGLCubeRenderTarget===!0,de=Q.length>1;if(de||(G.__webglTexture===void 0&&(G.__webglTexture=n.createTexture()),G.__version=P.version,o.memory.textures++),K){Z.__webglFramebuffer=[];for(let ye=0;ye<6;ye++)if(P.mipmaps&&P.mipmaps.length>0){Z.__webglFramebuffer[ye]=[];for(let Pe=0;Pe<P.mipmaps.length;Pe++)Z.__webglFramebuffer[ye][Pe]=n.createFramebuffer()}else Z.__webglFramebuffer[ye]=n.createFramebuffer()}else{if(P.mipmaps&&P.mipmaps.length>0){Z.__webglFramebuffer=[];for(let ye=0;ye<P.mipmaps.length;ye++)Z.__webglFramebuffer[ye]=n.createFramebuffer()}else Z.__webglFramebuffer=n.createFramebuffer();if(de)for(let ye=0,Pe=Q.length;ye<Pe;ye++){const Qe=i.get(Q[ye]);Qe.__webglTexture===void 0&&(Qe.__webglTexture=n.createTexture(),o.memory.textures++)}if(L.samples>0&&fe(L)===!1){Z.__webglMultisampledFramebuffer=n.createFramebuffer(),Z.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Z.__webglMultisampledFramebuffer);for(let ye=0;ye<Q.length;ye++){const Pe=Q[ye];Z.__webglColorRenderbuffer[ye]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Z.__webglColorRenderbuffer[ye]);const Qe=s.convert(Pe.format,Pe.colorSpace),Ne=s.convert(Pe.type),je=w(Pe.internalFormat,Qe,Ne,Pe.colorSpace,L.isXRRenderTarget===!0),lt=me(L);n.renderbufferStorageMultisample(n.RENDERBUFFER,lt,je,L.width,L.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ye,n.RENDERBUFFER,Z.__webglColorRenderbuffer[ye])}n.bindRenderbuffer(n.RENDERBUFFER,null),L.depthBuffer&&(Z.__webglDepthRenderbuffer=n.createRenderbuffer(),se(Z.__webglDepthRenderbuffer,L,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(K){t.bindTexture(n.TEXTURE_CUBE_MAP,G.__webglTexture),Ue(n.TEXTURE_CUBE_MAP,P);for(let ye=0;ye<6;ye++)if(P.mipmaps&&P.mipmaps.length>0)for(let Pe=0;Pe<P.mipmaps.length;Pe++)We(Z.__webglFramebuffer[ye][Pe],L,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ye,Pe);else We(Z.__webglFramebuffer[ye],L,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ye,0);v(P)&&g(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(de){for(let ye=0,Pe=Q.length;ye<Pe;ye++){const Qe=Q[ye],Ne=i.get(Qe);t.bindTexture(n.TEXTURE_2D,Ne.__webglTexture),Ue(n.TEXTURE_2D,Qe),We(Z.__webglFramebuffer,L,Qe,n.COLOR_ATTACHMENT0+ye,n.TEXTURE_2D,0),v(Qe)&&g(n.TEXTURE_2D)}t.unbindTexture()}else{let ye=n.TEXTURE_2D;if((L.isWebGL3DRenderTarget||L.isWebGLArrayRenderTarget)&&(ye=L.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(ye,G.__webglTexture),Ue(ye,P),P.mipmaps&&P.mipmaps.length>0)for(let Pe=0;Pe<P.mipmaps.length;Pe++)We(Z.__webglFramebuffer[Pe],L,P,n.COLOR_ATTACHMENT0,ye,Pe);else We(Z.__webglFramebuffer,L,P,n.COLOR_ATTACHMENT0,ye,0);v(P)&&g(ye),t.unbindTexture()}L.depthBuffer&&Me(L)}function H(L){const P=L.textures;for(let Z=0,G=P.length;Z<G;Z++){const Q=P[Z];if(v(Q)){const K=x(L),de=i.get(Q).__webglTexture;t.bindTexture(K,de),g(K),t.unbindTexture()}}}const X=[],D=[];function ge(L){if(L.samples>0){if(fe(L)===!1){const P=L.textures,Z=L.width,G=L.height;let Q=n.COLOR_BUFFER_BIT;const K=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,de=i.get(L),ye=P.length>1;if(ye)for(let Pe=0;Pe<P.length;Pe++)t.bindFramebuffer(n.FRAMEBUFFER,de.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,de.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,de.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,de.__webglFramebuffer);for(let Pe=0;Pe<P.length;Pe++){if(L.resolveDepthBuffer&&(L.depthBuffer&&(Q|=n.DEPTH_BUFFER_BIT),L.stencilBuffer&&L.resolveStencilBuffer&&(Q|=n.STENCIL_BUFFER_BIT)),ye){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,de.__webglColorRenderbuffer[Pe]);const Qe=i.get(P[Pe]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Qe,0)}n.blitFramebuffer(0,0,Z,G,0,0,Z,G,Q,n.NEAREST),l===!0&&(X.length=0,D.length=0,X.push(n.COLOR_ATTACHMENT0+Pe),L.depthBuffer&&L.resolveDepthBuffer===!1&&(X.push(K),D.push(K),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,D)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,X))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),ye)for(let Pe=0;Pe<P.length;Pe++){t.bindFramebuffer(n.FRAMEBUFFER,de.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.RENDERBUFFER,de.__webglColorRenderbuffer[Pe]);const Qe=i.get(P[Pe]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,de.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.TEXTURE_2D,Qe,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,de.__webglMultisampledFramebuffer)}else if(L.depthBuffer&&L.resolveDepthBuffer===!1&&l){const P=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[P])}}}function me(L){return Math.min(r.maxSamples,L.samples)}function fe(L){const P=i.get(L);return L.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&P.__useRenderToTexture!==!1}function N(L){const P=o.render.frame;h.get(L)!==P&&(h.set(L,P),L.update())}function B(L,P){const Z=L.colorSpace,G=L.format,Q=L.type;return L.isCompressedTexture===!0||L.isVideoTexture===!0||Z!==Wc&&Z!==da&&(Jt.getTransfer(Z)===un?(G!==$r||Q!==Uo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Z)),P}function j(L){return typeof HTMLImageElement<"u"&&L instanceof HTMLImageElement?(c.width=L.naturalWidth||L.width,c.height=L.naturalHeight||L.height):typeof VideoFrame<"u"&&L instanceof VideoFrame?(c.width=L.displayWidth,c.height=L.displayHeight):(c.width=L.width,c.height=L.height),c}this.allocateTextureUnit=$,this.resetTextureUnits=Y,this.setTexture2D=ae,this.setTexture2DArray=V,this.setTexture3D=te,this.setTextureCube=J,this.rebindTextures=De,this.setupRenderTarget=Be,this.updateRenderTargetMipmap=H,this.updateMultisampleRenderTarget=ge,this.setupDepthRenderbuffer=Me,this.setupFrameBufferTexture=We,this.useMultisampledRTT=fe}function zZ(n,e){function t(i,r=da){let s;const o=Jt.getTransfer(r);if(i===Uo)return n.UNSIGNED_BYTE;if(i===ov)return n.UNSIGNED_SHORT_4_4_4_4;if(i===av)return n.UNSIGNED_SHORT_5_5_5_1;if(i===SL)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===xL)return n.BYTE;if(i===wL)return n.SHORT;if(i===wh)return n.UNSIGNED_SHORT;if(i===sv)return n.INT;if(i===ml)return n.UNSIGNED_INT;if(i===rr)return n.FLOAT;if(i===Ro)return n.HALF_FLOAT;if(i===ML)return n.ALPHA;if(i===TL)return n.RGB;if(i===$r)return n.RGBA;if(i===EL)return n.LUMINANCE;if(i===LL)return n.LUMINANCE_ALPHA;if(i===Mc)return n.DEPTH_COMPONENT;if(i===zc)return n.DEPTH_STENCIL;if(i===lv)return n.RED;if(i===cv)return n.RED_INTEGER;if(i===AL)return n.RG;if(i===uv)return n.RG_INTEGER;if(i===hv)return n.RGBA_INTEGER;if(i===cp||i===up||i===hp||i===dp)if(o===un)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===cp)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===up)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===hp)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===dp)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===cp)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===up)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===hp)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===dp)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===W0||i===V0||i===G0||i===B0)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===W0)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===V0)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===G0)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===B0)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===H0||i===Z0||i===X0)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===H0||i===Z0)return o===un?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===X0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===j0||i===Y0||i===K0||i===J0||i===Q0||i===$0||i===q0||i===e_||i===t_||i===n_||i===i_||i===r_||i===s_||i===o_)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===j0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===Y0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===K0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===J0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===Q0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===$0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===q0)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===e_)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===t_)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===n_)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===i_)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===r_)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===s_)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===o_)return o===un?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===fp||i===a_||i===l_)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===fp)return o===un?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===a_)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===l_)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===CL||i===c_||i===u_||i===h_)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===fp)return s.COMPRESSED_RED_RGTC1_EXT;if(i===c_)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===u_)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===h_)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===Uc?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}const WZ={type:"move"};class Py{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new sr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new sr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new U,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new U),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new sr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new U,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new U),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const b of e.hand.values()){const v=t.getJointPose(b,i),g=this._getHandJoint(c,b);v!==null&&(g.matrix.fromArray(v.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=v.radius),g.visible=v!==null}const h=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],p=h.position.distanceTo(d.position),m=.02,y=.005;c.inputState.pinching&&p>m+y?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-y&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(WZ)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new sr;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}const VZ=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,GZ=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class BZ{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){const r=new In,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new rs({vertexShader:VZ,fragmentShader:GZ,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Xt(new js(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class HZ extends qs{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,h=null,d=null,p=null,m=null,y=null;const b=new BZ,v=t.getContextAttributes();let g=null,x=null;const w=[],S=[],C=new Ie;let A=null;const E=new Kn;E.viewport=new Ct;const O=new Kn;O.viewport=new Ct;const R=[E,O],T=new YG;let k=null,Y=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(_e){let Ae=w[_e];return Ae===void 0&&(Ae=new Py,w[_e]=Ae),Ae.getTargetRaySpace()},this.getControllerGrip=function(_e){let Ae=w[_e];return Ae===void 0&&(Ae=new Py,w[_e]=Ae),Ae.getGripSpace()},this.getHand=function(_e){let Ae=w[_e];return Ae===void 0&&(Ae=new Py,w[_e]=Ae),Ae.getHandSpace()};function $(_e){const Ae=S.indexOf(_e.inputSource);if(Ae===-1)return;const We=w[Ae];We!==void 0&&(We.update(_e.inputSource,_e.frame,c||o),We.dispatchEvent({type:_e.type,data:_e.inputSource}))}function re(){r.removeEventListener("select",$),r.removeEventListener("selectstart",$),r.removeEventListener("selectend",$),r.removeEventListener("squeeze",$),r.removeEventListener("squeezestart",$),r.removeEventListener("squeezeend",$),r.removeEventListener("end",re),r.removeEventListener("inputsourceschange",ae);for(let _e=0;_e<w.length;_e++){const Ae=S[_e];Ae!==null&&(S[_e]=null,w[_e].disconnect(Ae))}k=null,Y=null,b.reset(),e.setRenderTarget(g),m=null,p=null,d=null,r=null,x=null,tt.stop(),i.isPresenting=!1,e.setPixelRatio(A),e.setSize(C.width,C.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(_e){s=_e,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(_e){a=_e,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(_e){c=_e},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return d},this.getFrame=function(){return y},this.getSession=function(){return r},this.setSession=async function(_e){if(r=_e,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",$),r.addEventListener("selectstart",$),r.addEventListener("selectend",$),r.addEventListener("squeeze",$),r.addEventListener("squeezestart",$),r.addEventListener("squeezeend",$),r.addEventListener("end",re),r.addEventListener("inputsourceschange",ae),v.xrCompatible!==!0&&await t.makeXRCompatible(),A=e.getPixelRatio(),e.getSize(C),r.renderState.layers===void 0){const Ae={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,t,Ae),r.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),x=new Ma(m.framebufferWidth,m.framebufferHeight,{format:$r,type:Uo,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let Ae=null,We=null,se=null;v.depth&&(se=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ae=v.stencil?zc:Mc,We=v.stencil?Uc:ml);const Se={colorFormat:t.RGBA8,depthFormat:se,scaleFactor:s};d=new XRWebGLBinding(r,t),p=d.createProjectionLayer(Se),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),x=new Ma(p.textureWidth,p.textureHeight,{format:$r,type:Uo,depthTexture:new HL(p.textureWidth,p.textureHeight,We,void 0,void 0,void 0,void 0,void 0,void 0,Ae),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1})}x.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),tt.setContext(r),tt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return b.getDepthTexture()};function ae(_e){for(let Ae=0;Ae<_e.removed.length;Ae++){const We=_e.removed[Ae],se=S.indexOf(We);se>=0&&(S[se]=null,w[se].disconnect(We))}for(let Ae=0;Ae<_e.added.length;Ae++){const We=_e.added[Ae];let se=S.indexOf(We);if(se===-1){for(let Me=0;Me<w.length;Me++)if(Me>=S.length){S.push(We),se=Me;break}else if(S[Me]===null){S[Me]=We,se=Me;break}if(se===-1)break}const Se=w[se];Se&&Se.connect(We)}}const V=new U,te=new U;function J(_e,Ae,We){V.setFromMatrixPosition(Ae.matrixWorld),te.setFromMatrixPosition(We.matrixWorld);const se=V.distanceTo(te),Se=Ae.projectionMatrix.elements,Me=We.projectionMatrix.elements,De=Se[14]/(Se[10]-1),Be=Se[14]/(Se[10]+1),H=(Se[9]+1)/Se[5],X=(Se[9]-1)/Se[5],D=(Se[8]-1)/Se[0],ge=(Me[8]+1)/Me[0],me=De*D,fe=De*ge,N=se/(-D+ge),B=N*-D;if(Ae.matrixWorld.decompose(_e.position,_e.quaternion,_e.scale),_e.translateX(B),_e.translateZ(N),_e.matrixWorld.compose(_e.position,_e.quaternion,_e.scale),_e.matrixWorldInverse.copy(_e.matrixWorld).invert(),Se[10]===-1)_e.projectionMatrix.copy(Ae.projectionMatrix),_e.projectionMatrixInverse.copy(Ae.projectionMatrixInverse);else{const j=De+N,L=Be+N,P=me-B,Z=fe+(se-B),G=H*Be/L*j,Q=X*Be/L*j;_e.projectionMatrix.makePerspective(P,Z,G,Q,j,L),_e.projectionMatrixInverse.copy(_e.projectionMatrix).invert()}}function pe(_e,Ae){Ae===null?_e.matrixWorld.copy(_e.matrix):_e.matrixWorld.multiplyMatrices(Ae.matrixWorld,_e.matrix),_e.matrixWorldInverse.copy(_e.matrixWorld).invert()}this.updateCamera=function(_e){if(r===null)return;let Ae=_e.near,We=_e.far;b.texture!==null&&(b.depthNear>0&&(Ae=b.depthNear),b.depthFar>0&&(We=b.depthFar)),T.near=O.near=E.near=Ae,T.far=O.far=E.far=We,(k!==T.near||Y!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),k=T.near,Y=T.far),E.layers.mask=_e.layers.mask|2,O.layers.mask=_e.layers.mask|4,T.layers.mask=E.layers.mask|O.layers.mask;const se=_e.parent,Se=T.cameras;pe(T,se);for(let Me=0;Me<Se.length;Me++)pe(Se[Me],se);Se.length===2?J(T,E,O):T.projectionMatrix.copy(E.projectionMatrix),Te(_e,T,se)};function Te(_e,Ae,We){We===null?_e.matrix.copy(Ae.matrixWorld):(_e.matrix.copy(We.matrixWorld),_e.matrix.invert(),_e.matrix.multiply(Ae.matrixWorld)),_e.matrix.decompose(_e.position,_e.quaternion,_e.scale),_e.updateMatrixWorld(!0),_e.projectionMatrix.copy(Ae.projectionMatrix),_e.projectionMatrixInverse.copy(Ae.projectionMatrixInverse),_e.isPerspectiveCamera&&(_e.fov=Vc*2*Math.atan(1/_e.projectionMatrix.elements[5]),_e.zoom=1)}this.getCamera=function(){return T},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function(_e){l=_e,p!==null&&(p.fixedFoveation=_e),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=_e)},this.hasDepthSensing=function(){return b.texture!==null},this.getDepthSensingMesh=function(){return b.getMesh(T)};let Le=null;function Ue(_e,Ae){if(h=Ae.getViewerPose(c||o),y=Ae,h!==null){const We=h.views;m!==null&&(e.setRenderTargetFramebuffer(x,m.framebuffer),e.setRenderTarget(x));let se=!1;We.length!==T.cameras.length&&(T.cameras.length=0,se=!0);for(let Me=0;Me<We.length;Me++){const De=We[Me];let Be=null;if(m!==null)Be=m.getViewport(De);else{const X=d.getViewSubImage(p,De);Be=X.viewport,Me===0&&(e.setRenderTargetTextures(x,X.colorTexture,p.ignoreDepthValues?void 0:X.depthStencilTexture),e.setRenderTarget(x))}let H=R[Me];H===void 0&&(H=new Kn,H.layers.enable(Me),H.viewport=new Ct,R[Me]=H),H.matrix.fromArray(De.transform.matrix),H.matrix.decompose(H.position,H.quaternion,H.scale),H.projectionMatrix.fromArray(De.projectionMatrix),H.projectionMatrixInverse.copy(H.projectionMatrix).invert(),H.viewport.set(Be.x,Be.y,Be.width,Be.height),Me===0&&(T.matrix.copy(H.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),se===!0&&T.cameras.push(H)}const Se=r.enabledFeatures;if(Se&&Se.includes("depth-sensing")){const Me=d.getDepthInformation(We[0]);Me&&Me.isValid&&Me.texture&&b.init(e,Me,r.renderState)}}for(let We=0;We<w.length;We++){const se=S[We],Se=w[We];se!==null&&Se!==void 0&&Se.update(se,Ae,c||o)}Le&&Le(_e,Ae),Ae.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Ae}),y=null}const tt=new oA;tt.setAnimationLoop(Ue),this.setAnimationLoop=function(_e){Le=_e},this.dispose=function(){}}}const ja=new Ri,ZZ=new nt;function XZ(n,e){function t(v,g){v.matrixAutoUpdate===!0&&v.updateMatrix(),g.value.copy(v.matrix)}function i(v,g){g.color.getRGB(v.fogColor.value,zL(n)),g.isFog?(v.fogNear.value=g.near,v.fogFar.value=g.far):g.isFogExp2&&(v.fogDensity.value=g.density)}function r(v,g,x,w,S){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(v,g):g.isMeshToonMaterial?(s(v,g),d(v,g)):g.isMeshPhongMaterial?(s(v,g),h(v,g)):g.isMeshStandardMaterial?(s(v,g),p(v,g),g.isMeshPhysicalMaterial&&m(v,g,S)):g.isMeshMatcapMaterial?(s(v,g),y(v,g)):g.isMeshDepthMaterial?s(v,g):g.isMeshDistanceMaterial?(s(v,g),b(v,g)):g.isMeshNormalMaterial?s(v,g):g.isLineBasicMaterial?(o(v,g),g.isLineDashedMaterial&&a(v,g)):g.isPointsMaterial?l(v,g,x,w):g.isSpriteMaterial?c(v,g):g.isShadowMaterial?(v.color.value.copy(g.color),v.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(v,g){v.opacity.value=g.opacity,g.color&&v.diffuse.value.copy(g.color),g.emissive&&v.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(v.map.value=g.map,t(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,t(g.alphaMap,v.alphaMapTransform)),g.bumpMap&&(v.bumpMap.value=g.bumpMap,t(g.bumpMap,v.bumpMapTransform),v.bumpScale.value=g.bumpScale,g.side===Zi&&(v.bumpScale.value*=-1)),g.normalMap&&(v.normalMap.value=g.normalMap,t(g.normalMap,v.normalMapTransform),v.normalScale.value.copy(g.normalScale),g.side===Zi&&v.normalScale.value.negate()),g.displacementMap&&(v.displacementMap.value=g.displacementMap,t(g.displacementMap,v.displacementMapTransform),v.displacementScale.value=g.displacementScale,v.displacementBias.value=g.displacementBias),g.emissiveMap&&(v.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,v.emissiveMapTransform)),g.specularMap&&(v.specularMap.value=g.specularMap,t(g.specularMap,v.specularMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);const x=e.get(g),w=x.envMap,S=x.envMapRotation;w&&(v.envMap.value=w,ja.copy(S),ja.x*=-1,ja.y*=-1,ja.z*=-1,w.isCubeTexture&&w.isRenderTargetTexture===!1&&(ja.y*=-1,ja.z*=-1),v.envMapRotation.value.setFromMatrix4(ZZ.makeRotationFromEuler(ja)),v.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=g.reflectivity,v.ior.value=g.ior,v.refractionRatio.value=g.refractionRatio),g.lightMap&&(v.lightMap.value=g.lightMap,v.lightMapIntensity.value=g.lightMapIntensity,t(g.lightMap,v.lightMapTransform)),g.aoMap&&(v.aoMap.value=g.aoMap,v.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,v.aoMapTransform))}function o(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,g.map&&(v.map.value=g.map,t(g.map,v.mapTransform))}function a(v,g){v.dashSize.value=g.dashSize,v.totalSize.value=g.dashSize+g.gapSize,v.scale.value=g.scale}function l(v,g,x,w){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.size.value=g.size*x,v.scale.value=w*.5,g.map&&(v.map.value=g.map,t(g.map,v.uvTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,t(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function c(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.rotation.value=g.rotation,g.map&&(v.map.value=g.map,t(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,t(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function h(v,g){v.specular.value.copy(g.specular),v.shininess.value=Math.max(g.shininess,1e-4)}function d(v,g){g.gradientMap&&(v.gradientMap.value=g.gradientMap)}function p(v,g){v.metalness.value=g.metalness,g.metalnessMap&&(v.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,v.metalnessMapTransform)),v.roughness.value=g.roughness,g.roughnessMap&&(v.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,v.roughnessMapTransform)),g.envMap&&(v.envMapIntensity.value=g.envMapIntensity)}function m(v,g,x){v.ior.value=g.ior,g.sheen>0&&(v.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),v.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(v.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,v.sheenColorMapTransform)),g.sheenRoughnessMap&&(v.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,v.sheenRoughnessMapTransform))),g.clearcoat>0&&(v.clearcoat.value=g.clearcoat,v.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(v.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,v.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(v.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Zi&&v.clearcoatNormalScale.value.negate())),g.dispersion>0&&(v.dispersion.value=g.dispersion),g.iridescence>0&&(v.iridescence.value=g.iridescence,v.iridescenceIOR.value=g.iridescenceIOR,v.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(v.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,v.iridescenceMapTransform)),g.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),g.transmission>0&&(v.transmission.value=g.transmission,v.transmissionSamplerMap.value=x.texture,v.transmissionSamplerSize.value.set(x.width,x.height),g.transmissionMap&&(v.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,v.transmissionMapTransform)),v.thickness.value=g.thickness,g.thicknessMap&&(v.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=g.attenuationDistance,v.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(v.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(v.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=g.specularIntensity,v.specularColor.value.copy(g.specularColor),g.specularColorMap&&(v.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,v.specularColorMapTransform)),g.specularIntensityMap&&(v.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,v.specularIntensityMapTransform))}function y(v,g){g.matcap&&(v.matcap.value=g.matcap)}function b(v,g){const x=e.get(g).light;v.referencePosition.value.setFromMatrixPosition(x.matrixWorld),v.nearDistance.value=x.shadow.camera.near,v.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function jZ(n,e,t,i){let r={},s={},o=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(x,w){const S=w.program;i.uniformBlockBinding(x,S)}function c(x,w){let S=r[x.id];S===void 0&&(y(x),S=h(x),r[x.id]=S,x.addEventListener("dispose",v));const C=w.program;i.updateUBOMapping(x,C);const A=e.render.frame;s[x.id]!==A&&(p(x),s[x.id]=A)}function h(x){const w=d();x.__bindingPointIndex=w;const S=n.createBuffer(),C=x.__size,A=x.usage;return n.bindBuffer(n.UNIFORM_BUFFER,S),n.bufferData(n.UNIFORM_BUFFER,C,A),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,w,S),S}function d(){for(let x=0;x<a;x++)if(o.indexOf(x)===-1)return o.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(x){const w=r[x.id],S=x.uniforms,C=x.__cache;n.bindBuffer(n.UNIFORM_BUFFER,w);for(let A=0,E=S.length;A<E;A++){const O=Array.isArray(S[A])?S[A]:[S[A]];for(let R=0,T=O.length;R<T;R++){const k=O[R];if(m(k,A,R,C)===!0){const Y=k.__offset,$=Array.isArray(k.value)?k.value:[k.value];let re=0;for(let ae=0;ae<$.length;ae++){const V=$[ae],te=b(V);typeof V=="number"||typeof V=="boolean"?(k.__data[0]=V,n.bufferSubData(n.UNIFORM_BUFFER,Y+re,k.__data)):V.isMatrix3?(k.__data[0]=V.elements[0],k.__data[1]=V.elements[1],k.__data[2]=V.elements[2],k.__data[3]=0,k.__data[4]=V.elements[3],k.__data[5]=V.elements[4],k.__data[6]=V.elements[5],k.__data[7]=0,k.__data[8]=V.elements[6],k.__data[9]=V.elements[7],k.__data[10]=V.elements[8],k.__data[11]=0):(V.toArray(k.__data,re),re+=te.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Y,k.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function m(x,w,S,C){const A=x.value,E=w+"_"+S;if(C[E]===void 0)return typeof A=="number"||typeof A=="boolean"?C[E]=A:C[E]=A.clone(),!0;{const O=C[E];if(typeof A=="number"||typeof A=="boolean"){if(O!==A)return C[E]=A,!0}else if(O.equals(A)===!1)return O.copy(A),!0}return!1}function y(x){const w=x.uniforms;let S=0;const C=16;for(let E=0,O=w.length;E<O;E++){const R=Array.isArray(w[E])?w[E]:[w[E]];for(let T=0,k=R.length;T<k;T++){const Y=R[T],$=Array.isArray(Y.value)?Y.value:[Y.value];for(let re=0,ae=$.length;re<ae;re++){const V=$[re],te=b(V),J=S%C,pe=J%te.boundary,Te=J+pe;S+=pe,Te!==0&&C-Te<te.storage&&(S+=C-Te),Y.__data=new Float32Array(te.storage/Float32Array.BYTES_PER_ELEMENT),Y.__offset=S,S+=te.storage}}}const A=S%C;return A>0&&(S+=C-A),x.__size=S,x.__cache={},this}function b(x){const w={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(w.boundary=4,w.storage=4):x.isVector2?(w.boundary=8,w.storage=8):x.isVector3||x.isColor?(w.boundary=16,w.storage=12):x.isVector4?(w.boundary=16,w.storage=16):x.isMatrix3?(w.boundary=48,w.storage=48):x.isMatrix4?(w.boundary=64,w.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),w}function v(x){const w=x.target;w.removeEventListener("dispose",v);const S=o.indexOf(w.__bindingPointIndex);o.splice(S,1),n.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function g(){for(const x in r)n.deleteBuffer(r[x]);o=[],r={},s={}}return{bind:l,update:c,dispose:g}}class hA{constructor(e={}){const{canvas:t=bV(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:d=!1,reverseDepthBuffer:p=!1}=e;this.isWebGLRenderer=!0;let m;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=i.getContextAttributes().alpha}else m=o;const y=new Uint32Array(4),b=new Int32Array(4);let v=null,g=null;const x=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Li,this.toneMapping=xa,this.toneMappingExposure=1;const S=this;let C=!1,A=0,E=0,O=null,R=-1,T=null;const k=new Ct,Y=new Ct;let $=null;const re=new Ge(0);let ae=0,V=t.width,te=t.height,J=1,pe=null,Te=null;const Le=new Ct(0,0,V,te),Ue=new Ct(0,0,V,te);let tt=!1;const _e=new um;let Ae=!1,We=!1;const se=new nt,Se=new nt,Me=new U,De=new Ct,Be={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let H=!1;function X(){return O===null?J:1}let D=i;function ge(z,ce){return t.getContext(z,ce)}try{const z={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Gh}`),t.addEventListener("webglcontextlost",ke,!1),t.addEventListener("webglcontextrestored",qe,!1),t.addEventListener("webglcontextcreationerror",Ye,!1),D===null){const ce="webgl2";if(D=ge(ce,z),D===null)throw ge(ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(z){throw console.error("THREE.WebGLRenderer: "+z.message),z}let me,fe,N,B,j,L,P,Z,G,Q,K,de,ye,Pe,Qe,Ne,je,lt,ut,Xe,ne,Ee,Ke,ie;function He(){me=new iH(D),me.init(),Ee=new zZ(D,me),fe=new Q4(D,me,e,Ee),N=new FZ(D,me),fe.reverseDepthBuffer&&p&&N.buffers.depth.setReversed(!0),B=new oH(D),j=new MZ,L=new UZ(D,me,N,j,fe,Ee,B),P=new q4(S),Z=new nH(S),G=new f5(D),Ke=new K4(D,G),Q=new rH(D,G,B,Ke),K=new lH(D,Q,G,B),ut=new aH(D,fe,L),Ne=new $4(j),de=new SZ(S,P,Z,me,fe,Ke,Ne),ye=new XZ(S,j),Pe=new EZ,Qe=new IZ(me),lt=new Y4(S,P,Z,N,K,m,l),je=new OZ(S,K,fe),ie=new jZ(D,B,fe,N),Xe=new J4(D,me,B),ne=new sH(D,me,B),B.programs=de.programs,S.capabilities=fe,S.extensions=me,S.properties=j,S.renderLists=Pe,S.shadowMap=je,S.state=N,S.info=B}He();const xe=new HZ(S,D);this.xr=xe,this.getContext=function(){return D},this.getContextAttributes=function(){return D.getContextAttributes()},this.forceContextLoss=function(){const z=me.get("WEBGL_lose_context");z&&z.loseContext()},this.forceContextRestore=function(){const z=me.get("WEBGL_lose_context");z&&z.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(z){z!==void 0&&(J=z,this.setSize(V,te,!1))},this.getSize=function(z){return z.set(V,te)},this.setSize=function(z,ce,ve=!0){if(xe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}V=z,te=ce,t.width=Math.floor(z*J),t.height=Math.floor(ce*J),ve===!0&&(t.style.width=z+"px",t.style.height=ce+"px"),this.setViewport(0,0,z,ce)},this.getDrawingBufferSize=function(z){return z.set(V*J,te*J).floor()},this.setDrawingBufferSize=function(z,ce,ve){V=z,te=ce,J=ve,t.width=Math.floor(z*ve),t.height=Math.floor(ce*ve),this.setViewport(0,0,z,ce)},this.getCurrentViewport=function(z){return z.copy(k)},this.getViewport=function(z){return z.copy(Le)},this.setViewport=function(z,ce,ve,be){z.isVector4?Le.set(z.x,z.y,z.z,z.w):Le.set(z,ce,ve,be),N.viewport(k.copy(Le).multiplyScalar(J).round())},this.getScissor=function(z){return z.copy(Ue)},this.setScissor=function(z,ce,ve,be){z.isVector4?Ue.set(z.x,z.y,z.z,z.w):Ue.set(z,ce,ve,be),N.scissor(Y.copy(Ue).multiplyScalar(J).round())},this.getScissorTest=function(){return tt},this.setScissorTest=function(z){N.setScissorTest(tt=z)},this.setOpaqueSort=function(z){pe=z},this.setTransparentSort=function(z){Te=z},this.getClearColor=function(z){return z.copy(lt.getClearColor())},this.setClearColor=function(){lt.setClearColor.apply(lt,arguments)},this.getClearAlpha=function(){return lt.getClearAlpha()},this.setClearAlpha=function(){lt.setClearAlpha.apply(lt,arguments)},this.clear=function(z=!0,ce=!0,ve=!0){let be=0;if(z){let ue=!1;if(O!==null){const Ve=O.texture.format;ue=Ve===hv||Ve===uv||Ve===cv}if(ue){const Ve=O.texture.type,et=Ve===Uo||Ve===ml||Ve===wh||Ve===Uc||Ve===ov||Ve===av,rt=lt.getClearColor(),at=lt.getClearAlpha(),vt=rt.r,wt=rt.g,ht=rt.b;et?(y[0]=vt,y[1]=wt,y[2]=ht,y[3]=at,D.clearBufferuiv(D.COLOR,0,y)):(b[0]=vt,b[1]=wt,b[2]=ht,b[3]=at,D.clearBufferiv(D.COLOR,0,b))}else be|=D.COLOR_BUFFER_BIT}ce&&(be|=D.DEPTH_BUFFER_BIT),ve&&(be|=D.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),D.clear(be)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ke,!1),t.removeEventListener("webglcontextrestored",qe,!1),t.removeEventListener("webglcontextcreationerror",Ye,!1),lt.dispose(),Pe.dispose(),Qe.dispose(),j.dispose(),P.dispose(),Z.dispose(),K.dispose(),Ke.dispose(),ie.dispose(),de.dispose(),xe.dispose(),xe.removeEventListener("sessionstart",Tl),xe.removeEventListener("sessionend",$h),as.stop()};function ke(z){z.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function qe(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const z=B.autoReset,ce=je.enabled,ve=je.autoUpdate,be=je.needsUpdate,ue=je.type;He(),B.autoReset=z,je.enabled=ce,je.autoUpdate=ve,je.needsUpdate=be,je.type=ue}function Ye(z){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",z.statusMessage)}function ft(z){const ce=z.target;ce.removeEventListener("dispose",ft),tn(ce)}function tn(z){wn(z),j.remove(z)}function wn(z){const ce=j.get(z).programs;ce!==void 0&&(ce.forEach(function(ve){de.releaseProgram(ve)}),z.isShaderMaterial&&de.releaseShaderCache(z))}this.renderBufferDirect=function(z,ce,ve,be,ue,Ve){ce===null&&(ce=Be);const et=ue.isMesh&&ue.matrixWorld.determinant()<0,rt=rd(z,ce,ve,be,ue);N.setMaterial(be,et);let at=ve.index,vt=1;if(be.wireframe===!0){if(at=Q.getWireframeAttribute(ve),at===void 0)return;vt=2}const wt=ve.drawRange,ht=ve.attributes.position;let Vt=wt.start*vt,Yt=(wt.start+wt.count)*vt;Ve!==null&&(Vt=Math.max(Vt,Ve.start*vt),Yt=Math.min(Yt,(Ve.start+Ve.count)*vt)),at!==null?(Vt=Math.max(Vt,0),Yt=Math.min(Yt,at.count)):ht!=null&&(Vt=Math.max(Vt,0),Yt=Math.min(Yt,ht.count));const Nn=Yt-Vt;if(Nn<0||Nn===1/0)return;Ke.setup(ue,be,rt,ve,at);let Sn,Gt=Xe;if(at!==null&&(Sn=G.get(at),Gt=ne,Gt.setIndex(Sn)),ue.isMesh)be.wireframe===!0?(N.setLineWidth(be.wireframeLinewidth*X()),Gt.setMode(D.LINES)):Gt.setMode(D.TRIANGLES);else if(ue.isLine){let dt=be.linewidth;dt===void 0&&(dt=1),N.setLineWidth(dt*X()),ue.isLineSegments?Gt.setMode(D.LINES):ue.isLineLoop?Gt.setMode(D.LINE_LOOP):Gt.setMode(D.LINE_STRIP)}else ue.isPoints?Gt.setMode(D.POINTS):ue.isSprite&&Gt.setMode(D.TRIANGLES);if(ue.isBatchedMesh)if(ue._multiDrawInstances!==null)Gt.renderMultiDrawInstances(ue._multiDrawStarts,ue._multiDrawCounts,ue._multiDrawCount,ue._multiDrawInstances);else if(me.get("WEBGL_multi_draw"))Gt.renderMultiDraw(ue._multiDrawStarts,ue._multiDrawCounts,ue._multiDrawCount);else{const dt=ue._multiDrawStarts,Gn=ue._multiDrawCounts,Kt=ue._multiDrawCount,lr=at?G.get(at).bytesPerElement:1,ls=j.get(be).currentProgram.getUniforms();for(let Di=0;Di<Kt;Di++)ls.setValue(D,"_gl_DrawID",Di),Gt.render(dt[Di]/lr,Gn[Di])}else if(ue.isInstancedMesh)Gt.renderInstances(Vt,Nn,ue.count);else if(ve.isInstancedBufferGeometry){const dt=ve._maxInstanceCount!==void 0?ve._maxInstanceCount:1/0,Gn=Math.min(ve.instanceCount,dt);Gt.renderInstances(Vt,Nn,Gn)}else Gt.render(Vt,Nn)};function Nt(z,ce,ve){z.transparent===!0&&z.side===Yr&&z.forceSinglePass===!1?(z.side=Zi,z.needsUpdate=!0,Ll(z,ce,ve),z.side=ns,z.needsUpdate=!0,Ll(z,ce,ve),z.side=Yr):Ll(z,ce,ve)}this.compile=function(z,ce,ve=null){ve===null&&(ve=z),g=Qe.get(ve),g.init(ce),w.push(g),ve.traverseVisible(function(ue){ue.isLight&&ue.layers.test(ce.layers)&&(g.pushLight(ue),ue.castShadow&&g.pushShadow(ue))}),z!==ve&&z.traverseVisible(function(ue){ue.isLight&&ue.layers.test(ce.layers)&&(g.pushLight(ue),ue.castShadow&&g.pushShadow(ue))}),g.setupLights();const be=new Set;return z.traverse(function(ue){if(!(ue.isMesh||ue.isPoints||ue.isLine||ue.isSprite))return;const Ve=ue.material;if(Ve)if(Array.isArray(Ve))for(let et=0;et<Ve.length;et++){const rt=Ve[et];Nt(rt,ve,ue),be.add(rt)}else Nt(Ve,ve,ue),be.add(Ve)}),w.pop(),g=null,be},this.compileAsync=function(z,ce,ve=null){const be=this.compile(z,ce,ve);return new Promise(ue=>{function Ve(){if(be.forEach(function(et){j.get(et).currentProgram.isReady()&&be.delete(et)}),be.size===0){ue(z);return}setTimeout(Ve,10)}me.get("KHR_parallel_shader_compile")!==null?Ve():setTimeout(Ve,10)})};let mi=null;function os(z){mi&&mi(z)}function Tl(){as.stop()}function $h(){as.start()}const as=new oA;as.setAnimationLoop(os),typeof self<"u"&&as.setContext(self),this.setAnimationLoop=function(z){mi=z,xe.setAnimationLoop(z),z===null?as.stop():as.start()},xe.addEventListener("sessionstart",Tl),xe.addEventListener("sessionend",$h),this.render=function(z,ce){if(ce!==void 0&&ce.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(C===!0)return;if(z.matrixWorldAutoUpdate===!0&&z.updateMatrixWorld(),ce.parent===null&&ce.matrixWorldAutoUpdate===!0&&ce.updateMatrixWorld(),xe.enabled===!0&&xe.isPresenting===!0&&(xe.cameraAutoUpdate===!0&&xe.updateCamera(ce),ce=xe.getCamera()),z.isScene===!0&&z.onBeforeRender(S,z,ce,O),g=Qe.get(z,w.length),g.init(ce),w.push(g),Se.multiplyMatrices(ce.projectionMatrix,ce.matrixWorldInverse),_e.setFromProjectionMatrix(Se),We=this.localClippingEnabled,Ae=Ne.init(this.clippingPlanes,We),v=Pe.get(z,x.length),v.init(),x.push(v),xe.enabled===!0&&xe.isPresenting===!0){const Ve=S.xr.getDepthSensingMesh();Ve!==null&&eu(Ve,ce,-1/0,S.sortObjects)}eu(z,ce,0,S.sortObjects),v.finish(),S.sortObjects===!0&&v.sort(pe,Te),H=xe.enabled===!1||xe.isPresenting===!1||xe.hasDepthSensing()===!1,H&&lt.addToRenderList(v,z),this.info.render.frame++,Ae===!0&&Ne.beginShadows();const ve=g.state.shadowsArray;je.render(ve,z,ce),Ae===!0&&Ne.endShadows(),this.info.autoReset===!0&&this.info.reset();const be=v.opaque,ue=v.transmissive;if(g.setupLights(),ce.isArrayCamera){const Ve=ce.cameras;if(ue.length>0)for(let et=0,rt=Ve.length;et<rt;et++){const at=Ve[et];ed(be,ue,z,at)}H&&lt.render(z);for(let et=0,rt=Ve.length;et<rt;et++){const at=Ve[et];qh(v,z,at,at.viewport)}}else ue.length>0&&ed(be,ue,z,ce),H&&lt.render(z),qh(v,z,ce);O!==null&&(L.updateMultisampleRenderTarget(O),L.updateRenderTargetMipmap(O)),z.isScene===!0&&z.onAfterRender(S,z,ce),Ke.resetDefaultState(),R=-1,T=null,w.pop(),w.length>0?(g=w[w.length-1],Ae===!0&&Ne.setGlobalState(S.clippingPlanes,g.state.camera)):g=null,x.pop(),x.length>0?v=x[x.length-1]:v=null};function eu(z,ce,ve,be){if(z.visible===!1)return;if(z.layers.test(ce.layers)){if(z.isGroup)ve=z.renderOrder;else if(z.isLOD)z.autoUpdate===!0&&z.update(ce);else if(z.isLight)g.pushLight(z),z.castShadow&&g.pushShadow(z);else if(z.isSprite){if(!z.frustumCulled||_e.intersectsSprite(z)){be&&De.setFromMatrixPosition(z.matrixWorld).applyMatrix4(Se);const et=K.update(z),rt=z.material;rt.visible&&v.push(z,et,rt,ve,De.z,null)}}else if((z.isMesh||z.isLine||z.isPoints)&&(!z.frustumCulled||_e.intersectsObject(z))){const et=K.update(z),rt=z.material;if(be&&(z.boundingSphere!==void 0?(z.boundingSphere===null&&z.computeBoundingSphere(),De.copy(z.boundingSphere.center)):(et.boundingSphere===null&&et.computeBoundingSphere(),De.copy(et.boundingSphere.center)),De.applyMatrix4(z.matrixWorld).applyMatrix4(Se)),Array.isArray(rt)){const at=et.groups;for(let vt=0,wt=at.length;vt<wt;vt++){const ht=at[vt],Vt=rt[ht.materialIndex];Vt&&Vt.visible&&v.push(z,et,Vt,ve,De.z,ht)}}else rt.visible&&v.push(z,et,rt,ve,De.z,null)}}const Ve=z.children;for(let et=0,rt=Ve.length;et<rt;et++)eu(Ve[et],ce,ve,be)}function qh(z,ce,ve,be){const ue=z.opaque,Ve=z.transmissive,et=z.transparent;g.setupLightsView(ve),Ae===!0&&Ne.setGlobalState(S.clippingPlanes,ve),be&&N.viewport(k.copy(be)),ue.length>0&&El(ue,ce,ve),Ve.length>0&&El(Ve,ce,ve),et.length>0&&El(et,ce,ve),N.buffers.depth.setTest(!0),N.buffers.depth.setMask(!0),N.buffers.color.setMask(!0),N.setPolygonOffset(!1)}function ed(z,ce,ve,be){if((ve.isScene===!0?ve.overrideMaterial:null)!==null)return;g.state.transmissionRenderTarget[be.id]===void 0&&(g.state.transmissionRenderTarget[be.id]=new Ma(1,1,{generateMipmaps:!0,type:me.has("EXT_color_buffer_half_float")||me.has("EXT_color_buffer_float")?Ro:Uo,minFilter:Pr,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Jt.workingColorSpace}));const Ve=g.state.transmissionRenderTarget[be.id],et=be.viewport||k;Ve.setSize(et.z,et.w);const rt=S.getRenderTarget();S.setRenderTarget(Ve),S.getClearColor(re),ae=S.getClearAlpha(),ae<1&&S.setClearColor(16777215,.5),S.clear(),H&&lt.render(ve);const at=S.toneMapping;S.toneMapping=xa;const vt=be.viewport;if(be.viewport!==void 0&&(be.viewport=void 0),g.setupLightsView(be),Ae===!0&&Ne.setGlobalState(S.clippingPlanes,be),El(z,ve,be),L.updateMultisampleRenderTarget(Ve),L.updateRenderTargetMipmap(Ve),me.has("WEBGL_multisampled_render_to_texture")===!1){let wt=!1;for(let ht=0,Vt=ce.length;ht<Vt;ht++){const Yt=ce[ht],Nn=Yt.object,Sn=Yt.geometry,Gt=Yt.material,dt=Yt.group;if(Gt.side===Yr&&Nn.layers.test(be.layers)){const Gn=Gt.side;Gt.side=Zi,Gt.needsUpdate=!0,td(Nn,ve,be,Sn,Gt,dt),Gt.side=Gn,Gt.needsUpdate=!0,wt=!0}}wt===!0&&(L.updateMultisampleRenderTarget(Ve),L.updateRenderTargetMipmap(Ve))}S.setRenderTarget(rt),S.setClearColor(re,ae),vt!==void 0&&(be.viewport=vt),S.toneMapping=at}function El(z,ce,ve){const be=ce.isScene===!0?ce.overrideMaterial:null;for(let ue=0,Ve=z.length;ue<Ve;ue++){const et=z[ue],rt=et.object,at=et.geometry,vt=be===null?et.material:be,wt=et.group;rt.layers.test(ve.layers)&&td(rt,ce,ve,at,vt,wt)}}function td(z,ce,ve,be,ue,Ve){z.onBeforeRender(S,ce,ve,be,ue,Ve),z.modelViewMatrix.multiplyMatrices(ve.matrixWorldInverse,z.matrixWorld),z.normalMatrix.getNormalMatrix(z.modelViewMatrix),ue.onBeforeRender(S,ce,ve,be,z,Ve),ue.transparent===!0&&ue.side===Yr&&ue.forceSinglePass===!1?(ue.side=Zi,ue.needsUpdate=!0,S.renderBufferDirect(ve,ce,be,ue,z,Ve),ue.side=ns,ue.needsUpdate=!0,S.renderBufferDirect(ve,ce,be,ue,z,Ve),ue.side=Yr):S.renderBufferDirect(ve,ce,be,ue,z,Ve),z.onAfterRender(S,ce,ve,be,ue,Ve)}function Ll(z,ce,ve){ce.isScene!==!0&&(ce=Be);const be=j.get(z),ue=g.state.lights,Ve=g.state.shadowsArray,et=ue.state.version,rt=de.getParameters(z,ue.state,Ve,ce,ve),at=de.getProgramCacheKey(rt);let vt=be.programs;be.environment=z.isMeshStandardMaterial?ce.environment:null,be.fog=ce.fog,be.envMap=(z.isMeshStandardMaterial?Z:P).get(z.envMap||be.environment),be.envMapRotation=be.environment!==null&&z.envMap===null?ce.environmentRotation:z.envMapRotation,vt===void 0&&(z.addEventListener("dispose",ft),vt=new Map,be.programs=vt);let wt=vt.get(at);if(wt!==void 0){if(be.currentProgram===wt&&be.lightsStateVersion===et)return id(z,rt),wt}else rt.uniforms=de.getUniforms(z),z.onBeforeCompile(rt,S),wt=de.acquireProgram(rt,at),vt.set(at,wt),be.uniforms=rt.uniforms;const ht=be.uniforms;return(!z.isShaderMaterial&&!z.isRawShaderMaterial||z.clipping===!0)&&(ht.clippingPlanes=Ne.uniform),id(z,rt),be.needsLights=Mm(z),be.lightsStateVersion=et,be.needsLights&&(ht.ambientLightColor.value=ue.state.ambient,ht.lightProbe.value=ue.state.probe,ht.directionalLights.value=ue.state.directional,ht.directionalLightShadows.value=ue.state.directionalShadow,ht.spotLights.value=ue.state.spot,ht.spotLightShadows.value=ue.state.spotShadow,ht.rectAreaLights.value=ue.state.rectArea,ht.ltc_1.value=ue.state.rectAreaLTC1,ht.ltc_2.value=ue.state.rectAreaLTC2,ht.pointLights.value=ue.state.point,ht.pointLightShadows.value=ue.state.pointShadow,ht.hemisphereLights.value=ue.state.hemi,ht.directionalShadowMap.value=ue.state.directionalShadowMap,ht.directionalShadowMatrix.value=ue.state.directionalShadowMatrix,ht.spotShadowMap.value=ue.state.spotShadowMap,ht.spotLightMatrix.value=ue.state.spotLightMatrix,ht.spotLightMap.value=ue.state.spotLightMap,ht.pointShadowMap.value=ue.state.pointShadowMap,ht.pointShadowMatrix.value=ue.state.pointShadowMatrix),be.currentProgram=wt,be.uniformsList=null,wt}function nd(z){if(z.uniformsList===null){const ce=z.currentProgram.getUniforms();z.uniformsList=mp.seqWithValue(ce.seq,z.uniforms)}return z.uniformsList}function id(z,ce){const ve=j.get(z);ve.outputColorSpace=ce.outputColorSpace,ve.batching=ce.batching,ve.batchingColor=ce.batchingColor,ve.instancing=ce.instancing,ve.instancingColor=ce.instancingColor,ve.instancingMorph=ce.instancingMorph,ve.skinning=ce.skinning,ve.morphTargets=ce.morphTargets,ve.morphNormals=ce.morphNormals,ve.morphColors=ce.morphColors,ve.morphTargetsCount=ce.morphTargetsCount,ve.numClippingPlanes=ce.numClippingPlanes,ve.numIntersection=ce.numClipIntersection,ve.vertexAlphas=ce.vertexAlphas,ve.vertexTangents=ce.vertexTangents,ve.toneMapping=ce.toneMapping}function rd(z,ce,ve,be,ue){ce.isScene!==!0&&(ce=Be),L.resetTextureUnits();const Ve=ce.fog,et=be.isMeshStandardMaterial?ce.environment:null,rt=O===null?S.outputColorSpace:O.isXRRenderTarget===!0?O.texture.colorSpace:Wc,at=(be.isMeshStandardMaterial?Z:P).get(be.envMap||et),vt=be.vertexColors===!0&&!!ve.attributes.color&&ve.attributes.color.itemSize===4,wt=!!ve.attributes.tangent&&(!!be.normalMap||be.anisotropy>0),ht=!!ve.morphAttributes.position,Vt=!!ve.morphAttributes.normal,Yt=!!ve.morphAttributes.color;let Nn=xa;be.toneMapped&&(O===null||O.isXRRenderTarget===!0)&&(Nn=S.toneMapping);const Sn=ve.morphAttributes.position||ve.morphAttributes.normal||ve.morphAttributes.color,Gt=Sn!==void 0?Sn.length:0,dt=j.get(be),Gn=g.state.lights;if(Ae===!0&&(We===!0||z!==T)){const _i=z===T&&be.id===R;Ne.setState(be,z,_i)}let Kt=!1;be.version===dt.__version?(dt.needsLights&&dt.lightsStateVersion!==Gn.state.version||dt.outputColorSpace!==rt||ue.isBatchedMesh&&dt.batching===!1||!ue.isBatchedMesh&&dt.batching===!0||ue.isBatchedMesh&&dt.batchingColor===!0&&ue.colorTexture===null||ue.isBatchedMesh&&dt.batchingColor===!1&&ue.colorTexture!==null||ue.isInstancedMesh&&dt.instancing===!1||!ue.isInstancedMesh&&dt.instancing===!0||ue.isSkinnedMesh&&dt.skinning===!1||!ue.isSkinnedMesh&&dt.skinning===!0||ue.isInstancedMesh&&dt.instancingColor===!0&&ue.instanceColor===null||ue.isInstancedMesh&&dt.instancingColor===!1&&ue.instanceColor!==null||ue.isInstancedMesh&&dt.instancingMorph===!0&&ue.morphTexture===null||ue.isInstancedMesh&&dt.instancingMorph===!1&&ue.morphTexture!==null||dt.envMap!==at||be.fog===!0&&dt.fog!==Ve||dt.numClippingPlanes!==void 0&&(dt.numClippingPlanes!==Ne.numPlanes||dt.numIntersection!==Ne.numIntersection)||dt.vertexAlphas!==vt||dt.vertexTangents!==wt||dt.morphTargets!==ht||dt.morphNormals!==Vt||dt.morphColors!==Yt||dt.toneMapping!==Nn||dt.morphTargetsCount!==Gt)&&(Kt=!0):(Kt=!0,dt.__version=be.version);let lr=dt.currentProgram;Kt===!0&&(lr=Ll(be,ce,ue));let ls=!1,Di=!1,Ca=!1;const pn=lr.getUniforms(),Yi=dt.uniforms;if(N.useProgram(lr.program)&&(ls=!0,Di=!0,Ca=!0),be.id!==R&&(R=be.id,Di=!0),ls||T!==z){N.buffers.depth.getReversed()?(se.copy(z.projectionMatrix),wV(se),SV(se),pn.setValue(D,"projectionMatrix",se)):pn.setValue(D,"projectionMatrix",z.projectionMatrix),pn.setValue(D,"viewMatrix",z.matrixWorldInverse);const vi=pn.map.cameraPosition;vi!==void 0&&vi.setValue(D,Me.setFromMatrixPosition(z.matrixWorld)),fe.logarithmicDepthBuffer&&pn.setValue(D,"logDepthBufFC",2/(Math.log(z.far+1)/Math.LN2)),(be.isMeshPhongMaterial||be.isMeshToonMaterial||be.isMeshLambertMaterial||be.isMeshBasicMaterial||be.isMeshStandardMaterial||be.isShaderMaterial)&&pn.setValue(D,"isOrthographic",z.isOrthographicCamera===!0),T!==z&&(T=z,Di=!0,Ca=!0)}if(ue.isSkinnedMesh){pn.setOptional(D,ue,"bindMatrix"),pn.setOptional(D,ue,"bindMatrixInverse");const _i=ue.skeleton;_i&&(_i.boneTexture===null&&_i.computeBoneTexture(),pn.setValue(D,"boneTexture",_i.boneTexture,L))}ue.isBatchedMesh&&(pn.setOptional(D,ue,"batchingTexture"),pn.setValue(D,"batchingTexture",ue._matricesTexture,L),pn.setOptional(D,ue,"batchingIdTexture"),pn.setValue(D,"batchingIdTexture",ue._indirectTexture,L),pn.setOptional(D,ue,"batchingColorTexture"),ue._colorsTexture!==null&&pn.setValue(D,"batchingColorTexture",ue._colorsTexture,L));const Ni=ve.morphAttributes;if((Ni.position!==void 0||Ni.normal!==void 0||Ni.color!==void 0)&&ut.update(ue,ve,lr),(Di||dt.receiveShadow!==ue.receiveShadow)&&(dt.receiveShadow=ue.receiveShadow,pn.setValue(D,"receiveShadow",ue.receiveShadow)),be.isMeshGouraudMaterial&&be.envMap!==null&&(Yi.envMap.value=at,Yi.flipEnvMap.value=at.isCubeTexture&&at.isRenderTargetTexture===!1?-1:1),be.isMeshStandardMaterial&&be.envMap===null&&ce.environment!==null&&(Yi.envMapIntensity.value=ce.environmentIntensity),Di&&(pn.setValue(D,"toneMappingExposure",S.toneMappingExposure),dt.needsLights&&Sm(Yi,Ca),Ve&&be.fog===!0&&ye.refreshFogUniforms(Yi,Ve),ye.refreshMaterialUniforms(Yi,be,J,te,g.state.transmissionRenderTarget[z.id]),mp.upload(D,nd(dt),Yi,L)),be.isShaderMaterial&&be.uniformsNeedUpdate===!0&&(mp.upload(D,nd(dt),Yi,L),be.uniformsNeedUpdate=!1),be.isSpriteMaterial&&pn.setValue(D,"center",ue.center),pn.setValue(D,"modelViewMatrix",ue.modelViewMatrix),pn.setValue(D,"normalMatrix",ue.normalMatrix),pn.setValue(D,"modelMatrix",ue.matrixWorld),be.isShaderMaterial||be.isRawShaderMaterial){const _i=be.uniformsGroups;for(let vi=0,Ra=_i.length;vi<Ra;vi++){const cs=_i[vi];ie.update(cs,lr),ie.bind(cs,lr)}}return lr}function Sm(z,ce){z.ambientLightColor.needsUpdate=ce,z.lightProbe.needsUpdate=ce,z.directionalLights.needsUpdate=ce,z.directionalLightShadows.needsUpdate=ce,z.pointLights.needsUpdate=ce,z.pointLightShadows.needsUpdate=ce,z.spotLights.needsUpdate=ce,z.spotLightShadows.needsUpdate=ce,z.rectAreaLights.needsUpdate=ce,z.hemisphereLights.needsUpdate=ce}function Mm(z){return z.isMeshLambertMaterial||z.isMeshToonMaterial||z.isMeshPhongMaterial||z.isMeshStandardMaterial||z.isShadowMaterial||z.isShaderMaterial&&z.lights===!0}this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return O},this.setRenderTargetTextures=function(z,ce,ve){j.get(z.texture).__webglTexture=ce,j.get(z.depthTexture).__webglTexture=ve;const be=j.get(z);be.__hasExternalTextures=!0,be.__autoAllocateDepthBuffer=ve===void 0,be.__autoAllocateDepthBuffer||me.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),be.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(z,ce){const ve=j.get(z);ve.__webglFramebuffer=ce,ve.__useDefaultFramebuffer=ce===void 0},this.setRenderTarget=function(z,ce=0,ve=0){O=z,A=ce,E=ve;let be=!0,ue=null,Ve=!1,et=!1;if(z){const at=j.get(z);if(at.__useDefaultFramebuffer!==void 0)N.bindFramebuffer(D.FRAMEBUFFER,null),be=!1;else if(at.__webglFramebuffer===void 0)L.setupRenderTarget(z);else if(at.__hasExternalTextures)L.rebindTextures(z,j.get(z.texture).__webglTexture,j.get(z.depthTexture).__webglTexture);else if(z.depthBuffer){const ht=z.depthTexture;if(at.__boundDepthTexture!==ht){if(ht!==null&&j.has(ht)&&(z.width!==ht.image.width||z.height!==ht.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");L.setupDepthRenderbuffer(z)}}const vt=z.texture;(vt.isData3DTexture||vt.isDataArrayTexture||vt.isCompressedArrayTexture)&&(et=!0);const wt=j.get(z).__webglFramebuffer;z.isWebGLCubeRenderTarget?(Array.isArray(wt[ce])?ue=wt[ce][ve]:ue=wt[ce],Ve=!0):z.samples>0&&L.useMultisampledRTT(z)===!1?ue=j.get(z).__webglMultisampledFramebuffer:Array.isArray(wt)?ue=wt[ve]:ue=wt,k.copy(z.viewport),Y.copy(z.scissor),$=z.scissorTest}else k.copy(Le).multiplyScalar(J).floor(),Y.copy(Ue).multiplyScalar(J).floor(),$=tt;if(N.bindFramebuffer(D.FRAMEBUFFER,ue)&&be&&N.drawBuffers(z,ue),N.viewport(k),N.scissor(Y),N.setScissorTest($),Ve){const at=j.get(z.texture);D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+ce,at.__webglTexture,ve)}else if(et){const at=j.get(z.texture),vt=ce||0;D.framebufferTextureLayer(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,at.__webglTexture,ve||0,vt)}R=-1},this.readRenderTargetPixels=function(z,ce,ve,be,ue,Ve,et){if(!(z&&z.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let rt=j.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&et!==void 0&&(rt=rt[et]),rt){N.bindFramebuffer(D.FRAMEBUFFER,rt);try{const at=z.texture,vt=at.format,wt=at.type;if(!fe.textureFormatReadable(vt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!fe.textureTypeReadable(wt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ce>=0&&ce<=z.width-be&&ve>=0&&ve<=z.height-ue&&D.readPixels(ce,ve,be,ue,Ee.convert(vt),Ee.convert(wt),Ve)}finally{const at=O!==null?j.get(O).__webglFramebuffer:null;N.bindFramebuffer(D.FRAMEBUFFER,at)}}},this.readRenderTargetPixelsAsync=async function(z,ce,ve,be,ue,Ve,et){if(!(z&&z.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let rt=j.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&et!==void 0&&(rt=rt[et]),rt){const at=z.texture,vt=at.format,wt=at.type;if(!fe.textureFormatReadable(vt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!fe.textureTypeReadable(wt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(ce>=0&&ce<=z.width-be&&ve>=0&&ve<=z.height-ue){N.bindFramebuffer(D.FRAMEBUFFER,rt);const ht=D.createBuffer();D.bindBuffer(D.PIXEL_PACK_BUFFER,ht),D.bufferData(D.PIXEL_PACK_BUFFER,Ve.byteLength,D.STREAM_READ),D.readPixels(ce,ve,be,ue,Ee.convert(vt),Ee.convert(wt),0);const Vt=O!==null?j.get(O).__webglFramebuffer:null;N.bindFramebuffer(D.FRAMEBUFFER,Vt);const Yt=D.fenceSync(D.SYNC_GPU_COMMANDS_COMPLETE,0);return D.flush(),await xV(D,Yt,4),D.bindBuffer(D.PIXEL_PACK_BUFFER,ht),D.getBufferSubData(D.PIXEL_PACK_BUFFER,0,Ve),D.deleteBuffer(ht),D.deleteSync(Yt),Ve}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(z,ce=null,ve=0){z.isTexture!==!0&&(fc("WebGLRenderer: copyFramebufferToTexture function signature has changed."),ce=arguments[0]||null,z=arguments[1]);const be=Math.pow(2,-ve),ue=Math.floor(z.image.width*be),Ve=Math.floor(z.image.height*be),et=ce!==null?ce.x:0,rt=ce!==null?ce.y:0;L.setTexture2D(z,0),D.copyTexSubImage2D(D.TEXTURE_2D,ve,0,0,et,rt,ue,Ve),N.unbindTexture()};const Tm=D.createFramebuffer(),Em=D.createFramebuffer();this.copyTextureToTexture=function(z,ce,ve=null,be=null,ue=0,Ve=null){z.isTexture!==!0&&(fc("WebGLRenderer: copyTextureToTexture function signature has changed."),be=arguments[0]||null,z=arguments[1],ce=arguments[2],Ve=arguments[3]||0,ve=null),Ve===null&&(ue!==0?(fc("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ve=ue,ue=0):Ve=0);let et,rt,at,vt,wt,ht,Vt,Yt,Nn;const Sn=z.isCompressedTexture?z.mipmaps[Ve]:z.image;if(ve!==null)et=ve.max.x-ve.min.x,rt=ve.max.y-ve.min.y,at=ve.isBox3?ve.max.z-ve.min.z:1,vt=ve.min.x,wt=ve.min.y,ht=ve.isBox3?ve.min.z:0;else{const Ni=Math.pow(2,-ue);et=Math.floor(Sn.width*Ni),rt=Math.floor(Sn.height*Ni),z.isDataArrayTexture?at=Sn.depth:z.isData3DTexture?at=Math.floor(Sn.depth*Ni):at=1,vt=0,wt=0,ht=0}be!==null?(Vt=be.x,Yt=be.y,Nn=be.z):(Vt=0,Yt=0,Nn=0);const Gt=Ee.convert(ce.format),dt=Ee.convert(ce.type);let Gn;ce.isData3DTexture?(L.setTexture3D(ce,0),Gn=D.TEXTURE_3D):ce.isDataArrayTexture||ce.isCompressedArrayTexture?(L.setTexture2DArray(ce,0),Gn=D.TEXTURE_2D_ARRAY):(L.setTexture2D(ce,0),Gn=D.TEXTURE_2D),D.pixelStorei(D.UNPACK_FLIP_Y_WEBGL,ce.flipY),D.pixelStorei(D.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),D.pixelStorei(D.UNPACK_ALIGNMENT,ce.unpackAlignment);const Kt=D.getParameter(D.UNPACK_ROW_LENGTH),lr=D.getParameter(D.UNPACK_IMAGE_HEIGHT),ls=D.getParameter(D.UNPACK_SKIP_PIXELS),Di=D.getParameter(D.UNPACK_SKIP_ROWS),Ca=D.getParameter(D.UNPACK_SKIP_IMAGES);D.pixelStorei(D.UNPACK_ROW_LENGTH,Sn.width),D.pixelStorei(D.UNPACK_IMAGE_HEIGHT,Sn.height),D.pixelStorei(D.UNPACK_SKIP_PIXELS,vt),D.pixelStorei(D.UNPACK_SKIP_ROWS,wt),D.pixelStorei(D.UNPACK_SKIP_IMAGES,ht);const pn=z.isDataArrayTexture||z.isData3DTexture,Yi=ce.isDataArrayTexture||ce.isData3DTexture;if(z.isDepthTexture){const Ni=j.get(z),_i=j.get(ce),vi=j.get(Ni.__renderTarget),Ra=j.get(_i.__renderTarget);N.bindFramebuffer(D.READ_FRAMEBUFFER,vi.__webglFramebuffer),N.bindFramebuffer(D.DRAW_FRAMEBUFFER,Ra.__webglFramebuffer);for(let cs=0;cs<at;cs++)pn&&(D.framebufferTextureLayer(D.READ_FRAMEBUFFER,D.COLOR_ATTACHMENT0,j.get(z).__webglTexture,ue,ht+cs),D.framebufferTextureLayer(D.DRAW_FRAMEBUFFER,D.COLOR_ATTACHMENT0,j.get(ce).__webglTexture,Ve,Nn+cs)),D.blitFramebuffer(vt,wt,et,rt,Vt,Yt,et,rt,D.DEPTH_BUFFER_BIT,D.NEAREST);N.bindFramebuffer(D.READ_FRAMEBUFFER,null),N.bindFramebuffer(D.DRAW_FRAMEBUFFER,null)}else if(ue!==0||z.isRenderTargetTexture||j.has(z)){const Ni=j.get(z),_i=j.get(ce);N.bindFramebuffer(D.READ_FRAMEBUFFER,Tm),N.bindFramebuffer(D.DRAW_FRAMEBUFFER,Em);for(let vi=0;vi<at;vi++)pn?D.framebufferTextureLayer(D.READ_FRAMEBUFFER,D.COLOR_ATTACHMENT0,Ni.__webglTexture,ue,ht+vi):D.framebufferTexture2D(D.READ_FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_2D,Ni.__webglTexture,ue),Yi?D.framebufferTextureLayer(D.DRAW_FRAMEBUFFER,D.COLOR_ATTACHMENT0,_i.__webglTexture,Ve,Nn+vi):D.framebufferTexture2D(D.DRAW_FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_2D,_i.__webglTexture,Ve),ue!==0?D.blitFramebuffer(vt,wt,et,rt,Vt,Yt,et,rt,D.COLOR_BUFFER_BIT,D.NEAREST):Yi?D.copyTexSubImage3D(Gn,Ve,Vt,Yt,Nn+vi,vt,wt,et,rt):D.copyTexSubImage2D(Gn,Ve,Vt,Yt,vt,wt,et,rt);N.bindFramebuffer(D.READ_FRAMEBUFFER,null),N.bindFramebuffer(D.DRAW_FRAMEBUFFER,null)}else Yi?z.isDataTexture||z.isData3DTexture?D.texSubImage3D(Gn,Ve,Vt,Yt,Nn,et,rt,at,Gt,dt,Sn.data):ce.isCompressedArrayTexture?D.compressedTexSubImage3D(Gn,Ve,Vt,Yt,Nn,et,rt,at,Gt,Sn.data):D.texSubImage3D(Gn,Ve,Vt,Yt,Nn,et,rt,at,Gt,dt,Sn):z.isDataTexture?D.texSubImage2D(D.TEXTURE_2D,Ve,Vt,Yt,et,rt,Gt,dt,Sn.data):z.isCompressedTexture?D.compressedTexSubImage2D(D.TEXTURE_2D,Ve,Vt,Yt,Sn.width,Sn.height,Gt,Sn.data):D.texSubImage2D(D.TEXTURE_2D,Ve,Vt,Yt,et,rt,Gt,dt,Sn);D.pixelStorei(D.UNPACK_ROW_LENGTH,Kt),D.pixelStorei(D.UNPACK_IMAGE_HEIGHT,lr),D.pixelStorei(D.UNPACK_SKIP_PIXELS,ls),D.pixelStorei(D.UNPACK_SKIP_ROWS,Di),D.pixelStorei(D.UNPACK_SKIP_IMAGES,Ca),Ve===0&&ce.generateMipmaps&&D.generateMipmap(Gn),N.unbindTexture()},this.copyTextureToTexture3D=function(z,ce,ve=null,be=null,ue=0){return z.isTexture!==!0&&(fc("WebGLRenderer: copyTextureToTexture3D function signature has changed."),ve=arguments[0]||null,be=arguments[1]||null,z=arguments[2],ce=arguments[3],ue=arguments[4]||0),fc('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(z,ce,ve,be,ue)},this.initRenderTarget=function(z){j.get(z).__webglFramebuffer===void 0&&L.setupRenderTarget(z)},this.initTexture=function(z){z.isCubeTexture?L.setTextureCube(z,0):z.isData3DTexture?L.setTexture3D(z,0):z.isDataArrayTexture||z.isCompressedArrayTexture?L.setTexture2DArray(z,0):L.setTexture2D(z,0),N.unbindTexture()},this.resetState=function(){A=0,E=0,O=null,N.reset(),Ke.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Po}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=Jt._getDrawingBufferColorSpace(e),t.unpackColorSpace=Jt._getUnpackColorSpace()}}const fM={type:"change"},Nv={type:"start"},dA={type:"end"},Df=new wl,pM=new Vs,YZ=Math.cos(70*Ai.DEG2RAD),oi=new U,fr=2*Math.PI,hn={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Iy=1e-6;class KZ extends h5{constructor(e,t=null){super(e,t),this.state=hn.NONE,this.enabled=!0,this.target=new U,this.cursor=new U,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:yr.ROTATE,MIDDLE:yr.DOLLY,RIGHT:yr.PAN},this.touches={ONE:_r.ROTATE,TWO:_r.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new U,this._lastQuaternion=new Wn,this._lastTargetPosition=new U,this._quat=new Wn().setFromUnitVectors(e.up,new U(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Up,this._sphericalDelta=new Up,this._scale=1,this._panOffset=new U,this._rotateStart=new Ie,this._rotateEnd=new Ie,this._rotateDelta=new Ie,this._panStart=new Ie,this._panEnd=new Ie,this._panDelta=new Ie,this._dollyStart=new Ie,this._dollyEnd=new Ie,this._dollyDelta=new Ie,this._dollyDirection=new U,this._mouse=new Ie,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=QZ.bind(this),this._onPointerDown=JZ.bind(this),this._onPointerUp=$Z.bind(this),this._onContextMenu=s9.bind(this),this._onMouseWheel=t9.bind(this),this._onKeyDown=n9.bind(this),this._onTouchStart=i9.bind(this),this._onTouchMove=r9.bind(this),this._onMouseDown=qZ.bind(this),this._onMouseMove=e9.bind(this),this._interceptControlDown=o9.bind(this),this._interceptControlUp=a9.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(fM),this.update(),this.state=hn.NONE}update(e=null){const t=this.object.position;oi.copy(t).sub(this.target),oi.applyQuaternion(this._quat),this._spherical.setFromVector3(oi),this.autoRotate&&this.state===hn.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(i)&&isFinite(r)&&(i<-Math.PI?i+=fr:i>Math.PI&&(i-=fr),r<-Math.PI?r+=fr:r>Math.PI&&(r-=fr),i<=r?this._spherical.theta=Math.max(i,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+r)/2?Math.max(i,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(oi.setFromSpherical(this._spherical),oi.applyQuaternion(this._quatInverse),t.copy(this.target).add(oi),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=oi.length();o=this._clampDistance(a*this._scale);const l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){const a=new U(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;const c=new U(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),o=oi.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(Df.origin.copy(this.object.position),Df.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Df.direction))<YZ?this.object.lookAt(this.target):(pM.setFromNormalAndCoplanarPoint(this.object.up,this.target),Df.intersectPlane(pM,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>Iy||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Iy||this._lastTargetPosition.distanceToSquared(this.target)>Iy?(this.dispatchEvent(fM),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?fr/60*this.autoRotateSpeed*e:fr/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){oi.setFromMatrixColumn(t,0),oi.multiplyScalar(-e),this._panOffset.add(oi)}_panUp(e,t){this.screenSpacePanning===!0?oi.setFromMatrixColumn(t,1):(oi.setFromMatrixColumn(t,0),oi.crossVectors(this.object.up,oi)),oi.multiplyScalar(e),this._panOffset.add(oi)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;oi.copy(r).sub(this.target);let s=oi.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/i.clientHeight,this.object.matrix),this._panUp(2*t*s/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),r=e-i.left,s=t-i.top,o=i.width,a=i.height;this._mouse.x=r/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(fr*this._rotateDelta.x/t.clientHeight),this._rotateUp(fr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(fr*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-fr*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(fr*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-fr*this.rotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(i,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(i,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),r=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(fr*this._rotateDelta.x/t.clientHeight),this._rotateUp(fr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(i,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new Ie,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function JZ(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function QZ(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function $Z(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(dA),this.state=hn.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function qZ(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case yr.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=hn.DOLLY;break;case yr.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=hn.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=hn.ROTATE}break;case yr.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=hn.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=hn.PAN}break;default:this.state=hn.NONE}this.state!==hn.NONE&&this.dispatchEvent(Nv)}function e9(n){switch(this.state){case hn.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case hn.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case hn.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function t9(n){this.enabled===!1||this.enableZoom===!1||this.state!==hn.NONE||(n.preventDefault(),this.dispatchEvent(Nv),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(dA))}function n9(n){this.enabled!==!1&&this._handleKeyDown(n)}function i9(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case _r.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=hn.TOUCH_ROTATE;break;case _r.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=hn.TOUCH_PAN;break;default:this.state=hn.NONE}break;case 2:switch(this.touches.TWO){case _r.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=hn.TOUCH_DOLLY_PAN;break;case _r.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=hn.TOUCH_DOLLY_ROTATE;break;default:this.state=hn.NONE}break;default:this.state=hn.NONE}this.state!==hn.NONE&&this.dispatchEvent(Nv)}function r9(n){switch(this._trackPointer(n),this.state){case hn.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case hn.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case hn.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case hn.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=hn.NONE}}function s9(n){this.enabled!==!1&&n.preventDefault()}function o9(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function a9(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const l9={class:"min-h-screen bg-gray-900 text-white overflow-hidden flex flex-col relative"},c9={class:"relative z-10 pointer-events-none"},u9={class:"pointer-events-auto"},h9={class:"flex-1 flex flex-col justify-center items-center relative px-4 md:px-8 text-center max-w-5xl mx-auto z-10 pointer-events-none"},d9={class:"text-5xl md:text-7xl font-extrabold mb-6 tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300 animate-fade-in-up drop-shadow-lg filter shadow-blue-500/50"},f9={class:"text-xl md:text-3xl font-light text-gray-100 mb-6 md:mb-8 animate-fade-in-up delay-100 drop-shadow-md"},p9={class:"text-base md:text-lg text-gray-300 mb-8 md:mb-12 max-w-2xl mx-auto leading-relaxed animate-fade-in-up delay-200 drop-shadow-sm"},m9={class:"animate-fade-in-up delay-300 pointer-events-auto"},g9={class:"py-8 text-center text-gray-500 text-sm relative z-10 pointer-events-none"},y9={class:"pointer-events-auto"},_9=gt({__name:"LandingPage",setup(n){const{t:e}=Ht(),t=zt(null);let i,r,s,o,a,l,c,h,d,p,m;const y=()=>{if(!t.value)return;i=new WL,i.fog=new Lh(0,.002),r=new Kn(75,window.innerWidth/window.innerHeight,.1,1e3),r.position.z=2.2,r.position.x=.5,s=new hA({canvas:t.value,antialias:!0,alpha:!0}),s.setSize(window.innerWidth,window.innerHeight),s.setPixelRatio(Math.min(window.devicePixelRatio,2)),s.toneMapping=rv,s.toneMappingExposure=1,m=new KZ(r,s.domElement),m.enableDamping=!0,m.dampingFactor=.05,m.enableZoom=!1,m.enablePan=!1,m.autoRotate=!0,m.autoRotateSpeed=.5;const x=new jh,w=x.load(new URL("/assets/earth_map-d1pdJ3jg.jpg",import.meta.url).href),S=x.load(new URL("/assets/earth_specular-6aAFN27D.jpg",import.meta.url).href),C=x.load(new URL("/assets/earth_normal-BD2vMuPH.jpg",import.meta.url).href),A=x.load(new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sHDgwCEMBJZu0AAAAdaVRYdENvbW1lbnQAAAAAAENyZWF0ZWQgd2l0aCBHSU1QZC5lBwAABM5JREFUWMO1V0tPG2cUPZ4Hxh6DazIOrjFNqJs0FIMqWFgWQkatsmvVbtggKlSVRVf5AWz4AWz4AUSKEChll19QJYSXkECuhFxsHjEhxCYm+DWGMZ5HF72DJq4bAzFXurI0M/I5997v3u9cC65vTJVn2lX/xHINQOYSBLTLEuIuCWw4Z3IGAEvf6ASmVHjNzHCXBG4A0AjACsAOwEbO0nsFQBnAGYASAIl+ZRMR7SolMEdsByD09fV5R0ZGgg8ePPjW5/N1iqLYpuu6RZblciKR2I9Go69evnwZnZ+fjwI4IS8AKBIRzeQfJWCANwKwh0KhtrGxsYehUOin1tbW+zzP23ietzY2NnIAoGmaLsuyUiqVyvl8XtrY2NiamZn589mzZxsAUgCOAeQAnFI2tI+VxIjaAeDzoaGh7xYWFuZOTk6OZVk+12uYqqq6JEnn0Wg0OT4+/geAXwGEAdwDIFJQXC1wO4DWR48e/RCPxxclSSroVzRFUbSDg4P848ePFwH8DuAhkWih83TRQWxFOXgAwvDwcOfo6OhvXV1d39tsNtuVBwTDWBwOh1UUxVsMw1hXVlbSdCgNV43uYSvrHg6H24aHh38eHBz85TrgF9FYLHA4HLzH43FvbW2d7u/vG+dANp8FpqIlbd3d3V8Fg8EfBUFw4BONZVmL3+9vHhkZCQL4AoAHgJPK8G+yzC0XDofdoVAo5PP5vkadTBAEtr+/39ff3x8gAp/RPOEqx2qjx+NpvXv3bk9DQ0NDvQgwDIOWlhZrMBj8kgi0UJdxRgYMArzL5XJ7vd57qLPZ7Xamp6fnNgBXtQxcjFuHw+Hyer3t9SYgCAITCAScAJoBNNEY/08GOFVVrfVMv7kMNDntFD1vjIAPrlRN0xjckOm6biFQ3jwNPwDMZrOnqVTqfb3Bi8Wivru7W/VCYkwPlKOjo0IikXh7EwQikYgE4Nw0CfXKDCipVCoTj8df3QABbW1tLUc6oUgkFPMkVACUNjc337148eKvw8PDbJ2jP1taWkoCyNDVXDSECmNSK4qiKNLq6urW8+fPI/UicHx8rD59+jSVy+WOAKSJhKENwFItLtoxk8mwsixzHR0dHe3t7c5PAU+n09rs7OzJkydPYqVSaQfANoDXALIk31S2smU1TWMPDg7K5XKZ7+3t9TudTut1U7+wsFCcmJiIpdPpbQBxADsAknQWymYCOukBHYCuKApisdhpMpnURFEU79y503TVyKenpzOTk5M7e3t7MQKPV0Zv1gNm+awB0MvlshqLxfLb29uyJElWURSbXC4XXyvqxcXFs6mpqeTc3Nzu3t7e3wQcA7BPZ8Cov1pNlJplmQtAG8MwHV6v95tAINA5MDBwPxAIuLu6upr8fr/VAN3c3JQjkcjZ+vp6fnl5+d2bN29SuVzuNYAEpf01CdRChUL+X1VskHACuA3Ay3Fcu9vt7nA6nZ7m5uYWQRCaNE3jVVW15PP580KhIGUymWw2m00DOAJwSP4WwPtq4LX2Ao6USxNlQyS/RcQcdLGwlNIz6vEMAaZpNzCk2Pll94LK/cDYimxERiBwG10sxjgvEZBE0UpE6vxj+0Ct5bTaXthgEhRmja8QWNkkPGsuIpfdjpkK+cZUWTC0KredVmtD/gdlSl6EG4AMvQAAAABJRU5ErkJggg==",import.meta.url).href),E=new kp(1,64,64),O=new pp({map:w,specularMap:S,normalMap:C,color:11184810,specular:3355443,shininess:15,emissive:1122884,emissiveIntensity:.2});o=new Xt(E,O),o.rotation.y=4.7,o.rotation.x=.3;const R=new kp(1.2,64,64),T=new rs({vertexShader:`
      varying vec3 vNormal;
      void main() {
        vNormal = normalize(normalMatrix * normal);
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,fragmentShader:`
      varying vec3 vNormal;
      void main() {
        float intensity = pow(0.5 - dot(vNormal, vec3(0, 0, 1.0)), 3.0);
        gl_FragColor = vec4(0.3, 0.6, 1.0, 1.0) * intensity * 2.0;
      }
    `,blending:xh,side:Zi,transparent:!0});a=new Xt(R,T),i.add(a);const k=new Ev(1.35,.002,16,100),Y=new Ir({color:3900150,transparent:!0,opacity:.15});c=new Xt(k,Y),c.rotation.x=Math.PI/2,i.add(c),h=new Xt(k,Y),h.rotation.x=Math.PI/2,h.rotation.y=Math.PI/8,h.scale.set(1.05,1.05,1.05),i.add(h),d=new Xt(k,Y),d.rotation.x=Math.PI/2,d.rotation.y=-Math.PI/8,d.scale.set(1.02,1.02,1.02),i.add(d),i.add(o);const $=new Cv(1118481);i.add($);const re=new Ih(16777215,1.5);re.position.set(5,3,5),i.add(re);const ae=new Av(35071,5);ae.position.set(-5,0,2),ae.lookAt(o.position),i.add(ae);const V=new fn,te=2e3,J=new Float32Array(te*3),pe=new Float32Array(te*3);for(let Le=0;Le<te*3;Le+=3){let Ue=(Math.random()-.5)*25,tt=(Math.random()-.5)*25,_e=(Math.random()-.5)*25;const Ae=Math.sqrt(Ue*Ue+tt*tt+_e*_e);if(Ae<3){const se=3+Math.random()*10;Ue=Ue/Ae*se,tt=tt/Ae*se,_e=_e/Ae*se}J[Le]=Ue,J[Le+1]=tt,J[Le+2]=_e;const We=.5+Math.random()*.5;pe[Le]=We,pe[Le+1]=We,pe[Le+2]=We}V.setAttribute("position",new Ln(J,3)),V.setAttribute("color",new Ln(pe,3));const Te=new Zc({size:.1,map:A,sizeAttenuation:!0,alphaTest:.5,transparent:!0,vertexColors:!0,opacity:.8,blending:xh});l=new Xc(V,Te),i.add(l),window.addEventListener("resize",b),g()},b=()=>{!r||!s||(r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight))},v=x=>{if(x.target.closest("a, button"))return;const w=document.createElement("div");w.className="absolute rounded-full border border-blue-400/50 bg-blue-400/20 pointer-events-none animate-ripple",w.style.left=`${x.clientX}px`,w.style.top=`${x.clientY}px`,document.body.appendChild(w),setTimeout(()=>{w.remove()},1e3)},g=()=>{p=requestAnimationFrame(g),m&&m.update(),l&&(l.rotation.y-=1e-4),c&&(c.rotation.z+=.002,c.rotation.x=Math.PI/2+Math.sin(Date.now()*.001)*.1),h&&(h.rotation.z-=.0015),d&&(d.rotation.z+=.001),s.render(i,r)};return Dn(()=>{y()}),Vn(()=>{window.removeEventListener("resize",b),cancelAnimationFrame(p),s&&s.dispose(),m&&m.dispose(),window.removeEventListener("click",v)}),(x,w)=>{const S=Uh("router-link");return ot(),At("div",l9,[ee("canvas",{ref_key:"canvasRef",ref:t,class:"absolute inset-0 z-0 w-full h-full cursor-grab active:cursor-grabbing"},null,512),w[0]||(w[0]=ee("div",{class:"absolute inset-0 z-0 bg-gradient-to-b from-gray-900/60 via-gray-900/30 to-gray-900/90 pointer-events-none"},null,-1)),ee("div",c9,[ee("div",u9,[xt(mW)])]),ee("header",h9,[ee("h1",d9,Ze(Re(e)("home.title")),1),ee("p",f9,Ze(Re(e)("home.subtitle")),1),ee("p",p9,Ze(Re(e)("home.description")),1),ee("div",m9,[xt(S,{to:"/examples/basic-map",class:"inline-block px-8 md:px-10 py-3 md:py-4 bg-blue-600 hover:bg-blue-500 rounded-full font-bold text-lg text-white transition-all transform hover:scale-105 shadow-lg shadow-blue-900/50"},{default:yn(()=>[ul(Ze(Re(e)("home.getStarted")),1)]),_:1})])]),ee("footer",g9,[ee("span",y9," "+Ze(new Date().getFullYear())+" Terra-GL. All rights reserved.",1)])])}}}),v9=Vh(_9,[["__scopeId","data-v-022638ab"]]),b9="0.0.1-alpha.35",Dy={name:"Criska"};var ah=function(){var n=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(h){h.preventDefault(),i(++n%e.children.length)},!1);function t(h){return e.appendChild(h.dom),h}function i(h){for(var d=0;d<e.children.length;d++)e.children[d].style.display=d===h?"block":"none";n=h}var r=(performance||Date).now(),s=r,o=0,a=t(new ah.Panel("FPS","#0ff","#002")),l=t(new ah.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new ah.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:e,addPanel:t,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){o++;var h=(performance||Date).now();if(l.update(h-r,200),h>=s+1e3&&(a.update(o*1e3/(h-s),100),s=h,o=0,c)){var d=performance.memory;c.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return h},update:function(){r=this.end()},domElement:e,setMode:i}};ah.Panel=function(n,e,t){var i=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,h=2*o,d=3*o,p=15*o,m=74*o,y=30*o,b=document.createElement("canvas");b.width=a,b.height=l,b.style.cssText="width:80px;height:48px";var v=b.getContext("2d");return v.font="bold "+9*o+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=t,v.fillRect(0,0,a,l),v.fillStyle=e,v.fillText(n,c,h),v.fillRect(d,p,m,y),v.fillStyle=t,v.globalAlpha=.9,v.fillRect(d,p,m,y),{dom:b,update:function(g,x){i=Math.min(i,g),r=Math.max(r,g),v.fillStyle=t,v.globalAlpha=1,v.fillRect(0,0,a,p),v.fillStyle=e,v.fillText(s(g)+" "+n+" ("+s(i)+"-"+s(r)+")",c,h),v.drawImage(b,d+o,p,m-o,y,d,p,m-o,y),v.fillRect(d+m-o,p,o,y),v.fillStyle=t,v.globalAlpha=.9,v.fillRect(d+m-o,p,o,s((1-g/x)*y))}}};const _m=parseInt(Gh.replace(/\D+/g,"")),Ov=_m>=125?"uv1":"uv2";function mM(n,e){if(e===jW)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===d_||e===IL){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(t)if(e===d_)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}var Jr=Uint8Array,dl=Uint16Array,x_=Uint32Array,fA=new Jr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),pA=new Jr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),x9=new Jr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mA=function(n,e){for(var t=new dl(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var r=new x_(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return[t,r]},gA=mA(fA,2),yA=gA[0],w9=gA[1];yA[28]=258,w9[258]=28;var S9=mA(pA,0),M9=S9[0],_A=new dl(32768);for(var En=0;En<32768;++En){var ra=(En&43690)>>>1|(En&21845)<<1;ra=(ra&52428)>>>2|(ra&13107)<<2,ra=(ra&61680)>>>4|(ra&3855)<<4,_A[En]=((ra&65280)>>>8|(ra&255)<<8)>>>1}var lh=function(n,e,t){for(var i=n.length,r=0,s=new dl(e);r<i;++r)++s[n[r]-1];var o=new dl(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;{a=new dl(1<<e);var l=15-e;for(r=0;r<i;++r)if(n[r])for(var c=r<<4|n[r],h=e-n[r],d=o[n[r]-1]++<<h,p=d|(1<<h)-1;d<=p;++d)a[_A[d]>>>l]=c}return a},Yh=new Jr(288);for(var En=0;En<144;++En)Yh[En]=8;for(var En=144;En<256;++En)Yh[En]=9;for(var En=256;En<280;++En)Yh[En]=7;for(var En=280;En<288;++En)Yh[En]=8;var vA=new Jr(32);for(var En=0;En<32;++En)vA[En]=5;var T9=lh(Yh,9),E9=lh(vA,5),Ny=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},ys=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(e&7)&t},Oy=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},L9=function(n){return(n/8|0)+(n&7&&1)},A9=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var i=new(n instanceof dl?dl:n instanceof x_?x_:Jr)(t-e);return i.set(n.subarray(e,t)),i},C9=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new Jr(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new Jr(i*3));var o=function(We){var se=e.length;if(We>se){var Se=new Jr(Math.max(se*2,We));Se.set(e),e=Se}},a=t.f||0,l=t.p||0,c=t.b||0,h=t.l,d=t.d,p=t.m,m=t.n,y=i*8;do{if(!h){t.f=a=ys(n,l,1);var b=ys(n,l+1,3);if(l+=3,b)if(b==1)h=T9,d=E9,p=9,m=5;else if(b==2){var v=ys(n,l,31)+257,g=ys(n,l+10,15)+4,x=v+ys(n,l+5,31)+1;l+=14;for(var w=new Jr(x),S=new Jr(19),C=0;C<g;++C)S[x9[C]]=ys(n,l+C*3,7);l+=g*3;for(var A=Ny(S),E=(1<<A)-1,O=lh(S,A),C=0;C<x;){var R=O[ys(n,l,E)];l+=R&15;var T=R>>>4;if(T<16)w[C++]=T;else{var k=0,Y=0;for(T==16?(Y=3+ys(n,l,3),l+=2,k=w[C-1]):T==17?(Y=3+ys(n,l,7),l+=3):T==18&&(Y=11+ys(n,l,127),l+=7);Y--;)w[C++]=k}}var $=w.subarray(0,v),re=w.subarray(v);p=Ny($),m=Ny(re),h=lh($,p),d=lh(re,m)}else throw"invalid block type";else{var T=L9(l)+4,ae=n[T-4]|n[T-3]<<8,V=T+ae;if(V>i){if(s)throw"unexpected EOF";break}r&&o(c+ae),e.set(n.subarray(T,V),c),t.b=c+=ae,t.p=l=V*8;continue}if(l>y){if(s)throw"unexpected EOF";break}}r&&o(c+131072);for(var te=(1<<p)-1,J=(1<<m)-1,pe=l;;pe=l){var k=h[Oy(n,l)&te],Te=k>>>4;if(l+=k&15,l>y){if(s)throw"unexpected EOF";break}if(!k)throw"invalid length/literal";if(Te<256)e[c++]=Te;else if(Te==256){pe=l,h=null;break}else{var Le=Te-254;if(Te>264){var C=Te-257,Ue=fA[C];Le=ys(n,l,(1<<Ue)-1)+yA[C],l+=Ue}var tt=d[Oy(n,l)&J],_e=tt>>>4;if(!tt)throw"invalid distance";l+=tt&15;var re=M9[_e];if(_e>3){var Ue=pA[_e];re+=Oy(n,l)&(1<<Ue)-1,l+=Ue}if(l>y){if(s)throw"unexpected EOF";break}r&&o(c+131072);for(var Ae=c+Le;c<Ae;c+=4)e[c]=e[c-re],e[c+1]=e[c+1-re],e[c+2]=e[c+2-re],e[c+3]=e[c+3-re];c=Ae}}t.l=h,t.p=pe,t.b=c,h&&(a=1,t.m=p,t.d=d,t.n=m)}while(!a);return c==e.length?e:A9(e,0,c)},R9=new Jr(0),P9=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function I9(n,e){return C9((P9(n),n.subarray(2,-4)),e)}var D9=typeof TextDecoder<"u"&&new TextDecoder,N9=0;try{D9.decode(R9,{stream:!0}),N9=1}catch{}class O9 extends Xt{constructor(e,t={}){super(e),this.isWater=!0;const i=this,r=t.textureWidth!==void 0?t.textureWidth:512,s=t.textureHeight!==void 0?t.textureHeight:512,o=t.clipBias!==void 0?t.clipBias:0,a=t.alpha!==void 0?t.alpha:1,l=t.time!==void 0?t.time:0,c=t.waterNormals!==void 0?t.waterNormals:null,h=t.sunDirection!==void 0?t.sunDirection:new U(.70707,.70707,0),d=new Ge(t.sunColor!==void 0?t.sunColor:16777215),p=new Ge(t.waterColor!==void 0?t.waterColor:8355711),m=t.eye!==void 0?t.eye:new U(0,0,0),y=t.distortionScale!==void 0?t.distortionScale:20,b=t.side!==void 0?t.side:ns,v=t.fog!==void 0?t.fog:!1,g=new Vs,x=new U,w=new U,S=new U,C=new nt,A=new U(0,0,-1),E=new Ct,O=new U,R=new U,T=new Ct,k=new nt,Y=new Kn,$=new Ma(r,s),re={uniforms:Eh.merge([Je.fog,Je.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new nt},sunColor:{value:new Ge(8355711)},sunDirection:{value:new U(.70707,.70707,0)},eye:{value:new U},waterColor:{value:new Ge(5592405)}}]),vertexShader:`
				uniform mat4 textureMatrix;
				uniform float time;

				varying vec4 mirrorCoord;
				varying vec4 worldPosition;

				#include <common>
				#include <fog_pars_vertex>
				#include <shadowmap_pars_vertex>
				#include <logdepthbuf_pars_vertex>

				void main() {
					mirrorCoord = modelMatrix * vec4( position, 1.0 );
					worldPosition = mirrorCoord.xyzw;
					mirrorCoord = textureMatrix * mirrorCoord;
					vec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );
					gl_Position = projectionMatrix * mvPosition;

				#include <beginnormal_vertex>
				#include <defaultnormal_vertex>
				#include <logdepthbuf_vertex>
				#include <fog_vertex>
				#include <shadowmap_vertex>
			}`,fragmentShader:`
				uniform sampler2D mirrorSampler;
				uniform float alpha;
				uniform float time;
				uniform float size;
				uniform float distortionScale;
				uniform sampler2D normalSampler;
				uniform vec3 sunColor;
				uniform vec3 sunDirection;
				uniform vec3 eye;
				uniform vec3 waterColor;

				varying vec4 mirrorCoord;
				varying vec4 worldPosition;

				vec4 getNoise( vec2 uv ) {
					vec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);
					vec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );
					vec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );
					vec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );
					vec4 noise = texture2D( normalSampler, uv0 ) +
						texture2D( normalSampler, uv1 ) +
						texture2D( normalSampler, uv2 ) +
						texture2D( normalSampler, uv3 );
					return noise * 0.5 - 1.0;
				}

				void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {
					vec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );
					float direction = max( 0.0, dot( eyeDirection, reflection ) );
					specularColor += pow( direction, shiny ) * sunColor * spec;
					diffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;
				}

				#include <common>
				#include <packing>
				#include <bsdfs>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <lights_pars_begin>
				#include <shadowmap_pars_fragment>
				#include <shadowmask_pars_fragment>

				void main() {

					#include <logdepthbuf_fragment>
					vec4 noise = getNoise( worldPosition.xz * size );
					vec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );

					vec3 diffuseLight = vec3(0.0);
					vec3 specularLight = vec3(0.0);

					vec3 worldToEye = eye-worldPosition.xyz;
					vec3 eyeDirection = normalize( worldToEye );
					sunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );

					float distance = length(worldToEye);

					vec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;
					vec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );

					float theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );
					float rf0 = 0.3;
					float reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );
					vec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;
					vec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);
					vec3 outgoingLight = albedo;
					gl_FragColor = vec4( outgoingLight, alpha );

					#include <tonemapping_fragment>
					#include <${_m>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>	
				}`},ae=new rs({fragmentShader:re.fragmentShader,vertexShader:re.vertexShader,uniforms:Eh.clone(re.uniforms),lights:!0,side:b,fog:v});ae.uniforms.mirrorSampler.value=$.texture,ae.uniforms.textureMatrix.value=k,ae.uniforms.alpha.value=a,ae.uniforms.time.value=l,ae.uniforms.normalSampler.value=c,ae.uniforms.sunColor.value=d,ae.uniforms.waterColor.value=p,ae.uniforms.sunDirection.value=h,ae.uniforms.distortionScale.value=y,ae.uniforms.eye.value=m,i.material=ae,i.onBeforeRender=function(V,te,J){if(w.setFromMatrixPosition(i.matrixWorld),S.setFromMatrixPosition(J.matrixWorld),C.extractRotation(i.matrixWorld),x.set(0,0,1),x.applyMatrix4(C),O.subVectors(w,S),O.dot(x)>0)return;O.reflect(x).negate(),O.add(w),C.extractRotation(J.matrixWorld),A.set(0,0,-1),A.applyMatrix4(C),A.add(S),R.subVectors(w,A),R.reflect(x).negate(),R.add(w),Y.position.copy(O),Y.up.set(0,1,0),Y.up.applyMatrix4(C),Y.up.reflect(x),Y.lookAt(R),Y.far=J.far,Y.updateMatrixWorld(),Y.projectionMatrix.copy(J.projectionMatrix),k.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),k.multiply(Y.projectionMatrix),k.multiply(Y.matrixWorldInverse),g.setFromNormalAndCoplanarPoint(x,w),g.applyMatrix4(Y.matrixWorldInverse),E.set(g.normal.x,g.normal.y,g.normal.z,g.constant);const pe=Y.projectionMatrix;T.x=(Math.sign(E.x)+pe.elements[8])/pe.elements[0],T.y=(Math.sign(E.y)+pe.elements[9])/pe.elements[5],T.z=-1,T.w=(1+pe.elements[10])/pe.elements[14],E.multiplyScalar(2/E.dot(T)),pe.elements[2]=E.x,pe.elements[6]=E.y,pe.elements[10]=E.z+1-o,pe.elements[14]=E.w,m.setFromMatrixPosition(J.matrixWorld);const Te=V.getRenderTarget(),Le=V.xr.enabled,Ue=V.shadowMap.autoUpdate;i.visible=!1,V.xr.enabled=!1,V.shadowMap.autoUpdate=!1,V.setRenderTarget($),V.state.buffers.depth.setMask(!0),V.autoClear===!1&&V.clear(),V.render(te,Y),i.visible=!0,V.xr.enabled=Le,V.shadowMap.autoUpdate=Ue,V.setRenderTarget(Te);const tt=J.viewport;tt!==void 0&&V.state.viewport(tt)}}}var k9=Object.defineProperty,F9=(n,e,t)=>e in n?k9(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,U9=(n,e,t)=>(F9(n,e+"",t),t);class z9{constructor(){U9(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const i=t.slice(0);for(let r=0,s=i.length;r<s;r++)i[r].call(this,e);e.target=null}}}var W9=Object.defineProperty,V9=(n,e,t)=>e in n?W9(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pt=(n,e,t)=>(V9(n,typeof e!="symbol"?e+"":e,t),t);const Nf=new wl,gM=new Vs,G9=Math.cos(70*(Math.PI/180)),yM=(n,e)=>(n%e+e)%e;class B9 extends z9{constructor(e,t){super(),pt(this,"object"),pt(this,"domElement"),pt(this,"enabled",!0),pt(this,"target",new U),pt(this,"minDistance",0),pt(this,"maxDistance",1/0),pt(this,"minZoom",0),pt(this,"maxZoom",1/0),pt(this,"minPolarAngle",0),pt(this,"maxPolarAngle",Math.PI),pt(this,"minAzimuthAngle",-1/0),pt(this,"maxAzimuthAngle",1/0),pt(this,"enableDamping",!1),pt(this,"dampingFactor",.05),pt(this,"enableZoom",!0),pt(this,"zoomSpeed",1),pt(this,"enableRotate",!0),pt(this,"rotateSpeed",1),pt(this,"enablePan",!0),pt(this,"panSpeed",1),pt(this,"screenSpacePanning",!0),pt(this,"keyPanSpeed",7),pt(this,"zoomToCursor",!1),pt(this,"autoRotate",!1),pt(this,"autoRotateSpeed",2),pt(this,"reverseOrbit",!1),pt(this,"reverseHorizontalOrbit",!1),pt(this,"reverseVerticalOrbit",!1),pt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),pt(this,"mouseButtons",{LEFT:yr.ROTATE,MIDDLE:yr.DOLLY,RIGHT:yr.PAN}),pt(this,"touches",{ONE:_r.ROTATE,TWO:_r.DOLLY_PAN}),pt(this,"target0"),pt(this,"position0"),pt(this,"zoom0"),pt(this,"_domElementKeyEvents",null),pt(this,"getPolarAngle"),pt(this,"getAzimuthalAngle"),pt(this,"setPolarAngle"),pt(this,"setAzimuthalAngle"),pt(this,"getDistance"),pt(this,"getZoomScale"),pt(this,"listenToKeyEvents"),pt(this,"stopListenToKeyEvents"),pt(this,"saveState"),pt(this,"reset"),pt(this,"update"),pt(this,"connect"),pt(this,"dispose"),pt(this,"dollyIn"),pt(this,"dollyOut"),pt(this,"getScale"),pt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=ne=>{let Ee=yM(ne,2*Math.PI),Ke=h.phi;Ke<0&&(Ke+=2*Math.PI),Ee<0&&(Ee+=2*Math.PI);let ie=Math.abs(Ee-Ke);2*Math.PI-ie<ie&&(Ee<Ke?Ee+=2*Math.PI:Ke+=2*Math.PI),d.phi=Ee-Ke,i.update()},this.setAzimuthalAngle=ne=>{let Ee=yM(ne,2*Math.PI),Ke=h.theta;Ke<0&&(Ke+=2*Math.PI),Ee<0&&(Ee+=2*Math.PI);let ie=Math.abs(Ee-Ke);2*Math.PI-ie<ie&&(Ee<Ke?Ee+=2*Math.PI:Ke+=2*Math.PI),d.theta=Ee-Ke,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=ne=>{ne.addEventListener("keydown",ye),this._domElementKeyEvents=ne},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ye),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{const ne=new U,Ee=new U(0,1,0),Ke=new Wn().setFromUnitVectors(e.up,Ee),ie=Ke.clone().invert(),He=new U,xe=new Wn,ke=2*Math.PI;return function(){const qe=i.object.position;Ke.setFromUnitVectors(e.up,Ee),ie.copy(Ke).invert(),ne.copy(qe).sub(i.target),ne.applyQuaternion(Ke),h.setFromVector3(ne),i.autoRotate&&l===a.NONE&&re(Y()),i.enableDamping?(h.theta+=d.theta*i.dampingFactor,h.phi+=d.phi*i.dampingFactor):(h.theta+=d.theta,h.phi+=d.phi);let Ye=i.minAzimuthAngle,ft=i.maxAzimuthAngle;isFinite(Ye)&&isFinite(ft)&&(Ye<-Math.PI?Ye+=ke:Ye>Math.PI&&(Ye-=ke),ft<-Math.PI?ft+=ke:ft>Math.PI&&(ft-=ke),Ye<=ft?h.theta=Math.max(Ye,Math.min(ft,h.theta)):h.theta=h.theta>(Ye+ft)/2?Math.max(Ye,h.theta):Math.min(ft,h.theta)),h.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,h.phi)),h.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(m,i.dampingFactor):i.target.add(m),i.zoomToCursor&&R||i.object.isOrthographicCamera?h.radius=tt(h.radius):h.radius=tt(h.radius*p),ne.setFromSpherical(h),ne.applyQuaternion(ie),qe.copy(i.target).add(ne),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,m.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),m.set(0,0,0));let tn=!1;if(i.zoomToCursor&&R){let wn=null;if(i.object instanceof Kn&&i.object.isPerspectiveCamera){const Nt=ne.length();wn=tt(Nt*p);const mi=Nt-wn;i.object.position.addScaledVector(E,mi),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Nt=new U(O.x,O.y,0);Nt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/p)),i.object.updateProjectionMatrix(),tn=!0;const mi=new U(O.x,O.y,0);mi.unproject(i.object),i.object.position.sub(mi).add(Nt),i.object.updateMatrixWorld(),wn=ne.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;wn!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(wn).add(i.object.position):(Nf.origin.copy(i.object.position),Nf.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Nf.direction))<G9?e.lookAt(i.target):(gM.setFromNormalAndCoplanarPoint(i.object.up,i.target),Nf.intersectPlane(gM,i.target))))}else i.object instanceof hl&&i.object.isOrthographicCamera&&(tn=p!==1,tn&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/p)),i.object.updateProjectionMatrix()));return p=1,R=!1,tn||He.distanceToSquared(i.object.position)>c||8*(1-xe.dot(i.object.quaternion))>c?(i.dispatchEvent(r),He.copy(i.object.position),xe.copy(i.object.quaternion),tn=!1,!0):!1}})(),this.connect=ne=>{i.domElement=ne,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Ne),i.domElement.addEventListener("pointerdown",P),i.domElement.addEventListener("pointercancel",G),i.domElement.addEventListener("wheel",de)},this.dispose=()=>{var ne,Ee,Ke,ie,He,xe;i.domElement&&(i.domElement.style.touchAction="auto"),(ne=i.domElement)==null||ne.removeEventListener("contextmenu",Ne),(Ee=i.domElement)==null||Ee.removeEventListener("pointerdown",P),(Ke=i.domElement)==null||Ke.removeEventListener("pointercancel",G),(ie=i.domElement)==null||ie.removeEventListener("wheel",de),(He=i.domElement)==null||He.ownerDocument.removeEventListener("pointermove",Z),(xe=i.domElement)==null||xe.ownerDocument.removeEventListener("pointerup",G),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",ye)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new Up,d=new Up;let p=1;const m=new U,y=new Ie,b=new Ie,v=new Ie,g=new Ie,x=new Ie,w=new Ie,S=new Ie,C=new Ie,A=new Ie,E=new U,O=new Ie;let R=!1;const T=[],k={};function Y(){return 2*Math.PI/60/60*i.autoRotateSpeed}function $(){return Math.pow(.95,i.zoomSpeed)}function re(ne){i.reverseOrbit||i.reverseHorizontalOrbit?d.theta+=ne:d.theta-=ne}function ae(ne){i.reverseOrbit||i.reverseVerticalOrbit?d.phi+=ne:d.phi-=ne}const V=(()=>{const ne=new U;return function(Ee,Ke){ne.setFromMatrixColumn(Ke,0),ne.multiplyScalar(-Ee),m.add(ne)}})(),te=(()=>{const ne=new U;return function(Ee,Ke){i.screenSpacePanning===!0?ne.setFromMatrixColumn(Ke,1):(ne.setFromMatrixColumn(Ke,0),ne.crossVectors(i.object.up,ne)),ne.multiplyScalar(Ee),m.add(ne)}})(),J=(()=>{const ne=new U;return function(Ee,Ke){const ie=i.domElement;if(ie&&i.object instanceof Kn&&i.object.isPerspectiveCamera){const He=i.object.position;ne.copy(He).sub(i.target);let xe=ne.length();xe*=Math.tan(i.object.fov/2*Math.PI/180),V(2*Ee*xe/ie.clientHeight,i.object.matrix),te(2*Ke*xe/ie.clientHeight,i.object.matrix)}else ie&&i.object instanceof hl&&i.object.isOrthographicCamera?(V(Ee*(i.object.right-i.object.left)/i.object.zoom/ie.clientWidth,i.object.matrix),te(Ke*(i.object.top-i.object.bottom)/i.object.zoom/ie.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function pe(ne){i.object instanceof Kn&&i.object.isPerspectiveCamera||i.object instanceof hl&&i.object.isOrthographicCamera?p=ne:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Te(ne){pe(p/ne)}function Le(ne){pe(p*ne)}function Ue(ne){if(!i.zoomToCursor||!i.domElement)return;R=!0;const Ee=i.domElement.getBoundingClientRect(),Ke=ne.clientX-Ee.left,ie=ne.clientY-Ee.top,He=Ee.width,xe=Ee.height;O.x=Ke/He*2-1,O.y=-(ie/xe)*2+1,E.set(O.x,O.y,1).unproject(i.object).sub(i.object.position).normalize()}function tt(ne){return Math.max(i.minDistance,Math.min(i.maxDistance,ne))}function _e(ne){y.set(ne.clientX,ne.clientY)}function Ae(ne){Ue(ne),S.set(ne.clientX,ne.clientY)}function We(ne){g.set(ne.clientX,ne.clientY)}function se(ne){b.set(ne.clientX,ne.clientY),v.subVectors(b,y).multiplyScalar(i.rotateSpeed);const Ee=i.domElement;Ee&&(re(2*Math.PI*v.x/Ee.clientHeight),ae(2*Math.PI*v.y/Ee.clientHeight)),y.copy(b),i.update()}function Se(ne){C.set(ne.clientX,ne.clientY),A.subVectors(C,S),A.y>0?Te($()):A.y<0&&Le($()),S.copy(C),i.update()}function Me(ne){x.set(ne.clientX,ne.clientY),w.subVectors(x,g).multiplyScalar(i.panSpeed),J(w.x,w.y),g.copy(x),i.update()}function De(ne){Ue(ne),ne.deltaY<0?Le($()):ne.deltaY>0&&Te($()),i.update()}function Be(ne){let Ee=!1;switch(ne.code){case i.keys.UP:J(0,i.keyPanSpeed),Ee=!0;break;case i.keys.BOTTOM:J(0,-i.keyPanSpeed),Ee=!0;break;case i.keys.LEFT:J(i.keyPanSpeed,0),Ee=!0;break;case i.keys.RIGHT:J(-i.keyPanSpeed,0),Ee=!0;break}Ee&&(ne.preventDefault(),i.update())}function H(){if(T.length==1)y.set(T[0].pageX,T[0].pageY);else{const ne=.5*(T[0].pageX+T[1].pageX),Ee=.5*(T[0].pageY+T[1].pageY);y.set(ne,Ee)}}function X(){if(T.length==1)g.set(T[0].pageX,T[0].pageY);else{const ne=.5*(T[0].pageX+T[1].pageX),Ee=.5*(T[0].pageY+T[1].pageY);g.set(ne,Ee)}}function D(){const ne=T[0].pageX-T[1].pageX,Ee=T[0].pageY-T[1].pageY,Ke=Math.sqrt(ne*ne+Ee*Ee);S.set(0,Ke)}function ge(){i.enableZoom&&D(),i.enablePan&&X()}function me(){i.enableZoom&&D(),i.enableRotate&&H()}function fe(ne){if(T.length==1)b.set(ne.pageX,ne.pageY);else{const Ke=Xe(ne),ie=.5*(ne.pageX+Ke.x),He=.5*(ne.pageY+Ke.y);b.set(ie,He)}v.subVectors(b,y).multiplyScalar(i.rotateSpeed);const Ee=i.domElement;Ee&&(re(2*Math.PI*v.x/Ee.clientHeight),ae(2*Math.PI*v.y/Ee.clientHeight)),y.copy(b)}function N(ne){if(T.length==1)x.set(ne.pageX,ne.pageY);else{const Ee=Xe(ne),Ke=.5*(ne.pageX+Ee.x),ie=.5*(ne.pageY+Ee.y);x.set(Ke,ie)}w.subVectors(x,g).multiplyScalar(i.panSpeed),J(w.x,w.y),g.copy(x)}function B(ne){const Ee=Xe(ne),Ke=ne.pageX-Ee.x,ie=ne.pageY-Ee.y,He=Math.sqrt(Ke*Ke+ie*ie);C.set(0,He),A.set(0,Math.pow(C.y/S.y,i.zoomSpeed)),Te(A.y),S.copy(C)}function j(ne){i.enableZoom&&B(ne),i.enablePan&&N(ne)}function L(ne){i.enableZoom&&B(ne),i.enableRotate&&fe(ne)}function P(ne){var Ee,Ke;i.enabled!==!1&&(T.length===0&&((Ee=i.domElement)==null||Ee.ownerDocument.addEventListener("pointermove",Z),(Ke=i.domElement)==null||Ke.ownerDocument.addEventListener("pointerup",G)),je(ne),ne.pointerType==="touch"?Pe(ne):Q(ne))}function Z(ne){i.enabled!==!1&&(ne.pointerType==="touch"?Qe(ne):K(ne))}function G(ne){var Ee,Ke,ie;lt(ne),T.length===0&&((Ee=i.domElement)==null||Ee.releasePointerCapture(ne.pointerId),(Ke=i.domElement)==null||Ke.ownerDocument.removeEventListener("pointermove",Z),(ie=i.domElement)==null||ie.ownerDocument.removeEventListener("pointerup",G)),i.dispatchEvent(o),l=a.NONE}function Q(ne){let Ee;switch(ne.button){case 0:Ee=i.mouseButtons.LEFT;break;case 1:Ee=i.mouseButtons.MIDDLE;break;case 2:Ee=i.mouseButtons.RIGHT;break;default:Ee=-1}switch(Ee){case yr.DOLLY:if(i.enableZoom===!1)return;Ae(ne),l=a.DOLLY;break;case yr.ROTATE:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(i.enablePan===!1)return;We(ne),l=a.PAN}else{if(i.enableRotate===!1)return;_e(ne),l=a.ROTATE}break;case yr.PAN:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(i.enableRotate===!1)return;_e(ne),l=a.ROTATE}else{if(i.enablePan===!1)return;We(ne),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function K(ne){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;se(ne);break;case a.DOLLY:if(i.enableZoom===!1)return;Se(ne);break;case a.PAN:if(i.enablePan===!1)return;Me(ne);break}}function de(ne){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ne.preventDefault(),i.dispatchEvent(s),De(ne),i.dispatchEvent(o))}function ye(ne){i.enabled===!1||i.enablePan===!1||Be(ne)}function Pe(ne){switch(ut(ne),T.length){case 1:switch(i.touches.ONE){case _r.ROTATE:if(i.enableRotate===!1)return;H(),l=a.TOUCH_ROTATE;break;case _r.PAN:if(i.enablePan===!1)return;X(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case _r.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;ge(),l=a.TOUCH_DOLLY_PAN;break;case _r.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;me(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function Qe(ne){switch(ut(ne),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;fe(ne),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;N(ne),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;j(ne),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;L(ne),i.update();break;default:l=a.NONE}}function Ne(ne){i.enabled!==!1&&ne.preventDefault()}function je(ne){T.push(ne)}function lt(ne){delete k[ne.pointerId];for(let Ee=0;Ee<T.length;Ee++)if(T[Ee].pointerId==ne.pointerId){T.splice(Ee,1);return}}function ut(ne){let Ee=k[ne.pointerId];Ee===void 0&&(Ee=new Ie,k[ne.pointerId]=Ee),Ee.set(ne.pageX,ne.pageY)}function Xe(ne){const Ee=ne.pointerId===T[0].pointerId?T[1]:T[0];return k[Ee.pointerId]}this.dollyIn=(ne=$())=>{Le(ne),i.update()},this.dollyOut=(ne=$())=>{Te(ne),i.update()},this.getScale=()=>p,this.setScale=ne=>{pe(ne),i.update()},this.getZoomScale=()=>$(),t!==void 0&&this.connect(t),this.update()}}class H9 extends B9{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=yr.PAN,this.mouseButtons.RIGHT=yr.ROTATE,this.touches.ONE=_r.PAN,this.touches.TWO=_r.DOLLY_ROTATE}}function Bc(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,i=n.length;t<i;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const ol="srgb",Do="srgb-linear",_M=3001,Z9=3e3;class X9 extends no{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Q9(t)}),this.register(function(t){return new $9(t)}),this.register(function(t){return new aX(t)}),this.register(function(t){return new lX(t)}),this.register(function(t){return new cX(t)}),this.register(function(t){return new eX(t)}),this.register(function(t){return new tX(t)}),this.register(function(t){return new nX(t)}),this.register(function(t){return new iX(t)}),this.register(function(t){return new J9(t)}),this.register(function(t){return new rX(t)}),this.register(function(t){return new q9(t)}),this.register(function(t){return new oX(t)}),this.register(function(t){return new sX(t)}),this.register(function(t){return new Y9(t)}),this.register(function(t){return new uX(t)}),this.register(function(t){return new hX(t)})}load(e,t,i,r){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const c=Ec.extractUrlBase(e);o=Ec.resolveURL(c,this.path)}else o=Ec.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new zo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(h){t(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Bc(new Uint8Array(e.slice(0,4)))===bA){try{o[Ft.KHR_BINARY_GLTF]=new dX(e)}catch(c){r&&r(c);return}s=JSON.parse(o[Ft.KHR_BINARY_GLTF].content)}else s=JSON.parse(Bc(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new TX(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](l);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const h=s.extensionsUsed[c],d=s.extensionsRequired||[];switch(h){case Ft.KHR_MATERIALS_UNLIT:o[h]=new K9;break;case Ft.KHR_DRACO_MESH_COMPRESSION:o[h]=new fX(s,this.dracoLoader);break;case Ft.KHR_TEXTURE_TRANSFORM:o[h]=new pX;break;case Ft.KHR_MESH_QUANTIZATION:o[h]=new mX;break;default:d.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function j9(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Ft={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Y9{constructor(e){this.parser=e,this.name=Ft.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let a;const l=new Ge(16777215);o.color!==void 0&&l.setRGB(o.color[0],o.color[1],o.color[2],Do);const c=o.range!==void 0?o.range:0;switch(o.type){case"directional":a=new Ih(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new y_(l),a.distance=c;break;case"spot":a=new Av(l),a.distance=c,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),a.decay=2,Mo(a,o),o.intensity!==void 0&&(a.intensity=o.intensity),a.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(a),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,r=i.json.nodes[e],s=(r.extensions&&r.extensions[this.name]||{}).light;return s===void 0?null:this._loadLight(s).then(function(o){return i._getNodeRef(t.cache,s,o)})}}class K9{constructor(){this.name=Ft.KHR_MATERIALS_UNLIT}getMaterialType(){return Ir}extendParams(e,t,i){const r=[];e.color=new Ge(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Do),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,ol))}return Promise.all(r)}}class J9{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class Q9{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ie(a,a)}return Promise.all(s)}}class $9{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class q9{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class eX{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ge(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Do)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,ol)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class tX{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class nX{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Ge().setRGB(a[0],a[1],a[2],Do),Promise.all(s)}}class iX{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class rX{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Ge().setRGB(a[0],a[1],a[2],Do),o.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,ol)),Promise.all(s)}}class sX{constructor(e){this.parser=e,this.name=Ft.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class oX{constructor(e){this.parser=e,this.name=Ft.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:eo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class aX{constructor(e){this.parser=e,this.name=Ft.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class lX{constructor(e){this.parser=e,this.name=Ft.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class cX{constructor(e){this.parser=e,this.name=Ft.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class uX{constructor(e){this.name=Ft.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,h=r.count,d=r.byteStride,p=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,d,p,r.mode,r.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(h*d);return o.decodeGltfBuffer(new Uint8Array(m),h,d,p,r.mode,r.filter),m})})}else return null}}class hX{constructor(e){this.name=Ft.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const l of r.primitives)if(l.mode!==Xr.TRIANGLES&&l.mode!==Xr.TRIANGLE_STRIP&&l.mode!==Xr.TRIANGLE_FAN&&l.mode!==void 0)return null;const s=i.extensions[this.name].attributes,o=[],a={};for(const l in s)o.push(this.parser.getDependency("accessor",s[l]).then(c=>(a[l]=c,a[l])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(l=>{const c=l.pop(),h=c.isGroup?c.children:[c],d=l[0].count,p=[];for(const m of h){const y=new nt,b=new U,v=new Wn,g=new U(1,1,1),x=new bv(m.geometry,m.material,d);for(let w=0;w<d;w++)a.TRANSLATION&&b.fromBufferAttribute(a.TRANSLATION,w),a.ROTATION&&v.fromBufferAttribute(a.ROTATION,w),a.SCALE&&g.fromBufferAttribute(a.SCALE,w),x.setMatrixAt(w,y.compose(b,v,g));for(const w in a)if(w==="_COLOR_0"){const S=a[w];x.instanceColor=new Ah(S.array,S.itemSize,S.normalized)}else w!=="TRANSLATION"&&w!=="ROTATION"&&w!=="SCALE"&&m.geometry.setAttribute(w,a[w]);jt.prototype.copy.call(x,m),this.parser.assignFinalMaterial(x),p.push(x)}return c.isGroup?(c.clear(),c.add(...p),c):p[0]}))}}const bA="glTF",Iu=12,vM={JSON:1313821514,BIN:5130562};class dX{constructor(e){this.name=Ft.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Iu);if(this.header={magic:Bc(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==bA)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-Iu,r=new DataView(e,Iu);let s=0;for(;s<i;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,a===vM.JSON){const l=new Uint8Array(e,Iu+s,o);this.content=Bc(l)}else if(a===vM.BIN){const l=Iu+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class fX{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ft.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const d=w_[h]||h.toLowerCase();a[d]=o[h]}for(const h in e.attributes){const d=w_[h]||h.toLowerCase();if(o[h]!==void 0){const p=i.accessors[e.attributes[h]],m=Lc[p.componentType];c[d]=m.name,l[d]=p.normalized===!0}}return t.getDependency("bufferView",s).then(function(h){return new Promise(function(d,p){r.decodeDracoFile(h,function(m){for(const y in m.attributes){const b=m.attributes[y],v=l[y];v!==void 0&&(b.normalized=v)}d(m)},a,c,Do,p)})})}}class pX{constructor(){this.name=Ft.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class mX{constructor(){this.name=Ft.KHR_MESH_QUANTIZATION}}class xA extends Xh{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=r-t,d=(i-t)/h,p=d*d,m=p*d,y=e*c,b=y-c,v=-2*m+3*p,g=m-p,x=1-v,w=g-p+d;for(let S=0;S!==a;S++){const C=o[b+S+a],A=o[b+S+l]*h,E=o[y+S+a],O=o[y+S]*h;s[S]=x*C+w*A+v*E+g*O}return s}}const gX=new Wn;class yX extends xA{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return gX.fromArray(s).normalize().toArray(s),s}}const Xr={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Lc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},bM={9728:or,9729:ui,9984:bL,9985:lp,9986:Gu,9987:Pr},xM={33071:Qr,33648:Cp,10497:is},ky={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},w_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",..._m>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},sa={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},_X={CUBICSPLINE:void 0,LINEAR:Mh,STEP:Sh},Fy={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function vX(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Sl({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ns})),n.DefaultMaterial}function Ya(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Mo(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function bX(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const d=e[c];if(d.POSITION!==void 0&&(i=!0),d.NORMAL!==void 0&&(r=!0),d.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const d=e[c];if(i){const p=d.POSITION!==void 0?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(p)}if(r){const p=d.NORMAL!==void 0?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=d.COLOR_0!==void 0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],d=c[1],p=c[2];return i&&(n.morphAttributes.position=h),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}function xX(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function wX(n){let e;const t=n.extensions&&n.extensions[Ft.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Uy(t.attributes):e=n.indices+":"+Uy(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+Uy(n.targets[i]);return e}function Uy(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function S_(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function SX(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const MX=new nt;class TX{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new j9,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new jh(this.options.manager):this.textureLoader=new jG(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new zo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return Ya(s,a,r),Mo(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,h]of o.children.entries())s(h,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ft.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Ec.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=ky[r.type],a=Lc[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new Ln(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=ky[r.type],c=Lc[r.componentType],h=c.BYTES_PER_ELEMENT,d=h*l,p=r.byteOffset||0,m=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,y=r.normalized===!0;let b,v;if(m&&m!==d){const g=Math.floor(p/m),x="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let w=t.cache.get(x);w||(b=new c(a,g*m,r.count*m/h),w=new _v(b,m/h),t.cache.add(x,w)),v=new xs(w,l,p%m/h,y)}else a===null?b=new c(r.count*l):b=new c(a,p,r.count*l),v=new Ln(b,l,y);if(r.sparse!==void 0){const g=ky.SCALAR,x=Lc[r.sparse.indices.componentType],w=r.sparse.indices.byteOffset||0,S=r.sparse.values.byteOffset||0,C=new x(o[1],w,r.sparse.count*g),A=new c(o[2],S,r.sparse.count*l);a!==null&&(v=new Ln(v.array.slice(),v.itemSize,v.normalized));for(let E=0,O=C.length;E<O;E++){const R=C[E];if(v.setX(R,A[E*l]),l>=2&&v.setY(R,A[E*l+1]),l>=3&&v.setZ(R,A[E*l+2]),l>=4&&v.setW(R,A[E*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){const t=this.json,i=this.options,r=t.textures[e].source,s=t.images[r];let o=this.textureLoader;if(s.uri){const a=i.manager.getHandler(s.uri);a!==null&&(o=a)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return h.magFilter=bM[d.magFilter]||ui,h.minFilter=bM[d.minFilter]||Pr,h.wrapS=xM[d.wrapS]||is,h.wrapT=xM[d.wrapT]||is,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(d){c=!0;const p=new Blob([d],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(d){return new Promise(function(p,m){let y=p;t.isImageBitmapLoader===!0&&(y=function(b){const v=new In(b);v.needsUpdate=!0,p(v)}),t.load(Ec.resolveURL(d,s.path),y,void 0,m)})}).then(function(d){return c===!0&&a.revokeObjectURL(l),Mo(d,o),d.userData.mimeType=o.mimeType||SX(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=h,h}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[Ft.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[Ft.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[Ft.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(typeof r=="number"&&(r=r===_M?ol:Do),"colorSpace"in o?o.colorSpace=r:o.encoding=r===ol?_M:Z9),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Zc,Nr.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new hm,Nr.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return Sl}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[Ft.KHR_MATERIALS_UNLIT]){const d=r[Ft.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new Ge(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const p=d.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],Do),a.opacity=p[3]}d.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",d.baseColorTexture,ol)),a.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,a.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Yr);const h=s.alphaMode||Fy.OPAQUE;if(h===Fy.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===Fy.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Ir&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ie(1,1),s.normalTexture.scale!==void 0)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}if(s.occlusionTexture!==void 0&&o!==Ir&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Ir){const d=s.emissiveFactor;a.emissive=new Ge().setRGB(d[0],d[1],d[2],Do)}return s.emissiveTexture!==void 0&&o!==Ir&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,ol)),Promise.all(c).then(function(){const d=new o(a);return s.name&&(d.name=s.name),Mo(d,s),t.associations.set(d,{materials:e}),s.extensions&&Ya(r,d,s),d})}createUniqueName(e){const t=Zt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[Ft.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return wM(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=wX(c),d=r[h];if(d)o.push(d.promise);else{let p;c.extensions&&c.extensions[Ft.KHR_DRACO_MESH_COMPRESSION]?p=s(c):p=wM(new fn,c,t),r[h]={primitive:c,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].material===void 0?vX(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],d=[];for(let m=0,y=h.length;m<y;m++){const b=h[m],v=o[m];let g;const x=c[m];if(v.mode===Xr.TRIANGLES||v.mode===Xr.TRIANGLE_STRIP||v.mode===Xr.TRIANGLE_FAN||v.mode===void 0)g=s.isSkinnedMesh===!0?new GL(b,x):new Xt(b,x),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),v.mode===Xr.TRIANGLE_STRIP?g.geometry=mM(g.geometry,IL):v.mode===Xr.TRIANGLE_FAN&&(g.geometry=mM(g.geometry,d_));else if(v.mode===Xr.LINES)g=new BL(b,x);else if(v.mode===Xr.LINE_STRIP)g=new dm(b,x);else if(v.mode===Xr.LINE_LOOP)g=new qV(b,x);else if(v.mode===Xr.POINTS)g=new Xc(b,x);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);Object.keys(g.geometry.morphAttributes).length>0&&xX(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),Mo(g,s),v.extensions&&Ya(r,g,v),t.assignFinalMaterial(g),d.push(g)}for(let m=0,y=d.length;m<y;m++)t.associations.set(d[m],{meshes:e,primitives:m});if(d.length===1)return s.extensions&&Ya(r,d[0],s),d[0];const p=new sr;s.extensions&&Ya(r,p,s),t.associations.set(p,{meshes:e});for(let m=0,y=d.length;m<y;m++)p.add(d[m]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Kn(Ai.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new hl(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Mo(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const d=o[c];if(d){a.push(d);const p=new nt;s!==null&&p.fromArray(s.array,c*16),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new cm(a,l)})}loadAnimation(e){const t=this.json,i=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],h=[];for(let d=0,p=r.channels.length;d<p;d++){const m=r.channels[d],y=r.samplers[m.sampler],b=m.target,v=b.node,g=r.parameters!==void 0?r.parameters[y.input]:y.input,x=r.parameters!==void 0?r.parameters[y.output]:y.output;b.node!==void 0&&(o.push(this.getDependency("node",v)),a.push(this.getDependency("accessor",g)),l.push(this.getDependency("accessor",x)),c.push(y),h.push(b))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(h)]).then(function(d){const p=d[0],m=d[1],y=d[2],b=d[3],v=d[4],g=[];for(let x=0,w=p.length;x<w;x++){const S=p[x],C=m[x],A=y[x],E=b[x],O=v[x];if(S===void 0)continue;S.updateMatrix&&S.updateMatrix();const R=i._createAnimationTracks(S,C,A,E,O);if(R)for(let T=0;T<R.length;T++)g.push(R[T])}return new Fp(s,void 0,g)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,h=a.length;c<h;c++)o.push(i.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const h=c[0],d=c[1],p=c[2];p!==null&&h.traverse(function(m){m.isSkinnedMesh&&m.bind(p,MX)});for(let m=0,y=d.length;m<y;m++)h.add(d[m]);return h})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(s.isBone===!0?h=new Dp:c.length>1?h=new sr:c.length===1?h=c[0]:h=new jt,h!==c[0])for(let d=0,p=c.length;d<p;d++)h.add(c[d]);if(s.name&&(h.userData.name=s.name,h.name=o),Mo(h,s),s.extensions&&Ya(i,h,s),s.matrix!==void 0){const d=new nt;d.fromArray(s.matrix),h.applyMatrix4(d)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new sr;i.name&&(s.name=r.createUniqueName(i.name)),Mo(s,i),i.extensions&&Ya(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,d=l.length;h<d;h++)s.add(l[h]);const c=h=>{const d=new Map;for(const[p,m]of r.associations)(p instanceof Nr||p instanceof In)&&d.set(p,m);return h.traverse(p=>{const m=r.associations.get(p);m!=null&&d.set(p,m)}),d};return r.associations=c(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];sa[s.path]===sa.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a);let c;switch(sa[s.path]){case sa.weights:c=yl;break;case sa.rotation:c=_l;break;case sa.position:case sa.scale:c=vl;break;default:switch(i.itemSize){case 1:c=yl;break;case 2:case 3:default:c=vl;break}break}const h=r.interpolation!==void 0?_X[r.interpolation]:Mh,d=this._getArrayFromAccessor(i);for(let p=0,m=l.length;p<m;p++){const y=new c(l[p]+"."+sa[s.path],t.array,d,h);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(y),o.push(y)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=S_(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(t){const i=this instanceof _l?yX:xA;return new i(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function EX(n,e,t){const i=e.attributes,r=new ji;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new U(l[0],l[1],l[2]),new U(c[0],c[1],c[2])),a.normalized){const h=S_(Lc[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new U,l=new U;for(let c=0,h=s.length;c<h;c++){const d=s[c];if(d.POSITION!==void 0){const p=t.json.accessors[d.POSITION],m=p.min,y=p.max;if(m!==void 0&&y!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(y[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(y[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(y[2]))),p.normalized){const b=S_(Lc[p.componentType]);l.multiplyScalar(b)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new ss;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}function wM(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=w_[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Mo(n,e),EX(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?bX(n,e.targets,t):n})}function wA(n,e,t){const i=t.length-n-1;if(e>=t[i])return i-1;if(e<=t[n])return n;let r=n,s=i,o=Math.floor((r+s)/2);for(;e<t[o]||e>=t[o+1];)e<t[o]?s=o:r=o,o=Math.floor((r+s)/2);return o}function LX(n,e,t,i){const r=[],s=[],o=[];r[0]=1;for(let a=1;a<=t;++a){s[a]=e-i[n+1-a],o[a]=i[n+a]-e;let l=0;for(let c=0;c<a;++c){const h=o[c+1],d=s[a-c],p=r[c]/(h+d);r[c]=l+h*p,l=d*p}r[a]=l}return r}function AX(n,e,t,i){const r=wA(n,i,e),s=LX(r,i,n,e),o=new Ct(0,0,0,0);for(let a=0;a<=n;++a){const l=t[r-n+a],c=s[a],h=l.w*c;o.x+=l.x*h,o.y+=l.y*h,o.z+=l.z*h,o.w+=l.w*c}return o}function CX(n,e,t,i,r){const s=[];for(let d=0;d<=t;++d)s[d]=0;const o=[];for(let d=0;d<=i;++d)o[d]=s.slice(0);const a=[];for(let d=0;d<=t;++d)a[d]=s.slice(0);a[0][0]=1;const l=s.slice(0),c=s.slice(0);for(let d=1;d<=t;++d){l[d]=e-r[n+1-d],c[d]=r[n+d]-e;let p=0;for(let m=0;m<d;++m){const y=c[m+1],b=l[d-m];a[d][m]=y+b;const v=a[m][d-1]/a[d][m];a[m][d]=p+y*v,p=b*v}a[d][d]=p}for(let d=0;d<=t;++d)o[0][d]=a[d][t];for(let d=0;d<=t;++d){let p=0,m=1;const y=[];for(let b=0;b<=t;++b)y[b]=s.slice(0);y[0][0]=1;for(let b=1;b<=i;++b){let v=0;const g=d-b,x=t-b;d>=b&&(y[m][0]=y[p][0]/a[x+1][g],v=y[m][0]*a[g][x]);const w=g>=-1?1:-g,S=d-1<=x?b-1:t-d;for(let A=w;A<=S;++A)y[m][A]=(y[p][A]-y[p][A-1])/a[x+1][g+A],v+=y[m][A]*a[g+A][x];d<=x&&(y[m][b]=-y[p][b-1]/a[x+1][d],v+=y[m][b]*a[d][x]),o[b][d]=v;const C=p;p=m,m=C}}let h=t;for(let d=1;d<=i;++d){for(let p=0;p<=t;++p)o[d][p]*=h;h*=t-d}return o}function RX(n,e,t,i,r){const s=r<n?r:n,o=[],a=wA(n,i,e),l=CX(a,i,n,s,e),c=[];for(let h=0;h<t.length;++h){const d=t[h].clone(),p=d.w;d.x*=p,d.y*=p,d.z*=p,c[h]=d}for(let h=0;h<=s;++h){const d=c[a-n].clone().multiplyScalar(l[h][0]);for(let p=1;p<=n;++p)d.add(c[a-n+p].clone().multiplyScalar(l[h][p]));o[h]=d}for(let h=s+1;h<=r+1;++h)o[h]=new Ct(0,0,0);return o}function PX(n,e){let t=1;for(let r=2;r<=n;++r)t*=r;let i=1;for(let r=2;r<=e;++r)i*=r;for(let r=2;r<=n-e;++r)i*=r;return t/i}function IX(n){const e=n.length,t=[],i=[];for(let s=0;s<e;++s){const o=n[s];t[s]=new U(o.x,o.y,o.z),i[s]=o.w}const r=[];for(let s=0;s<e;++s){const o=t[s].clone();for(let a=1;a<=s;++a)o.sub(r[s-a].clone().multiplyScalar(PX(s,a)*i[a]));r[s]=o.divideScalar(i[0])}return r}function DX(n,e,t,i,r){const s=RX(n,e,t,i,r);return IX(s)}class SM extends As{constructor(e,t,i,r,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||this.knots.length-1;for(let o=0;o<i.length;++o){const a=i[o];this.controlPoints[o]=new Ct(a.x,a.y,a.z,a.w)}}getPoint(e,t){const i=t||new U,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=AX(this.degree,this.knots,this.controlPoints,r);return s.w!=1&&s.divideScalar(s.w),i.set(s.x,s.y,s.z)}getTangent(e,t){const i=t||new U,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),s=DX(this.degree,this.knots,this.controlPoints,r,1);return i.copy(s[1]).normalize(),i}}let kt,jn,mr;class NX extends no{constructor(e){super(e)}load(e,t,i,r){const s=this,o=s.path===""?Ec.extractUrlBase(e):s.path,a=new zo(this.manager);a.setPath(s.path),a.setResponseType("arraybuffer"),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(l,o))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e,t){if(WX(e))kt=new zX().parse(e);else{const r=EA(e);if(!VX(r))throw new Error("THREE.FBXLoader: Unknown format.");if(TM(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+TM(r));kt=new UX().parse(r)}const i=new jh(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new OX(i,this.manager).parse(kt)}}class OX{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){jn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),r=this.parseDeformers(),s=new kX().parse(r);return this.parseScene(r,s,i),mr}parseConnections(){const e=new Map;return"Connections"in kt&&kt.Connections.connections.forEach(function(t){const i=t[0],r=t[1],s=t[2];e.has(i)||e.set(i,{parents:[],children:[]});const o={ID:r,relationship:s};e.get(i).parents.push(o),e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:i,relationship:s};e.get(r).children.push(a)}),e}parseImages(){const e={},t={};if("Video"in kt.Objects){const i=kt.Objects.Video;for(const r in i){const s=i[r],o=parseInt(r);if(e[o]=s.RelativeFilename||s.Filename,"Content"in s){const a=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,l=typeof s.Content=="string"&&s.Content!=="";if(a||l){const c=this.parseImage(i[r]);t[s.RelativeFilename||s.Filename]=c}}}}for(const i in e){const r=e[i];t[r]!==void 0?e[i]=t[r]:e[i]=e[i].split("\\").pop()}return e}parseImage(e){const t=e.Content,i=e.RelativeFilename||e.Filename,r=i.slice(i.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",i),s="image/tga";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof t=="string")return"data:"+s+";base64,"+t;{const o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in kt.Objects){const i=kt.Objects.Texture;for(const r in i){const s=this.parseTexture(i[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,o=r!==void 0?r.value:0,a=s!==void 0?s.value:0;if(i.wrapS=o===0?is:Qr,i.wrapT=a===0?is:Qr,"Scaling"in e){const l=e.Scaling.value;i.repeat.x=l[0],i.repeat.y=l[1]}return i}loadTexture(e,t){let i;const r=this.textureLoader.path,s=jn.get(e.id).children;s!==void 0&&s.length>0&&t[s[0].ID]!==void 0&&(i=t[s[0].ID],(i.indexOf("blob:")===0||i.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let o;const a=e.FileName.slice(-3).toLowerCase();if(a==="tga"){const l=this.manager.getHandler(".tga");l===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new In):(l.setPath(this.textureLoader.path),o=l.load(i))}else a==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new In):o=this.textureLoader.load(i);return this.textureLoader.setPath(r),o}parseMaterials(e){const t=new Map;if("Material"in kt.Objects){const i=kt.Objects.Material;for(const r in i){const s=this.parseMaterial(i[r],e);s!==null&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const i=e.id,r=e.attrName;let s=e.ShadingModel;if(typeof s=="object"&&(s=s.value),!jn.has(i))return null;const o=this.parseParameters(e,t,i);let a;switch(s.toLowerCase()){case"phong":a=new pp;break;case"lambert":a=new eA;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),a=new pp;break}return a.setValues(o),a.name=r,a}parseParameters(e,t,i){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=new Ge().fromArray(e.Diffuse.value):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=new Ge().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=new Ge().fromArray(e.Emissive.value):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=new Ge().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=new Ge().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=new Ge().fromArray(e.SpecularColor.value));const s=this;return jn.get(i).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":r.bumpMap=s.getTexture(t,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,o.ID),r.map!==void 0&&("colorSpace"in r.map?r.map.colorSpace="srgb":r.map.encoding=3001);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,o.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,o.ID),r.emissiveMap!==void 0&&("colorSpace"in r.emissiveMap?r.emissiveMap.colorSpace="srgb":r.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,o.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,o.ID),r.envMap!==void 0&&(r.envMap.mapping=Ap,"colorSpace"in r.envMap?r.envMap.colorSpace="srgb":r.envMap.encoding=3001);break;case"SpecularColor":r.specularMap=s.getTexture(t,o.ID),r.specularMap!==void 0&&("colorSpace"in r.specularMap?r.specularMap.colorSpace="srgb":r.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,o.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a);break}}),r}getTexture(e,t){return"LayeredTexture"in kt.Objects&&t in kt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=jn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in kt.Objects){const i=kt.Objects.Deformer;for(const r in i){const s=i[r],o=jn.get(parseInt(r));if(s.attrType==="Skin"){const a=this.parseSkeleton(o,i);a.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[r]=a}else if(s.attrType==="BlendShape"){const a={id:r};a.rawTargets=this.parseMorphTargets(o,i),a.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const i=[];return e.children.forEach(function(r){const s=t[r.ID];if(s.attrType!=="Cluster")return;const o={ID:r.ID,indices:[],weights:[],transformLink:new nt().fromArray(s.TransformLink.a)};"Indexes"in s&&(o.indices=s.Indexes.a,o.weights=s.Weights.a),i.push(o)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){const i=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],o=t[s.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if(o.attrType!=="BlendShapeChannel")return;a.geoID=jn.get(parseInt(s.ID)).children.filter(function(l){return l.relationship===void 0})[0].ID,i.push(a)}return i}parseScene(e,t,i){mr=new sr;const r=this.parseModels(e.skeletons,t,i),s=kt.Objects.Model,o=this;r.forEach(function(l){const c=s[l.ID];o.setLookAtProperties(l,c),jn.get(l.ID).parents.forEach(function(h){const d=r.get(h.ID);d!==void 0&&d.add(l)}),l.parent===null&&mr.add(l)}),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),mr.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const c=MA(l.userData.transformData);l.applyMatrix4(c),l.updateWorldMatrix()}});const a=new FX().parse();mr.children.length===1&&mr.children[0].isGroup&&(mr.children[0].animations=a,mr=mr.children[0]),mr.animations=a}parseModels(e,t,i){const r=new Map,s=kt.Objects.Model;for(const o in s){const a=parseInt(o),l=s[o],c=jn.get(a);let h=this.buildSkeleton(c,e,a,l.attrName);if(!h){switch(l.attrType){case"Camera":h=this.createCamera(c);break;case"Light":h=this.createLight(c);break;case"Mesh":h=this.createMesh(c,t,i);break;case"NurbsCurve":h=this.createCurve(c,t);break;case"LimbNode":case"Root":h=new Dp;break;case"Null":default:h=new sr;break}h.name=l.attrName?Zt.sanitizeNodeName(l.attrName):"",h.ID=a}this.getTransformData(h,l),r.set(a,h)}return r}buildSkeleton(e,t,i,r){let s=null;return e.parents.forEach(function(o){for(const a in t){const l=t[a];l.rawBones.forEach(function(c,h){if(c.ID===o.ID){const d=s;s=new Dp,s.matrixWorld.copy(c.transformLink),s.name=r?Zt.sanitizeNodeName(r):"",s.ID=i,l.bones[h]=s,d!==null&&s.add(d)}})}}),s}createCamera(e){let t,i;if(e.children.forEach(function(r){const s=kt.Objects.NodeAttribute[r.ID];s!==void 0&&(i=s)}),i===void 0)t=new jt;else{let r=0;i.CameraProjectionType!==void 0&&i.CameraProjectionType.value===1&&(r=1);let s=1;i.NearPlane!==void 0&&(s=i.NearPlane.value/1e3);let o=1e3;i.FarPlane!==void 0&&(o=i.FarPlane.value/1e3);let a=window.innerWidth,l=window.innerHeight;i.AspectWidth!==void 0&&i.AspectHeight!==void 0&&(a=i.AspectWidth.value,l=i.AspectHeight.value);const c=a/l;let h=45;i.FieldOfView!==void 0&&(h=i.FieldOfView.value);const d=i.FocalLength?i.FocalLength.value:null;switch(r){case 0:t=new Kn(h,c,s,o),d!==null&&t.setFocalLength(d);break;case 1:t=new hl(-a/2,a/2,l/2,-l/2,s,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new jt;break}}return t}createLight(e){let t,i;if(e.children.forEach(function(r){const s=kt.Objects.NodeAttribute[r.ID];s!==void 0&&(i=s)}),i===void 0)t=new jt;else{let r;i.LightType===void 0?r=0:r=i.LightType.value;let s=16777215;i.Color!==void 0&&(s=new Ge().fromArray(i.Color.value));let o=i.Intensity===void 0?1:i.Intensity.value/100;i.CastLightOnObject!==void 0&&i.CastLightOnObject.value===0&&(o=0);let a=0;i.FarAttenuationEnd!==void 0&&(i.EnableFarAttenuation!==void 0&&i.EnableFarAttenuation.value===0?a=0:a=i.FarAttenuationEnd.value);const l=1;switch(r){case 0:t=new y_(s,o,a,l);break;case 1:t=new Ih(s,o);break;case 2:let c=Math.PI/3;i.InnerAngle!==void 0&&(c=Ai.degToRad(i.InnerAngle.value));let h=0;i.OuterAngle!==void 0&&(h=Ai.degToRad(i.OuterAngle.value),h=Math.max(h,1)),t=new Av(s,o,a,c,h,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new y_(s,o);break}i.CastShadows!==void 0&&i.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,i){let r,s=null,o=null;const a=[];return e.children.forEach(function(l){t.has(l.ID)&&(s=t.get(l.ID)),i.has(l.ID)&&a.push(i.get(l.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new pp({color:13421772}),a.push(o)),"color"in s.attributes&&a.forEach(function(l){l.vertexColors=!0}),s.FBX_Deformer?(r=new GL(s,o),r.normalizeSkinWeights()):r=new Xt(s,o),r}createCurve(e,t){const i=e.children.reduce(function(s,o){return t.has(o.ID)&&(s=t.get(o.ID)),s},null),r=new hm({color:3342591,linewidth:1});return new dm(i,r)}getTransformData(e,t){const i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?i.eulerOrder=TA(t.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&jn.get(e.ID).children.forEach(function(i){if(i.relationship==="LookAtProperty"){const r=kt.Objects.Model[i.ID];if("Lcl_Translation"in r){const s=r.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(s),mr.add(e.target)):e.lookAt(new U().fromArray(s))}}})}bindSkeleton(e,t,i){const r=this.parsePoseNodes();for(const s in e){const o=e[s];jn.get(parseInt(o.ID)).parents.forEach(function(a){if(t.has(a.ID)){const l=a.ID;jn.get(l).parents.forEach(function(c){i.has(c.ID)&&i.get(c.ID).bind(new cm(o.bones),r[c.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in kt.Objects){const t=kt.Objects.Pose;for(const i in t)if(t[i].attrType==="BindPose"&&t[i].NbPoseNodes>0){const r=t[i].PoseNode;Array.isArray(r)?r.forEach(function(s){e[s.Node]=new nt().fromArray(s.Matrix.a)}):e[r.Node]=new nt().fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in kt&&"AmbientColor"in kt.GlobalSettings){const e=kt.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],r=e[2];if(t!==0||i!==0||r!==0){const s=new Ge(t,i,r);mr.add(new Cv(s,1))}}}}class kX{parse(e){const t=new Map;if("Geometry"in kt.Objects){const i=kt.Objects.Geometry;for(const r in i){const s=jn.get(parseInt(r)),o=this.parseGeometry(s,i[r],e);t.set(parseInt(r),o)}}return t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){const r=i.skeletons,s=[],o=e.parents.map(function(d){return kt.Objects.Model[d.ID]});if(o.length===0)return;const a=e.children.reduce(function(d,p){return r[p.ID]!==void 0&&(d=r[p.ID]),d},null);e.children.forEach(function(d){i.morphTargets[d.ID]!==void 0&&s.push(i.morphTargets[d.ID])});const l=o[0],c={};"RotationOrder"in l&&(c.eulerOrder=TA(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);const h=MA(c);return this.genGeometry(t,a,s,h)}genGeometry(e,t,i,r){const s=new fn;e.attrName&&(s.name=e.attrName);const o=this.parseGeoNode(e,t),a=this.genBuffers(o),l=new $t(a.vertex,3);if(l.applyMatrix4(r),s.setAttribute("position",l),a.colors.length>0&&s.setAttribute("color",new $t(a.colors,3)),t&&(s.setAttribute("skinIndex",new mv(a.weightsIndices,4)),s.setAttribute("skinWeight",new $t(a.vertexWeights,4)),s.FBX_Deformer=t),a.normal.length>0){const c=new Lt().getNormalMatrix(r),h=new $t(a.normal,3);h.applyNormalMatrix(c),s.setAttribute("normal",h)}if(a.uvs.forEach(function(c,h){Ov==="uv2"&&h++;const d=h===0?"uv":`uv${h}`;s.setAttribute(d,new $t(a.uvs[h],2))}),o.material&&o.material.mappingType!=="AllSame"){let c=a.materialIndex[0],h=0;if(a.materialIndex.forEach(function(d,p){d!==c&&(s.addGroup(h,p-h,c),c=d,h=p)}),s.groups.length>0){const d=s.groups[s.groups.length-1],p=d.start+d.count;p!==a.materialIndex.length&&s.addGroup(p,a.materialIndex.length-p,c)}s.groups.length===0&&s.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(s,e,i,r),s}parseGeoNode(e,t){const i={};if(i.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],i.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return i.weightTable={},t!==null&&(i.skeleton=t,t.rawBones.forEach(function(r,s){r.indices.forEach(function(o,a){i.weightTable[o]===void 0&&(i.weightTable[o]=[]),i.weightTable[o].push({id:s,weight:r.weights[a]})})})),i}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,r=0,s=!1,o=[],a=[],l=[],c=[],h=[],d=[];const p=this;return e.vertexIndices.forEach(function(m,y){let b,v=!1;m<0&&(m=m^-1,v=!0);let g=[],x=[];if(o.push(m*3,m*3+1,m*3+2),e.color){const w=Of(y,i,m,e.color);l.push(w[0],w[1],w[2])}if(e.skeleton){if(e.weightTable[m]!==void 0&&e.weightTable[m].forEach(function(w){x.push(w.weight),g.push(w.id)}),x.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const w=[0,0,0,0],S=[0,0,0,0];x.forEach(function(C,A){let E=C,O=g[A];S.forEach(function(R,T,k){if(E>R){k[T]=E,E=R;const Y=w[T];w[T]=O,O=Y}})}),g=w,x=S}for(;x.length<4;)x.push(0),g.push(0);for(let w=0;w<4;++w)h.push(x[w]),d.push(g[w])}if(e.normal){const w=Of(y,i,m,e.normal);a.push(w[0],w[1],w[2])}e.material&&e.material.mappingType!=="AllSame"&&(b=Of(y,i,m,e.material)[0]),e.uv&&e.uv.forEach(function(w,S){const C=Of(y,i,m,w);c[S]===void 0&&(c[S]=[]),c[S].push(C[0]),c[S].push(C[1])}),r++,v&&(p.genFace(t,e,o,b,a,l,c,h,d,r),i++,r=0,o=[],a=[],l=[],c=[],h=[],d=[])}),t}genFace(e,t,i,r,s,o,a,l,c,h){for(let d=2;d<h;d++)e.vertex.push(t.vertexPositions[i[0]]),e.vertex.push(t.vertexPositions[i[1]]),e.vertex.push(t.vertexPositions[i[2]]),e.vertex.push(t.vertexPositions[i[(d-1)*3]]),e.vertex.push(t.vertexPositions[i[(d-1)*3+1]]),e.vertex.push(t.vertexPositions[i[(d-1)*3+2]]),e.vertex.push(t.vertexPositions[i[d*3]]),e.vertex.push(t.vertexPositions[i[d*3+1]]),e.vertex.push(t.vertexPositions[i[d*3+2]]),t.skeleton&&(e.vertexWeights.push(l[0]),e.vertexWeights.push(l[1]),e.vertexWeights.push(l[2]),e.vertexWeights.push(l[3]),e.vertexWeights.push(l[(d-1)*4]),e.vertexWeights.push(l[(d-1)*4+1]),e.vertexWeights.push(l[(d-1)*4+2]),e.vertexWeights.push(l[(d-1)*4+3]),e.vertexWeights.push(l[d*4]),e.vertexWeights.push(l[d*4+1]),e.vertexWeights.push(l[d*4+2]),e.vertexWeights.push(l[d*4+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[(d-1)*4]),e.weightsIndices.push(c[(d-1)*4+1]),e.weightsIndices.push(c[(d-1)*4+2]),e.weightsIndices.push(c[(d-1)*4+3]),e.weightsIndices.push(c[d*4]),e.weightsIndices.push(c[d*4+1]),e.weightsIndices.push(c[d*4+2]),e.weightsIndices.push(c[d*4+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[(d-1)*3]),e.colors.push(o[(d-1)*3+1]),e.colors.push(o[(d-1)*3+2]),e.colors.push(o[d*3]),e.colors.push(o[d*3+1]),e.colors.push(o[d*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[(d-1)*3]),e.normal.push(s[(d-1)*3+1]),e.normal.push(s[(d-1)*3+2]),e.normal.push(s[d*3]),e.normal.push(s[d*3+1]),e.normal.push(s[d*3+2])),t.uv&&t.uv.forEach(function(p,m){e.uvs[m]===void 0&&(e.uvs[m]=[]),e.uvs[m].push(a[m][0]),e.uvs[m].push(a[m][1]),e.uvs[m].push(a[m][(d-1)*2]),e.uvs[m].push(a[m][(d-1)*2+1]),e.uvs[m].push(a[m][d*2]),e.uvs[m].push(a[m][d*2+1])})}addMorphTargets(e,t,i,r){if(i.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;i.forEach(function(o){o.rawTargets.forEach(function(a){const l=kt.Objects.Geometry[a.geoID];l!==void 0&&s.genMorphGeometry(e,t,l,r,a.name)})})}genMorphGeometry(e,t,i,r,s){const o=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],a=i.Vertices!==void 0?i.Vertices.a:[],l=i.Indexes!==void 0?i.Indexes.a:[],c=e.attributes.position.count*3,h=new Float32Array(c);for(let y=0;y<l.length;y++){const b=l[y]*3;h[b]=a[y*3],h[b+1]=a[y*3+1],h[b+2]=a[y*3+2]}const d={vertexIndices:o,vertexPositions:h},p=this.genBuffers(d),m=new $t(p.vertex,3);m.name=s||i.attrName,m.applyMatrix4(r),e.morphAttributes.position.push(m)}parseNormals(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,r=e.Normals.a;let s=[];return i==="IndexToDirect"&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:s,mappingType:t,referenceType:i}}parseUVs(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,r=e.UV.a;let s=[];return i==="IndexToDirect"&&(s=e.UVIndex.a),{dataSize:2,buffer:r,indices:s,mappingType:t,referenceType:i}}parseVertexColors(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,r=e.Colors.a;let s=[];return i==="IndexToDirect"&&(s=e.ColorIndex.a),{dataSize:4,buffer:r,indices:s,mappingType:t,referenceType:i}}parseMaterialIndices(e){const t=e.MappingInformationType,i=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const r=e.Materials.a,s=[];for(let o=0;o<r.length;++o)s.push(o);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:i}}parseNurbsGeometry(e){if(SM===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new fn;const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new fn;const i=t-1,r=e.KnotVector.a,s=[],o=e.Points.a;for(let h=0,d=o.length;h<d;h+=4)s.push(new Ct().fromArray(o,h));let a,l;if(e.Form==="Closed")s.push(s[0]);else if(e.Form==="Periodic"){a=i,l=r.length-1-a;for(let h=0;h<i;++h)s.push(s[h])}const c=new SM(i,r,s,a,l).getPoints(s.length*12);return new fn().setFromPoints(c)}}class FX{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const i in t){const r=t[i],s=this.addClip(r);e.push(s)}return e}parseClips(){if(kt.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=kt.Objects.AnimationCurveNode,t=new Map;for(const i in e){const r=e[i];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const s={id:r.id,attr:r.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=kt.Objects.AnimationCurve;for(const i in t){const r={id:t[i].id,times:t[i].KeyTime.a.map(GX),values:t[i].KeyValueFloat.a},s=jn.get(r.id);if(s!==void 0){const o=s.parents[0].ID,a=s.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=r:a.match(/Y/)?e.get(o).curves.y=r:a.match(/Z/)?e.get(o).curves.z=r:a.match(/d|DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const t=kt.Objects.AnimationLayer,i=new Map;for(const r in t){const s=[],o=jn.get(parseInt(r));o!==void 0&&(o.children.forEach(function(a,l){if(e.has(a.ID)){const c=e.get(a.ID);if(c.curves.x!==void 0||c.curves.y!==void 0||c.curves.z!==void 0){if(s[l]===void 0){const h=jn.get(a.ID).parents.filter(function(d){return d.relationship!==void 0})[0].ID;if(h!==void 0){const d=kt.Objects.Model[h.toString()];if(d===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",a);return}const p={modelName:d.attrName?Zt.sanitizeNodeName(d.attrName):"",ID:d.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};mr.traverse(function(m){m.ID===d.id&&(p.transform=m.matrix,m.userData.transformData&&(p.eulerOrder=m.userData.transformData.eulerOrder))}),p.transform||(p.transform=new nt),"PreRotation"in d&&(p.preRotation=d.PreRotation.value),"PostRotation"in d&&(p.postRotation=d.PostRotation.value),s[l]=p}}s[l]&&(s[l][c.attr]=c)}else if(c.curves.morph!==void 0){if(s[l]===void 0){const h=jn.get(a.ID).parents.filter(function(v){return v.relationship!==void 0})[0].ID,d=jn.get(h).parents[0].ID,p=jn.get(d).parents[0].ID,m=jn.get(p).parents[0].ID,y=kt.Objects.Model[m],b={modelName:y.attrName?Zt.sanitizeNodeName(y.attrName):"",morphName:kt.Objects.Deformer[h].attrName};s[l]=b}s[l][c.attr]=c}}}),i.set(parseInt(r),s))}return i}parseAnimStacks(e){const t=kt.Objects.AnimationStack,i={};for(const r in t){const s=jn.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(s[0].ID);i[r]={name:t[r].attrName,layer:o}}return i}addClip(e){let t=[];const i=this;return e.layer.forEach(function(r){t=t.concat(i.generateTracks(r))}),new Fp(e.name,-1,t)}generateTracks(e){const t=[];let i=new U,r=new Wn,s=new U;if(e.transform&&e.transform.decompose(i,r,s),i=i.toArray(),r=new Ri().setFromQuaternion(r,e.eulerOrder).toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");o!==void 0&&t.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&t.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");o!==void 0&&t.push(o)}if(e.DeformPercent!==void 0){const o=this.generateMorphTrack(e);o!==void 0&&t.push(o)}return t}generateVectorTrack(e,t,i,r){const s=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(s,t,i);return new vl(e+"."+r,s,o)}generateRotationTrack(e,t,i,r,s,o){t.x!==void 0&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(Ai.degToRad)),t.y!==void 0&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(Ai.degToRad)),t.z!==void 0&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(Ai.degToRad));const a=this.getTimesForAllAxes(t),l=this.getKeyframeTrackValues(a,t,i);r!==void 0&&(r=r.map(Ai.degToRad),r.push(o),r=new Ri().fromArray(r),r=new Wn().setFromEuler(r)),s!==void 0&&(s=s.map(Ai.degToRad),s.push(o),s=new Ri().fromArray(s),s=new Wn().setFromEuler(s).invert());const c=new Wn,h=new Ri,d=[];for(let p=0;p<l.length;p+=3)h.set(l[p],l[p+1],l[p+2],o),c.setFromEuler(h),r!==void 0&&c.premultiply(r),s!==void 0&&c.multiply(s),c.toArray(d,p/3*4);return new _l(e+".quaternion",a,d)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,i=t.values.map(function(s){return s/100}),r=mr.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new yl(e.modelName+".morphTargetInfluences["+r+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(i,r){return i-r}),t.length>1){let i=1,r=t[0];for(let s=1;s<t.length;s++){const o=t[s];o!==r&&(t[i]=o,r=o,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){const r=i,s=[];let o=-1,a=-1,l=-1;return e.forEach(function(c){if(t.x&&(o=t.x.times.indexOf(c)),t.y&&(a=t.y.times.indexOf(c)),t.z&&(l=t.z.times.indexOf(c)),o!==-1){const h=t.x.values[o];s.push(h),r[0]=h}else s.push(r[0]);if(a!==-1){const h=t.y.values[a];s.push(h),r[1]=h}else s.push(r[1]);if(l!==-1){const h=t.z.values[l];s.push(h),r[2]=h}else s.push(r[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const i=e.values[t-1],r=e.values[t]-i,s=Math.abs(r);if(s>=180){const o=s/180,a=r/o;let l=i+a;const c=e.times[t-1],h=(e.times[t]-c)/o;let d=c+h;const p=[],m=[];for(;d<e.times[t];)p.push(d),d+=h,m.push(l),l+=a;e.times=EM(e.times,t,p),e.values=EM(e.values,t,m)}}}}class UX{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new SA,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,i=e.split(/[\r\n]+/);return i.forEach(function(r,s){const o=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(o||a)return;const l=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),c=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),h=r.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(r,l):c?t.parseNodeProperty(r,c,i[++s]):h?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const i=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:i},o=this.parseNodeAttr(r),a=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(i,s):i in a?(i==="PoseNode"?a.PoseNode.push(s):a[i].id!==void 0&&(a[i]={},a[i][a[i].id]=a[i]),o.id!==""&&(a[i][o.id]=s)):typeof o.id=="number"?(a[i]={},a[i][o.id]=s):i!=="Properties70"&&(i==="PoseNode"?a[i]=[s]:a[i]=s),typeof o.id=="number"&&(s.id=o.id),o.name!==""&&(s.attrName=o.name),o.type!==""&&(s.attrType=o.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",r="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:i,type:r}}parseNodeProperty(e,t,i){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&s===","&&(s=i.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if(o.name==="Properties70"){this.parseNodeSpecialProperty(e,r,s);return}if(r==="C"){const a=s.split(",").slice(1),l=parseInt(a[0]),c=parseInt(a[1]);let h=s.split(",").slice(3);h=h.map(function(d){return d.trim().replace(/^"/,"")}),r="connections",s=[l,c],HX(s,h),o[r]===void 0&&(o[r]=[])}r==="Node"&&(o.id=s),r in o&&Array.isArray(o[r])?o[r].push(s):r!=="a"?o[r]=s:o.a=s,this.setCurrentProp(o,r),r==="a"&&s.slice(-1)!==","&&(o.a=Wy(s))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=Wy(t.a))}parseNodeSpecialProperty(e,t,i){const r=i.split('",').map(function(h){return h.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=r[0],o=r[1],a=r[2],l=r[3];let c=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=Wy(c);break}this.getPrevNode()[s]={type:o,type2:a,flag:l,value:c},this.setCurrentProp(this.getPrevNode(),s)}}class zX{parse(e){const t=new MM(e);t.skip(23);const i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const r=new SA;for(;!this.endOfContent(t);){const s=this.parseNode(t,i);s!==null&&r.add(s.name,s)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const i={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(r===0)return null;const l=[];for(let p=0;p<s;p++)l.push(this.parseProperty(e));const c=l.length>0?l[0]:"",h=l.length>1?l[1]:"",d=l.length>2?l[2]:"";for(i.singleProperty=s===1&&e.getOffset()===r;r>e.getOffset();){const p=this.parseNode(e,t);p!==null&&this.parseSubNode(a,i,p)}return i.propertyList=l,typeof c=="number"&&(i.id=c),h!==""&&(i.attrName=h),d!==""&&(i.attrType=d),a!==""&&(i.name=a),i}parseSubNode(e,t,i){if(i.singleProperty===!0){const r=i.propertyList[0];Array.isArray(r)?(t[i.name]=i,i.a=r):t[i.name]=r}else if(e==="Connections"&&i.name==="C"){const r=[];i.propertyList.forEach(function(s,o){o!==0&&r.push(s)}),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(i.name==="Properties70")Object.keys(i).forEach(function(r){t[r]=i[r]});else if(e==="Properties70"&&i.name==="P"){let r=i.propertyList[0],s=i.propertyList[1];const o=i.propertyList[2],a=i.propertyList[3];let l;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),s==="Color"||s==="ColorRGB"||s==="Vector"||s==="Vector3D"||s.indexOf("Lcl_")===0?l=[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:l=i.propertyList[4],t[r]={type:s,type2:o,flag:a,value:l}}else t[i.name]===void 0?typeof i.id=="number"?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:i.name==="PoseNode"?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):t[i.name][i.id]===void 0&&(t[i.name][i.id]=i)}parseProperty(e){const t=e.getString(1);let i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),o=e.getUint32();if(s===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const a=I9(new Uint8Array(e.getArrayBuffer(o))),l=new MM(a.buffer);switch(t){case"b":case"c":return l.getBooleanArray(r);case"d":return l.getFloat64Array(r);case"f":return l.getFloat32Array(r);case"i":return l.getInt32Array(r);case"l":return l.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class MM{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const i=t.indexOf(0);return i>=0&&(t=t.slice(0,i)),Bc(new Uint8Array(t))}}class SA{add(e,t){this[e]=t}}function WX(n){const e="Kaydara FBX Binary  \0";return n.byteLength>=e.length&&e===EA(n,0,e.length)}function VX(n){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function i(r){const s=n[r-1];return n=n.slice(t+r),t++,s}for(let r=0;r<e.length;++r)if(i(1)===e[r])return!1;return!0}function TM(n){const e=/FBXVersion: (\d+)/,t=n.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function GX(n){return n/46186158e3}const BX=[];function Of(n,e,t,i){let r;switch(i.mappingType){case"ByPolygonVertex":r=n;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}i.referenceType==="IndexToDirect"&&(r=i.indices[r]);const s=r*i.dataSize,o=s+i.dataSize;return ZX(BX,i.buffer,s,o)}const zy=new Ri,lc=new U;function MA(n){const e=new nt,t=new nt,i=new nt,r=new nt,s=new nt,o=new nt,a=new nt,l=new nt,c=new nt,h=new nt,d=new nt,p=new nt,m=n.inheritType?n.inheritType:0;if(n.translation&&e.setPosition(lc.fromArray(n.translation)),n.preRotation){const T=n.preRotation.map(Ai.degToRad);T.push(n.eulerOrder),t.makeRotationFromEuler(zy.fromArray(T))}if(n.rotation){const T=n.rotation.map(Ai.degToRad);T.push(n.eulerOrder),i.makeRotationFromEuler(zy.fromArray(T))}if(n.postRotation){const T=n.postRotation.map(Ai.degToRad);T.push(n.eulerOrder),r.makeRotationFromEuler(zy.fromArray(T)),r.invert()}n.scale&&s.scale(lc.fromArray(n.scale)),n.scalingOffset&&a.setPosition(lc.fromArray(n.scalingOffset)),n.scalingPivot&&o.setPosition(lc.fromArray(n.scalingPivot)),n.rotationOffset&&l.setPosition(lc.fromArray(n.rotationOffset)),n.rotationPivot&&c.setPosition(lc.fromArray(n.rotationPivot)),n.parentMatrixWorld&&(d.copy(n.parentMatrix),h.copy(n.parentMatrixWorld));const y=t.clone().multiply(i).multiply(r),b=new nt;b.extractRotation(h);const v=new nt;v.copyPosition(h);const g=v.clone().invert().multiply(h),x=b.clone().invert().multiply(g),w=s,S=new nt;if(m===0)S.copy(b).multiply(y).multiply(x).multiply(w);else if(m===1)S.copy(b).multiply(x).multiply(y).multiply(w);else{const T=new nt().scale(new U().setFromMatrixScale(d)).clone().invert(),k=x.clone().multiply(T);S.copy(b).multiply(y).multiply(k).multiply(w)}const C=c.clone().invert(),A=o.clone().invert();let E=e.clone().multiply(l).multiply(c).multiply(t).multiply(i).multiply(r).multiply(C).multiply(a).multiply(o).multiply(s).multiply(A);const O=new nt().copyPosition(E),R=h.clone().multiply(O);return p.copyPosition(R),E=p.clone().multiply(S),E.premultiply(h.invert()),E}function TA(n){n=n||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return n===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[n]}function Wy(n){return n.split(",").map(function(e){return parseFloat(e)})}function EA(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=n.byteLength),Bc(new Uint8Array(n,e,t))}function HX(n,e){for(let t=0,i=n.length,r=e.length;t<r;t++,i++)n[i]=e[t]}function ZX(n,e,t,i){for(let r=t,s=0;r<i;r++,s++)n[s]=e[r];return n}function EM(n,e,t){return n.slice(0,e).concat(t).concat(n.slice(e))}class XX extends BG{constructor(e){super(e),this.type=Ro}parse(e){const t=function(g,x){switch(g){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(x||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(x||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(x||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(x||""))}},i=`
`,r=function(g,x,w){x=x||1024;let S=g.pos,C=-1,A=0,E="",O=String.fromCharCode.apply(null,new Uint16Array(g.subarray(S,S+128)));for(;0>(C=O.indexOf(i))&&A<x&&S<g.byteLength;)E+=O,A+=O.length,S+=128,O+=String.fromCharCode.apply(null,new Uint16Array(g.subarray(S,S+128)));return-1<C?(g.pos+=A+C+1,E+O.slice(0,C)):!1},s=function(g){const x=/^#\?(\S+)/,w=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,S=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,C=/^\s*FORMAT=(\S+)\s*$/,A=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,E={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let O,R;for((g.pos>=g.byteLength||!(O=r(g)))&&t(1,"no header found"),(R=O.match(x))||t(3,"bad initial token"),E.valid|=1,E.programtype=R[1],E.string+=O+`
`;O=r(g),O!==!1;){if(E.string+=O+`
`,O.charAt(0)==="#"){E.comments+=O+`
`;continue}if((R=O.match(w))&&(E.gamma=parseFloat(R[1])),(R=O.match(S))&&(E.exposure=parseFloat(R[1])),(R=O.match(C))&&(E.valid|=2,E.format=R[1]),(R=O.match(A))&&(E.valid|=4,E.height=parseInt(R[1],10),E.width=parseInt(R[2],10)),E.valid&2&&E.valid&4)break}return E.valid&2||t(3,"missing format specifier"),E.valid&4||t(3,"missing image size specifier"),E},o=function(g,x,w){const S=x;if(S<8||S>32767||g[0]!==2||g[1]!==2||g[2]&128)return new Uint8Array(g);S!==(g[2]<<8|g[3])&&t(3,"wrong scanline width");const C=new Uint8Array(4*x*w);C.length||t(4,"unable to allocate buffer space");let A=0,E=0;const O=4*S,R=new Uint8Array(4),T=new Uint8Array(O);let k=w;for(;k>0&&E<g.byteLength;){E+4>g.byteLength&&t(1),R[0]=g[E++],R[1]=g[E++],R[2]=g[E++],R[3]=g[E++],(R[0]!=2||R[1]!=2||(R[2]<<8|R[3])!=S)&&t(3,"bad rgbe scanline format");let Y=0,$;for(;Y<O&&E<g.byteLength;){$=g[E++];const ae=$>128;if(ae&&($-=128),($===0||Y+$>O)&&t(3,"bad scanline data"),ae){const V=g[E++];for(let te=0;te<$;te++)T[Y++]=V}else T.set(g.subarray(E,E+$),Y),Y+=$,E+=$}const re=S;for(let ae=0;ae<re;ae++){let V=0;C[A]=T[ae+V],V+=S,C[A+1]=T[ae+V],V+=S,C[A+2]=T[ae+V],V+=S,C[A+3]=T[ae+V],A+=4}k--}return C},a=function(g,x,w,S){const C=g[x+3],A=Math.pow(2,C-128)/255;w[S+0]=g[x+0]*A,w[S+1]=g[x+1]*A,w[S+2]=g[x+2]*A,w[S+3]=1},l=function(g,x,w,S){const C=g[x+3],A=Math.pow(2,C-128)/255;w[S+0]=sf.toHalfFloat(Math.min(g[x+0]*A,65504)),w[S+1]=sf.toHalfFloat(Math.min(g[x+1]*A,65504)),w[S+2]=sf.toHalfFloat(Math.min(g[x+2]*A,65504)),w[S+3]=sf.toHalfFloat(1)},c=new Uint8Array(e);c.pos=0;const h=s(c),d=h.width,p=h.height,m=o(c.subarray(c.pos),d,p);let y,b,v;switch(this.type){case rr:v=m.length/4;const g=new Float32Array(v*4);for(let w=0;w<v;w++)a(m,w*4,g,w*4);y=g,b=rr;break;case Ro:v=m.length/4;const x=new Uint16Array(v*4);for(let w=0;w<v;w++)l(m,w*4,x,w*4);y=x,b=Ro;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:d,height:p,data:y,header:h.string,gamma:h.gamma,exposure:h.exposure,type:b}}setDataType(e){return this.type=e,this}load(e,t,i,r){function s(o,a){switch(o.type){case rr:case Ro:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=ui,o.magFilter=ui,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,i,r)}}const Vy=new WeakMap;class jX extends no{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new zo(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(r)},i,r)}decodeDracoFile(e,t,i,r){const s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const i=JSON.stringify(t);if(Vy.has(e)){const l=Vy.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,h)=>{r._callbacks[s]={resolve:c,reject:h},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),Vy.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new fn;e.index&&t.setIndex(new Ln(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,a=r.itemSize;t.setAttribute(s,new Ln(o,a))}return t}_loadLibrary(e,t){const i=new zo(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=YX.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function YX(){let n,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(h){n.onModuleLoaded=function(d){h({draco:d})},DracoDecoderModule(n)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(h=>{const d=h.draco,p=new d.Decoder,m=new d.DecoderBuffer;m.Init(new Int8Array(l),l.byteLength);try{const y=t(d,p,m,c),b=y.attributes.map(v=>v.array.buffer);y.index&&b.push(y.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:y},b)}catch(y){console.error(y),self.postMessage({type:"error",id:a.id,error:y.message})}finally{d.destroy(m),d.destroy(p)}});break}};function t(o,a,l,c){const h=c.attributeIDs,d=c.attributeTypes;let p,m;const y=a.GetEncodedGeometryType(l);if(y===o.TRIANGULAR_MESH)p=new o.Mesh,m=a.DecodeBufferToMesh(l,p);else if(y===o.POINT_CLOUD)p=new o.PointCloud,m=a.DecodeBufferToPointCloud(l,p);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||p.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const b={index:null,attributes:[]};for(const v in h){const g=self[d[v]];let x,w;if(c.useUniqueIDs)w=h[v],x=a.GetAttributeByUniqueId(p,w);else{if(w=a.GetAttributeId(p,o[h[v]]),w===-1)continue;x=a.GetAttribute(p,w)}b.attributes.push(r(o,a,p,v,g,x))}return y===o.TRIANGULAR_MESH&&(b.index=i(o,a,p)),o.destroy(p),b}function i(o,a,l){const c=l.num_faces()*3,h=c*4,d=o._malloc(h);a.GetTrianglesUInt32Array(l,h,d);const p=new Uint32Array(o.HEAPF32.buffer,d,c).slice();return o._free(d),{array:p,itemSize:1}}function r(o,a,l,c,h,d){const p=d.num_components(),m=l.num_points()*p,y=m*h.BYTES_PER_ELEMENT,b=s(o,h),v=o._malloc(y);a.GetAttributeDataArrayForAllPoints(l,d,b,y,v);const g=new h(o.HEAPF32.buffer,v,m).slice();return o._free(v),{name:c,array:g,itemSize:p}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}const LM=new ji,kf=new U;class LA extends sA{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new $t(e,3)),this.setAttribute("uv",new $t(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new __(t,6,1);return this.setAttribute("instanceStart",new xs(i,3,0)),this.setAttribute("instanceEnd",new xs(i,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let i;e instanceof Float32Array?i=e:Array.isArray(e)&&(i=new Float32Array(e));const r=new __(i,t*2,1);return this.setAttribute("instanceColorStart",new xs(r,t,0)),this.setAttribute("instanceColorEnd",new xs(r,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new RG(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ji);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),LM.setFromBufferAttribute(t),this.boundingBox.union(LM))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ss),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)kf.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(kf)),kf.fromBufferAttribute(t,s),r=Math.max(r,i.distanceToSquared(kf));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class vm extends LA{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setPositions(i),this}setColors(e,t=3){const i=e.length-t,r=new Float32Array(2*i);if(t===3)for(let s=0;s<i;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5];else for(let s=0;s<i;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5],r[2*s+6]=e[s+6],r[2*s+7]=e[s+7];return super.setColors(r,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class Kh extends rs{constructor(e){super({type:"LineMaterial",uniforms:Eh.clone(Eh.merge([Je.common,Je.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ie(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${_m>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const Gy=new Ct,AM=new U,CM=new U,wi=new Ct,Si=new Ct,Os=new Ct,By=new U,Hy=new nt,Ei=new c5,RM=new U,Ff=new ji,Uf=new ss,ks=new Ct;let Bs,fl;function PM(n,e,t){return ks.set(0,0,-e,1).applyMatrix4(n.projectionMatrix),ks.multiplyScalar(1/ks.w),ks.x=fl/t.width,ks.y=fl/t.height,ks.applyMatrix4(n.projectionMatrixInverse),ks.multiplyScalar(1/ks.w),Math.abs(Math.max(ks.x,ks.y))}function KX(n,e){const t=n.matrixWorld,i=n.geometry,r=i.attributes.instanceStart,s=i.attributes.instanceEnd,o=Math.min(i.instanceCount,r.count);for(let a=0,l=o;a<l;a++){Ei.start.fromBufferAttribute(r,a),Ei.end.fromBufferAttribute(s,a),Ei.applyMatrix4(t);const c=new U,h=new U;Bs.distanceSqToSegment(Ei.start,Ei.end,h,c),h.distanceTo(c)<fl*.5&&e.push({point:h,pointOnLine:c,distance:Bs.origin.distanceTo(h),object:n,face:null,faceIndex:a,uv:null,[Ov]:null})}}function JX(n,e,t){const i=e.projectionMatrix,r=n.material.resolution,s=n.matrixWorld,o=n.geometry,a=o.attributes.instanceStart,l=o.attributes.instanceEnd,c=Math.min(o.instanceCount,a.count),h=-e.near;Bs.at(1,Os),Os.w=1,Os.applyMatrix4(e.matrixWorldInverse),Os.applyMatrix4(i),Os.multiplyScalar(1/Os.w),Os.x*=r.x/2,Os.y*=r.y/2,Os.z=0,By.copy(Os),Hy.multiplyMatrices(e.matrixWorldInverse,s);for(let d=0,p=c;d<p;d++){if(wi.fromBufferAttribute(a,d),Si.fromBufferAttribute(l,d),wi.w=1,Si.w=1,wi.applyMatrix4(Hy),Si.applyMatrix4(Hy),wi.z>h&&Si.z>h)continue;if(wi.z>h){const g=wi.z-Si.z,x=(wi.z-h)/g;wi.lerp(Si,x)}else if(Si.z>h){const g=Si.z-wi.z,x=(Si.z-h)/g;Si.lerp(wi,x)}wi.applyMatrix4(i),Si.applyMatrix4(i),wi.multiplyScalar(1/wi.w),Si.multiplyScalar(1/Si.w),wi.x*=r.x/2,wi.y*=r.y/2,Si.x*=r.x/2,Si.y*=r.y/2,Ei.start.copy(wi),Ei.start.z=0,Ei.end.copy(Si),Ei.end.z=0;const m=Ei.closestPointToPointParameter(By,!0);Ei.at(m,RM);const y=Ai.lerp(wi.z,Si.z,m),b=y>=-1&&y<=1,v=By.distanceTo(RM)<fl*.5;if(b&&v){Ei.start.fromBufferAttribute(a,d),Ei.end.fromBufferAttribute(l,d),Ei.start.applyMatrix4(s),Ei.end.applyMatrix4(s);const g=new U,x=new U;Bs.distanceSqToSegment(Ei.start,Ei.end,x,g),t.push({point:x,pointOnLine:g,distance:Bs.origin.distanceTo(x),object:n,face:null,faceIndex:d,uv:null,[Ov]:null})}}}class QX extends Xt{constructor(e=new LA,t=new Kh({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)AM.fromBufferAttribute(t,o),CM.fromBufferAttribute(i,o),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+AM.distanceTo(CM);const s=new __(r,2,1);return e.setAttribute("instanceDistanceStart",new xs(s,1,0)),e.setAttribute("instanceDistanceEnd",new xs(s,1,1)),this}raycast(e,t){const i=this.material.worldUnits,r=e.camera;r===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Bs=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;fl=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),Uf.copy(a.boundingSphere).applyMatrix4(o);let c;if(i)c=fl*.5;else{const d=Math.max(r.near,Uf.distanceToPoint(Bs.origin));c=PM(r,d,l.resolution)}if(Uf.radius+=c,Bs.intersectsSphere(Uf)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),Ff.copy(a.boundingBox).applyMatrix4(o);let h;if(i)h=fl*.5;else{const d=Math.max(r.near,Ff.distanceToPoint(Bs.origin));h=PM(r,d,l.resolution)}Ff.expandByScalar(h),Bs.intersectsBox(Ff)!==!1&&(i?KX(this,t):JX(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(Gy),this.material.uniforms.resolution.value.set(Gy.z,Gy.w))}}class kv extends QX{constructor(e=new vm,t=new Kh({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}var wa=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-wa.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?wa.Bounce.In(n*2)*.5:wa.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),Hu=function(){return performance.now()},$X=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){e===void 0&&(e=Hu()),t===void 0&&(t=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]],o=!t;s&&s.update(e,o)===!1&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),M_={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=M_.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n}}},AA=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),T_=new $X,zf=function(){function n(e,t){t===void 0&&(t=T_),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=wa.Linear.None,this._interpolationFunction=M_.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=AA.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=Hu()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),c=l?"array":typeof a,h=!l&&Array.isArray(i[o]);if(!(c==="undefined"||c==="function")){if(h){var d=i[o];if(d.length===0)continue;for(var p=[a],m=0,y=d.length;m<y;m+=1){var b=this._handleRelativeValue(a,d[m]);if(isNaN(b)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(b)}h&&(i[o]=p)}if((c==="object"||l)&&a&&!h){t[o]=l?[]:{};var v=a;for(var g in v)t[o][g]=v[g];r[o]=l?[]:{};var d=i[o];if(!this._isDynamic){var x={};for(var g in d)x[g]=d[g];i[o]=d=x}this._setupProperties(v,t[o],d,r[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),h?r[o]=i[o].slice().reverse():r[o]=t[o]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return e===void 0&&(e=Hu()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},n.prototype.resume=function(e){return e===void 0&&(e=Hu()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e===void 0&&(e=T_),this._group=e,this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=wa.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=M_.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var i=this,r;if(e===void 0&&(e=Hu()),t===void 0&&(t=!0),this._isPaused)return!0;var s,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>o)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=e-this._startTime,l=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),c=this._duration+this._repeat*l,h=function(){if(i._duration===0||a>c)return 1;var v=Math.trunc(a/l),g=a-v*l,x=Math.min(g/i._duration,1);return x===0&&a===i._duration?1:x},d=h(),p=this._easingFunction(d);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,p),this._onUpdateCallback&&this._onUpdateCallback(this._object,d),this._duration===0||a>=this._duration)if(this._repeat>0){var m=Math.min(Math.trunc((a-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=m);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*m,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var y=0,b=this._chainedTweens.length;y<b;y++)this._chainedTweens[y].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(t[s]!==void 0){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),c=Array.isArray(a),h=!l&&c;h?e[s]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(e[s],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(e[s]=o+(a-o)*r))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n}();AA.nextId;var Qs=T_;Qs.getAll.bind(Qs);Qs.removeAll.bind(Qs);Qs.add.bind(Qs);Qs.remove.bind(Qs);var qX=Qs.update.bind(Qs);function Fv(n,e,t){if(n==null||n==="")throw new Error(t||`Parameter "${e}" is required but received: ${n}`);return n}function CA(n,e,t){const i=e.split(".");let r=n;for(const s of i){if(r[s]===void 0||r[s]===null)throw new Error(`Property "${e}" is required but missing at path: "${s}"`);r=r[s]}return r}function ej(n,e,t,i=0,r=1){const s=(n-e)*(r-i)/(t-e)+i,o=Math.min(i,r),a=Math.max(i,r);return s<o?o:s>a?a:s||0}var tj=Object.defineProperty,nj=(n,e,t)=>e in n?tj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Xn=(n,e,t)=>nj(n,typeof e!="symbol"?e+"":e,t);class ij extends qs{constructor(e,t={}){super(),Xn(this,"scene"),Xn(this,"renderer"),Xn(this,"camera"),Xn(this,"controls"),Xn(this,"ambLight"),Xn(this,"dirLight"),Xn(this,"auxDirLight"),Xn(this,"clouds",null),Xn(this,"container"),Xn(this,"_clock",new gm),Xn(this,"stats"),Xn(this,"_animationCallbacks",new Set),Xn(this,"_fogFactor",1),Xn(this,"_sceneSize",5e4*2),Xn(this,"gorund"),Xn(this,"map"),Xn(this,"centerPostion"),Xn(this,"_isInteracting",!1),Xn(this,"debug",!1),Xn(this,"flyTween",null),Xn(this,"calculateCameraPosition",(l,c,h,d)=>{const p=new U(0,c*Math.cos(h),c*Math.sin(h));return p.applyAxisAngle(new U(0,1,0),d),new U(l.x+p.x,l.y+p.y,l.z+p.z)});const{antialias:i=!1,stencil:r=!0,logarithmicDepthBuffer:s=!0,skybox:o,map:a}=t;this.map=a,this.centerPostion=this.map.geo2world(new U(this.map.center[0],this.map.center[1],0)),this.renderer=this._createRenderer(i,r,s),this.scene=this._createScene(o),this.camera=this._createCamera(),e&&this.addTo(e),this.controls=this._createControls(),this.ambLight=this._createAmbLight(),this.scene.add(this.ambLight),this.dirLight=this._createDirLight(),this.scene.add(this.dirLight),this.scene.add(this.dirLight.target),this.auxDirLight=this._createAuxDirLight(),this.gorund=this._createGorund(),this.scene.add(this.gorund),this.renderer.setAnimationLoop(this.animate.bind(this)),this.debug=t.debug||!1,this.flyTween=null,this.debug&&(this.stats=new ah,document.body.appendChild(this.stats.dom))}get fogFactor(){return this._fogFactor}get isInteracting(){return this._isInteracting}set fogFactor(e){this._fogFactor=e,this.controls.dispatchEvent({type:"change",target:this.controls})}get width(){var e;return((e=this.container)==null?void 0:e.clientWidth)||0}get height(){var e;return((e=this.container)==null?void 0:e.clientHeight)||0}addTo(e){const t=typeof e=="string"?document.querySelector(e):e;if(t instanceof HTMLElement)this.container=t,t.appendChild(this.renderer.domElement),new ResizeObserver(this.resize.bind(this)).observe(t);else throw`${e} not found!}`;return this}_createScene(e){const t=new WL,i=(e==null?void 0:e.defaultColor)||"rgb(21,48,94)";if(t.background=new Ge(i),t.fog=new Lh(i,2e-4),e==null?void 0:e.files){const r=new GG;e.path&&r.setPath(e.path),r.load(e.files,s=>{t.background=s},void 0,s=>{console.error("Error loading skybox:",s),t.background=new Ge(i)})}else e!=null&&e.hdr&&this._loadHDRWithPMREM(t,e);return t}async _loadHDRWithPMREM(e,t){try{if(t){const i=await new XX().setPath(t.path||"").setDataType(rr).loadAsync(t.hdr);i.colorSpace=this.renderer.outputColorSpace,i.mapping=303,i.needsUpdate=!0,e.background=i,e.environment=i}}catch(i){console.error("HDR:",i),e.background=new Ge((t==null?void 0:t.defaultColor)||14414079)}}_createRenderer(e,t,i){const r=new hA({antialias:e,logarithmicDepthBuffer:i,stencil:t,alpha:!0,precision:"highp",powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0});return r.debug.checkShaderErrors=!0,r.sortObjects=!0,r.setPixelRatio(window.devicePixelRatio),r.domElement.tabIndex=0,r.shadowMap.enabled=!0,r.shadowMap.needsUpdate=!0,r.shadowMap.type=_L,r.toneMapping=rv,r.toneMappingExposure=1,r.outputColorSpace=Li,r}_createCamera(){return new Kn(45,this.getAspect(),.1,this._sceneSize*2)}_createControls(){const e=new H9(this.camera,this.renderer.domElement),t=Math.PI/2.1;return e.screenSpacePanning=!1,e.minDistance=.1,e.maxDistance=3e4*2,e.maxPolarAngle=t,e.enableDamping=!0,e.dampingFactor=.08,e.keyPanSpeed=1,e.listenToKeyEvents(this.renderer.domElement),e.addEventListener("change",()=>{var a;const i=Math.max(e.getPolarAngle(),.1),r=Math.max(e.getDistance(),100);e.zoomSpeed=Math.max(Math.log(r/1e3),1)+3;const s=3e5*2;e.maxDistance>s*.95&&(e.maxDistance=s*.95),this.camera.far=Ai.clamp(r/i*8,100,s),this.camera.near=Ai.clamp(this.camera.far/1e3,.001,1),this.camera.updateProjectionMatrix(),this.scene.fog instanceof Lh&&(this.scene.fog.density=i/(r+5)*this.fogFactor*.1);const o=r>6e4;e.minAzimuthAngle=o?0:-1/0,e.maxAzimuthAngle=o?0:1/0,e.maxPolarAngle=ej(e.getDistance(),0,7e4,t,0),(a=this.map)==null||a.trigger("control-change",{type:"control-change",control:e,camera:this.camera,target:this.map})}),e.addEventListener("start",()=>{var i;this._isInteracting=!0,(i=this.map)==null||i.trigger("control-start",{type:"control-start",control:e,camera:this.camera,target:this.map})}),e.addEventListener("end",()=>{var i;this._isInteracting=!1,(i=this.map)==null||i.trigger("control-end",{type:"control-end",control:e,camera:this.camera,target:this.map})}),e}_createAmbLight(){return new Cv(16777215,.1)}_createDirLight(){const e=new Ih("rgb(255, 255, 255)",3);e.position.set(this.centerPostion.x+55e3*1.2,55e3*2,this.centerPostion.z+55e3*1);const t=new jt;if(t.position.copy(this.centerPostion),this.scene.add(t),e.target=t,e.castShadow=!0,e.shadow.mapSize.width=1024*10,e.shadow.mapSize.height=1024*10,e.shadow.camera.near=1,e.shadow.camera.far=192500,e.shadow.camera.left=-55e3,e.shadow.camera.bottom=-55e3,e.shadow.camera.top=55e3,e.shadow.camera.right=55e3,e.shadow.radius=1,e.shadow.bias=-0,this.debug){const i=new u5(e.shadow.camera);i.name="dirLightCameraHelper",this.scene.add(i)}return e}_createAuxDirLight(){const e=this._createAuxLightInstance(this.centerPostion.x+-66e3,82500,this.centerPostion.z+-55e3,.5);e.name="AuxDirLight_BackFill",this.scene.add(e),this.scene.add(e.target);const t=this._createAuxLightInstance(this.centerPostion.x+55e3*-1,55e3*1.5,this.centerPostion.z+55e3*1.2,.5);t.name="AuxDirLight_LeftRim",this.scene.add(t),this.scene.add(t.target);const i=this._createAuxLightInstance(this.centerPostion.x+55e3*1,55e3*1.5,this.centerPostion.z+55e3*-1.2,.5);return i.name="AuxDirLight_RightRim",this.scene.add(i),this.scene.add(i.target),e}_createAuxLightInstance(e,t,i,r){const s=new Ih(16777215,r);s.position.set(e,t,i);const o=new jt;return o.position.copy(this.centerPostion),this.scene.add(o),s.target=o,s.castShadow=!1,s}resize(){const e=this.width,t=this.height;return this.renderer.setSize(e,t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.render(this.scene,this.camera),this}addAnimationCallback(e){return this._animationCallbacks.add(e),()=>this._animationCallbacks.delete(e)}animate(){const e=this._clock.getDelta(),t=this._clock.getElapsedTime();this._animationCallbacks.forEach(i=>i(e,t,this)),this.controls.update(),this.renderer.render(this.scene,this.camera),qX(),this.stats&&this.stats.update(),this.dispatchEvent({type:"update",delta:e})}flyTo(e,t,i=!0,r){if(this.controls.target.copy(e),i){const s=this.camera.position;new zf(s).to({y:2e7,z:0},500).chain(new zf(s).to(t,2e3).easing(wa.Quintic.Out).onComplete(o=>r&&r(o))).start()}else this.camera.position.copy(t)}flyToAdvanced(e){const t=this.camera,i=this.controls,r=e.center,s=e.cameraCoord,o=e.duration??2e3,a=e.delay??0,l=e.complete,c=!!e.curvePath;if(!r||!s)return;const h=this.map.geo2world(new U(r[0],r[1],0)),d=this.map.geo2world(new U(s[0],s[1],s[2]));if(!t||!i||!h||!d)return;const p=i.target.clone(),m=t.position.clone(),y=new U(h.x,h.y,h.z),b=new U(d.x,d.y,d.z);if(this.flyTween&&(this.flyTween.stop(),this.flyTween=null),c){const v=[m,m.clone().lerp(b,.33),m.clone().lerp(b,.67),b],g=new XL(...v),x={t:0,x:p.x,y:p.y,z:p.z};this.flyTween=new zf(x).to({t:1,x:y.x,y:y.y,z:y.z},o).easing(wa.Quadratic.InOut).onUpdate(()=>{const w=g.getPoint(x.t),S=new U(x.x,x.y,x.z);t.position.copy(w),t.lookAt(S),t.updateProjectionMatrix(),i.target.copy(S),i.update()})}else{const v={tx:p.x,ty:p.y,tz:p.z,px:m.x,py:m.y,pz:m.z};this.flyTween=new zf(v).to({tx:y.x,ty:y.y,tz:y.z,px:b.x,py:b.y,pz:b.z},o).easing(wa.Quadratic.InOut).onUpdate(()=>{const g=new U(v.tx,v.ty,v.tz),x=new U(v.px,v.py,v.pz);t.position.copy(x),t.lookAt(g),i.target.copy(g),i.update()})}this.flyTween&&(this.flyTween.onComplete(()=>{this.flyTween&&(this.flyTween.stop(),this.flyTween=null),l&&l()}),a>0?setTimeout(()=>{this.flyTween&&this.flyTween.start()},a):this.flyTween.start())}flyToPoint(e){const{controls:t}=this,i=e.center,r=e.duration??2e3,s=typeof e.distance=="number"?e.distance:typeof e.altitude=="number"?e.altitude:t.getDistance(),o=y=>y*Math.PI/180,a=typeof e.polarDeg=="number"?o(e.polarDeg):e.polarAngle||t.getPolarAngle(),l=typeof e.azimuthDeg=="number"?o(e.azimuthDeg):e.azimuthAngle||t.getAzimuthalAngle(),c=e.complete,h=!!e.curvePath,d=this.map.geo2world(new U(i[0],i[1],0)),p=this.calculateCameraPosition(d,s,a,l),m=this.map.world2geo(p);this.flyToAdvanced({center:[i[0],i[1],0],cameraCoord:[m.x,m.y,m.z||0],duration:r,complete:c,curvePath:h})}getState(){return{centerPosition:this.controls.target,cameraPosition:this.camera.position}}_bindMap(e){e&&(this.map=e)}getMap(){return this.map?this.map:null}getAspect(){const[e,t]=this.getWidthHeight();return e/t}getWidthHeight(){let e=window.innerWidth,t=window.innerHeight;return[e,t]}_createGorund(){const e=this.centerPostion,t=new Sl({transparent:!1,color:new Ge("rgb(45,52,60)").multiplyScalar(.7),metalness:.2,roughness:1}),i=new js(this._sceneSize*2,this._sceneSize*2),r=new Xt(i,t);return r.name="",r.castShadow=!1,r.receiveShadow=!1,r.position.y=0,r.position.add(e),r.rotateX(-Math.PI/2),r.visible=!1,r}}var Zu=(n=>(n[n.none=0]="none",n[n.create=1]="create",n[n.remove=2]="remove",n))(Zu||{});function rj(n,e){const t=n.position.clone().setZ(n.maxZ).applyMatrix4(n.matrixWorld);return e.distanceTo(t)}function sj(n){const e=n.scale,t=new U(-e.x,-e.y,0).applyMatrix4(n.matrixWorld),i=new U(e.x,e.y,0).applyMatrix4(n.matrixWorld);return t.sub(i).length()}function oj(n){return n.distToCamera/n.sizeInWorld*.8}function aj(n,e,t,i){const r=oj(n);if(n.isLeaf){if(n.inFrustum&&n.z<t&&(n.z<e||n.showing)&&(n.z<e||r<i))return 1}else if(n.z>=e&&(n.z>t||r>i))return 2;return 0}function lj(n,e,t,i){const r=[],s=i+1,o=e*2,a=0,l=.25;{const c=t*2,h=new U(.5,.5,1),d=new al(o,c,s),p=new al(o+1,c,s),m=new al(o,c+1,s),y=new al(o+1,c+1,s);d.position.set(-l,l,a),d.scale.copy(h),p.position.set(l,l,a),p.scale.copy(h),m.position.set(-l,-l,a),m.scale.copy(h),y.position.set(l,-l,a),y.scale.copy(h),r.push(d,p,m,y)}return r}var cj=Object.defineProperty,uj=(n,e,t)=>e in n?cj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Mi=(n,e,t)=>uj(n,typeof e!="symbol"?e+"":e,t);const hj=10,dj=new sA,fj=new U,pj=new nt,mj=new ji(new U(-.5,-.5,0),new U(.5,.5,1)),IM=new um,RA=class Xu extends Xt{constructor(e=0,t=0,i=0){super(dj,[]),Mi(this,"_dataOnlyMode",!1),Mi(this,"vectorData",null),Mi(this,"x"),Mi(this,"y"),Mi(this,"z"),Mi(this,"isTile",!0),Mi(this,"parent",null),Mi(this,"children",[]),Mi(this,"_ready",!1),Mi(this,"_isDummy",!1),Mi(this,"_showing",!1),Mi(this,"_maxZ",0),Mi(this,"distToCamera",0),Mi(this,"sizeInWorld",0),Mi(this,"_loaded",!1),Mi(this,"_inFrustum",!1),this.x=e,this.y=t,this.z=i,this.name=`Tile ${i}-${e}-${t}`,this.up.set(0,0,1),this.matrixAutoUpdate=!1}setDataOnlyMode(e){return this._dataOnlyMode=e,e&&(this.visible=!1),this}isDataOnlyMode(){return this._dataOnlyMode}getVectorData(){return this.vectorData}static get downloadThreads(){return Xu._downloadThreads}get isDummy(){return this._isDummy}get showing(){return this._showing}set showing(e){const t=this._showing;this._showing=e,this.material.forEach(i=>i.visible=e),t===!1&&this._showing===!0&&this._loaded&&this.dispatchEvent({type:"tile-shown",tile:this}),t===!0&&this._showing===!1&&this.dispatchEvent({type:"tile-hidden",tile:this})}get maxZ(){return this._maxZ}set maxZ(e){this._maxZ=e}get index(){return this.parent?this.parent.children.indexOf(this):-1}get loaded(){return this._loaded}get inFrustum(){return this._inFrustum}set inFrustum(e){this._inFrustum=e}get isLeaf(){return this.children.filter(e=>e.isTile).length===0}traverse(e){e(this),this.children.forEach(t=>{t.isTile&&t.traverse(e)})}traverseVisible(e){this.visible&&(e(this),this.children.forEach(t=>{t.isTile&&t.traverseVisible(e)}))}raycast(e,t){this.showing&&this.loaded&&this.isTile&&super.raycast(e,t)}LOD(e){if(Xu.downloadThreads>hj)return{action:Zu.none};let t=[];const{loader:i,minLevel:r,maxLevel:s,LODThreshold:o}=e,a=aj(this,r,s,o);return a===Zu.create&&(t=lj(i,this.x,this.y,this.z),this.add(...t)),{action:a,newTiles:t}}_checkVisible(){const e=this.parent;if(e&&e.isTile){const t=e.children.filter(r=>r.isTile),i=t.every(r=>r.loaded);e.showing=!i,t.forEach(r=>r.showing=i)}return this}async _load(e){var s,o;Xu._downloadThreads++;const{x:t,y:i,z:r}=this;if(this._dataOnlyMode)try{const a=await e.load({x:t,y:i,z:r,bounds:[-1/0,-1/0,1/0,1/0]});this.vectorData=((s=a.geometry)==null?void 0:s.userData)||{},this._loaded=!0,this.dispatchEvent({type:"vector-data-loaded",data:this.vectorData,tile:this})}catch(a){console.error(` ${r}/${t}/${i}:`,a),this._loaded=!1}else{const a=await e.load({x:t,y:i,z:r,bounds:[-1/0,-1/0,1/0,1/0]});this.material=a.materials,this.geometry=a.geometry,this.maxZ=((o=this.geometry.boundingBox)==null?void 0:o.max.z)||0,this._loaded=!0}return Xu._downloadThreads--,this}_init(){this.updateMatrix(),this.updateMatrixWorld(),this.sizeInWorld=sj(this)}update(e){if(console.assert(this.z===0),!this.parent)return this;IM.setFromProjectionMatrix(pj.multiplyMatrices(e.camera.projectionMatrix,e.camera.matrixWorldInverse));const t=e.camera.getWorldPosition(fj);return this.traverse(i=>{i.receiveShadow=this.receiveShadow,i.castShadow=this.castShadow;const r=mj.clone().applyMatrix4(i.matrixWorld);r.max.setY(9e3),i.inFrustum=IM.intersectsBox(r),i.distToCamera=rj(i,t);const{action:s,newTiles:o}=i.LOD(e);this._doAction(i,s,o,e)}),this._checkReady(),this}_doAction(e,t,i,r){return t===Zu.create?i==null||i.forEach(s=>{s._init(),s._isDummy=s.z<r.minLevel,this.dispatchEvent({type:"tile-created",tile:s}),s.isDummy||s._load(r.loader).then(()=>{s._checkVisible(),this.dispatchEvent({type:"tile-loaded",tile:s})})}):t===Zu.remove&&(e.showing=!0,e._unLoad(!1,r.loader),this.dispatchEvent({type:"tile-unload",tile:e})),this}reload(e){return this._unLoad(!0,e),this}_checkReady(){return this._ready||(this._ready=!0,this.traverse(e=>{if(e.isLeaf&&e.loaded&&!e.isDummy){this._ready=!1;return}}),this._ready&&this.dispatchEvent({type:"ready"})),this}_unLoad(e,t){var i;return e&&this.isTile&&!this.isDummy&&(this.dispatchEvent({type:"unload"}),(i=t==null?void 0:t.unload)==null||i.call(t,this)),this.children.forEach(r=>r._unLoad(!0,t)),this.clear(),this}};Mi(RA,"_downloadThreads",0);let al=RA;var gj=Object.defineProperty,yj=(n,e,t)=>e in n?gj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_j=(n,e,t)=>yj(n,e+"",t);class PA{constructor(e=0){_j(this,"_lon0",0),this._lon0=e}get lon0(){return this._lon0}getTileXWithCenterLon(e,t){const i=Math.pow(2,t);let r=e+Math.round(i/360*this._lon0);return r>=i?r-=i:r<0&&(r+=i),r}getTileXYZproj(e,t,i){const r=this.mapWidth,s=this.mapHeight/2,o=e/Math.pow(2,i)*r-r/2,a=s-t/Math.pow(2,i)*s*2;return{x:o,y:a}}getProjBoundsFromLonLat(e){const t=e[0]===-180&&e[2]===180,i=this.project(e[0]+(t?this._lon0:0),e[1]),r=this.project(e[2]+(t?this._lon0:0),e[3]);return[Math.min(i.x,r.x),Math.min(i.y,r.y),Math.max(i.x,r.x),Math.max(i.y,r.y)]}getProjBoundsFromXYZ(e,t,i){const r=this.getTileXYZproj(e,t,i),s=this.getTileXYZproj(e+1,t+1,i);return[Math.min(r.x,s.x),Math.min(r.y,s.y),Math.max(r.x,s.x),Math.max(r.y,s.y)]}getLonLatBoundsFromXYZ(e,t,i){const r=this.getProjBoundsFromXYZ(e,t,i),s=this.unProject(r[0],r[1]),o=this.unProject(r[2],r[3]);return[s.lon,s.lat,o.lon,o.lat]}}var vj=Object.defineProperty,bj=(n,e,t)=>e in n?vj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Wf=(n,e,t)=>bj(n,typeof e!="symbol"?e+"":e,t);const Du=6378e3;class IA extends PA{constructor(){super(...arguments),Wf(this,"ID","3857"),Wf(this,"mapWidth",2*Math.PI*Du),Wf(this,"mapHeight",this.mapWidth),Wf(this,"mapDepth",1)}project(e,t){const i=(e-this.lon0)*(Math.PI/180),r=t*(Math.PI/180),s=Du*i,o=Du*Math.log(Math.tan(Math.PI/4+r/2));return{x:s,y:o}}unProject(e,t){let i=e/Du*(180/Math.PI)+this.lon0;return i>180&&(i-=360),{lat:(2*Math.atan(Math.exp(t/Du))-Math.PI/2)*(180/Math.PI),lon:i}}}var xj=Object.defineProperty,wj=(n,e,t)=>e in n?xj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Vf=(n,e,t)=>wj(n,typeof e!="symbol"?e+"":e,t);class Sj extends PA{constructor(){super(...arguments),Vf(this,"ID","4326"),Vf(this,"mapWidth",36e3),Vf(this,"mapHeight",18e3),Vf(this,"mapDepth",1)}project(e,t){return{x:(e-this.lon0)*100,y:t*100}}unProject(e,t){return{lon:e/100+this.lon0,lat:t/100}}}const $n={createFromID:(n="3857",e)=>{let t;switch(n){case"3857":t=new IA(e);break;case"4326":t=new Sj(e);break;default:throw new Error(`Projection ID: ${n} is not supported.`)}return t}};function DA(n,e){var r;const t=(r=n.getLayers().find(s=>s.isBaseLayer===!0))==null?void 0:r._rootTile,i=e.intersectObjects([t]);for(const s of i)if(s.object instanceof al){const o=n.worldToLocal(s.point.clone()),a=n.map2geo(o);return Object.assign(s,{location:a})}}function DM(n,e){const t=new U(0,-1,0),i=new U(e.x,10*1e3,e.z),r=new Iv(i,t);return DA(n,r)}function Mj(n,e,t){const i=new Iv;return i.setFromCamera(t,n),DA(e,i)}var Tj=Object.defineProperty,Ej=(n,e,t)=>e in n?Tj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Fs=(n,e,t)=>Ej(n,typeof e!="symbol"?e+"":e,t);class Uv extends Xt{constructor(e){super(),Fs(this,"name","map"),Fs(this,"_clock",new gm),Fs(this,"isLOD",!0),Fs(this,"autoUpdate",!0),Fs(this,"updateInterval",100),Fs(this,"_minLevel",2),Fs(this,"_layers",new Map),Fs(this,"_maxLevel",24),Fs(this,"_projection",new IA(0)),Fs(this,"_LODThreshold",1),this.up.set(0,0,1);const{minLevel:t=2,maxLevel:i=19}=e;this.minLevel=t,this.maxLevel=i}get minLevel(){return this._minLevel}set minLevel(e){this._minLevel=e}get maxLevel(){return this._maxLevel}set maxLevel(e){this._maxLevel=e}get lon0(){return this.projection.lon0}get projection(){return this._projection}get LODThreshold(){return this._LODThreshold}set LODThreshold(e){this._LODThreshold=e}static create(e){return new Uv(e)}update(e){if(!this.autoUpdate)return;const t=this._clock.getElapsedTime();t>this.updateInterval/1e3&&(this._layers.forEach(i=>{i.enabled&&i.visible&&i.update(e)}),this._clock.start(),this.dispatchEvent({type:"update",delta:t}))}dispose(){this.removeFromParent()}geo2pos(e){return this.geo2map(e)}geo2map(e){const t=this.projection.project(e.x,e.y);return new U(t.x,t.y,e.z)}geo2world(e){return this.localToWorld(this.geo2map(e))}pos2geo(e){return this.map2geo(e)}map2geo(e){const t=this.projection.unProject(e.x,e.y);return new U(t.lon,t.lat,e.z)}world2geo(e){return this.pos2geo(this.worldToLocal(e.clone()))}getLocalInfoFromGeo(e){const t=this.geo2world(e);return DM(this,t)}getLocalInfoFromWorld(e){return DM(this,e)}getLocalInfoFromScreen(e,t){return Mj(e,this,t)}get downloading(){return al.downloadThreads}addLayer(e){return this._layers.has(e.layerId)&&console.warn(` ${e.layerid} `),this._layers.set(e.layerId,e),this.add(e),this}removeLayer(e){const t=this._layers.get(e);return t?(this._layers.delete(e),this.remove(t),t.dispose(),console.log(`  ${e} `),!0):(console.warn(`  ${e} `),!1)}getLayer(e){return this._layers.get(e)}getLayerIds(){return Array.from(this._layers.keys())}clearLayers(){return this._layers.forEach(e=>{this.remove(e),e.dispose()}),this._layers.clear(),console.log(" "),this}getLayers(){return Array.from(this._layers.values())}getApproxZoomLevel(){let e=this.minLevel;const t=this.getLayers().find(i=>i.isBaseLayer===!0);return!t||!t._rootTile||t._rootTile.traverseVisible(i=>{i.showing&&i.inFrustum&&(e=Math.max(e,i.z))}),e}getDataZoom(){let e=this.minLevel;const t=this.getLayers().find(i=>i.isBaseLayer===!0);return!t||!t._rootTile||t._rootTile.traverseVisible(i=>{i.showing&&i.inFrustum&&(e=Math.max(e,i.z))}),e}}var Lj=Object.defineProperty,Aj=(n,e,t)=>e in n?Lj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,NM=(n,e,t)=>Aj(n,typeof e!="symbol"?e+"":e,t);class OM{constructor(){NM(this,"_dispatcher",new qs),NM(this,"_listenerMap",new Map)}on(e,t){const i=r=>t(r.data||r);return this._listenerMap.has(e)||this._listenerMap.set(e,new Map),this._listenerMap.get(e).set(t,i),this._dispatcher.addEventListener(e,i),this}once(e,t){const i=r=>{this.off(e,i),t(r.data||r)};return this.on(e,i)}off(e,t){const i=this._listenerMap.get(e);if(!i)return this;const r=i.get(t);return r&&(this._dispatcher.removeEventListener(e,r),i.delete(t),i.size===0&&this._listenerMap.delete(e)),this}trigger(e,t){const i={type:e,data:t};return this._dispatcher.dispatchEvent(i),this}get threeEventDispatcher(){return this._dispatcher}}function Cj(n,e){return n.replace(/\{(\w+)\}/g,(t,i)=>{if(e.hasOwnProperty(i)){const r=e[i];return r!==void 0?String(r):t}throw new Error(`: ${i}`)})}function Zy(n,...e){for(let t=0;t<e.length;t++){const i=e[t];for(const r in i)n[r]=i[r]}return n}function zp(n){return n==null}function Nu(n){return zp(n)?!1:typeof n=="function"||n.constructor!==null&&n.constructor===Function}function Rj(n=new Date){const e=n.getFullYear().toString(),t=(n.getMonth()+1).toString().padStart(2,"0"),i=n.getDate().toString().padStart(2,"0"),r=n.getHours().toString().padStart(2,"0"),s=n.getMinutes().toString().padStart(2,"0"),o=n.getSeconds().toString().padStart(2,"0");return`${e}-${t}-${i} ${r}:${s}:${o}`}var Pj=Object.defineProperty,Ij=(n,e,t)=>e in n?Pj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Xy=(n,e,t)=>Ij(n,typeof e!="symbol"?e+"":e,t);class Dj{}class NA extends Jc(Qc(Dj)){constructor(e){super(),Xy(this,"target"),Xy(this,"dom"),Xy(this,"_enabled",!1),this.target=e}enable(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)}disable(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this}enabled(){return!!this._enabled}remove(){this.disable(),delete this.target,delete this.dom}}const kM=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"&&!process.versions.electron&&!process.versions.nw&&!process.versions["node-webkit"];let ju={};function FM(){return window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI}if(!kM){const n=navigator.userAgent.toLowerCase(),e=document.documentElement||{style:{}},t="ActiveXObject"in window,i=n.indexOf("webkit")!==-1,r=n.indexOf("phantom")!==-1,s=n.search("android [23]")!==-1,o=n.indexOf("chrome")!==-1,a=n.indexOf("gecko")!==-1&&!i&&!("opera"in window)&&!t,l=/iphone/i.test(n)&&/micromessenger/i.test(n),c=typeof orientation<"u"||n.indexOf("mobile")!==-1,h=!window.PointerEvent&&"MSPointerEvent"in window,d=window.PointerEvent&&navigator.pointerEnabled||h,p=t&&"transition"in e.style,m="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!s,y="MozPerspective"in e.style,b="OTransition"in e.style,v=(p||m||y)&&!b&&!r,g=typeof window<"u"&&Nu(window.createImageBitmap),x=typeof window<"u"&&Nu(window.ResizeObserver),w=typeof window<"u"&&Nu(window.btoa),S=typeof window<"u"&&Nu(window.Proxy),C=typeof window<"u"&&Nu(window.requestIdleCallback);let A=0;if(o){const Y=n.match(/chrome\/([\d.]+)/);A=Y?Y[1]:0}const E=!r&&(d||"ontouchstart"in window||"DocumentTouch"in window&&document instanceof window.DocumentTouch),O=typeof window<"u"&&"WebGLRenderingContext"in window,R=FM();let T=!1;try{new OffscreenCanvas(2,2).getContext("2d"),T=!0}catch{T=!1}let k=!1;try{window.addEventListener("testPassive",()=>{},{get passive(){return k=!0,!0}})}catch{}ju={IS_NODE:kM,isTest:!1,ie:t,ielt9:t&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:i,gecko:a,android:n.indexOf("android")!==-1,android23:s,chrome:o,chromeVersion:A,safari:!o&&n.indexOf("safari")!==-1,phantomjs:r,ie3d:p,webkit3d:m,gecko3d:y,opera12:b,any3d:v,iosWeixin:l,mobile:c,mobileWebkit:c&&i,mobileWebkit3d:c&&m,mobileOpera:c&&"opera"in window,mobileGecko:c&&a,touch:!!E,msPointer:!!h,pointer:!!d,retina:R>1,devicePixelRatio:R,language:navigator.browserLanguage?navigator.browserLanguage:navigator.language,ie9:t&&document.documentMode===9,ie10:t&&document.documentMode===10,webgl:O,imageBitMap:g,resizeObserver:x,btoa:w,decodeImageInWorker:T,monitorDPRChange:!0,supportsPassive:k,proxy:S,requestIdleCallback:C,checkDevicePixelRatio:()=>{if(typeof window<"u"&&ju.monitorDPRChange){const Y=FM(),$=Y!==ju.devicePixelRatio;return $&&(ju.devicePixelRatio=Y),$}return!1}}}const Nj=ju;var Oj=Object.defineProperty,kj=(n,e,t)=>e in n?Oj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ma=(n,e,t)=>kj(n,typeof e!="symbol"?e+"":e,t);function Jc(n){return class extends n{constructor(...e){super(...e),ma(this,"eventClass",new OM),ma(this,"on",this.eventClass.on.bind(this.eventClass)),ma(this,"trigger",this.eventClass.trigger.bind(this.eventClass)),ma(this,"off",this.eventClass.off.bind(this.eventClass)),this.eventClass=new OM}}}function Qc(n){return class extends n{constructor(...e){super(...e),ma(this,"options"),ma(this,"_isUpdatingOptions"),ma(this,"_initHooksCalled"),ma(this,"_initHooks");const t=Object.getPrototypeOf(this).options||{},i=Zy({},t,e[0]||{});this.setOptions(i),this.callInitHooks(),this._isUpdatingOptions=!1}proxyOptions(){return Nj.proxy?(this.options=new Proxy(this.options,{set:(e,t,i)=>{if(t=t,e[t]===i||(e[t]=i,this._isUpdatingOptions))return!0;const r={};return r[t]=i,this.config(r),!0}}),this):this}callInitHooks(){const e=Object.getPrototypeOf(this);return this._visitInitHooks(e),this}setOptions(e){if((!this.hasOwnProperty("options")||zp(this.options))&&(this.options=this.options?Object.create(this.options):{}),!e)return this;for(const t in e)this.options[t]=e[t];return this}config(e,t){if(this._isUpdatingOptions=!0,e){if(arguments.length===2&&typeof e=="string"){const i={};i[e]=t,e=i}e=e;for(const i in e)this.options[i]=e[i],this[i]&&this[i]instanceof NA&&(e[i]?this[i].enable():this[i].disable());this.onConfig(e),this._isUpdatingOptions=!1}else{const i={};for(const r in this.options)this.options.hasOwnProperty(r)&&(i[r]=this.options[r]);return this._isUpdatingOptions=!1,i}return this}onConfig(e){}_visitInitHooks(e){if(this._initHooksCalled)return;const t=Object.getPrototypeOf(e);t._visitInitHooks&&t._visitInitHooks.call(this,t),this._initHooksCalled=!0;const i=e._initHooks;if(i&&i!==t._initHooks)for(let r=0;r<i.length;r++)i[r].call(this)}static mergeOptions(e){const t=this.prototype,i=Object.getPrototypeOf(t);return t.hasOwnProperty("options")?t.options===i.options&&(t.options=Object.create(t.options)):t.options={},Zy(t.options,e),this}static addInitHook(e,...t){const i=typeof e=="function"?e:function(){this[e].apply(this,t)},r=this.prototype,s=Object.getPrototypeOf(r);return(!r._initHooks||r._initHooks===s._initHooks)&&(r._initHooks=[]),r._initHooks.push(i),this}static include(...e){for(let t=0;t<e.length;t++)Zy(this.prototype,e[t]);return this}}}var Fj=Object.defineProperty,Uj=(n,e,t)=>e in n?Fj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zj=(n,e,t)=>Uj(n,e+"",t);function zv(n){return class extends n{constructor(...e){super(...e),zj(this,"_handlers"),this._handlers=[]}addHandler(e,t){if(!t)return this;if(this._handlers||(this._handlers=[]),this[e])return this[e].enable(),this;const i=this[e]=new t(this);return this._handlers.push(i),this.options[e]&&i.enable(),this}removeHandler(e){if(!e)return this;const t=this[e];if(t&&this._handlers){const i=this._handlers.indexOf(t);i>=0&&this._handlers.splice(i,1),this[e].remove(),delete this[e]}return this}_clearHandlers(){if(this._handlers){for(let e=0,t=this._handlers.length;e<t;e++)this._handlers[e].remove();this._handlers=[]}}}}var Wj=Object.defineProperty,Vj=(n,e,t)=>e in n?Wj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ka=(n,e,t)=>Vj(n,typeof e!="symbol"?e+"":e,t);const Gj={attribution:"",visible:!0,opacity:1,zIndex:0,isSceneLayer:!1,altitude:0};class bm extends zv(Jc(Qc(sr))){constructor(e,t){super(),Ka(this,"_id"),Ka(this,"opacity",1),Ka(this,"_animationCallbacks",new Set),Ka(this,"isSceneLayer",!1),Ka(this,"_altitude",0),Ka(this,"depthOffset"),Ka(this,"_regionOverlays",[]),Fv(e,"id","ID"),t&&(this.setOptions(t),this.opacity=t.opacity||1,this.isSceneLayer=t.isSceneLayer??!1,t.altitude!==void 0&&this.setAltitude(t.altitude)),this._id=e,typeof this.animate=="function"&&this._registerAnimate()}getId(){return this._id}addTo(e){return e.addLayer(this),this}getZIndex(){const e=this.options||{};return typeof e.zIndex=="number"?e.zIndex:0}getDepthOffset(){const e=this.options||{};return typeof e.depthOffset=="number"?e.depthOffset:0}getOpacity(){return this.opacity}setOpacity(e){this.opacity=e,this.traverse(t=>{"material"in t&&(Array.isArray(t.material)?t.material:[t.material]).forEach(i=>{"opacity"in i&&(i.transparent=e<1,i.opacity=e,i.needsUpdate=!0)}),t instanceof Zh&&(t.material.opacity=e,t.material.transparent=e<1,t.material.needsUpdate=!0)})}getMap(){return this.map?this.map:null}show(){return this.visible||(this.visible=!0,this.options.visible=!0,this.getMap()),this}hide(){return this.visible&&(this.visible=!1,this.options.visible=!1,this.getMap()),this}setAltitude(e){return this.position.y=e,this.updateMatrix(),this.updateMatrixWorld(!0),this}getAltitude(){return this.position.y}_bindMap(e){e&&(this.map=e,typeof this.animate=="function"&&this._registerAnimate())}_registerAnimate(){const e=this.getMap();if(!(e!=null&&e.viewer))return;const t=e.viewer.addAnimationCallback((i,r,s)=>{var o;(o=this.animate)==null||o.call(this,i,r,s)});this._animationCallbacks.add(t)}_clearAnimationCallbacks(){this._animationCallbacks.forEach(e=>e()),this._animationCallbacks.clear()}getOptions(){return{...this.options}}setRegionOverlays(e){return this._regionOverlays=(e||[]).map(t=>({id:t.id??this._generateRegionOverlayId(),color:t.color??"#00FF88",opacity:t.opacity??.3,mode:t.mode??"overlay",zIndex:t.zIndex??0,geometry:t.geometry,feature:t.feature})),this}addRegionOverlay(e){const t=e.id??this._generateRegionOverlayId(),i={id:t,color:e.color??"#00FF88",opacity:e.opacity??.3,mode:e.mode??"overlay",zIndex:e.zIndex??0,geometry:e.geometry,feature:e.feature};return this._regionOverlays.push(i),t}removeRegionOverlay(e){return this._regionOverlays=this._regionOverlays.filter(t=>t.id!==e),this}clearRegionOverlays(){return this._regionOverlays=[],this}getRegionOverlays(){return this._regionOverlays.slice()}_generateRegionOverlayId(){return`region-overlay-${Date.now()}-${Math.random().toString(16).slice(2)}`}}bm.mergeOptions(Gj);var Bj=Object.defineProperty,Hj=(n,e,t)=>e in n?Bj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Yu=(n,e,t)=>Hj(n,typeof e!="symbol"?e+"":e,t);const OA=class kA{constructor(e){Yu(this,"_cache",new Map),Yu(this,"_gltfLoader"),Yu(this,"_fbxLoader"),Yu(this,"_dracoLoader"),this._gltfLoader=new X9(e),this._fbxLoader=new NX(e)}static init(e){return this._instance||(this._instance=new kA(e)),this._instance}async load(e){var s;const t=`${e.type}:${e.url}`;if(this._cache.has(t))return this._cloneCachedModel(t,e);e.type==="gltf"&&((s=e.dracoOptions)!=null&&s.enable)&&this._initDracoLoader(e.dracoOptions.decoderPath);let i,r;try{if(e.type==="gltf"){const o=await this._gltfLoader.loadAsync(e.url);i=o.scene,r=o.animations}else i=await this._fbxLoader.loadAsync(e.url),r=i.animations;return this._cache.set(t,{model:i,animations:r}),{model:this._processModel(i.clone(),e),animations:(r==null?void 0:r.map(o=>({...o,name:o.name||"unnamed"})))||[]}}catch(o){throw console.error(`${e.type}:`,e.url,o),o}}_initDracoLoader(e="/draco/"){this._dracoLoader||(this._dracoLoader=new jX,this._dracoLoader.setDecoderPath(e),this._gltfLoader.setDRACOLoader(this._dracoLoader))}_cloneCachedModel(e,t){const i=this._cache.get(e).model.clone();return this._processModel(i,t)}_processModel(e,t){return t.position&&e.position.copy(t.position),t.scale&&(typeof t.scale=="number"?e.scale.setScalar(t.scale):t.scale.x!==void 0||t.scale.y!==void 0||t.scale.z!==void 0?(t.scale.x!==void 0&&(e.scale.x=t.scale.x),t.scale.y!==void 0&&(e.scale.y=t.scale.y),t.scale.z!==void 0&&(e.scale.z=t.scale.z)):e.scale.copy(t.scale)),t.rotation&&e.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),t.materialOverrides&&e.traverse(i=>{if(i instanceof Xt&&i.material){const r=t.materialOverrides[i.name];r&&(i.material=r)}}),e.traverse(i=>{i instanceof Xt&&i.material}),e}};Yu(OA,"_instance");let Zj=OA;const jy=(n,e)=>{"updateRanges"in n?n.updateRanges[0]=e:n.updateRange=e},UM=new nt,Gf=new U,Bf=new Wn,zM=new U,WM=new Wn,Ou=new U,Xj=n=>class extends n{constructor(){super();const e=parseInt(Gh.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=t=>{t.vertexShader=`attribute float cloudOpacity;
               varying float vOpacity;
              `+t.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = cloudOpacity;
                `),t.fragmentShader=`varying float vOpacity;
              `+t.fragmentShader.replace(`#include <${e}>`,`#include <${e}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}};class jj extends sr{constructor({limit:e=200,range:t,material:i=eA,texture:r,frustumCulled:s=!0}={}){super(),this.name="Clouds",this.ref=this;const o=this,a=new js(1,1),l=new Float32Array(Array.from({length:e},()=>1)),c=new Float32Array(Array.from({length:e},()=>[1,1,1]).flat()),h=new Ah(l,1);h.setUsage(H1),a.setAttribute("cloudOpacity",h);const d=Xj(i),p=new d;p.map=r,p.transparent=!0,p.depthWrite=!1,p.needsUpdate=!0,this.cloudMaterial=p,this.instance=new bv(a,p,e);const m=this.instance;m.matrixAutoUpdate=!1,m.frustumCulled=s,m.instanceColor=new Ah(c,3),m.instanceColor.setUsage(H1),o.add(m);const y=[],b=()=>{const E=y.length;let O=0;for(let R=0;R<this.ref.children.length;R++){const T=this.ref.children[R];T.cloudStateArray&&(O+=T.cloudStateArray.length)}if(E===O)return y;y.length=0;for(let R=0;R<this.ref.children.length;R++){const T=this.ref.children[R];T.cloudStateArray&&y.push(...T.cloudStateArray)}return v(),y},v=()=>{const E=Math.min(e,t!==void 0?t:e,y.length);m.count=E,jy(m.instanceMatrix,{offset:0,count:E*16}),m.instanceColor&&jy(m.instanceColor,{offset:0,count:E*3}),jy(m.geometry.attributes.cloudOpacity,{offset:0,count:E})};let g=0,x=0,w;const S=new Wn,C=new U(0,0,1),A=new U;this.update=(E,O,R)=>{g=O,UM.copy(m.matrixWorld).invert(),E.matrixWorld.decompose(zM,WM,Ou);const T=b();for(x=0;x<T.length;x++)w=T[x],w.ref.matrixWorld.decompose(Gf,Bf,Ou),Gf.add(A.copy(w.position).applyQuaternion(Bf).multiply(Ou)),Bf.copy(WM).multiply(S.setFromAxisAngle(C,w.rotation+=R*w.rotationFactor)),Ou.multiplyScalar(w.volume+(1+Math.sin(g*w.density*w.speed))/2*w.growth),w.matrix.compose(Gf,Bf,Ou).premultiply(UM),w.dist=Gf.distanceTo(zM);for(T.sort((k,Y)=>Y.dist-k.dist),x=0;x<T.length;x++)w=T[x],l[x]=w.opacity*(w.dist<w.fade-1?w.dist/w.fade:1),m.setMatrixAt(x,w.matrix),m.setColorAt(x,w.color);m.geometry.attributes.cloudOpacity.needsUpdate=!0,m.instanceMatrix.needsUpdate=!0,m.instanceColor&&(m.instanceColor.needsUpdate=!0)}}}let Yj=0;class Kj extends sr{constructor({opacity:e=1,speed:t=0,bounds:i=new U().fromArray([5,1,1]),segments:r=20,color:s=new Ge("#ffffff"),fade:o=10,volume:a=6,smallestVolume:l=.25,distribute:c=null,growth:h=4,concentrate:d="inside",seed:p=Math.random()}={}){super(),this.name="cloud_"+Yj++,this.seed=p,this.segments=r,this.bounds=i,this.concentrate=d,this.volume=a,this.smallestVolume=l,this.distribute=c,this.growth=h,this.speed=t,this.fade=o,this.opacity=e,this.color=s,this.ref=this,this.cloudStateArray=[],this.updateCloud()}updateCloudStateArray(){if(this.cloudStateArray.length===this.segments)return;const{segments:e,uuid:t}=this;if(this.cloudStateArray.length>this.segments)this.cloudStateArray.splice(0,this.cloudStateArray.length-this.segments);else for(let i=this.cloudStateArray.length;i<e;i++)this.cloudStateArray.push({segments:e,bounds:new U(1,1,1),position:new U,uuid:t,index:i,ref:this,dist:0,matrix:new nt,volume:0,length:0,speed:0,growth:0,opacity:1,fade:0,density:0,rotation:i*(Math.PI/e),rotationFactor:0,color:new Ge})}updateCloud(){const{volume:e,color:t,speed:i,growth:r,opacity:s,fade:o,bounds:a,seed:l,cloudStateArray:c,distribute:h,segments:d,concentrate:p,smallestVolume:m}=this;this.updateCloudStateArray();let y=0;function b(){const v=Math.sin(l+y)*1e4;return y++,v-Math.floor(v)}c.forEach((v,g)=>{v.segments=d,v.volume=e,v.color=t,v.speed=i,v.growth=r,v.opacity=s,v.fade=o,v.bounds.copy(a),v.density=Math.max(.5,b()),v.rotationFactor=Math.max(.2,.5*b())*i;const x=h==null?void 0:h(v,g);if(x||d>1){var w;v.position.copy(v.bounds).multiply((w=x==null?void 0:x.point)!==null&&w!==void 0?w:{x:b()*2-1,y:b()*2-1,z:b()*2-1})}const S=Math.abs(v.position.x),C=Math.abs(v.position.y),A=Math.abs(v.position.z),E=Math.max(S,C,A);v.length=1,S===E&&(v.length-=S/v.bounds.x),C===E&&(v.length-=C/v.bounds.y),A===E&&(v.length-=A/v.bounds.z),v.volume=((x==null?void 0:x.volume)!==void 0?x.volume:Math.max(Math.max(0,m),p==="random"?b():p==="inside"?v.length:1-v.length))*e})}}class Wv{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const i=this.workersResolve[e];if(i&&i(t),this.queue.length){const{resolve:r,msg:s,transfer:o}=this.queue.shift();this.workersResolve[e]=r,this.workers[e].postMessage(s,o)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(i=>{const r=this._getIdleWorker();r!==-1?(this._initWorker(r),this.workerStatus|=1<<r,this.workersResolve[r]=i,this.workers[r].postMessage(e,t)):this.queue.push({resolve:i,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}function FA(n,e){const t=new fn;t.setAttribute("position",new Ln(new Float32Array([0,0,0]),3));const i=new Xc(t,new Zc({size:n.size,color:n.color||16777215,sizeAttenuation:!n.glow,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0}));return i.position.copy(e),i}async function Jj(n,e){var c,h;let t=null;try{t=await Ms._loadTexture(n.url),t.magFilter=ui,t.minFilter=Pr,t.colorSpace=Li,t.generateMipmaps=!0,t.premultiplyAlpha=!1,t.needsUpdate=!0}catch(d){console.error("IconPoint texture load failed:",n.url,d)}const i=new Hh({map:t??null,color:n.color||16777215,transparent:n.transparent??!0,opacity:n.opacity??1,sizeAttenuation:n.sizeAttenuation??!0,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0,premultipliedAlpha:!1,blending:ba}),r=new Zh(i),s=.002,o=n.size;let a,l;if(Array.isArray(o))[a,l]=o;else{const d=typeof o=="number"?o:32;if(t&&((c=t.image)!=null&&c.width)&&((h=t.image)!=null&&h.height)){const p=t.image,m=p.width/p.height||1;l=d,a=d*m}else a=d,l=d}return r.scale.set(a*s,l*s,1),n.rotation&&(r.rotation.z=n.rotation),n.anchor&&r.center.set(n.anchor[0],n.anchor[1]),r.position.copy(e),r}function Vv(n,e){var s,o,a;let t;e instanceof Float32Array?t=Array.from(e):Array.isArray(e)&&typeof e[0]=="number"?t=e:t=e.flatMap(l=>[l.x,l.y,l.z]);const i=new vm;i.setPositions(t);const r=new Kh({color:new Ge(n.color??16777215).getHex(),linewidth:n.width??2,transparent:n.transparent??!0,opacity:n.opacity??1,dashed:!!n.dashArray,dashScale:((s=n.dashArray)==null?void 0:s[0])??1,dashSize:((o=n.dashArray)==null?void 0:o[0])??1,gapSize:((a=n.dashArray)==null?void 0:a[1])??0,resolution:new Ie(window.innerWidth,window.innerHeight),alphaToCoverage:!0,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0});return window.addEventListener("resize",()=>{r.resolution.set(window.innerWidth,window.innerHeight)}),new kv(i,r)}async function Qj(n,e){const t=n.type||(n.url.toLowerCase().endsWith(".fbx")?"fbx":"gltf");return await Zj.init().load({...n,type:t,position:e})}function $j(n,e){const{geometry:t,center:i,avgY:r}=Gv(e),s=n.depthOffset??0,o=s!==0,a=new Ir({color:new Ge(n.color??16777215),transparent:n.transparent??!0,opacity:n.opacity??1,wireframe:n.wireframe??!1,side:n.side==="back"?Zi:n.side==="double"?Yr:ns,polygonOffset:o,polygonOffsetFactor:o?s:0,polygonOffsetUnits:o?s:0,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0}),l=new Xt(t,a);if(l.rotation.x=-Math.PI/2,l.position.set(i.x,r,i.z),(n.borderWidth??0)>0){const c={color:n.borderColor??n.color??0,width:n.borderWidth},h=[];for(let p=0;p<e.length;p+=3){const m=e[p],y=e[p+2];h.push(m-i.x,-(y-i.z),0)}const d=Vv(c,h);d.position.z+=.1,l.add(d)}return l}function qj(n,e){var h;const t=((h=n.extrude)==null?void 0:h.height)||2e3,i=[],r=[],s=[];for(let d=0;d<e.length;d+=3){const p=e[d],m=e[d+1],y=e[d+2];r.push(new U(p,m,y)),s.push(new U(p,m+t,y))}i.push(...r,...s);const o=new fn;o.setFromPoints(i);const a=[],l=r.length;for(let d=0;d<l;d++){const p=(d+1)%l;a.push(d,d+l,p),a.push(p,d+l,p+l)}for(let d=2;d<l;d++)a.push(0,d-1,d),a.push(l,l+d-1,l+d);o.setIndex(a),o.computeVertexNormals();const c=new rs({uniforms:{uColor:{value:new Ge(n.color??16777215)},uOpacity:{value:n.opacity??1},uBrightness:{value:1.2}},vertexShader:`
          varying vec3 vWorldPosition;
          varying vec3 vNormal;
          void main() {
            vNormal = normalize(normalMatrix * normal);
            vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform vec3 uColor;
          uniform float uOpacity;
          uniform float uBrightness;
          varying vec3 vWorldPosition;
          varying vec3 vNormal;
      
          void main() {
            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            float innerGlow = smoothstep(0.3, 0.8, length(vWorldPosition - vec3(0.0))) * uBrightness;
            vec3 finalColor = uColor * (1.0 + fresnel * 0.5 + innerGlow);
            gl_FragColor = vec4(finalColor, uOpacity);
            if (uOpacity >= 0.99) gl_FragDepthEXT = gl_FragCoord.z;
          }
        `,transparent:n.transparent??!0,side:Yr,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0});return new Xt(o,c)}function eY(n,e,t){const{geometry:i,center:r,avgY:s}=Gv(t),o=new O9(i,{textureWidth:512,textureHeight:512,waterNormals:new jh().load(n.normalMap,function(c){c.wrapS=c.wrapT=is}),waterColor:n.color||"#19AAEE",sunColor:n.sunColor||"#05FFF8",distortionScale:1,alpha:n.opacity||.8}),a=o.onBeforeRender,l=o.onAfterRender;return o.onBeforeRender=(c,h,d,p,m,y)=>{e.tilemap.autoUpdate=!1,a.call(o,c,h,d,p,m,y)},o.onAfterRender=(c,h,d,p,m,y)=>{e.tilemap.autoUpdate=!0,l.call(o,c,h,d,p,m,y)},o.material.uniforms.size.value=.1,o.rotation.x=-Math.PI/2,o.position.set(r.x,s,r.z),e.viewer.addEventListener("update",()=>{o.material.uniforms.time.value+=1/60}),o}function Gv(n){let e=0;for(let s=1;s<n.length;s+=3)e+=n[s];e/=n.length/3;const t={x:0,z:0},i=[];for(let s=0;s<n.length;s+=3)t.x+=n[s],t.z+=n[s+2];t.x/=n.length/3,t.z/=n.length/3;for(let s=0;s<n.length;s+=3)i.push(new Ie(n[s]-t.x,-(n[s+2]-t.z)));const r=new JL(i);return{geometry:new Tv(r),center:t,avgY:e}}async function tY(n,e){const{geometry:t,center:i,avgY:r}=Gv(e),s=await Ms._loadTexture(n.normalMap),o=await Ms._loadTexture(n.normalMap);s.wrapS=s.wrapT=is,o.wrapS=o.wrapT=is,s.repeat.set(.015,.015),o.repeat.set(.005,.005);const a=new Sl({color:new Ge(n.color).multiplyScalar(3.5),roughness:.1,metalness:.8,transparent:n.transparent??!0,opacity:.9,fog:!1,normalMap:s,normalScale:new Ie(1.5,1.5),envMapIntensity:2,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0}),l=new Xt(t,a);l.rotation.x=-Math.PI/2,l.position.set(i.x,r+.15,i.z),l.castShadow=!1,l.receiveShadow=!0;let c=0;return l.onBeforeRender=()=>{const h=performance.now(),d=c?(h-c)/1e3:.016;s.offset.x+=d*.08,s.offset.y+=d*.03,o.offset.x-=d*.12,o.offset.y+=d*.02,l.position.y=r+.5+Math.sin(h*.02)*.02,c=h},l}function nY(n,e){n.color=new Ge(n.hexcolor),n.boundstext&&(n.bounds=new U(n.boundstext.x,n.boundstext.y,n.boundstext.z));const t=new Kj(n);return t.castShadow=!0,t.scale.setScalar(50),t.position.copy(e),t}async function iY(n,e){const t={fontSizeDpi:48,fontFamily:"'Microsoft YaHei', sans-serif",fontWeight:"bold",fontStyle:"normal",textColor:"#ffffff",strokeColor:"#000000",strokeWidth:2,showBackground:!0,bgStyle:1,bgColor:"#3498db",bgOpacity:.8,shadowColor:"rgba(0, 0, 0, 0.5)",shadowBlur:5,shadowOffsetX:3,shadowOffsetY:3,roundRectRadius:20,bubblePointerHeight:10,bubblePointerWidth:15,bubbleBorderColor:"#ffffff",bubbleBorderWidth:3,screenSpaceSize:20,fixedSize:50,...n};t.screenSpaceSize==null&&t.fixedSize!=null&&(t.screenSpaceSize=t.fixedSize);const i=(typeof window<"u"&&window.devicePixelRatio||1)*4,r=n.screenSpaceSize!=null||n.fixedSize!=null;if(n.fontSizeDpi==null&&r){const x=n.screenSpaceSize??n.fixedSize??t.screenSpaceSize;t.fontSizeDpi=x*i}t.fontSizeDpi=Math.min(Math.max(t.fontSizeDpi,8),128);const s=document.createElement("canvas"),o=s.getContext("2d");if(!o)throw new Error("canvas context is null");const a=`${t.fontStyle} ${t.fontWeight} ${t.fontSizeDpi}px ${t.fontFamily}`;o.font=a;const l=t.showBackground?20:0,c=100,h=50,d=o.measureText(t.text),p=Math.max(c,d.width+l*2),m=Math.max(h,t.fontSizeDpi*1.5+l*2);s.width=Math.min(p,2048),s.height=Math.min(m,2048),o.clearRect(0,0,s.width,s.height),o.font=a,t.showBackground&&(t.bgStyle===1?(o.fillStyle=t.bgColor,o.globalAlpha=t.bgOpacity,o.beginPath(),UA(o,l/2,l/2,s.width-l,s.height-l,t.roundRectRadius),o.fill(),o.globalAlpha=1,o.shadowColor=t.shadowColor,o.shadowBlur=t.shadowBlur,o.shadowOffsetX=t.shadowOffsetX,o.shadowOffsetY=t.shadowOffsetY):(o.fillStyle=t.bgColor,o.globalAlpha=t.bgOpacity,o.beginPath(),zA(o,s.width/2,s.height/2,s.width*.8,s.height*.8,t.roundRectRadius,t.bubblePointerHeight,t.bubblePointerWidth),o.fill(),o.globalAlpha=1,o.strokeStyle=t.bubbleBorderColor,o.lineWidth=t.bubbleBorderWidth,o.stroke())),o.textAlign="center",o.textBaseline="middle",t.strokeWidth>0&&(o.strokeStyle=t.strokeColor,o.lineWidth=t.strokeWidth,o.lineJoin="round",o.strokeText(t.text,s.width/2,s.height/2)),o.fillStyle=t.textColor,o.fillText(t.text,s.width/2,s.height/2),o.shadowColor="transparent";const y=new xv(s);y.magFilter=or,y.minFilter=Pr,y.anisotropy=16;const b=new Hh({map:y,transparent:n.transparent??!0,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0,fog:!1}),v=new Zh(b),g=t.screenSpaceSize??t.fixedSize;return v.scale.set(s.width*g/100,s.height*g/100,1),e&&v.position.copy(e),v}async function rY(n,e,t){const i={fontSizeDpi:48,fontFamily:"'Microsoft YaHei', sans-serif",fontWeight:"bold",fontStyle:"normal",textColor:"#ffffff",strokeColor:"#000000",strokeWidth:2,showBackground:!0,bgStyle:1,bgColor:"#3498db",bgOpacity:.8,shadowColor:"rgba(0, 0, 0, 0.5)",shadowBlur:5,shadowOffsetX:3,shadowOffsetY:3,roundRectRadius:20,bubblePointerHeight:10,bubblePointerWidth:15,bubbleBorderColor:"#ffffff",bubbleBorderWidth:3,screenSpaceSize:20,maxVisibleDistance:1/0,...n};i.screenSpaceSize==null&&n.fixedSize!=null&&(i.screenSpaceSize=n.fixedSize);const r=(typeof window<"u"&&window.devicePixelRatio||1)*4;n.fontSizeDpi==null&&(i.fontSizeDpi=i.screenSpaceSize*r),i.fontSizeDpi=Math.max(i.fontSizeDpi,8);const s=document.createElement("canvas"),o=s.getContext("2d");if(!o)throw new Error("Failed to get canvas context");const a=`${i.fontStyle} ${i.fontWeight} ${i.fontSizeDpi}px ${i.fontFamily}`;o.font=a;const l=i.showBackground?20:0,c=100,h=50,d=o.measureText(i.text),p=Math.max(c,d.width+l*2),m=Math.max(h,i.fontSizeDpi*1.5+l*2);s.width=Math.min(p,2048),s.height=Math.min(m,2048),o.clearRect(0,0,s.width,s.height),o.font=a,i.showBackground&&(i.bgStyle===1?(o.fillStyle=i.bgColor,o.globalAlpha=i.bgOpacity,o.beginPath(),UA(o,l/2,l/2,s.width-l,s.height-l,i.roundRectRadius),o.fill(),o.globalAlpha=1,o.shadowColor=i.shadowColor,o.shadowBlur=i.shadowBlur,o.shadowOffsetX=i.shadowOffsetX,o.shadowOffsetY=i.shadowOffsetY):(o.fillStyle=i.bgColor,o.globalAlpha=i.bgOpacity,o.beginPath(),zA(o,s.width/2,s.height/2,s.width*.8,s.height*.8,i.roundRectRadius,i.bubblePointerHeight,i.bubblePointerWidth),o.fill(),o.globalAlpha=1,o.strokeStyle=i.bubbleBorderColor,o.lineWidth=i.bubbleBorderWidth,o.stroke())),o.textAlign="center",o.textBaseline="middle",i.strokeWidth>0&&(o.strokeStyle=i.strokeColor,o.lineWidth=i.strokeWidth,o.lineJoin="round",o.strokeText(i.text,s.width/2,s.height/2)),o.fillStyle=i.textColor,o.fillText(i.text,s.width/2,s.height/2),o.shadowColor="transparent";const y=new xv(s),b=new Hh({map:y,transparent:n.transparent??!0,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!0,fog:!1}),v=new Zh(b);v.position.copy(e),v.userData.isLabel=!0;const g=()=>{if(!v.visible)return;const w=t.viewer.camera.position.distanceTo(v.position);if(w>i.maxVisibleDistance){v.visible=!1;return}v.visible=!0;const S=new Ie;t.viewer.renderer.getSize(S);const C=S.height,A=Ai.degToRad(t.viewer.camera.fov),E=typeof window<"u"&&window.devicePixelRatio||1,O=i.screenSpaceSize*E/s.height*(2*w*Math.tan(A/2)/C);v.scale.set(O*s.width,O*s.height,1),v.lookAt(t.viewer.camera.position)};g();const x=()=>g();return v.addEventListener("dispose",()=>{t.viewer.renderer.domElement.removeEventListener("resize",g)}),t.viewer.renderer.domElement.addEventListener("resize",g),t.viewer.camera.addEventListener("change",g),v.onBeforeRender=x,v}async function sY(n,e){const t=n.size??n.iconSize,i={text:n.text||"",iconSize:t,fontSize:n.fontSize??12,fontFamily:n.fontFamily||"",fontWeight:n.fontWeight??400,padding:{top:3,right:6,bottom:3,left:6,...n.padding},bgColor:n.bgColor||"#ffffff",bgOpacity:n.bgOpacity??1,textColor:n.textColor||"#000000",strokeColor:n.strokeColor||"#000000",strokeWidth:n.strokeWidth??0,iconScale:n.iconScale??1,renderbg:n.renderbg??!0,textOffset:n.textOffset??{x:-40,y:-19},depthTest:n.depthTest??!1,depthWrite:n.depthWrite??!1,transparent:n.transparent??!0,canvasScale:4};let r=null;if(n.url)try{r=await dY(n.url)}catch{console.error("Label icon load failed:",n.url)}const{canvas:s,width:o,height:a,center:l}=await oY(i,r),c=new In(s);c.generateMipmaps=!0,c.minFilter=Pr,c.magFilter=ui,c.colorSpace=Li,c.premultiplyAlpha=!1,c.needsUpdate=!0;const h=new Hh({map:c,transparent:i.transparent??!0,depthTest:i.depthTest??!0,depthWrite:i.depthWrite??!0,blending:ba,sizeAttenuation:!1,premultipliedAlpha:!1,alphaTest:.05}),d=new Zh(h),p=.002;return d.scale.set(o*p,a*p,1),n.anchor?d.center.set(n.anchor[0],n.anchor[1]):d.center.set(l[0],l[1]),e&&d.position.copy(e),d}async function oY(n,e){return new Promise(t=>{const{text:i,fontSize:r,fontFamily:s,padding:o,bgColor:a,textColor:l,strokeColor:c,strokeWidth:h,iconScale:d,canvasScale:p,renderbg:m,textOffset:y,iconSize:b,fontWeight:v,bgOpacity:g}=n,x=e!==null;let w=0,S=0;if(x&&e){const X=e.naturalWidth||e.width||1,D=e.naturalHeight||e.height||1,ge=X/D||1;Array.isArray(b)?(w=b[0],S=b[1]):typeof b=="number"?(S=b,w=b*ge):(w=X,S=D)}else Array.isArray(b)?(w=b[0],S=b[1]):typeof b=="number"&&(w=b,S=b);const C=document.createElement("canvas").getContext("2d"),A=`${v} ${r}px ${s}`;C.font=A;const E=lY(C,i,r),{width:O,ascent:R,descent:T}=E,k=x?w/2:0,Y=x?S/2:0,$=k+y.x,re=Y+y.y,ae=$-o.left,V=$+O+o.right,te=re-R-o.top,J=re+T+o.bottom;let pe,Te,Le,Ue;x?(pe=Math.min(0,ae),Te=Math.min(0,te),Le=Math.max(w,V),Ue=Math.max(S,J)):(pe=ae,Te=te,Le=V,Ue=J);const tt=Math.ceil(Le-pe),_e=Math.ceil(Ue-Te),{canvas:Ae,ctx:We}=aY(tt,_e,p),se=-pe,Se=-Te;if(x&&e&&w>0&&S>0){const X=w*d,D=S*d,ge=(w-X)/2,me=(S-D)/2,fe=se+ge,N=Se+me;We.drawImage(e,fe,N,X,D)}const Me=se+$,De=Se+re;m&&a&&a!=="transparent"&&uY(We,Me,De,O,R,T,o,a,g),We.font=A,hY(We,i,Me,De,l,h,c);let Be,H;x&&w>0&&S>0?(Be=(se+k)/tt,H=(Se+Y)/_e):(Be=.5,H=.5),t({canvas:Ae,width:tt,height:_e,center:[Be,1-H]})})}function UA(n,e,t,i,r,s){n.beginPath(),n.moveTo(e+s,t),n.lineTo(e+i-s,t),n.quadraticCurveTo(e+i,t,e+i,t+s),n.lineTo(e+i,t+r-s),n.quadraticCurveTo(e+i,t+r,e+i-s,t+r),n.lineTo(e+s,t+r),n.quadraticCurveTo(e,t+r,e,t+r-s),n.lineTo(e,t+s),n.quadraticCurveTo(e,t,e+s,t),n.closePath()}function zA(n,e,t,i,r,s,o,a){if(i<=0)throw new Error("Width must be positive");if(r<=0)throw new Error("Height must be positive");if(s<0)throw new Error("Radius cannot be negative");const l=i,c=r,h=Math.min(s,i/2,r/2),d=o??10,p=a??15;n.beginPath(),n.moveTo(e-l/2+h,t-c/2),n.lineTo(e+l/2-h,t-c/2),n.quadraticCurveTo(e+l/2,t-c/2,e+l/2,t-c/2+h),n.lineTo(e+l/2,t+c/2-h),n.quadraticCurveTo(e+l/2,t+c/2,e+l/2-h,t+c/2),n.lineTo(e+p/2,t+c/2),n.lineTo(e,t+c/2+d),n.lineTo(e-p/2,t+c/2),n.lineTo(e-l/2+h,t+c/2),n.quadraticCurveTo(e-l/2,t+c/2,e-l/2,t+c/2-h),n.lineTo(e-l/2,t-c/2+h),n.quadraticCurveTo(e-l/2,t-c/2,e-l/2+h,t-c/2),n.closePath()}function aY(n,e,t){const i=document.createElement("canvas");i.width=Math.ceil(n*t),i.height=Math.ceil(e*t);const r=i.getContext("2d",{alpha:!0});return r.scale(t,t),r.imageSmoothingEnabled=!1,{canvas:i,ctx:r}}function lY(n,e,t){const i=n.measureText(e);return{width:i.width,ascent:i.actualBoundingBoxAscent||t*.8,descent:i.actualBoundingBoxDescent||t*.2,totalHeight:(i.actualBoundingBoxAscent||t*.8)+(i.actualBoundingBoxDescent||t*.2)}}function cY(n,e,t,i,r,s){n.beginPath(),n.moveTo(e+s,t),n.lineTo(e+i-s,t),n.arcTo(e+i,t,e+i,t+s,s),n.lineTo(e+i,t+r-s),n.arcTo(e+i,t+r,e+i-s,t+r,s),n.lineTo(e+s,t+r),n.arcTo(e,t+r,e,t+r-s,s),n.lineTo(e,t+s),n.arcTo(e,t,e+s,t,s),n.closePath()}function uY(n,e,t,i,r,s,o,a,l=1){const c=e-o.left,h=t-r-o.top,d=i+o.left+o.right,p=r+s+o.top+o.bottom;n.save(),n.globalAlpha=l,n.fillStyle=a,cY(n,c,h,d,p,2),n.fill(),n.restore()}function hY(n,e,t,i,r,s,o){n.save(),n.textBaseline="alphabetic",n.textAlign="left",s>0&&(n.strokeStyle=o,n.lineWidth=s,n.lineJoin="round",n.strokeText(e,t,i)),n.fillStyle=r,n.fillText(e,t,i),n.restore()}function dY(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>e(i),i.onerror=r=>t(new Error(`Failed to load image: ${n} ${r}`)),i.src=n})}async function fY(n,e,t){const i=new Mv(.2,.2,24,12),r=new Ir({color:n.color}),s=await Ms._loadTexture(n.icon),o=new Zc({size:80*window.innerHeight/window.innerHeight,fog:!1,opacity:1,transparent:n.transparent??!0,toneMapped:!1,blending:xh,map:s,sizeAttenuation:!0,depthTest:n.depthTest??!0,depthWrite:n.depthWrite??!1}),a=new bv(i,r,e.length);a.position.add(t.prjcenter),a.castShadow=!0;const l=new jt,c=[];for(let m=0;m<e.length;m++){const y=e[m],b=new U(y.coordinates[0],y.coordinates[1],y.coordinates[2]||0),v=t.geo2world(b).sub(t.prjcenter);l.position.copy(v),l.updateMatrix(),a.setMatrixAt(m,l.matrix),c.push(v.x,0,v.z)}const h=new Float32Array(c),d=new fn;d.setAttribute("position",new Ln(h,3));const p=new Xc(d,o);return p.position.add(t.prjcenter),p.position.y=1.5*10,p.renderOrder=99999999,p.visible=!0,console.log(t,"map"),{points:p,InstancedCol:a}}var pY=Object.defineProperty,mY=(n,e,t)=>e in n?pY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,WA=(n,e,t)=>mY(n,typeof e!="symbol"?e+"":e,t);const Bv=class el{constructor(e){this.config=e}async applyTo(e){if(!e)return!1;try{switch(e.visible=this.config.visible!==!1,this.config.type){case"basic-point":case"icon-point":case"icon-label-point":return this._applyPointStyle(e);case"basic-line":return this._applyLineStyle(e);case"gltf":case"fbx":return this._applyModelStyle(e);case"basic-polygon":return this._applyPolygonStyle(e);case"extrude-polygon":return this._applyExtrudeStyle(e);case"water":case"base-water":return this._applyWaterStyle(e);case"cloud":return this._applyCloudStyle(e);case"canvas-label":case"canvas-label-fixed":return this._applyTextSpriteStyle(e);case"light":return this._applyLightStyle(e);case"custom":return this._applyCustomStyle(e);default:throw new Error("Unknown style type")}}catch(t){return console.error("Style apply failed:",t),e.visible=!1,!1}}async _applyPointStyle(e){const t=this.config;return t.type==="icon-point"?await this._applyIconPoint(e,t):t.type==="basic-point"?this._applyBasicPoint(e,t):t.type==="icon-label-point"&&this._applyIconLabelPoint(e,t),!0}async _applyIconPoint(e,t){return!0}_applyBasicPoint(e,t){let i;if(e instanceof Xc)i=e;else if(i=FA(t,e.position),i.position.copy(e.position),i.rotation.copy(e.rotation),i.scale.copy(e.scale),e.parent){let s=e.parent;s._threeGeometry=i,s._updateGeometry()}const r=i.material;r.size=t.size,t.color&&r.color.set(t.color),t.glow&&(r.sizeAttenuation=!1)}_applyIconLabelPoint(e,t){return!0}_applyLineStyle(e){return this.config,!0}_applyPolygonStyle(e){return!0}_applyExtrudeStyle(e){return!0}_applyWaterStyle(e){return!0}_applyCloudStyle(e){return!0}_applyTextSpriteStyle(e){return!0}_applyLightStyle(e){return!0}async _applyModelStyle(e){return!0}async _applyCustomStyle(e){const t=await this.config.build();return e instanceof sr&&(e.clear(),e.add(t)),!0}static async _loadTexture(e){if(el._textureCache.has(e))return el._textureCache.get(e);const t=await new Promise((i,r)=>{el._textureLoader.load(e,i,void 0,r)});return t.needsUpdate=!0,el._textureCache.set(e,t),t}static create(e){return e instanceof el?e:new el(e)}};WA(Bv,"_textureCache",new Map);WA(Bv,"_textureLoader",new jh);let Ms=Bv;const Ti=[];for(let n=0;n<256;++n)Ti.push((n+256).toString(16).slice(1));function gY(n,e=0){return(Ti[n[e+0]]+Ti[n[e+1]]+Ti[n[e+2]]+Ti[n[e+3]]+"-"+Ti[n[e+4]]+Ti[n[e+5]]+"-"+Ti[n[e+6]]+Ti[n[e+7]]+"-"+Ti[n[e+8]]+Ti[n[e+9]]+"-"+Ti[n[e+10]]+Ti[n[e+11]]+Ti[n[e+12]]+Ti[n[e+13]]+Ti[n[e+14]]+Ti[n[e+15]]).toLowerCase()}let Yy;const yY=new Uint8Array(16);function _Y(){if(!Yy){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Yy=crypto.getRandomValues.bind(crypto)}return Yy(yY)}const vY=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),VM={randomUUID:vY};function bY(n,e,t){var r;if(VM.randomUUID&&!n)return VM.randomUUID();n=n||{};const i=n.random??((r=n.rng)==null?void 0:r.call(n))??_Y();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,gY(i)}var VA=(n=>(n.POINT="point",n.LINE_VERTEX="line_vertex",n.POLYGON_CENTER="polygon_center",n.LABEL="label",n.ICON="icon",n.CLUSTER="cluster",n))(VA||{}),Hs=(n=>(n.NO_COLLISION="no_collision",n.PRIORITY_LOST="priority_lost",n.OUT_OF_VIEWPORT="out_of_viewport",n.ZOOM_FILTERED="zoom_filtered",n.MANUAL_HIDDEN="manual_hidden",n.GROUP_COLLISION="group_collision",n))(Hs||{}),xY=Object.defineProperty,wY=(n,e,t)=>e in n?xY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zr=(n,e,t)=>wY(n,typeof e!="symbol"?e+"":e,t);class Wo extends zv(Jc(Qc(jt))){constructor(e){super(),Zr(this,"_position"),Zr(this,"_threeGeometry"),Zr(this,"_geometry"),Zr(this,"_layer"),Zr(this,"_style"),Zr(this,"_id"),Zr(this,"_styleQueue",[]),Zr(this,"_isApplyingStyle",!1),Zr(this,"_isGeometryInitializing",!1),Zr(this,"_collisionState",{visible:!0,reason:Hs.NO_COLLISION,collidedWith:[],timestamp:Date.now()}),Zr(this,"_collisionConfig",{enabled:!0,priority:50,padding:4,minZoom:0,maxZoom:24}),Zr(this,"_animationRef",null),Fv(e.geometry,"geometry","geometry must be specified"),this._geometry=e.geometry,this._position=new U(0,0,0),this._threeGeometry=new jt,e.userData&&(this.userData=Object.assign({},JSON.parse(JSON.stringify(e.userData)))),e.style&&this.setStyle(e.style),e.id?this._id=e.id:this._id=bY()}async initializeGeometry(){if(!(this._isGeometryInitializing||this._threeGeometry)){this._isGeometryInitializing=!0;try{await this._toThreeJSGeometry(),this._processStyleQueue()}finally{this._isGeometryInitializing=!1}}}setStyle(e){const t=e instanceof Ms?e:new Ms(e);this._style=t;const i=JSON.parse(JSON.stringify(t.config));return this._styleQueue.push(i),this._tryProcessQueue(),this}getStyle(){return this._style}async _applyStyleWithRetry(e,t=3,i=100){let r=null;for(let s=1;s<=t;s++)try{this._threeGeometry.parent||(this.add(this._threeGeometry),await new Promise(o=>requestAnimationFrame(o))),await e.applyTo(this._threeGeometry);return}catch(o){if(r=o,s<t){const a=i*Math.pow(2,s-1);await new Promise(l=>setTimeout(l,a))}}throw r||new Error("")}async _processStyleQueue(){if(!this._threeGeometry||this._isApplyingStyle||this._styleQueue.length===0)return;this._isApplyingStyle=!0;const e=this._styleQueue[0];try{const t=new Ms(JSON.parse(JSON.stringify(e)));await this._applyStyleWithRetry(t),this._styleQueue.shift(),this._styleQueue.length>0&&await this._processStyleQueue()}catch(t){throw t}finally{this._isApplyingStyle=!1,this._styleQueue.length>0&&this._tryProcessQueue()}}_tryProcessQueue(){this._threeGeometry&&!this._isApplyingStyle&&this._styleQueue.length>0?this._processStyleQueue().catch(e=>{this._isApplyingStyle=!1,this._tryProcessQueue(),console.warn(e)}):!this._threeGeometry&&!this._isGeometryInitializing&&this.initializeGeometry()}addTo(e){return e.addFeature(this),this}getLayer(){return this._layer||null}getMap(){var e;return((e=this._layer)==null?void 0:e.getMap())||null}_bindLayer(e){if(this._layer&&this._layer!==e)throw new Error("Feature cannot be added to multiple layers");this._layer=e}_updateGeometry(){var e,t;this._disposeGeometry(),this._threeGeometry&&(this._threeGeometry.position.copy(this._position),((t=(e=this._threeGeometry)==null?void 0:e.userData)==null?void 0:t._type)==="Model"?this._threeGeometry.renderOrder=0:this._threeGeometry.renderOrder=99,this.add(this._threeGeometry),this.updateMatrixWorld(!0),this._tryProcessQueue())}_remove(){return this.getLayer()?(this._unbind(),this):this}_unbind(){const e=this.getLayer();e&&(e.onRemoveFeature&&e.onRemoveFeature(this),delete this._layer)}_disposeGeometry(){this._threeGeometry&&(this.clear(),"traverse"in this&&this._threeGeometry.traverse(e=>{var t,i,r,s;e instanceof Xt?((t=e.geometry)==null||t.dispose(),Array.isArray(e.material)?e.material.forEach(o=>o.dispose()):(i=e.material)==null||i.dispose()):"isLine"in e&&e.isLine&&((r=e.geometry)==null||r.dispose(),(s=e.material)==null||s.dispose())}))}get collidable(){return this._collisionConfig.enabled}get collisionType(){return VA.POINT}getCollisionPriority(){var e;return this.userData.collisionPriority??((e=this._style)==null?void 0:e.config.collisionPriority)??this._collisionConfig.priority}getScreenBoundingBox(e,t){var i;if(!this.collidable)return null;try{const r=new U;this._threeGeometry.getWorldPosition(r);const s=r.clone().project(e);if(!(s.x>=-1.1&&s.x<=1.1&&s.y>=-1.1&&s.y<=1.1&&s.z>=-1&&s.z<=1))return null;const{width:o,height:a}=t.domElement,l=(s.x*.5+.5)*o,c=(-s.y*.5+.5)*a,h=this._calculateCollisionBoundingBox(e,t);return h?{id:this._id,x:l+h.offsetX,y:c+h.offsetY,width:20+this._collisionConfig.padding*2,height:20+this._collisionConfig.padding*2,priority:this.getCollisionPriority(),featureId:this._id,layerId:((i=this._layer)==null?void 0:i.getId())||"unknown",type:this.collisionType,data:this.getCollisionData()}:null}catch(r){return console.warn(`Feature ${this._id} :`,r),null}}setCollisionVisibility(e,t=Hs.MANUAL_HIDDEN){this._collisionState.visible!==e&&(this._animationRef!==null&&(cancelAnimationFrame(this._animationRef),this._animationRef=null),this.visible=e,this._applyFinalAlpha(e?1:0),this._collisionState={visible:e,reason:t,collidedWith:e?[]:this._collisionState.collidedWith,timestamp:Date.now()})}getCollisionVisibility(){return this._collisionState.visible}setCollisionConfig(e){return Object.assign(this._collisionConfig,e),this}enableCollision(){return this._collisionConfig.enabled=!0,this}disableCollision(){return this._collisionConfig.enabled=!1,this.setCollisionVisibility(!0,Hs.MANUAL_HIDDEN),this}_applyVisibilityAlpha(e){this.traverse(t=>{t instanceof Xt&&(Array.isArray(t.material)?t.material.forEach(i=>{i.opacity!==void 0&&(i.opacity=e)}):t.material.opacity!==void 0&&(t.material.opacity=e))})}_applyFinalAlpha(e){this._applyVisibilityAlpha(e),this.traverse(t=>{t instanceof Xt&&(t.material.needsUpdate=!0)})}getCollisionData(){var e;return{featureType:this.constructor.name,userData:this.userData,styleConfig:(e=this._style)==null?void 0:e.config}}_calculateCollisionBoundingBox(e,t){if(!this.visible||!this._threeGeometry||!e||!t)return null;try{const i=new ji().setFromObject(this._threeGeometry);if(i.isEmpty())return this._getFallbackBoundingBox();const r=[new U(i.min.x,i.min.y,i.min.z),new U(i.max.x,i.min.y,i.min.z),new U(i.min.x,i.max.y,i.min.z),new U(i.max.x,i.max.y,i.min.z),new U(i.min.x,i.min.y,i.max.z),new U(i.max.x,i.min.y,i.max.z),new U(i.min.x,i.max.y,i.max.z),new U(i.max.x,i.max.y,i.max.z)],{width:s,height:o}=t.domElement,a=[];r.forEach(C=>{const A=C.clone().project(e),E=(A.x*.5+.5)*s,O=(-A.y*.5+.5)*o;a.push(new Ie(E,O))});let l=1/0,c=-1/0,h=1/0,d=-1/0;a.forEach(C=>{l=Math.min(l,C.x),c=Math.max(c,C.x),h=Math.min(h,C.y),d=Math.max(d,C.y)});const p=c-l,m=d-h,y=4,b=Math.max(p,y),v=Math.max(m,y),g=new U;i.getCenter(g);const x=g.clone().project(e),w=(x.x*.5+.5)*s,S=(-x.y*.5+.5)*o;return{width:b,height:v,offsetX:l-w,offsetY:h-S}}catch(i){return console.warn(":",i),this._getFallbackBoundingBox()}}_getFallbackBoundingBox(){return{width:20,height:20,offsetX:-10,offsetY:-10}}_tileCoordToLocalWorld(e,t,i,r){const{tileZ:s,tileX:o,tileY:a,extent:l,tileSize:c}=i,h=(e/l-.5)*c,d=(.5-t/l)*c;return r.tileIDToWorldCenter(s,o,a).clone().add(new U(h,d,0)).sub(r.prjcenter)}}var SY=Object.defineProperty,MY=(n,e,t)=>e in n?SY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,GM=(n,e,t)=>MY(n,typeof e!="symbol"?e+"":e,t);class Ta extends bm{constructor(e,t){super(e,t),GM(this,"_feaList"),GM(this,"_collision",!1),this._feaList=[],t!=null&&t.collision&&(this._collision=!0)}addFeature(e){const t=Array.isArray(e)?e:[e];for(const i of t)if(!(!i||!(i instanceof Wo))&&!i.getLayer()){if(!this.validateFeature(i)){console.error(`Feature ${i.id} does not match the layer's type requirements`);continue}i._bindLayer(this),this._feaList.push(i),i.getMap()&&i._toThreeJSGeometry(),this._clouds&&(this.map.viewer.scene.add(this._clouds),console.log("cloud",this.map.viewer.scene)),this.add(i)}return this}getFeatures(e,t){if(!e)return this._feaList.slice(0);const i=[];let r,s;for(let o=0,a=this._feaList.length;o<a;o++)r=this._feaList[o],t?s=e.call(t,r):s=e(r),s&&i.push(r);return i}getCount(){return this._feaList.length}isEmpty(){return!this._feaList.length}removeFeature(e){if(!Array.isArray(e))return this.removeFeature([e]);for(let t=e.length-1;t>=0;t--)e[t]instanceof Wo||(e[t]=this.removeFeature(e[t])),!(!e[t]||this!==e[t].getLayer())&&e[t]._remove();return this}clear(){const e=this._feaList.slice();for(const t of e)t._remove();return this}onRemoveFeature(e){if(!e)return;const t=e.getLayer();if(!t||t!==this)return;const i=this._findInList(e);i>=0&&this._feaList.splice(i,1),e.parent&&e.parent===this?this.remove(e):console.warn("Feature parent mismatch:",e.parent),this._disposeFeatureResources(e)}_findInList(e){const t=this._feaList.length;if(t===0)return-1;let i=0,r=t-1,s;for(;i<=r;){if(s=Math.floor((i+r)/2),this._feaList[s]===e)return s;i=s+1}return-1}_disposeFeatureResources(e){try{e.geometry&&e.geometry.dispose&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(t=>{var i;return(i=t.dispose)==null?void 0:i.call(t)}):e.material.dispose&&e.material.dispose()),e instanceof jt&&e.traverse(t=>{t!==e&&this._disposeFeatureResources(t)})}catch(t){console.error("Error disposing feature resources:",t)}}_mergedGeometry(){this.traverse(e=>{e.isMesh&&e.geometry&&e.material&&console.log("",e)})}setCollisionEngine(e){return this._collisionEngine=e,this}}var TY=Object.defineProperty,EY=(n,e,t)=>e in n?TY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,BM=(n,e,t)=>EY(n,typeof e!="symbol"?e+"":e,t);class LY extends sr{constructor(){super(...arguments),BM(this,"_layers",new Set),BM(this,"_layerids",new Set)}add(...e){return e.forEach(t=>{if(!(t instanceof bm))throw new Error("LayerContainerLayer!");const i=t.getId();if(this._layerids.has(i))throw new Error(`ID'${i}'!`);this._layers.add(t),this._layerids.add(i),super.add(t)}),this}remove(...e){return e.forEach(t=>{this._layers.delete(t),this._layerids.delete(t.getId()),super.remove(t)}),this}getLayers(){return Array.from(this._layers)}getLayerById(e){for(const t of this._layers)if(t.getId()===e)return t}clearLayers(){return this._layers.clear(),this._layerids.clear(),super.clear(),this}}var AY=Object.defineProperty,CY=(n,e,t)=>e in n?AY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,RY=(n,e,t)=>CY(n,e+"",t);class PY{constructor(){RY(this,"canvasDict",{})}getCanvas(e=40,t=30,i=1,r){const s=Math.ceil(e*i),o=Math.ceil(t*i),a=r?`${s}_${o}_${r}`:`${s}_${o}`;if(!this.canvasDict[a]){const h=document.createElement("canvas");h.width=s,h.height=o,this.canvasDict[a]=h}const l=this.canvasDict[a],c=l.getContext("2d");return c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,l.width,l.height),c.scale(i,i),l}}function IY(n){const e=+this._x.call(null,n),t=+this._y.call(null,n);return GA(this.cover(e,t),e,t,n)}function GA(n,e,t,i){if(isNaN(e)||isNaN(t))return n;var r,s=n._root,o={data:i},a=n._x0,l=n._y0,c=n._x1,h=n._y1,d,p,m,y,b,v,g,x;if(!s)return n._root=o,n;for(;s.length;)if((b=e>=(d=(a+c)/2))?a=d:c=d,(v=t>=(p=(l+h)/2))?l=p:h=p,r=s,!(s=s[g=v<<1|b]))return r[g]=o,n;if(m=+n._x.call(null,s.data),y=+n._y.call(null,s.data),e===m&&t===y)return o.next=s,r?r[g]=o:n._root=o,n;do r=r?r[g]=new Array(4):n._root=new Array(4),(b=e>=(d=(a+c)/2))?a=d:c=d,(v=t>=(p=(l+h)/2))?l=p:h=p;while((g=v<<1|b)===(x=(y>=p)<<1|m>=d));return r[x]=s,r[g]=o,n}function DY(n){var e,t,i=n.length,r,s,o=new Array(i),a=new Array(i),l=1/0,c=1/0,h=-1/0,d=-1/0;for(t=0;t<i;++t)isNaN(r=+this._x.call(null,e=n[t]))||isNaN(s=+this._y.call(null,e))||(o[t]=r,a[t]=s,r<l&&(l=r),r>h&&(h=r),s<c&&(c=s),s>d&&(d=s));if(l>h||c>d)return this;for(this.cover(l,c).cover(h,d),t=0;t<i;++t)GA(this,o[t],a[t],n[t]);return this}function NY(n,e){if(isNaN(n=+n)||isNaN(e=+e))return this;var t=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(t))r=(t=Math.floor(n))+1,s=(i=Math.floor(e))+1;else{for(var o=r-t||1,a=this._root,l,c;t>n||n>=r||i>e||e>=s;)switch(c=(e<i)<<1|n<t,l=new Array(4),l[c]=a,a=l,o*=2,c){case 0:r=t+o,s=i+o;break;case 1:t=r-o,s=i+o;break;case 2:r=t+o,i=s-o;break;case 3:t=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=i,this._x1=r,this._y1=s,this}function OY(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function kY(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ir(n,e,t,i,r){this.node=n,this.x0=e,this.y0=t,this.x1=i,this.y1=r}function FY(n,e,t){var i,r=this._x0,s=this._y0,o,a,l,c,h=this._x1,d=this._y1,p=[],m=this._root,y,b;for(m&&p.push(new ir(m,r,s,h,d)),t==null?t=1/0:(r=n-t,s=e-t,h=n+t,d=e+t,t*=t);y=p.pop();)if(!(!(m=y.node)||(o=y.x0)>h||(a=y.y0)>d||(l=y.x1)<r||(c=y.y1)<s))if(m.length){var v=(o+l)/2,g=(a+c)/2;p.push(new ir(m[3],v,g,l,c),new ir(m[2],o,g,v,c),new ir(m[1],v,a,l,g),new ir(m[0],o,a,v,g)),(b=(e>=g)<<1|n>=v)&&(y=p[p.length-1],p[p.length-1]=p[p.length-1-b],p[p.length-1-b]=y)}else{var x=n-+this._x.call(null,m.data),w=e-+this._y.call(null,m.data),S=x*x+w*w;if(S<t){var C=Math.sqrt(t=S);r=n-C,s=e-C,h=n+C,d=e+C,i=m.data}}return i}function UY(n){if(isNaN(h=+this._x.call(null,n))||isNaN(d=+this._y.call(null,n)))return this;var e,t=this._root,i,r,s,o=this._x0,a=this._y0,l=this._x1,c=this._y1,h,d,p,m,y,b,v,g;if(!t)return this;if(t.length)for(;;){if((y=h>=(p=(o+l)/2))?o=p:l=p,(b=d>=(m=(a+c)/2))?a=m:c=m,e=t,!(t=t[v=b<<1|y]))return this;if(!t.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(i=e,g=v)}for(;t.data!==n;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[v]=s:delete e[v],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(i?i[g]=t:this._root=t),this):(this._root=s,this)}function zY(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function WY(){return this._root}function VY(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function GY(n){var e=[],t,i=this._root,r,s,o,a,l;for(i&&e.push(new ir(i,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!n(i=t.node,s=t.x0,o=t.y0,a=t.x1,l=t.y1)&&i.length){var c=(s+a)/2,h=(o+l)/2;(r=i[3])&&e.push(new ir(r,c,h,a,l)),(r=i[2])&&e.push(new ir(r,s,h,c,l)),(r=i[1])&&e.push(new ir(r,c,o,a,h)),(r=i[0])&&e.push(new ir(r,s,o,c,h))}return this}function BY(n){var e=[],t=[],i;for(this._root&&e.push(new ir(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.x1,c=i.y1,h=(o+l)/2,d=(a+c)/2;(s=r[0])&&e.push(new ir(s,o,a,h,d)),(s=r[1])&&e.push(new ir(s,h,a,l,d)),(s=r[2])&&e.push(new ir(s,o,d,h,c)),(s=r[3])&&e.push(new ir(s,h,d,l,c))}t.push(i)}for(;i=t.pop();)n(i.node,i.x0,i.y0,i.x1,i.y1);return this}function HY(n){return n[0]}function ZY(n){return arguments.length?(this._x=n,this):this._x}function XY(n){return n[1]}function jY(n){return arguments.length?(this._y=n,this):this._y}function BA(n,e,t){var i=new Hv(e??HY,t??XY,NaN,NaN,NaN,NaN);return n==null?i:i.addAll(n)}function Hv(n,e,t,i,r,s){this._x=n,this._y=e,this._x0=t,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function HM(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var ar=BA.prototype=Hv.prototype;ar.copy=function(){var n=new Hv(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,i;if(!e)return n;if(!e.length)return n._root=HM(e),n;for(t=[{source:e,target:n._root=new Array(4)}];e=t.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?t.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=HM(i));return n};ar.add=IY;ar.addAll=DY;ar.cover=NY;ar.data=OY;ar.extent=kY;ar.find=FY;ar.remove=UY;ar.removeAll=zY;ar.root=WY;ar.size=VY;ar.visit=GY;ar.visitAfter=BY;ar.x=ZY;ar.y=jY;var YY=Object.defineProperty,KY=(n,e,t)=>e in n?YY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ZM=(n,e,t)=>KY(n,typeof e!="symbol"?e+"":e,t);class HA{constructor(e){ZM(this,"_quadtree"),ZM(this,"_viewport"),this._viewport=e,this._rebuildQuadTree()}updateViewport(e){(e.width!==this._viewport.width||e.height!==this._viewport.height)&&(this._viewport=e,this._rebuildQuadTree())}addBoxes(e){e.forEach(t=>{this._isBoxInViewport(t)&&this._quadtree.add(t)})}findCollisions(e){const t=[],i=this._getSearchBounds(e);return this._quadtree.visit((r,s,o,a,l)=>this._checkNodeCollision(i,s,o,a,l)?(r.length||this._getNodeData(r).forEach(c=>{c.id!==e.id&&this._checkBoxCollision(e,c)&&t.push(c)}),!1):void 0),t}clear(){this._rebuildQuadTree()}getAllBoxes(){const e=[];return this._quadtree.visit(t=>{if(!t.length){const i=this._getNodeData(t);e.push(...i)}return!1}),e}_rebuildQuadTree(){this._quadtree=BA().x(e=>e.x).y(e=>e.y).extent([[0,0],[this._viewport.width,this._viewport.height]])}_isBoxInViewport(e){const t=e.width/2,i=e.height/2;return e.x+t>=0&&e.x-t<=this._viewport.width&&e.y+i>=0&&e.y-i<=this._viewport.height}_getSearchBounds(e){return{x:e.x,y:e.y,width:e.width*2,height:e.height*2}}_checkNodeCollision(e,t,i,r,s){const o=(t+r)/2,a=(i+s)/2,l=r-t,c=s-i;return Math.abs(e.x-o)*2<e.width+l&&Math.abs(e.y-a)*2<e.height+c}_checkBoxCollision(e,t){return Math.abs(e.x-t.x)*2<e.width+t.width&&Math.abs(e.y-t.y)*2<e.height+t.height}_getNodeData(e){return e?Array.isArray(e.data)?e.data:e.data?[e.data]:[]:[]}removeBox(e){const t=this.getAllBoxes().filter(i=>i.id!==e);this.clear(),t.length>0&&this.addBoxes(t)}}var JY=Object.defineProperty,QY=(n,e,t)=>e in n?JY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,XM=(n,e,t)=>QY(n,typeof e!="symbol"?e+"":e,t);class $Y{constructor(){XM(this,"_strategies",new Map),XM(this,"_executionOrder",[])}registerStrategy(e,t){return this._strategies.set(e.name,e),t!==void 0?this._executionOrder.splice(t,0,e.name):this._executionOrder.push(e.name),this}async executeStrategies(e,t){const i=new Map;e.forEach(r=>{i.set(r._id,{featureId:r._id,visible:!0,reason:Hs.NO_COLLISION,collidedWith:[],timestamp:t.timestamp})});for(const r of this._executionOrder){const s=this._strategies.get(r);if(s!=null&&s.enabled)try{const o=await s.execute(e,t,i);this._mergeResults(i,o)}catch(o){console.error(` ${r} :`,o)}}return i}_mergeResults(e,t){t.forEach(i=>{const r=e.get(i.featureId);r&&!r.visible||e.set(i.featureId,i)})}}var qY=Object.defineProperty,e8=(n,e,t)=>e in n?qY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ja=(n,e,t)=>e8(n,typeof e!="symbol"?e+"":e,t);class t8{constructor(){Ja(this,"frameStats",new Map),Ja(this,"summaryStats",{totalFrames:0,averageFrameTime:0,averageFPS:0,minFrameTime:1/0,maxFrameTime:0,totalFeaturesProcessed:0}),Ja(this,"sampleWindowSize",60),Ja(this,"currentFrameId",0),Ja(this,"lastReportTime",0),Ja(this,"reportInterval",5e3),Ja(this,"performanceThresholds",{criticalFrameTime:33,warningFrameTime:16,idealFrameTime:8}),this.lastReportTime=Date.now()}startFrame(e){this.currentFrameId=e;const t={frameId:e,startTime:performance.now(),endTime:0,duration:0,featureCount:0,visibleCount:0,hiddenCount:0,collisionChecks:0,memoryUsage:0,strategyTimes:new Map};this.frameStats.set(e,t),this.cleanupOldFrames()}endFrame(e,t){const i=this.frameStats.get(e);if(!i)return;const r=performance.now();i.endTime=r,i.duration=r-i.startTime,t&&Object.assign(i,t),"memory"in performance&&(i.memoryUsage=performance.memory.usedJSHeapSize),this.updateSummaryStats(i),this.maybeOutputReport()}recordStrategyTime(e,t){const i=this.frameStats.get(this.currentFrameId);i&&i.strategyTimes.set(e,t)}recordCollisionChecks(e){const t=this.frameStats.get(this.currentFrameId);t&&(t.collisionChecks+=e)}getStats(){const e=this.getRecentFrames(this.sampleWindowSize),t=this.calculateFPS(e),i=this.calculateAverageFrameTime(e);return{summary:{...this.summaryStats},recent:{fps:t,frameTime:i,frameTimeStdDev:this.calculateFrameTimeStdDev(e),averageFeaturesPerFrame:this.calculateAverageFeatures(e),performanceLevel:this.getPerformanceLevel(i)},currentFrame:this.frameStats.get(this.currentFrameId)||null,strategies:this.getStrategyPerformance(e),warnings:this.getPerformanceWarnings(e)}}getDetailedReport(){const e=this.getRecentFrames(this.sampleWindowSize),t=this.getStats();return{...t,frameHistory:Array.from(e.values()),trends:this.calculateTrends(e),recommendations:this.getPerformanceRecommendations(t)}}reset(){this.frameStats.clear(),this.summaryStats={totalFrames:0,averageFrameTime:0,averageFPS:0,minFrameTime:1/0,maxFrameTime:0,totalFeaturesProcessed:0},this.currentFrameId=0,this.lastReportTime=Date.now()}cleanupOldFrames(){this.frameStats.size>this.sampleWindowSize*2&&Array.from(this.frameStats.keys()).sort((e,t)=>e-t).slice(0,this.frameStats.size-this.sampleWindowSize).forEach(e=>{this.frameStats.delete(e)})}updateSummaryStats(e){this.summaryStats.totalFrames++,this.summaryStats.totalFeaturesProcessed+=e.featureCount||0,this.summaryStats.averageFrameTime=(this.summaryStats.averageFrameTime*(this.summaryStats.totalFrames-1)+e.duration)/this.summaryStats.totalFrames,this.summaryStats.minFrameTime=Math.min(this.summaryStats.minFrameTime,e.duration),this.summaryStats.maxFrameTime=Math.max(this.summaryStats.maxFrameTime,e.duration),this.summaryStats.averageFPS=1e3/this.summaryStats.averageFrameTime}maybeOutputReport(){const e=Date.now();if(e-this.lastReportTime>=this.reportInterval){const t=this.getStats();t.warnings.length>0?console.warn(":",t):console.log(":",t),this.lastReportTime=e}}getRecentFrames(e){return Array.from(this.frameStats.values()).slice(-e).filter(t=>t.duration>0)}calculateFPS(e){if(e.length===0)return 0;const t=this.calculateAverageFrameTime(e);return t>0?1e3/t:0}calculateAverageFrameTime(e){return e.length===0?0:e.reduce((t,i)=>t+i.duration,0)/e.length}calculateFrameTimeStdDev(e){if(e.length===0)return 0;const t=this.calculateAverageFrameTime(e),i=e.map(r=>Math.pow(r.duration-t,2));return Math.sqrt(i.reduce((r,s)=>r+s,0)/e.length)}calculateAverageFeatures(e){return e.length===0?0:e.reduce((t,i)=>t+(i.featureCount||0),0)/e.length}getPerformanceLevel(e){return e>this.performanceThresholds.criticalFrameTime?"critical":e>this.performanceThresholds.warningFrameTime?"warning":e>this.performanceThresholds.idealFrameTime?"good":"excellent"}getStrategyPerformance(e){const t=new Map;return e.forEach(i=>{i.strategyTimes.forEach((r,s)=>{t.has(s)||t.set(s,[]),t.get(s).push(r)})}),Array.from(t.entries()).map(([i,r])=>({name:i,averageTime:r.reduce((s,o)=>s+o,0)/r.length,maxTime:Math.max(...r),minTime:Math.min(...r),callCount:r.length}))}getPerformanceWarnings(e){const t=[],i=e.slice(-30);if(i.length===0)return t;const r=this.calculateAverageFrameTime(i);r>this.performanceThresholds.criticalFrameTime?t.push({type:"critical",message:`: ${Math.round(1e3/r)}fps`,suggestion:""}):r>this.performanceThresholds.warningFrameTime&&t.push({type:"warning",message:`: ${Math.round(1e3/r)}fps`,suggestion:""});const s=i.map(o=>o.memoryUsage).filter(o=>o>0);if(s.length>0){const o=s.reduce((a,l)=>a+l,0)/s.length;o>100*1024*1024&&t.push({type:"warning",message:`: ${(o/1024/1024).toFixed(1)}MB`,suggestion:""})}return t}calculateTrends(e){if(e.length<2)return{frameTime:"stable",fps:"stable",features:"stable"};const t=e.slice(0,Math.floor(e.length/2)),i=e.slice(Math.floor(e.length/2)),r=this.calculateAverageFrameTime(t),s=(this.calculateAverageFrameTime(i)-r)/r*100;return{frameTime:Math.abs(s)<5?"stable":s>0?"worsening":"improving",fps:Math.abs(s)<5?"stable":s>0?"improving":"worsening",features:"stable"}}getPerformanceRecommendations(e){const t=[];return e.recent.performanceLevel==="critical"&&(t.push(""),t.push(""),t.push("")),e.recent.averageFeaturesPerFrame>5e3&&t.push("LOD"),e.strategies.forEach(i=>{i.averageTime>10&&t.push(` "${i.name}" `)}),t}}var n8=Object.defineProperty,i8=(n,e,t)=>e in n?n8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Hf=(n,e,t)=>i8(n,typeof e!="symbol"?e+"":e,t);class r8{constructor(){Hf(this,"name","priority"),Hf(this,"enabled",!0),Hf(this,"weight",1),Hf(this,"description","")}async execute(e,t,i){const r=[],s=new HA(t.viewport),o=[],a=new Map;return e.forEach(l=>{var h;if(!l.collidable)return;const c=l.getScreenBoundingBox(t.camera,t.renderer);c&&(o.push(c),a.set(l._id,l),(h=i==null?void 0:i.get(l._id))==null||h.visible)}),o.sort((l,c)=>l.priority-c.priority),o.forEach(l=>{const c=s.findCollisions(l);c.length===0?(s.addBoxes([l]),r.push({featureId:l.featureId,visible:!0,reason:Hs.NO_COLLISION,collidedWith:[],timestamp:t.timestamp})):c.some(h=>h.priority<l.priority)?r.push({featureId:l.featureId,visible:!1,reason:Hs.PRIORITY_LOST,collidedWith:c.map(h=>h.featureId),timestamp:t.timestamp}):(s.addBoxes([l]),r.push({featureId:l.featureId,visible:!0,reason:Hs.NO_COLLISION,collidedWith:[],timestamp:t.timestamp}),c.forEach(h=>{r.push({featureId:h.featureId,visible:!1,reason:Hs.PRIORITY_LOST,collidedWith:[l.featureId],timestamp:t.timestamp})}))}),r}}var s8=Object.defineProperty,o8=(n,e,t)=>e in n?s8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,oa=(n,e,t)=>o8(n,typeof e!="symbol"?e+"":e,t);class a8{constructor(e,t={}){this.renderer=e,oa(this,"_quadTreeManager"),oa(this,"_strategyOrchestrator"),oa(this,"_performanceMonitor"),oa(this,"_layers",new Set),oa(this,"_config"),oa(this,"_isUpdating",!1),oa(this,"_lastUpdateTime",0),oa(this,"_frameCount",0),this._config={enabled:!0,padding:4,updateInterval:0,animationDuration:300,maxFeaturesPerFrame:2e3,viewportMargin:50,strategies:{priority:!0,grouping:!1,proximity:!1},...t},this._initializeComponents(),this._setupPerformanceMonitoring()}async update(e){if(!this._config.enabled||this._isUpdating)return;const t=Date.now();if(!(this._config.updateInterval>0&&t-this._lastUpdateTime<this._config.updateInterval)){this._isUpdating=!0,this._frameCount++;try{this._resetAllFeaturesVisibility();const i=this._createCollisionContext(e,t),r=this._collectCollidableFeatures();if(r.length===0)return;this._performanceMonitor.startFrame(this._frameCount);const s=await this._strategyOrchestrator.executeStrategies(r,i);await this._applyCollisionResults(s,r),this._performanceMonitor.endFrame(this._frameCount,{featureCount:r.length,visibleCount:Array.from(s.values()).filter(o=>o.visible).length,hiddenCount:Array.from(s.values()).filter(o=>!o.visible).length}),this._lastUpdateTime=t}catch(i){console.error(":",i)}finally{this._isUpdating=!1}}}_resetAllFeaturesVisibility(){this._layers.forEach(e=>{e.getFeatures().filter(t=>t.collidable).forEach(t=>{t.setCollisionVisibility(!0,Hs.NO_COLLISION)})})}registerLayer(e){return this._layers.add(e),this}unregisterLayer(e){return this._layers.delete(e),this}setConfig(e){return Object.assign(this._config,e),this}getPerformanceStats(){return this._performanceMonitor.getStats()}_initializeComponents(){const e={width:this.renderer.domElement.width,height:this.renderer.domElement.height};this._quadTreeManager=new HA(e),this._strategyOrchestrator=new $Y,this._performanceMonitor=new t8,this._strategyOrchestrator.registerStrategy(new r8,0),this._setupViewportResizeHandler()}_createCollisionContext(e,t){return{camera:e,renderer:this.renderer,viewport:{width:this.renderer.domElement.width,height:this.renderer.domElement.height},zoomLevel:e.position.z,timestamp:t,frameNumber:this._frameCount}}_collectCollidableFeatures(){const e=[];return this._layers.forEach(t=>{const i=t.getFeatures().filter(r=>r.collidable&&r instanceof Wo);if(e.length+i.length>this._config.maxFeaturesPerFrame){console.warn(`: ${this._config.maxFeaturesPerFrame}`);return}e.push(...i)}),e}async _applyCollisionResults(e,t){const i=t.map(r=>{const s=e.get(r._id);return s&&r.setCollisionVisibility(s.visible,s.reason),Promise.resolve()});await Promise.all(i)}_setupViewportResizeHandler(){new ResizeObserver(e=>{e.forEach(t=>{const{width:i,height:r}=t.contentRect;this._quadTreeManager.updateViewport({width:i,height:r})})}).observe(this.renderer.domElement)}_setupPerformanceMonitoring(){setInterval(()=>{const e=this.getPerformanceStats();e.frameRate<30&&console.warn(":",e)},5e3)}}var ku=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wp={exports:{}};Wp.exports;(function(n,e){(function(){var t,i="4.17.21",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",c=500,h="__lodash_placeholder__",d=1,p=2,m=4,y=1,b=2,v=1,g=2,x=4,w=8,S=16,C=32,A=64,E=128,O=256,R=512,T=30,k="...",Y=800,$=16,re=1,ae=2,V=3,te=1/0,J=9007199254740991,pe=17976931348623157e292,Te=NaN,Le=4294967295,Ue=Le-1,tt=Le>>>1,_e=[["ary",E],["bind",v],["bindKey",g],["curry",w],["curryRight",S],["flip",R],["partial",C],["partialRight",A],["rearg",O]],Ae="[object Arguments]",We="[object Array]",se="[object AsyncFunction]",Se="[object Boolean]",Me="[object Date]",De="[object DOMException]",Be="[object Error]",H="[object Function]",X="[object GeneratorFunction]",D="[object Map]",ge="[object Number]",me="[object Null]",fe="[object Object]",N="[object Promise]",B="[object Proxy]",j="[object RegExp]",L="[object Set]",P="[object String]",Z="[object Symbol]",G="[object Undefined]",Q="[object WeakMap]",K="[object WeakSet]",de="[object ArrayBuffer]",ye="[object DataView]",Pe="[object Float32Array]",Qe="[object Float64Array]",Ne="[object Int8Array]",je="[object Int16Array]",lt="[object Int32Array]",ut="[object Uint8Array]",Xe="[object Uint8ClampedArray]",ne="[object Uint16Array]",Ee="[object Uint32Array]",Ke=/\b__p \+= '';/g,ie=/\b(__p \+=) '' \+/g,He=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xe=/&(?:amp|lt|gt|quot|#39);/g,ke=/[&<>"']/g,qe=RegExp(xe.source),Ye=RegExp(ke.source),ft=/<%-([\s\S]+?)%>/g,tn=/<%([\s\S]+?)%>/g,wn=/<%=([\s\S]+?)%>/g,Nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mi=/^\w*$/,os=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Tl=/[\\^$.*+?()[\]{}|]/g,$h=RegExp(Tl.source),as=/^\s+/,eu=/\s/,qh=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ed=/\{\n\/\* \[wrapped with (.+)\] \*/,El=/,? & /,td=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ll=/[()=,{}\[\]\/\s]/,nd=/\\(\\)?/g,id=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rd=/\w*$/,Sm=/^[-+]0x[0-9a-f]+$/i,Mm=/^0b[01]+$/i,Tm=/^\[object .+?Constructor\]$/,Em=/^0o[0-7]+$/i,z=/^(?:0|[1-9]\d*)$/,ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ve=/($^)/,be=/['\n\r\u2028\u2029\\]/g,ue="\\ud800-\\udfff",Ve="\\u0300-\\u036f",et="\\ufe20-\\ufe2f",rt="\\u20d0-\\u20ff",at=Ve+et+rt,vt="\\u2700-\\u27bf",wt="a-z\\xdf-\\xf6\\xf8-\\xff",ht="\\xac\\xb1\\xd7\\xf7",Vt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Yt="\\u2000-\\u206f",Nn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Sn="A-Z\\xc0-\\xd6\\xd8-\\xde",Gt="\\ufe0e\\ufe0f",dt=ht+Vt+Yt+Nn,Gn="[']",Kt="["+ue+"]",lr="["+dt+"]",ls="["+at+"]",Di="\\d+",Ca="["+vt+"]",pn="["+wt+"]",Yi="[^"+ue+dt+Di+vt+wt+Sn+"]",Ni="\\ud83c[\\udffb-\\udfff]",_i="(?:"+ls+"|"+Ni+")",vi="[^"+ue+"]",Ra="(?:\\ud83c[\\udde6-\\uddff]){2}",cs="[\\ud800-\\udbff][\\udc00-\\udfff]",Al="["+Sn+"]",$v="\\u200d",qv="(?:"+pn+"|"+Yi+")",SC="(?:"+Al+"|"+Yi+")",eb="(?:"+Gn+"(?:d|ll|m|re|s|t|ve))?",tb="(?:"+Gn+"(?:D|LL|M|RE|S|T|VE))?",nb=_i+"?",ib="["+Gt+"]?",MC="(?:"+$v+"(?:"+[vi,Ra,cs].join("|")+")"+ib+nb+")*",TC="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",EC="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rb=ib+nb+MC,LC="(?:"+[Ca,Ra,cs].join("|")+")"+rb,AC="(?:"+[vi+ls+"?",ls,Ra,cs,Kt].join("|")+")",CC=RegExp(Gn,"g"),RC=RegExp(ls,"g"),Lm=RegExp(Ni+"(?="+Ni+")|"+AC+rb,"g"),PC=RegExp([Al+"?"+pn+"+"+eb+"(?="+[lr,Al,"$"].join("|")+")",SC+"+"+tb+"(?="+[lr,Al+qv,"$"].join("|")+")",Al+"?"+qv+"+"+eb,Al+"+"+tb,EC,TC,Di,LC].join("|"),"g"),IC=RegExp("["+$v+ue+at+Gt+"]"),DC=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,NC=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],OC=-1,Mn={};Mn[Pe]=Mn[Qe]=Mn[Ne]=Mn[je]=Mn[lt]=Mn[ut]=Mn[Xe]=Mn[ne]=Mn[Ee]=!0,Mn[Ae]=Mn[We]=Mn[de]=Mn[Se]=Mn[ye]=Mn[Me]=Mn[Be]=Mn[H]=Mn[D]=Mn[ge]=Mn[fe]=Mn[j]=Mn[L]=Mn[P]=Mn[Q]=!1;var vn={};vn[Ae]=vn[We]=vn[de]=vn[ye]=vn[Se]=vn[Me]=vn[Pe]=vn[Qe]=vn[Ne]=vn[je]=vn[lt]=vn[D]=vn[ge]=vn[fe]=vn[j]=vn[L]=vn[P]=vn[Z]=vn[ut]=vn[Xe]=vn[ne]=vn[Ee]=!0,vn[Be]=vn[H]=vn[Q]=!1;var kC={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},FC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},UC={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},zC={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},WC=parseFloat,VC=parseInt,sb=typeof ku=="object"&&ku&&ku.Object===Object&&ku,GC=typeof self=="object"&&self&&self.Object===Object&&self,bi=sb||GC||Function("return this")(),Am=e&&!e.nodeType&&e,Pa=Am&&!0&&n&&!n.nodeType&&n,ob=Pa&&Pa.exports===Am,Cm=ob&&sb.process,kr=function(){try{var le=Pa&&Pa.require&&Pa.require("util").types;return le||Cm&&Cm.binding&&Cm.binding("util")}catch{}}(),ab=kr&&kr.isArrayBuffer,lb=kr&&kr.isDate,cb=kr&&kr.isMap,ub=kr&&kr.isRegExp,hb=kr&&kr.isSet,db=kr&&kr.isTypedArray;function br(le,Ce,we){switch(we.length){case 0:return le.call(Ce);case 1:return le.call(Ce,we[0]);case 2:return le.call(Ce,we[0],we[1]);case 3:return le.call(Ce,we[0],we[1],we[2])}return le.apply(Ce,we)}function BC(le,Ce,we,st){for(var St=-1,qt=le==null?0:le.length;++St<qt;){var ri=le[St];Ce(st,ri,we(ri),le)}return st}function Fr(le,Ce){for(var we=-1,st=le==null?0:le.length;++we<st&&Ce(le[we],we,le)!==!1;);return le}function HC(le,Ce){for(var we=le==null?0:le.length;we--&&Ce(le[we],we,le)!==!1;);return le}function fb(le,Ce){for(var we=-1,st=le==null?0:le.length;++we<st;)if(!Ce(le[we],we,le))return!1;return!0}function Go(le,Ce){for(var we=-1,st=le==null?0:le.length,St=0,qt=[];++we<st;){var ri=le[we];Ce(ri,we,le)&&(qt[St++]=ri)}return qt}function sd(le,Ce){var we=le==null?0:le.length;return!!we&&Cl(le,Ce,0)>-1}function Rm(le,Ce,we){for(var st=-1,St=le==null?0:le.length;++st<St;)if(we(Ce,le[st]))return!0;return!1}function An(le,Ce){for(var we=-1,st=le==null?0:le.length,St=Array(st);++we<st;)St[we]=Ce(le[we],we,le);return St}function Bo(le,Ce){for(var we=-1,st=Ce.length,St=le.length;++we<st;)le[St+we]=Ce[we];return le}function Pm(le,Ce,we,st){var St=-1,qt=le==null?0:le.length;for(st&&qt&&(we=le[++St]);++St<qt;)we=Ce(we,le[St],St,le);return we}function ZC(le,Ce,we,st){var St=le==null?0:le.length;for(st&&St&&(we=le[--St]);St--;)we=Ce(we,le[St],St,le);return we}function Im(le,Ce){for(var we=-1,st=le==null?0:le.length;++we<st;)if(Ce(le[we],we,le))return!0;return!1}var XC=Dm("length");function jC(le){return le.split("")}function YC(le){return le.match(td)||[]}function pb(le,Ce,we){var st;return we(le,function(St,qt,ri){if(Ce(St,qt,ri))return st=qt,!1}),st}function od(le,Ce,we,st){for(var St=le.length,qt=we+(st?1:-1);st?qt--:++qt<St;)if(Ce(le[qt],qt,le))return qt;return-1}function Cl(le,Ce,we){return Ce===Ce?o2(le,Ce,we):od(le,mb,we)}function KC(le,Ce,we,st){for(var St=we-1,qt=le.length;++St<qt;)if(st(le[St],Ce))return St;return-1}function mb(le){return le!==le}function gb(le,Ce){var we=le==null?0:le.length;return we?Om(le,Ce)/we:Te}function Dm(le){return function(Ce){return Ce==null?t:Ce[le]}}function Nm(le){return function(Ce){return le==null?t:le[Ce]}}function yb(le,Ce,we,st,St){return St(le,function(qt,ri,mn){we=st?(st=!1,qt):Ce(we,qt,ri,mn)}),we}function JC(le,Ce){var we=le.length;for(le.sort(Ce);we--;)le[we]=le[we].value;return le}function Om(le,Ce){for(var we,st=-1,St=le.length;++st<St;){var qt=Ce(le[st]);qt!==t&&(we=we===t?qt:we+qt)}return we}function km(le,Ce){for(var we=-1,st=Array(le);++we<le;)st[we]=Ce(we);return st}function QC(le,Ce){return An(Ce,function(we){return[we,le[we]]})}function _b(le){return le&&le.slice(0,wb(le)+1).replace(as,"")}function xr(le){return function(Ce){return le(Ce)}}function Fm(le,Ce){return An(Ce,function(we){return le[we]})}function tu(le,Ce){return le.has(Ce)}function vb(le,Ce){for(var we=-1,st=le.length;++we<st&&Cl(Ce,le[we],0)>-1;);return we}function bb(le,Ce){for(var we=le.length;we--&&Cl(Ce,le[we],0)>-1;);return we}function $C(le,Ce){for(var we=le.length,st=0;we--;)le[we]===Ce&&++st;return st}var qC=Nm(kC),e2=Nm(FC);function t2(le){return"\\"+zC[le]}function n2(le,Ce){return le==null?t:le[Ce]}function Rl(le){return IC.test(le)}function i2(le){return DC.test(le)}function r2(le){for(var Ce,we=[];!(Ce=le.next()).done;)we.push(Ce.value);return we}function Um(le){var Ce=-1,we=Array(le.size);return le.forEach(function(st,St){we[++Ce]=[St,st]}),we}function xb(le,Ce){return function(we){return le(Ce(we))}}function Ho(le,Ce){for(var we=-1,st=le.length,St=0,qt=[];++we<st;){var ri=le[we];(ri===Ce||ri===h)&&(le[we]=h,qt[St++]=we)}return qt}function ad(le){var Ce=-1,we=Array(le.size);return le.forEach(function(st){we[++Ce]=st}),we}function s2(le){var Ce=-1,we=Array(le.size);return le.forEach(function(st){we[++Ce]=[st,st]}),we}function o2(le,Ce,we){for(var st=we-1,St=le.length;++st<St;)if(le[st]===Ce)return st;return-1}function a2(le,Ce,we){for(var st=we+1;st--;)if(le[st]===Ce)return st;return st}function Pl(le){return Rl(le)?c2(le):XC(le)}function us(le){return Rl(le)?u2(le):jC(le)}function wb(le){for(var Ce=le.length;Ce--&&eu.test(le.charAt(Ce)););return Ce}var l2=Nm(UC);function c2(le){for(var Ce=Lm.lastIndex=0;Lm.test(le);)++Ce;return Ce}function u2(le){return le.match(Lm)||[]}function h2(le){return le.match(PC)||[]}var d2=function le(Ce){Ce=Ce==null?bi:Il.defaults(bi.Object(),Ce,Il.pick(bi,NC));var we=Ce.Array,st=Ce.Date,St=Ce.Error,qt=Ce.Function,ri=Ce.Math,mn=Ce.Object,zm=Ce.RegExp,f2=Ce.String,Ur=Ce.TypeError,ld=we.prototype,p2=qt.prototype,Dl=mn.prototype,cd=Ce["__core-js_shared__"],ud=p2.toString,ln=Dl.hasOwnProperty,m2=0,Sb=function(){var u=/[^.]+$/.exec(cd&&cd.keys&&cd.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),hd=Dl.toString,g2=ud.call(mn),y2=bi._,_2=zm("^"+ud.call(ln).replace(Tl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dd=ob?Ce.Buffer:t,Zo=Ce.Symbol,fd=Ce.Uint8Array,Mb=dd?dd.allocUnsafe:t,pd=xb(mn.getPrototypeOf,mn),Tb=mn.create,Eb=Dl.propertyIsEnumerable,md=ld.splice,Lb=Zo?Zo.isConcatSpreadable:t,nu=Zo?Zo.iterator:t,Ia=Zo?Zo.toStringTag:t,gd=function(){try{var u=Fa(mn,"defineProperty");return u({},"",{}),u}catch{}}(),v2=Ce.clearTimeout!==bi.clearTimeout&&Ce.clearTimeout,b2=st&&st.now!==bi.Date.now&&st.now,x2=Ce.setTimeout!==bi.setTimeout&&Ce.setTimeout,yd=ri.ceil,_d=ri.floor,Wm=mn.getOwnPropertySymbols,w2=dd?dd.isBuffer:t,Ab=Ce.isFinite,S2=ld.join,M2=xb(mn.keys,mn),si=ri.max,Oi=ri.min,T2=st.now,E2=Ce.parseInt,Cb=ri.random,L2=ld.reverse,Vm=Fa(Ce,"DataView"),iu=Fa(Ce,"Map"),Gm=Fa(Ce,"Promise"),Nl=Fa(Ce,"Set"),ru=Fa(Ce,"WeakMap"),su=Fa(mn,"create"),vd=ru&&new ru,Ol={},A2=Ua(Vm),C2=Ua(iu),R2=Ua(Gm),P2=Ua(Nl),I2=Ua(ru),bd=Zo?Zo.prototype:t,ou=bd?bd.valueOf:t,Rb=bd?bd.toString:t;function F(u){if(On(u)&&!Mt(u)&&!(u instanceof Wt)){if(u instanceof zr)return u;if(ln.call(u,"__wrapped__"))return Px(u)}return new zr(u)}var kl=function(){function u(){}return function(f){if(!Rn(f))return{};if(Tb)return Tb(f);u.prototype=f;var _=new u;return u.prototype=t,_}}();function xd(){}function zr(u,f){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}F.templateSettings={escape:ft,evaluate:tn,interpolate:wn,variable:"",imports:{_:F}},F.prototype=xd.prototype,F.prototype.constructor=F,zr.prototype=kl(xd.prototype),zr.prototype.constructor=zr;function Wt(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Le,this.__views__=[]}function D2(){var u=new Wt(this.__wrapped__);return u.__actions__=cr(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=cr(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=cr(this.__views__),u}function N2(){if(this.__filtered__){var u=new Wt(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function O2(){var u=this.__wrapped__.value(),f=this.__dir__,_=Mt(u),M=f<0,I=_?u.length:0,W=jR(0,I,this.__views__),q=W.start,oe=W.end,he=oe-q,Oe=M?oe:q-1,Fe=this.__iteratees__,ze=Fe.length,$e=0,ct=Oi(he,this.__takeCount__);if(!_||!M&&I==he&&ct==he)return ex(u,this.__actions__);var yt=[];e:for(;he--&&$e<ct;){Oe+=f;for(var Pt=-1,_t=u[Oe];++Pt<ze;){var Ot=Fe[Pt],Bt=Ot.iteratee,Mr=Ot.type,Qi=Bt(_t);if(Mr==ae)_t=Qi;else if(!Qi){if(Mr==re)continue e;break e}}yt[$e++]=_t}return yt}Wt.prototype=kl(xd.prototype),Wt.prototype.constructor=Wt;function Da(u){var f=-1,_=u==null?0:u.length;for(this.clear();++f<_;){var M=u[f];this.set(M[0],M[1])}}function k2(){this.__data__=su?su(null):{},this.size=0}function F2(u){var f=this.has(u)&&delete this.__data__[u];return this.size-=f?1:0,f}function U2(u){var f=this.__data__;if(su){var _=f[u];return _===l?t:_}return ln.call(f,u)?f[u]:t}function z2(u){var f=this.__data__;return su?f[u]!==t:ln.call(f,u)}function W2(u,f){var _=this.__data__;return this.size+=this.has(u)?0:1,_[u]=su&&f===t?l:f,this}Da.prototype.clear=k2,Da.prototype.delete=F2,Da.prototype.get=U2,Da.prototype.has=z2,Da.prototype.set=W2;function io(u){var f=-1,_=u==null?0:u.length;for(this.clear();++f<_;){var M=u[f];this.set(M[0],M[1])}}function V2(){this.__data__=[],this.size=0}function G2(u){var f=this.__data__,_=wd(f,u);if(_<0)return!1;var M=f.length-1;return _==M?f.pop():md.call(f,_,1),--this.size,!0}function B2(u){var f=this.__data__,_=wd(f,u);return _<0?t:f[_][1]}function H2(u){return wd(this.__data__,u)>-1}function Z2(u,f){var _=this.__data__,M=wd(_,u);return M<0?(++this.size,_.push([u,f])):_[M][1]=f,this}io.prototype.clear=V2,io.prototype.delete=G2,io.prototype.get=B2,io.prototype.has=H2,io.prototype.set=Z2;function ro(u){var f=-1,_=u==null?0:u.length;for(this.clear();++f<_;){var M=u[f];this.set(M[0],M[1])}}function X2(){this.size=0,this.__data__={hash:new Da,map:new(iu||io),string:new Da}}function j2(u){var f=Nd(this,u).delete(u);return this.size-=f?1:0,f}function Y2(u){return Nd(this,u).get(u)}function K2(u){return Nd(this,u).has(u)}function J2(u,f){var _=Nd(this,u),M=_.size;return _.set(u,f),this.size+=_.size==M?0:1,this}ro.prototype.clear=X2,ro.prototype.delete=j2,ro.prototype.get=Y2,ro.prototype.has=K2,ro.prototype.set=J2;function Na(u){var f=-1,_=u==null?0:u.length;for(this.__data__=new ro;++f<_;)this.add(u[f])}function Q2(u){return this.__data__.set(u,l),this}function $2(u){return this.__data__.has(u)}Na.prototype.add=Na.prototype.push=Q2,Na.prototype.has=$2;function hs(u){var f=this.__data__=new io(u);this.size=f.size}function q2(){this.__data__=new io,this.size=0}function eR(u){var f=this.__data__,_=f.delete(u);return this.size=f.size,_}function tR(u){return this.__data__.get(u)}function nR(u){return this.__data__.has(u)}function iR(u,f){var _=this.__data__;if(_ instanceof io){var M=_.__data__;if(!iu||M.length<r-1)return M.push([u,f]),this.size=++_.size,this;_=this.__data__=new ro(M)}return _.set(u,f),this.size=_.size,this}hs.prototype.clear=q2,hs.prototype.delete=eR,hs.prototype.get=tR,hs.prototype.has=nR,hs.prototype.set=iR;function Pb(u,f){var _=Mt(u),M=!_&&za(u),I=!_&&!M&&Jo(u),W=!_&&!M&&!I&&Wl(u),q=_||M||I||W,oe=q?km(u.length,f2):[],he=oe.length;for(var Oe in u)(f||ln.call(u,Oe))&&!(q&&(Oe=="length"||I&&(Oe=="offset"||Oe=="parent")||W&&(Oe=="buffer"||Oe=="byteLength"||Oe=="byteOffset")||lo(Oe,he)))&&oe.push(Oe);return oe}function Ib(u){var f=u.length;return f?u[qm(0,f-1)]:t}function rR(u,f){return Od(cr(u),Oa(f,0,u.length))}function sR(u){return Od(cr(u))}function Bm(u,f,_){(_!==t&&!ds(u[f],_)||_===t&&!(f in u))&&so(u,f,_)}function au(u,f,_){var M=u[f];(!(ln.call(u,f)&&ds(M,_))||_===t&&!(f in u))&&so(u,f,_)}function wd(u,f){for(var _=u.length;_--;)if(ds(u[_][0],f))return _;return-1}function oR(u,f,_,M){return Xo(u,function(I,W,q){f(M,I,_(I),q)}),M}function Db(u,f){return u&&Rs(f,gi(f),u)}function aR(u,f){return u&&Rs(f,hr(f),u)}function so(u,f,_){f=="__proto__"&&gd?gd(u,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):u[f]=_}function Hm(u,f){for(var _=-1,M=f.length,I=we(M),W=u==null;++_<M;)I[_]=W?t:Mg(u,f[_]);return I}function Oa(u,f,_){return u===u&&(_!==t&&(u=u<=_?u:_),f!==t&&(u=u>=f?u:f)),u}function Wr(u,f,_,M,I,W){var q,oe=f&d,he=f&p,Oe=f&m;if(_&&(q=I?_(u,M,I,W):_(u)),q!==t)return q;if(!Rn(u))return u;var Fe=Mt(u);if(Fe){if(q=KR(u),!oe)return cr(u,q)}else{var ze=ki(u),$e=ze==H||ze==X;if(Jo(u))return ix(u,oe);if(ze==fe||ze==Ae||$e&&!I){if(q=he||$e?{}:wx(u),!oe)return he?UR(u,aR(q,u)):FR(u,Db(q,u))}else{if(!vn[ze])return I?u:{};q=JR(u,ze,oe)}}W||(W=new hs);var ct=W.get(u);if(ct)return ct;W.set(u,q),Qx(u)?u.forEach(function(_t){q.add(Wr(_t,f,_,_t,u,W))}):Kx(u)&&u.forEach(function(_t,Ot){q.set(Ot,Wr(_t,f,_,Ot,u,W))});var yt=Oe?he?ug:cg:he?hr:gi,Pt=Fe?t:yt(u);return Fr(Pt||u,function(_t,Ot){Pt&&(Ot=_t,_t=u[Ot]),au(q,Ot,Wr(_t,f,_,Ot,u,W))}),q}function lR(u){var f=gi(u);return function(_){return Nb(_,u,f)}}function Nb(u,f,_){var M=_.length;if(u==null)return!M;for(u=mn(u);M--;){var I=_[M],W=f[I],q=u[I];if(q===t&&!(I in u)||!W(q))return!1}return!0}function Ob(u,f,_){if(typeof u!="function")throw new Ur(o);return pu(function(){u.apply(t,_)},f)}function lu(u,f,_,M){var I=-1,W=sd,q=!0,oe=u.length,he=[],Oe=f.length;if(!oe)return he;_&&(f=An(f,xr(_))),M?(W=Rm,q=!1):f.length>=r&&(W=tu,q=!1,f=new Na(f));e:for(;++I<oe;){var Fe=u[I],ze=_==null?Fe:_(Fe);if(Fe=M||Fe!==0?Fe:0,q&&ze===ze){for(var $e=Oe;$e--;)if(f[$e]===ze)continue e;he.push(Fe)}else W(f,ze,M)||he.push(Fe)}return he}var Xo=lx(Cs),kb=lx(Xm,!0);function cR(u,f){var _=!0;return Xo(u,function(M,I,W){return _=!!f(M,I,W),_}),_}function Sd(u,f,_){for(var M=-1,I=u.length;++M<I;){var W=u[M],q=f(W);if(q!=null&&(oe===t?q===q&&!Sr(q):_(q,oe)))var oe=q,he=W}return he}function uR(u,f,_,M){var I=u.length;for(_=Rt(_),_<0&&(_=-_>I?0:I+_),M=M===t||M>I?I:Rt(M),M<0&&(M+=I),M=_>M?0:qx(M);_<M;)u[_++]=f;return u}function Fb(u,f){var _=[];return Xo(u,function(M,I,W){f(M,I,W)&&_.push(M)}),_}function xi(u,f,_,M,I){var W=-1,q=u.length;for(_||(_=$R),I||(I=[]);++W<q;){var oe=u[W];f>0&&_(oe)?f>1?xi(oe,f-1,_,M,I):Bo(I,oe):M||(I[I.length]=oe)}return I}var Zm=cx(),Ub=cx(!0);function Cs(u,f){return u&&Zm(u,f,gi)}function Xm(u,f){return u&&Ub(u,f,gi)}function Md(u,f){return Go(f,function(_){return co(u[_])})}function ka(u,f){f=Yo(f,u);for(var _=0,M=f.length;u!=null&&_<M;)u=u[Ps(f[_++])];return _&&_==M?u:t}function zb(u,f,_){var M=f(u);return Mt(u)?M:Bo(M,_(u))}function Ki(u){return u==null?u===t?G:me:Ia&&Ia in mn(u)?XR(u):sP(u)}function jm(u,f){return u>f}function hR(u,f){return u!=null&&ln.call(u,f)}function dR(u,f){return u!=null&&f in mn(u)}function fR(u,f,_){return u>=Oi(f,_)&&u<si(f,_)}function Ym(u,f,_){for(var M=_?Rm:sd,I=u[0].length,W=u.length,q=W,oe=we(W),he=1/0,Oe=[];q--;){var Fe=u[q];q&&f&&(Fe=An(Fe,xr(f))),he=Oi(Fe.length,he),oe[q]=!_&&(f||I>=120&&Fe.length>=120)?new Na(q&&Fe):t}Fe=u[0];var ze=-1,$e=oe[0];e:for(;++ze<I&&Oe.length<he;){var ct=Fe[ze],yt=f?f(ct):ct;if(ct=_||ct!==0?ct:0,!($e?tu($e,yt):M(Oe,yt,_))){for(q=W;--q;){var Pt=oe[q];if(!(Pt?tu(Pt,yt):M(u[q],yt,_)))continue e}$e&&$e.push(yt),Oe.push(ct)}}return Oe}function pR(u,f,_,M){return Cs(u,function(I,W,q){f(M,_(I),W,q)}),M}function cu(u,f,_){f=Yo(f,u),u=Ex(u,f);var M=u==null?u:u[Ps(Gr(f))];return M==null?t:br(M,u,_)}function Wb(u){return On(u)&&Ki(u)==Ae}function mR(u){return On(u)&&Ki(u)==de}function gR(u){return On(u)&&Ki(u)==Me}function uu(u,f,_,M,I){return u===f?!0:u==null||f==null||!On(u)&&!On(f)?u!==u&&f!==f:yR(u,f,_,M,uu,I)}function yR(u,f,_,M,I,W){var q=Mt(u),oe=Mt(f),he=q?We:ki(u),Oe=oe?We:ki(f);he=he==Ae?fe:he,Oe=Oe==Ae?fe:Oe;var Fe=he==fe,ze=Oe==fe,$e=he==Oe;if($e&&Jo(u)){if(!Jo(f))return!1;q=!0,Fe=!1}if($e&&!Fe)return W||(W=new hs),q||Wl(u)?vx(u,f,_,M,I,W):HR(u,f,he,_,M,I,W);if(!(_&y)){var ct=Fe&&ln.call(u,"__wrapped__"),yt=ze&&ln.call(f,"__wrapped__");if(ct||yt){var Pt=ct?u.value():u,_t=yt?f.value():f;return W||(W=new hs),I(Pt,_t,_,M,W)}}return $e?(W||(W=new hs),ZR(u,f,_,M,I,W)):!1}function _R(u){return On(u)&&ki(u)==D}function Km(u,f,_,M){var I=_.length,W=I,q=!M;if(u==null)return!W;for(u=mn(u);I--;){var oe=_[I];if(q&&oe[2]?oe[1]!==u[oe[0]]:!(oe[0]in u))return!1}for(;++I<W;){oe=_[I];var he=oe[0],Oe=u[he],Fe=oe[1];if(q&&oe[2]){if(Oe===t&&!(he in u))return!1}else{var ze=new hs;if(M)var $e=M(Oe,Fe,he,u,f,ze);if(!($e===t?uu(Fe,Oe,y|b,M,ze):$e))return!1}}return!0}function Vb(u){if(!Rn(u)||eP(u))return!1;var f=co(u)?_2:Tm;return f.test(Ua(u))}function vR(u){return On(u)&&Ki(u)==j}function bR(u){return On(u)&&ki(u)==L}function xR(u){return On(u)&&Vd(u.length)&&!!Mn[Ki(u)]}function Gb(u){return typeof u=="function"?u:u==null?dr:typeof u=="object"?Mt(u)?Zb(u[0],u[1]):Hb(u):uw(u)}function Jm(u){if(!fu(u))return M2(u);var f=[];for(var _ in mn(u))ln.call(u,_)&&_!="constructor"&&f.push(_);return f}function wR(u){if(!Rn(u))return rP(u);var f=fu(u),_=[];for(var M in u)M=="constructor"&&(f||!ln.call(u,M))||_.push(M);return _}function Qm(u,f){return u<f}function Bb(u,f){var _=-1,M=ur(u)?we(u.length):[];return Xo(u,function(I,W,q){M[++_]=f(I,W,q)}),M}function Hb(u){var f=dg(u);return f.length==1&&f[0][2]?Mx(f[0][0],f[0][1]):function(_){return _===u||Km(_,u,f)}}function Zb(u,f){return pg(u)&&Sx(f)?Mx(Ps(u),f):function(_){var M=Mg(_,u);return M===t&&M===f?Tg(_,u):uu(f,M,y|b)}}function Td(u,f,_,M,I){u!==f&&Zm(f,function(W,q){if(I||(I=new hs),Rn(W))SR(u,f,q,_,Td,M,I);else{var oe=M?M(gg(u,q),W,q+"",u,f,I):t;oe===t&&(oe=W),Bm(u,q,oe)}},hr)}function SR(u,f,_,M,I,W,q){var oe=gg(u,_),he=gg(f,_),Oe=q.get(he);if(Oe){Bm(u,_,Oe);return}var Fe=W?W(oe,he,_+"",u,f,q):t,ze=Fe===t;if(ze){var $e=Mt(he),ct=!$e&&Jo(he),yt=!$e&&!ct&&Wl(he);Fe=he,$e||ct||yt?Mt(oe)?Fe=oe:Bn(oe)?Fe=cr(oe):ct?(ze=!1,Fe=ix(he,!0)):yt?(ze=!1,Fe=rx(he,!0)):Fe=[]:mu(he)||za(he)?(Fe=oe,za(oe)?Fe=ew(oe):(!Rn(oe)||co(oe))&&(Fe=wx(he))):ze=!1}ze&&(q.set(he,Fe),I(Fe,he,M,W,q),q.delete(he)),Bm(u,_,Fe)}function Xb(u,f){var _=u.length;if(_)return f+=f<0?_:0,lo(f,_)?u[f]:t}function jb(u,f,_){f.length?f=An(f,function(W){return Mt(W)?function(q){return ka(q,W.length===1?W[0]:W)}:W}):f=[dr];var M=-1;f=An(f,xr(mt()));var I=Bb(u,function(W,q,oe){var he=An(f,function(Oe){return Oe(W)});return{criteria:he,index:++M,value:W}});return JC(I,function(W,q){return kR(W,q,_)})}function MR(u,f){return Yb(u,f,function(_,M){return Tg(u,M)})}function Yb(u,f,_){for(var M=-1,I=f.length,W={};++M<I;){var q=f[M],oe=ka(u,q);_(oe,q)&&hu(W,Yo(q,u),oe)}return W}function TR(u){return function(f){return ka(f,u)}}function $m(u,f,_,M){var I=M?KC:Cl,W=-1,q=f.length,oe=u;for(u===f&&(f=cr(f)),_&&(oe=An(u,xr(_)));++W<q;)for(var he=0,Oe=f[W],Fe=_?_(Oe):Oe;(he=I(oe,Fe,he,M))>-1;)oe!==u&&md.call(oe,he,1),md.call(u,he,1);return u}function Kb(u,f){for(var _=u?f.length:0,M=_-1;_--;){var I=f[_];if(_==M||I!==W){var W=I;lo(I)?md.call(u,I,1):ng(u,I)}}return u}function qm(u,f){return u+_d(Cb()*(f-u+1))}function ER(u,f,_,M){for(var I=-1,W=si(yd((f-u)/(_||1)),0),q=we(W);W--;)q[M?W:++I]=u,u+=_;return q}function eg(u,f){var _="";if(!u||f<1||f>J)return _;do f%2&&(_+=u),f=_d(f/2),f&&(u+=u);while(f);return _}function Dt(u,f){return yg(Tx(u,f,dr),u+"")}function LR(u){return Ib(Vl(u))}function AR(u,f){var _=Vl(u);return Od(_,Oa(f,0,_.length))}function hu(u,f,_,M){if(!Rn(u))return u;f=Yo(f,u);for(var I=-1,W=f.length,q=W-1,oe=u;oe!=null&&++I<W;){var he=Ps(f[I]),Oe=_;if(he==="__proto__"||he==="constructor"||he==="prototype")return u;if(I!=q){var Fe=oe[he];Oe=M?M(Fe,he,oe):t,Oe===t&&(Oe=Rn(Fe)?Fe:lo(f[I+1])?[]:{})}au(oe,he,Oe),oe=oe[he]}return u}var Jb=vd?function(u,f){return vd.set(u,f),u}:dr,CR=gd?function(u,f){return gd(u,"toString",{configurable:!0,enumerable:!1,value:Lg(f),writable:!0})}:dr;function RR(u){return Od(Vl(u))}function Vr(u,f,_){var M=-1,I=u.length;f<0&&(f=-f>I?0:I+f),_=_>I?I:_,_<0&&(_+=I),I=f>_?0:_-f>>>0,f>>>=0;for(var W=we(I);++M<I;)W[M]=u[M+f];return W}function PR(u,f){var _;return Xo(u,function(M,I,W){return _=f(M,I,W),!_}),!!_}function Ed(u,f,_){var M=0,I=u==null?M:u.length;if(typeof f=="number"&&f===f&&I<=tt){for(;M<I;){var W=M+I>>>1,q=u[W];q!==null&&!Sr(q)&&(_?q<=f:q<f)?M=W+1:I=W}return I}return tg(u,f,dr,_)}function tg(u,f,_,M){var I=0,W=u==null?0:u.length;if(W===0)return 0;f=_(f);for(var q=f!==f,oe=f===null,he=Sr(f),Oe=f===t;I<W;){var Fe=_d((I+W)/2),ze=_(u[Fe]),$e=ze!==t,ct=ze===null,yt=ze===ze,Pt=Sr(ze);if(q)var _t=M||yt;else Oe?_t=yt&&(M||$e):oe?_t=yt&&$e&&(M||!ct):he?_t=yt&&$e&&!ct&&(M||!Pt):ct||Pt?_t=!1:_t=M?ze<=f:ze<f;_t?I=Fe+1:W=Fe}return Oi(W,Ue)}function Qb(u,f){for(var _=-1,M=u.length,I=0,W=[];++_<M;){var q=u[_],oe=f?f(q):q;if(!_||!ds(oe,he)){var he=oe;W[I++]=q===0?0:q}}return W}function $b(u){return typeof u=="number"?u:Sr(u)?Te:+u}function wr(u){if(typeof u=="string")return u;if(Mt(u))return An(u,wr)+"";if(Sr(u))return Rb?Rb.call(u):"";var f=u+"";return f=="0"&&1/u==-te?"-0":f}function jo(u,f,_){var M=-1,I=sd,W=u.length,q=!0,oe=[],he=oe;if(_)q=!1,I=Rm;else if(W>=r){var Oe=f?null:GR(u);if(Oe)return ad(Oe);q=!1,I=tu,he=new Na}else he=f?[]:oe;e:for(;++M<W;){var Fe=u[M],ze=f?f(Fe):Fe;if(Fe=_||Fe!==0?Fe:0,q&&ze===ze){for(var $e=he.length;$e--;)if(he[$e]===ze)continue e;f&&he.push(ze),oe.push(Fe)}else I(he,ze,_)||(he!==oe&&he.push(ze),oe.push(Fe))}return oe}function ng(u,f){return f=Yo(f,u),u=Ex(u,f),u==null||delete u[Ps(Gr(f))]}function qb(u,f,_,M){return hu(u,f,_(ka(u,f)),M)}function Ld(u,f,_,M){for(var I=u.length,W=M?I:-1;(M?W--:++W<I)&&f(u[W],W,u););return _?Vr(u,M?0:W,M?W+1:I):Vr(u,M?W+1:0,M?I:W)}function ex(u,f){var _=u;return _ instanceof Wt&&(_=_.value()),Pm(f,function(M,I){return I.func.apply(I.thisArg,Bo([M],I.args))},_)}function ig(u,f,_){var M=u.length;if(M<2)return M?jo(u[0]):[];for(var I=-1,W=we(M);++I<M;)for(var q=u[I],oe=-1;++oe<M;)oe!=I&&(W[I]=lu(W[I]||q,u[oe],f,_));return jo(xi(W,1),f,_)}function tx(u,f,_){for(var M=-1,I=u.length,W=f.length,q={};++M<I;){var oe=M<W?f[M]:t;_(q,u[M],oe)}return q}function rg(u){return Bn(u)?u:[]}function sg(u){return typeof u=="function"?u:dr}function Yo(u,f){return Mt(u)?u:pg(u,f)?[u]:Rx(nn(u))}var IR=Dt;function Ko(u,f,_){var M=u.length;return _=_===t?M:_,!f&&_>=M?u:Vr(u,f,_)}var nx=v2||function(u){return bi.clearTimeout(u)};function ix(u,f){if(f)return u.slice();var _=u.length,M=Mb?Mb(_):new u.constructor(_);return u.copy(M),M}function og(u){var f=new u.constructor(u.byteLength);return new fd(f).set(new fd(u)),f}function DR(u,f){var _=f?og(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.byteLength)}function NR(u){var f=new u.constructor(u.source,rd.exec(u));return f.lastIndex=u.lastIndex,f}function OR(u){return ou?mn(ou.call(u)):{}}function rx(u,f){var _=f?og(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.length)}function sx(u,f){if(u!==f){var _=u!==t,M=u===null,I=u===u,W=Sr(u),q=f!==t,oe=f===null,he=f===f,Oe=Sr(f);if(!oe&&!Oe&&!W&&u>f||W&&q&&he&&!oe&&!Oe||M&&q&&he||!_&&he||!I)return 1;if(!M&&!W&&!Oe&&u<f||Oe&&_&&I&&!M&&!W||oe&&_&&I||!q&&I||!he)return-1}return 0}function kR(u,f,_){for(var M=-1,I=u.criteria,W=f.criteria,q=I.length,oe=_.length;++M<q;){var he=sx(I[M],W[M]);if(he){if(M>=oe)return he;var Oe=_[M];return he*(Oe=="desc"?-1:1)}}return u.index-f.index}function ox(u,f,_,M){for(var I=-1,W=u.length,q=_.length,oe=-1,he=f.length,Oe=si(W-q,0),Fe=we(he+Oe),ze=!M;++oe<he;)Fe[oe]=f[oe];for(;++I<q;)(ze||I<W)&&(Fe[_[I]]=u[I]);for(;Oe--;)Fe[oe++]=u[I++];return Fe}function ax(u,f,_,M){for(var I=-1,W=u.length,q=-1,oe=_.length,he=-1,Oe=f.length,Fe=si(W-oe,0),ze=we(Fe+Oe),$e=!M;++I<Fe;)ze[I]=u[I];for(var ct=I;++he<Oe;)ze[ct+he]=f[he];for(;++q<oe;)($e||I<W)&&(ze[ct+_[q]]=u[I++]);return ze}function cr(u,f){var _=-1,M=u.length;for(f||(f=we(M));++_<M;)f[_]=u[_];return f}function Rs(u,f,_,M){var I=!_;_||(_={});for(var W=-1,q=f.length;++W<q;){var oe=f[W],he=M?M(_[oe],u[oe],oe,_,u):t;he===t&&(he=u[oe]),I?so(_,oe,he):au(_,oe,he)}return _}function FR(u,f){return Rs(u,fg(u),f)}function UR(u,f){return Rs(u,bx(u),f)}function Ad(u,f){return function(_,M){var I=Mt(_)?BC:oR,W=f?f():{};return I(_,u,mt(M,2),W)}}function Fl(u){return Dt(function(f,_){var M=-1,I=_.length,W=I>1?_[I-1]:t,q=I>2?_[2]:t;for(W=u.length>3&&typeof W=="function"?(I--,W):t,q&&Ji(_[0],_[1],q)&&(W=I<3?t:W,I=1),f=mn(f);++M<I;){var oe=_[M];oe&&u(f,oe,M,W)}return f})}function lx(u,f){return function(_,M){if(_==null)return _;if(!ur(_))return u(_,M);for(var I=_.length,W=f?I:-1,q=mn(_);(f?W--:++W<I)&&M(q[W],W,q)!==!1;);return _}}function cx(u){return function(f,_,M){for(var I=-1,W=mn(f),q=M(f),oe=q.length;oe--;){var he=q[u?oe:++I];if(_(W[he],he,W)===!1)break}return f}}function zR(u,f,_){var M=f&v,I=du(u);function W(){var q=this&&this!==bi&&this instanceof W?I:u;return q.apply(M?_:this,arguments)}return W}function ux(u){return function(f){f=nn(f);var _=Rl(f)?us(f):t,M=_?_[0]:f.charAt(0),I=_?Ko(_,1).join(""):f.slice(1);return M[u]()+I}}function Ul(u){return function(f){return Pm(lw(aw(f).replace(CC,"")),u,"")}}function du(u){return function(){var f=arguments;switch(f.length){case 0:return new u;case 1:return new u(f[0]);case 2:return new u(f[0],f[1]);case 3:return new u(f[0],f[1],f[2]);case 4:return new u(f[0],f[1],f[2],f[3]);case 5:return new u(f[0],f[1],f[2],f[3],f[4]);case 6:return new u(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new u(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=kl(u.prototype),M=u.apply(_,f);return Rn(M)?M:_}}function WR(u,f,_){var M=du(u);function I(){for(var W=arguments.length,q=we(W),oe=W,he=zl(I);oe--;)q[oe]=arguments[oe];var Oe=W<3&&q[0]!==he&&q[W-1]!==he?[]:Ho(q,he);if(W-=Oe.length,W<_)return mx(u,f,Cd,I.placeholder,t,q,Oe,t,t,_-W);var Fe=this&&this!==bi&&this instanceof I?M:u;return br(Fe,this,q)}return I}function hx(u){return function(f,_,M){var I=mn(f);if(!ur(f)){var W=mt(_,3);f=gi(f),_=function(oe){return W(I[oe],oe,I)}}var q=u(f,_,M);return q>-1?I[W?f[q]:q]:t}}function dx(u){return ao(function(f){var _=f.length,M=_,I=zr.prototype.thru;for(u&&f.reverse();M--;){var W=f[M];if(typeof W!="function")throw new Ur(o);if(I&&!q&&Dd(W)=="wrapper")var q=new zr([],!0)}for(M=q?M:_;++M<_;){W=f[M];var oe=Dd(W),he=oe=="wrapper"?hg(W):t;he&&mg(he[0])&&he[1]==(E|w|C|O)&&!he[4].length&&he[9]==1?q=q[Dd(he[0])].apply(q,he[3]):q=W.length==1&&mg(W)?q[oe]():q.thru(W)}return function(){var Oe=arguments,Fe=Oe[0];if(q&&Oe.length==1&&Mt(Fe))return q.plant(Fe).value();for(var ze=0,$e=_?f[ze].apply(this,Oe):Fe;++ze<_;)$e=f[ze].call(this,$e);return $e}})}function Cd(u,f,_,M,I,W,q,oe,he,Oe){var Fe=f&E,ze=f&v,$e=f&g,ct=f&(w|S),yt=f&R,Pt=$e?t:du(u);function _t(){for(var Ot=arguments.length,Bt=we(Ot),Mr=Ot;Mr--;)Bt[Mr]=arguments[Mr];if(ct)var Qi=zl(_t),Tr=$C(Bt,Qi);if(M&&(Bt=ox(Bt,M,I,ct)),W&&(Bt=ax(Bt,W,q,ct)),Ot-=Tr,ct&&Ot<Oe){var Hn=Ho(Bt,Qi);return mx(u,f,Cd,_t.placeholder,_,Bt,Hn,oe,he,Oe-Ot)}var fs=ze?_:this,ho=$e?fs[u]:u;return Ot=Bt.length,oe?Bt=oP(Bt,oe):yt&&Ot>1&&Bt.reverse(),Fe&&he<Ot&&(Bt.length=he),this&&this!==bi&&this instanceof _t&&(ho=Pt||du(ho)),ho.apply(fs,Bt)}return _t}function fx(u,f){return function(_,M){return pR(_,u,f(M),{})}}function Rd(u,f){return function(_,M){var I;if(_===t&&M===t)return f;if(_!==t&&(I=_),M!==t){if(I===t)return M;typeof _=="string"||typeof M=="string"?(_=wr(_),M=wr(M)):(_=$b(_),M=$b(M)),I=u(_,M)}return I}}function ag(u){return ao(function(f){return f=An(f,xr(mt())),Dt(function(_){var M=this;return u(f,function(I){return br(I,M,_)})})})}function Pd(u,f){f=f===t?" ":wr(f);var _=f.length;if(_<2)return _?eg(f,u):f;var M=eg(f,yd(u/Pl(f)));return Rl(f)?Ko(us(M),0,u).join(""):M.slice(0,u)}function VR(u,f,_,M){var I=f&v,W=du(u);function q(){for(var oe=-1,he=arguments.length,Oe=-1,Fe=M.length,ze=we(Fe+he),$e=this&&this!==bi&&this instanceof q?W:u;++Oe<Fe;)ze[Oe]=M[Oe];for(;he--;)ze[Oe++]=arguments[++oe];return br($e,I?_:this,ze)}return q}function px(u){return function(f,_,M){return M&&typeof M!="number"&&Ji(f,_,M)&&(_=M=t),f=uo(f),_===t?(_=f,f=0):_=uo(_),M=M===t?f<_?1:-1:uo(M),ER(f,_,M,u)}}function Id(u){return function(f,_){return typeof f=="string"&&typeof _=="string"||(f=Br(f),_=Br(_)),u(f,_)}}function mx(u,f,_,M,I,W,q,oe,he,Oe){var Fe=f&w,ze=Fe?q:t,$e=Fe?t:q,ct=Fe?W:t,yt=Fe?t:W;f|=Fe?C:A,f&=~(Fe?A:C),f&x||(f&=-4);var Pt=[u,f,I,ct,ze,yt,$e,oe,he,Oe],_t=_.apply(t,Pt);return mg(u)&&Lx(_t,Pt),_t.placeholder=M,Ax(_t,u,f)}function lg(u){var f=ri[u];return function(_,M){if(_=Br(_),M=M==null?0:Oi(Rt(M),292),M&&Ab(_)){var I=(nn(_)+"e").split("e"),W=f(I[0]+"e"+(+I[1]+M));return I=(nn(W)+"e").split("e"),+(I[0]+"e"+(+I[1]-M))}return f(_)}}var GR=Nl&&1/ad(new Nl([,-0]))[1]==te?function(u){return new Nl(u)}:Rg;function gx(u){return function(f){var _=ki(f);return _==D?Um(f):_==L?s2(f):QC(f,u(f))}}function oo(u,f,_,M,I,W,q,oe){var he=f&g;if(!he&&typeof u!="function")throw new Ur(o);var Oe=M?M.length:0;if(Oe||(f&=-97,M=I=t),q=q===t?q:si(Rt(q),0),oe=oe===t?oe:Rt(oe),Oe-=I?I.length:0,f&A){var Fe=M,ze=I;M=I=t}var $e=he?t:hg(u),ct=[u,f,_,M,I,Fe,ze,W,q,oe];if($e&&iP(ct,$e),u=ct[0],f=ct[1],_=ct[2],M=ct[3],I=ct[4],oe=ct[9]=ct[9]===t?he?0:u.length:si(ct[9]-Oe,0),!oe&&f&(w|S)&&(f&=-25),!f||f==v)var yt=zR(u,f,_);else f==w||f==S?yt=WR(u,f,oe):(f==C||f==(v|C))&&!I.length?yt=VR(u,f,_,M):yt=Cd.apply(t,ct);var Pt=$e?Jb:Lx;return Ax(Pt(yt,ct),u,f)}function yx(u,f,_,M){return u===t||ds(u,Dl[_])&&!ln.call(M,_)?f:u}function _x(u,f,_,M,I,W){return Rn(u)&&Rn(f)&&(W.set(f,u),Td(u,f,t,_x,W),W.delete(f)),u}function BR(u){return mu(u)?t:u}function vx(u,f,_,M,I,W){var q=_&y,oe=u.length,he=f.length;if(oe!=he&&!(q&&he>oe))return!1;var Oe=W.get(u),Fe=W.get(f);if(Oe&&Fe)return Oe==f&&Fe==u;var ze=-1,$e=!0,ct=_&b?new Na:t;for(W.set(u,f),W.set(f,u);++ze<oe;){var yt=u[ze],Pt=f[ze];if(M)var _t=q?M(Pt,yt,ze,f,u,W):M(yt,Pt,ze,u,f,W);if(_t!==t){if(_t)continue;$e=!1;break}if(ct){if(!Im(f,function(Ot,Bt){if(!tu(ct,Bt)&&(yt===Ot||I(yt,Ot,_,M,W)))return ct.push(Bt)})){$e=!1;break}}else if(!(yt===Pt||I(yt,Pt,_,M,W))){$e=!1;break}}return W.delete(u),W.delete(f),$e}function HR(u,f,_,M,I,W,q){switch(_){case ye:if(u.byteLength!=f.byteLength||u.byteOffset!=f.byteOffset)return!1;u=u.buffer,f=f.buffer;case de:return!(u.byteLength!=f.byteLength||!W(new fd(u),new fd(f)));case Se:case Me:case ge:return ds(+u,+f);case Be:return u.name==f.name&&u.message==f.message;case j:case P:return u==f+"";case D:var oe=Um;case L:var he=M&y;if(oe||(oe=ad),u.size!=f.size&&!he)return!1;var Oe=q.get(u);if(Oe)return Oe==f;M|=b,q.set(u,f);var Fe=vx(oe(u),oe(f),M,I,W,q);return q.delete(u),Fe;case Z:if(ou)return ou.call(u)==ou.call(f)}return!1}function ZR(u,f,_,M,I,W){var q=_&y,oe=cg(u),he=oe.length,Oe=cg(f),Fe=Oe.length;if(he!=Fe&&!q)return!1;for(var ze=he;ze--;){var $e=oe[ze];if(!(q?$e in f:ln.call(f,$e)))return!1}var ct=W.get(u),yt=W.get(f);if(ct&&yt)return ct==f&&yt==u;var Pt=!0;W.set(u,f),W.set(f,u);for(var _t=q;++ze<he;){$e=oe[ze];var Ot=u[$e],Bt=f[$e];if(M)var Mr=q?M(Bt,Ot,$e,f,u,W):M(Ot,Bt,$e,u,f,W);if(!(Mr===t?Ot===Bt||I(Ot,Bt,_,M,W):Mr)){Pt=!1;break}_t||(_t=$e=="constructor")}if(Pt&&!_t){var Qi=u.constructor,Tr=f.constructor;Qi!=Tr&&"constructor"in u&&"constructor"in f&&!(typeof Qi=="function"&&Qi instanceof Qi&&typeof Tr=="function"&&Tr instanceof Tr)&&(Pt=!1)}return W.delete(u),W.delete(f),Pt}function ao(u){return yg(Tx(u,t,Nx),u+"")}function cg(u){return zb(u,gi,fg)}function ug(u){return zb(u,hr,bx)}var hg=vd?function(u){return vd.get(u)}:Rg;function Dd(u){for(var f=u.name+"",_=Ol[f],M=ln.call(Ol,f)?_.length:0;M--;){var I=_[M],W=I.func;if(W==null||W==u)return I.name}return f}function zl(u){var f=ln.call(F,"placeholder")?F:u;return f.placeholder}function mt(){var u=F.iteratee||Ag;return u=u===Ag?Gb:u,arguments.length?u(arguments[0],arguments[1]):u}function Nd(u,f){var _=u.__data__;return qR(f)?_[typeof f=="string"?"string":"hash"]:_.map}function dg(u){for(var f=gi(u),_=f.length;_--;){var M=f[_],I=u[M];f[_]=[M,I,Sx(I)]}return f}function Fa(u,f){var _=n2(u,f);return Vb(_)?_:t}function XR(u){var f=ln.call(u,Ia),_=u[Ia];try{u[Ia]=t;var M=!0}catch{}var I=hd.call(u);return M&&(f?u[Ia]=_:delete u[Ia]),I}var fg=Wm?function(u){return u==null?[]:(u=mn(u),Go(Wm(u),function(f){return Eb.call(u,f)}))}:Pg,bx=Wm?function(u){for(var f=[];u;)Bo(f,fg(u)),u=pd(u);return f}:Pg,ki=Ki;(Vm&&ki(new Vm(new ArrayBuffer(1)))!=ye||iu&&ki(new iu)!=D||Gm&&ki(Gm.resolve())!=N||Nl&&ki(new Nl)!=L||ru&&ki(new ru)!=Q)&&(ki=function(u){var f=Ki(u),_=f==fe?u.constructor:t,M=_?Ua(_):"";if(M)switch(M){case A2:return ye;case C2:return D;case R2:return N;case P2:return L;case I2:return Q}return f});function jR(u,f,_){for(var M=-1,I=_.length;++M<I;){var W=_[M],q=W.size;switch(W.type){case"drop":u+=q;break;case"dropRight":f-=q;break;case"take":f=Oi(f,u+q);break;case"takeRight":u=si(u,f-q);break}}return{start:u,end:f}}function YR(u){var f=u.match(ed);return f?f[1].split(El):[]}function xx(u,f,_){f=Yo(f,u);for(var M=-1,I=f.length,W=!1;++M<I;){var q=Ps(f[M]);if(!(W=u!=null&&_(u,q)))break;u=u[q]}return W||++M!=I?W:(I=u==null?0:u.length,!!I&&Vd(I)&&lo(q,I)&&(Mt(u)||za(u)))}function KR(u){var f=u.length,_=new u.constructor(f);return f&&typeof u[0]=="string"&&ln.call(u,"index")&&(_.index=u.index,_.input=u.input),_}function wx(u){return typeof u.constructor=="function"&&!fu(u)?kl(pd(u)):{}}function JR(u,f,_){var M=u.constructor;switch(f){case de:return og(u);case Se:case Me:return new M(+u);case ye:return DR(u,_);case Pe:case Qe:case Ne:case je:case lt:case ut:case Xe:case ne:case Ee:return rx(u,_);case D:return new M;case ge:case P:return new M(u);case j:return NR(u);case L:return new M;case Z:return OR(u)}}function QR(u,f){var _=f.length;if(!_)return u;var M=_-1;return f[M]=(_>1?"& ":"")+f[M],f=f.join(_>2?", ":" "),u.replace(qh,`{
/* [wrapped with `+f+`] */
`)}function $R(u){return Mt(u)||za(u)||!!(Lb&&u&&u[Lb])}function lo(u,f){var _=typeof u;return f=f??J,!!f&&(_=="number"||_!="symbol"&&z.test(u))&&u>-1&&u%1==0&&u<f}function Ji(u,f,_){if(!Rn(_))return!1;var M=typeof f;return(M=="number"?ur(_)&&lo(f,_.length):M=="string"&&f in _)?ds(_[f],u):!1}function pg(u,f){if(Mt(u))return!1;var _=typeof u;return _=="number"||_=="symbol"||_=="boolean"||u==null||Sr(u)?!0:mi.test(u)||!Nt.test(u)||f!=null&&u in mn(f)}function qR(u){var f=typeof u;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?u!=="__proto__":u===null}function mg(u){var f=Dd(u),_=F[f];if(typeof _!="function"||!(f in Wt.prototype))return!1;if(u===_)return!0;var M=hg(_);return!!M&&u===M[0]}function eP(u){return!!Sb&&Sb in u}var tP=cd?co:Ig;function fu(u){var f=u&&u.constructor,_=typeof f=="function"&&f.prototype||Dl;return u===_}function Sx(u){return u===u&&!Rn(u)}function Mx(u,f){return function(_){return _==null?!1:_[u]===f&&(f!==t||u in mn(_))}}function nP(u){var f=zd(u,function(M){return _.size===c&&_.clear(),M}),_=f.cache;return f}function iP(u,f){var _=u[1],M=f[1],I=_|M,W=I<(v|g|E),q=M==E&&_==w||M==E&&_==O&&u[7].length<=f[8]||M==(E|O)&&f[7].length<=f[8]&&_==w;if(!(W||q))return u;M&v&&(u[2]=f[2],I|=_&v?0:x);var oe=f[3];if(oe){var he=u[3];u[3]=he?ox(he,oe,f[4]):oe,u[4]=he?Ho(u[3],h):f[4]}return oe=f[5],oe&&(he=u[5],u[5]=he?ax(he,oe,f[6]):oe,u[6]=he?Ho(u[5],h):f[6]),oe=f[7],oe&&(u[7]=oe),M&E&&(u[8]=u[8]==null?f[8]:Oi(u[8],f[8])),u[9]==null&&(u[9]=f[9]),u[0]=f[0],u[1]=I,u}function rP(u){var f=[];if(u!=null)for(var _ in mn(u))f.push(_);return f}function sP(u){return hd.call(u)}function Tx(u,f,_){return f=si(f===t?u.length-1:f,0),function(){for(var M=arguments,I=-1,W=si(M.length-f,0),q=we(W);++I<W;)q[I]=M[f+I];I=-1;for(var oe=we(f+1);++I<f;)oe[I]=M[I];return oe[f]=_(q),br(u,this,oe)}}function Ex(u,f){return f.length<2?u:ka(u,Vr(f,0,-1))}function oP(u,f){for(var _=u.length,M=Oi(f.length,_),I=cr(u);M--;){var W=f[M];u[M]=lo(W,_)?I[W]:t}return u}function gg(u,f){if(!(f==="constructor"&&typeof u[f]=="function")&&f!="__proto__")return u[f]}var Lx=Cx(Jb),pu=x2||function(u,f){return bi.setTimeout(u,f)},yg=Cx(CR);function Ax(u,f,_){var M=f+"";return yg(u,QR(M,aP(YR(M),_)))}function Cx(u){var f=0,_=0;return function(){var M=T2(),I=$-(M-_);if(_=M,I>0){if(++f>=Y)return arguments[0]}else f=0;return u.apply(t,arguments)}}function Od(u,f){var _=-1,M=u.length,I=M-1;for(f=f===t?M:f;++_<f;){var W=qm(_,I),q=u[W];u[W]=u[_],u[_]=q}return u.length=f,u}var Rx=nP(function(u){var f=[];return u.charCodeAt(0)===46&&f.push(""),u.replace(os,function(_,M,I,W){f.push(I?W.replace(nd,"$1"):M||_)}),f});function Ps(u){if(typeof u=="string"||Sr(u))return u;var f=u+"";return f=="0"&&1/u==-te?"-0":f}function Ua(u){if(u!=null){try{return ud.call(u)}catch{}try{return u+""}catch{}}return""}function aP(u,f){return Fr(_e,function(_){var M="_."+_[0];f&_[1]&&!sd(u,M)&&u.push(M)}),u.sort()}function Px(u){if(u instanceof Wt)return u.clone();var f=new zr(u.__wrapped__,u.__chain__);return f.__actions__=cr(u.__actions__),f.__index__=u.__index__,f.__values__=u.__values__,f}function lP(u,f,_){(_?Ji(u,f,_):f===t)?f=1:f=si(Rt(f),0);var M=u==null?0:u.length;if(!M||f<1)return[];for(var I=0,W=0,q=we(yd(M/f));I<M;)q[W++]=Vr(u,I,I+=f);return q}function cP(u){for(var f=-1,_=u==null?0:u.length,M=0,I=[];++f<_;){var W=u[f];W&&(I[M++]=W)}return I}function uP(){var u=arguments.length;if(!u)return[];for(var f=we(u-1),_=arguments[0],M=u;M--;)f[M-1]=arguments[M];return Bo(Mt(_)?cr(_):[_],xi(f,1))}var hP=Dt(function(u,f){return Bn(u)?lu(u,xi(f,1,Bn,!0)):[]}),dP=Dt(function(u,f){var _=Gr(f);return Bn(_)&&(_=t),Bn(u)?lu(u,xi(f,1,Bn,!0),mt(_,2)):[]}),fP=Dt(function(u,f){var _=Gr(f);return Bn(_)&&(_=t),Bn(u)?lu(u,xi(f,1,Bn,!0),t,_):[]});function pP(u,f,_){var M=u==null?0:u.length;return M?(f=_||f===t?1:Rt(f),Vr(u,f<0?0:f,M)):[]}function mP(u,f,_){var M=u==null?0:u.length;return M?(f=_||f===t?1:Rt(f),f=M-f,Vr(u,0,f<0?0:f)):[]}function gP(u,f){return u&&u.length?Ld(u,mt(f,3),!0,!0):[]}function yP(u,f){return u&&u.length?Ld(u,mt(f,3),!0):[]}function _P(u,f,_,M){var I=u==null?0:u.length;return I?(_&&typeof _!="number"&&Ji(u,f,_)&&(_=0,M=I),uR(u,f,_,M)):[]}function Ix(u,f,_){var M=u==null?0:u.length;if(!M)return-1;var I=_==null?0:Rt(_);return I<0&&(I=si(M+I,0)),od(u,mt(f,3),I)}function Dx(u,f,_){var M=u==null?0:u.length;if(!M)return-1;var I=M-1;return _!==t&&(I=Rt(_),I=_<0?si(M+I,0):Oi(I,M-1)),od(u,mt(f,3),I,!0)}function Nx(u){var f=u==null?0:u.length;return f?xi(u,1):[]}function vP(u){var f=u==null?0:u.length;return f?xi(u,te):[]}function bP(u,f){var _=u==null?0:u.length;return _?(f=f===t?1:Rt(f),xi(u,f)):[]}function xP(u){for(var f=-1,_=u==null?0:u.length,M={};++f<_;){var I=u[f];M[I[0]]=I[1]}return M}function Ox(u){return u&&u.length?u[0]:t}function wP(u,f,_){var M=u==null?0:u.length;if(!M)return-1;var I=_==null?0:Rt(_);return I<0&&(I=si(M+I,0)),Cl(u,f,I)}function SP(u){var f=u==null?0:u.length;return f?Vr(u,0,-1):[]}var MP=Dt(function(u){var f=An(u,rg);return f.length&&f[0]===u[0]?Ym(f):[]}),TP=Dt(function(u){var f=Gr(u),_=An(u,rg);return f===Gr(_)?f=t:_.pop(),_.length&&_[0]===u[0]?Ym(_,mt(f,2)):[]}),EP=Dt(function(u){var f=Gr(u),_=An(u,rg);return f=typeof f=="function"?f:t,f&&_.pop(),_.length&&_[0]===u[0]?Ym(_,t,f):[]});function LP(u,f){return u==null?"":S2.call(u,f)}function Gr(u){var f=u==null?0:u.length;return f?u[f-1]:t}function AP(u,f,_){var M=u==null?0:u.length;if(!M)return-1;var I=M;return _!==t&&(I=Rt(_),I=I<0?si(M+I,0):Oi(I,M-1)),f===f?a2(u,f,I):od(u,mb,I,!0)}function CP(u,f){return u&&u.length?Xb(u,Rt(f)):t}var RP=Dt(kx);function kx(u,f){return u&&u.length&&f&&f.length?$m(u,f):u}function PP(u,f,_){return u&&u.length&&f&&f.length?$m(u,f,mt(_,2)):u}function IP(u,f,_){return u&&u.length&&f&&f.length?$m(u,f,t,_):u}var DP=ao(function(u,f){var _=u==null?0:u.length,M=Hm(u,f);return Kb(u,An(f,function(I){return lo(I,_)?+I:I}).sort(sx)),M});function NP(u,f){var _=[];if(!(u&&u.length))return _;var M=-1,I=[],W=u.length;for(f=mt(f,3);++M<W;){var q=u[M];f(q,M,u)&&(_.push(q),I.push(M))}return Kb(u,I),_}function _g(u){return u==null?u:L2.call(u)}function OP(u,f,_){var M=u==null?0:u.length;return M?(_&&typeof _!="number"&&Ji(u,f,_)?(f=0,_=M):(f=f==null?0:Rt(f),_=_===t?M:Rt(_)),Vr(u,f,_)):[]}function kP(u,f){return Ed(u,f)}function FP(u,f,_){return tg(u,f,mt(_,2))}function UP(u,f){var _=u==null?0:u.length;if(_){var M=Ed(u,f);if(M<_&&ds(u[M],f))return M}return-1}function zP(u,f){return Ed(u,f,!0)}function WP(u,f,_){return tg(u,f,mt(_,2),!0)}function VP(u,f){var _=u==null?0:u.length;if(_){var M=Ed(u,f,!0)-1;if(ds(u[M],f))return M}return-1}function GP(u){return u&&u.length?Qb(u):[]}function BP(u,f){return u&&u.length?Qb(u,mt(f,2)):[]}function HP(u){var f=u==null?0:u.length;return f?Vr(u,1,f):[]}function ZP(u,f,_){return u&&u.length?(f=_||f===t?1:Rt(f),Vr(u,0,f<0?0:f)):[]}function XP(u,f,_){var M=u==null?0:u.length;return M?(f=_||f===t?1:Rt(f),f=M-f,Vr(u,f<0?0:f,M)):[]}function jP(u,f){return u&&u.length?Ld(u,mt(f,3),!1,!0):[]}function YP(u,f){return u&&u.length?Ld(u,mt(f,3)):[]}var KP=Dt(function(u){return jo(xi(u,1,Bn,!0))}),JP=Dt(function(u){var f=Gr(u);return Bn(f)&&(f=t),jo(xi(u,1,Bn,!0),mt(f,2))}),QP=Dt(function(u){var f=Gr(u);return f=typeof f=="function"?f:t,jo(xi(u,1,Bn,!0),t,f)});function $P(u){return u&&u.length?jo(u):[]}function qP(u,f){return u&&u.length?jo(u,mt(f,2)):[]}function eI(u,f){return f=typeof f=="function"?f:t,u&&u.length?jo(u,t,f):[]}function vg(u){if(!(u&&u.length))return[];var f=0;return u=Go(u,function(_){if(Bn(_))return f=si(_.length,f),!0}),km(f,function(_){return An(u,Dm(_))})}function Fx(u,f){if(!(u&&u.length))return[];var _=vg(u);return f==null?_:An(_,function(M){return br(f,t,M)})}var tI=Dt(function(u,f){return Bn(u)?lu(u,f):[]}),nI=Dt(function(u){return ig(Go(u,Bn))}),iI=Dt(function(u){var f=Gr(u);return Bn(f)&&(f=t),ig(Go(u,Bn),mt(f,2))}),rI=Dt(function(u){var f=Gr(u);return f=typeof f=="function"?f:t,ig(Go(u,Bn),t,f)}),sI=Dt(vg);function oI(u,f){return tx(u||[],f||[],au)}function aI(u,f){return tx(u||[],f||[],hu)}var lI=Dt(function(u){var f=u.length,_=f>1?u[f-1]:t;return _=typeof _=="function"?(u.pop(),_):t,Fx(u,_)});function Ux(u){var f=F(u);return f.__chain__=!0,f}function cI(u,f){return f(u),u}function kd(u,f){return f(u)}var uI=ao(function(u){var f=u.length,_=f?u[0]:0,M=this.__wrapped__,I=function(W){return Hm(W,u)};return f>1||this.__actions__.length||!(M instanceof Wt)||!lo(_)?this.thru(I):(M=M.slice(_,+_+(f?1:0)),M.__actions__.push({func:kd,args:[I],thisArg:t}),new zr(M,this.__chain__).thru(function(W){return f&&!W.length&&W.push(t),W}))});function hI(){return Ux(this)}function dI(){return new zr(this.value(),this.__chain__)}function fI(){this.__values__===t&&(this.__values__=$x(this.value()));var u=this.__index__>=this.__values__.length,f=u?t:this.__values__[this.__index__++];return{done:u,value:f}}function pI(){return this}function mI(u){for(var f,_=this;_ instanceof xd;){var M=Px(_);M.__index__=0,M.__values__=t,f?I.__wrapped__=M:f=M;var I=M;_=_.__wrapped__}return I.__wrapped__=u,f}function gI(){var u=this.__wrapped__;if(u instanceof Wt){var f=u;return this.__actions__.length&&(f=new Wt(this)),f=f.reverse(),f.__actions__.push({func:kd,args:[_g],thisArg:t}),new zr(f,this.__chain__)}return this.thru(_g)}function yI(){return ex(this.__wrapped__,this.__actions__)}var _I=Ad(function(u,f,_){ln.call(u,_)?++u[_]:so(u,_,1)});function vI(u,f,_){var M=Mt(u)?fb:cR;return _&&Ji(u,f,_)&&(f=t),M(u,mt(f,3))}function bI(u,f){var _=Mt(u)?Go:Fb;return _(u,mt(f,3))}var xI=hx(Ix),wI=hx(Dx);function SI(u,f){return xi(Fd(u,f),1)}function MI(u,f){return xi(Fd(u,f),te)}function TI(u,f,_){return _=_===t?1:Rt(_),xi(Fd(u,f),_)}function zx(u,f){var _=Mt(u)?Fr:Xo;return _(u,mt(f,3))}function Wx(u,f){var _=Mt(u)?HC:kb;return _(u,mt(f,3))}var EI=Ad(function(u,f,_){ln.call(u,_)?u[_].push(f):so(u,_,[f])});function LI(u,f,_,M){u=ur(u)?u:Vl(u),_=_&&!M?Rt(_):0;var I=u.length;return _<0&&(_=si(I+_,0)),Gd(u)?_<=I&&u.indexOf(f,_)>-1:!!I&&Cl(u,f,_)>-1}var AI=Dt(function(u,f,_){var M=-1,I=typeof f=="function",W=ur(u)?we(u.length):[];return Xo(u,function(q){W[++M]=I?br(f,q,_):cu(q,f,_)}),W}),CI=Ad(function(u,f,_){so(u,_,f)});function Fd(u,f){var _=Mt(u)?An:Bb;return _(u,mt(f,3))}function RI(u,f,_,M){return u==null?[]:(Mt(f)||(f=f==null?[]:[f]),_=M?t:_,Mt(_)||(_=_==null?[]:[_]),jb(u,f,_))}var PI=Ad(function(u,f,_){u[_?0:1].push(f)},function(){return[[],[]]});function II(u,f,_){var M=Mt(u)?Pm:yb,I=arguments.length<3;return M(u,mt(f,4),_,I,Xo)}function DI(u,f,_){var M=Mt(u)?ZC:yb,I=arguments.length<3;return M(u,mt(f,4),_,I,kb)}function NI(u,f){var _=Mt(u)?Go:Fb;return _(u,Wd(mt(f,3)))}function OI(u){var f=Mt(u)?Ib:LR;return f(u)}function kI(u,f,_){(_?Ji(u,f,_):f===t)?f=1:f=Rt(f);var M=Mt(u)?rR:AR;return M(u,f)}function FI(u){var f=Mt(u)?sR:RR;return f(u)}function UI(u){if(u==null)return 0;if(ur(u))return Gd(u)?Pl(u):u.length;var f=ki(u);return f==D||f==L?u.size:Jm(u).length}function zI(u,f,_){var M=Mt(u)?Im:PR;return _&&Ji(u,f,_)&&(f=t),M(u,mt(f,3))}var WI=Dt(function(u,f){if(u==null)return[];var _=f.length;return _>1&&Ji(u,f[0],f[1])?f=[]:_>2&&Ji(f[0],f[1],f[2])&&(f=[f[0]]),jb(u,xi(f,1),[])}),Ud=b2||function(){return bi.Date.now()};function VI(u,f){if(typeof f!="function")throw new Ur(o);return u=Rt(u),function(){if(--u<1)return f.apply(this,arguments)}}function Vx(u,f,_){return f=_?t:f,f=u&&f==null?u.length:f,oo(u,E,t,t,t,t,f)}function Gx(u,f){var _;if(typeof f!="function")throw new Ur(o);return u=Rt(u),function(){return--u>0&&(_=f.apply(this,arguments)),u<=1&&(f=t),_}}var bg=Dt(function(u,f,_){var M=v;if(_.length){var I=Ho(_,zl(bg));M|=C}return oo(u,M,f,_,I)}),Bx=Dt(function(u,f,_){var M=v|g;if(_.length){var I=Ho(_,zl(Bx));M|=C}return oo(f,M,u,_,I)});function Hx(u,f,_){f=_?t:f;var M=oo(u,w,t,t,t,t,t,f);return M.placeholder=Hx.placeholder,M}function Zx(u,f,_){f=_?t:f;var M=oo(u,S,t,t,t,t,t,f);return M.placeholder=Zx.placeholder,M}function Xx(u,f,_){var M,I,W,q,oe,he,Oe=0,Fe=!1,ze=!1,$e=!0;if(typeof u!="function")throw new Ur(o);f=Br(f)||0,Rn(_)&&(Fe=!!_.leading,ze="maxWait"in _,W=ze?si(Br(_.maxWait)||0,f):W,$e="trailing"in _?!!_.trailing:$e);function ct(Hn){var fs=M,ho=I;return M=I=t,Oe=Hn,q=u.apply(ho,fs),q}function yt(Hn){return Oe=Hn,oe=pu(Ot,f),Fe?ct(Hn):q}function Pt(Hn){var fs=Hn-he,ho=Hn-Oe,hw=f-fs;return ze?Oi(hw,W-ho):hw}function _t(Hn){var fs=Hn-he,ho=Hn-Oe;return he===t||fs>=f||fs<0||ze&&ho>=W}function Ot(){var Hn=Ud();if(_t(Hn))return Bt(Hn);oe=pu(Ot,Pt(Hn))}function Bt(Hn){return oe=t,$e&&M?ct(Hn):(M=I=t,q)}function Mr(){oe!==t&&nx(oe),Oe=0,M=he=I=oe=t}function Qi(){return oe===t?q:Bt(Ud())}function Tr(){var Hn=Ud(),fs=_t(Hn);if(M=arguments,I=this,he=Hn,fs){if(oe===t)return yt(he);if(ze)return nx(oe),oe=pu(Ot,f),ct(he)}return oe===t&&(oe=pu(Ot,f)),q}return Tr.cancel=Mr,Tr.flush=Qi,Tr}var GI=Dt(function(u,f){return Ob(u,1,f)}),BI=Dt(function(u,f,_){return Ob(u,Br(f)||0,_)});function HI(u){return oo(u,R)}function zd(u,f){if(typeof u!="function"||f!=null&&typeof f!="function")throw new Ur(o);var _=function(){var M=arguments,I=f?f.apply(this,M):M[0],W=_.cache;if(W.has(I))return W.get(I);var q=u.apply(this,M);return _.cache=W.set(I,q)||W,q};return _.cache=new(zd.Cache||ro),_}zd.Cache=ro;function Wd(u){if(typeof u!="function")throw new Ur(o);return function(){var f=arguments;switch(f.length){case 0:return!u.call(this);case 1:return!u.call(this,f[0]);case 2:return!u.call(this,f[0],f[1]);case 3:return!u.call(this,f[0],f[1],f[2])}return!u.apply(this,f)}}function ZI(u){return Gx(2,u)}var XI=IR(function(u,f){f=f.length==1&&Mt(f[0])?An(f[0],xr(mt())):An(xi(f,1),xr(mt()));var _=f.length;return Dt(function(M){for(var I=-1,W=Oi(M.length,_);++I<W;)M[I]=f[I].call(this,M[I]);return br(u,this,M)})}),xg=Dt(function(u,f){var _=Ho(f,zl(xg));return oo(u,C,t,f,_)}),jx=Dt(function(u,f){var _=Ho(f,zl(jx));return oo(u,A,t,f,_)}),jI=ao(function(u,f){return oo(u,O,t,t,t,f)});function YI(u,f){if(typeof u!="function")throw new Ur(o);return f=f===t?f:Rt(f),Dt(u,f)}function KI(u,f){if(typeof u!="function")throw new Ur(o);return f=f==null?0:si(Rt(f),0),Dt(function(_){var M=_[f],I=Ko(_,0,f);return M&&Bo(I,M),br(u,this,I)})}function JI(u,f,_){var M=!0,I=!0;if(typeof u!="function")throw new Ur(o);return Rn(_)&&(M="leading"in _?!!_.leading:M,I="trailing"in _?!!_.trailing:I),Xx(u,f,{leading:M,maxWait:f,trailing:I})}function QI(u){return Vx(u,1)}function $I(u,f){return xg(sg(f),u)}function qI(){if(!arguments.length)return[];var u=arguments[0];return Mt(u)?u:[u]}function e3(u){return Wr(u,m)}function t3(u,f){return f=typeof f=="function"?f:t,Wr(u,m,f)}function n3(u){return Wr(u,d|m)}function i3(u,f){return f=typeof f=="function"?f:t,Wr(u,d|m,f)}function r3(u,f){return f==null||Nb(u,f,gi(f))}function ds(u,f){return u===f||u!==u&&f!==f}var s3=Id(jm),o3=Id(function(u,f){return u>=f}),za=Wb(function(){return arguments}())?Wb:function(u){return On(u)&&ln.call(u,"callee")&&!Eb.call(u,"callee")},Mt=we.isArray,a3=ab?xr(ab):mR;function ur(u){return u!=null&&Vd(u.length)&&!co(u)}function Bn(u){return On(u)&&ur(u)}function l3(u){return u===!0||u===!1||On(u)&&Ki(u)==Se}var Jo=w2||Ig,c3=lb?xr(lb):gR;function u3(u){return On(u)&&u.nodeType===1&&!mu(u)}function h3(u){if(u==null)return!0;if(ur(u)&&(Mt(u)||typeof u=="string"||typeof u.splice=="function"||Jo(u)||Wl(u)||za(u)))return!u.length;var f=ki(u);if(f==D||f==L)return!u.size;if(fu(u))return!Jm(u).length;for(var _ in u)if(ln.call(u,_))return!1;return!0}function d3(u,f){return uu(u,f)}function f3(u,f,_){_=typeof _=="function"?_:t;var M=_?_(u,f):t;return M===t?uu(u,f,t,_):!!M}function wg(u){if(!On(u))return!1;var f=Ki(u);return f==Be||f==De||typeof u.message=="string"&&typeof u.name=="string"&&!mu(u)}function p3(u){return typeof u=="number"&&Ab(u)}function co(u){if(!Rn(u))return!1;var f=Ki(u);return f==H||f==X||f==se||f==B}function Yx(u){return typeof u=="number"&&u==Rt(u)}function Vd(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=J}function Rn(u){var f=typeof u;return u!=null&&(f=="object"||f=="function")}function On(u){return u!=null&&typeof u=="object"}var Kx=cb?xr(cb):_R;function m3(u,f){return u===f||Km(u,f,dg(f))}function g3(u,f,_){return _=typeof _=="function"?_:t,Km(u,f,dg(f),_)}function y3(u){return Jx(u)&&u!=+u}function _3(u){if(tP(u))throw new St(s);return Vb(u)}function v3(u){return u===null}function b3(u){return u==null}function Jx(u){return typeof u=="number"||On(u)&&Ki(u)==ge}function mu(u){if(!On(u)||Ki(u)!=fe)return!1;var f=pd(u);if(f===null)return!0;var _=ln.call(f,"constructor")&&f.constructor;return typeof _=="function"&&_ instanceof _&&ud.call(_)==g2}var Sg=ub?xr(ub):vR;function x3(u){return Yx(u)&&u>=-J&&u<=J}var Qx=hb?xr(hb):bR;function Gd(u){return typeof u=="string"||!Mt(u)&&On(u)&&Ki(u)==P}function Sr(u){return typeof u=="symbol"||On(u)&&Ki(u)==Z}var Wl=db?xr(db):xR;function w3(u){return u===t}function S3(u){return On(u)&&ki(u)==Q}function M3(u){return On(u)&&Ki(u)==K}var T3=Id(Qm),E3=Id(function(u,f){return u<=f});function $x(u){if(!u)return[];if(ur(u))return Gd(u)?us(u):cr(u);if(nu&&u[nu])return r2(u[nu]());var f=ki(u),_=f==D?Um:f==L?ad:Vl;return _(u)}function uo(u){if(!u)return u===0?u:0;if(u=Br(u),u===te||u===-te){var f=u<0?-1:1;return f*pe}return u===u?u:0}function Rt(u){var f=uo(u),_=f%1;return f===f?_?f-_:f:0}function qx(u){return u?Oa(Rt(u),0,Le):0}function Br(u){if(typeof u=="number")return u;if(Sr(u))return Te;if(Rn(u)){var f=typeof u.valueOf=="function"?u.valueOf():u;u=Rn(f)?f+"":f}if(typeof u!="string")return u===0?u:+u;u=_b(u);var _=Mm.test(u);return _||Em.test(u)?VC(u.slice(2),_?2:8):Sm.test(u)?Te:+u}function ew(u){return Rs(u,hr(u))}function L3(u){return u?Oa(Rt(u),-J,J):u===0?u:0}function nn(u){return u==null?"":wr(u)}var A3=Fl(function(u,f){if(fu(f)||ur(f)){Rs(f,gi(f),u);return}for(var _ in f)ln.call(f,_)&&au(u,_,f[_])}),tw=Fl(function(u,f){Rs(f,hr(f),u)}),Bd=Fl(function(u,f,_,M){Rs(f,hr(f),u,M)}),C3=Fl(function(u,f,_,M){Rs(f,gi(f),u,M)}),R3=ao(Hm);function P3(u,f){var _=kl(u);return f==null?_:Db(_,f)}var I3=Dt(function(u,f){u=mn(u);var _=-1,M=f.length,I=M>2?f[2]:t;for(I&&Ji(f[0],f[1],I)&&(M=1);++_<M;)for(var W=f[_],q=hr(W),oe=-1,he=q.length;++oe<he;){var Oe=q[oe],Fe=u[Oe];(Fe===t||ds(Fe,Dl[Oe])&&!ln.call(u,Oe))&&(u[Oe]=W[Oe])}return u}),D3=Dt(function(u){return u.push(t,_x),br(nw,t,u)});function N3(u,f){return pb(u,mt(f,3),Cs)}function O3(u,f){return pb(u,mt(f,3),Xm)}function k3(u,f){return u==null?u:Zm(u,mt(f,3),hr)}function F3(u,f){return u==null?u:Ub(u,mt(f,3),hr)}function U3(u,f){return u&&Cs(u,mt(f,3))}function z3(u,f){return u&&Xm(u,mt(f,3))}function W3(u){return u==null?[]:Md(u,gi(u))}function V3(u){return u==null?[]:Md(u,hr(u))}function Mg(u,f,_){var M=u==null?t:ka(u,f);return M===t?_:M}function G3(u,f){return u!=null&&xx(u,f,hR)}function Tg(u,f){return u!=null&&xx(u,f,dR)}var B3=fx(function(u,f,_){f!=null&&typeof f.toString!="function"&&(f=hd.call(f)),u[f]=_},Lg(dr)),H3=fx(function(u,f,_){f!=null&&typeof f.toString!="function"&&(f=hd.call(f)),ln.call(u,f)?u[f].push(_):u[f]=[_]},mt),Z3=Dt(cu);function gi(u){return ur(u)?Pb(u):Jm(u)}function hr(u){return ur(u)?Pb(u,!0):wR(u)}function X3(u,f){var _={};return f=mt(f,3),Cs(u,function(M,I,W){so(_,f(M,I,W),M)}),_}function j3(u,f){var _={};return f=mt(f,3),Cs(u,function(M,I,W){so(_,I,f(M,I,W))}),_}var Y3=Fl(function(u,f,_){Td(u,f,_)}),nw=Fl(function(u,f,_,M){Td(u,f,_,M)}),K3=ao(function(u,f){var _={};if(u==null)return _;var M=!1;f=An(f,function(W){return W=Yo(W,u),M||(M=W.length>1),W}),Rs(u,ug(u),_),M&&(_=Wr(_,d|p|m,BR));for(var I=f.length;I--;)ng(_,f[I]);return _});function J3(u,f){return iw(u,Wd(mt(f)))}var Q3=ao(function(u,f){return u==null?{}:MR(u,f)});function iw(u,f){if(u==null)return{};var _=An(ug(u),function(M){return[M]});return f=mt(f),Yb(u,_,function(M,I){return f(M,I[0])})}function $3(u,f,_){f=Yo(f,u);var M=-1,I=f.length;for(I||(I=1,u=t);++M<I;){var W=u==null?t:u[Ps(f[M])];W===t&&(M=I,W=_),u=co(W)?W.call(u):W}return u}function q3(u,f,_){return u==null?u:hu(u,f,_)}function eD(u,f,_,M){return M=typeof M=="function"?M:t,u==null?u:hu(u,f,_,M)}var rw=gx(gi),sw=gx(hr);function tD(u,f,_){var M=Mt(u),I=M||Jo(u)||Wl(u);if(f=mt(f,4),_==null){var W=u&&u.constructor;I?_=M?new W:[]:Rn(u)?_=co(W)?kl(pd(u)):{}:_={}}return(I?Fr:Cs)(u,function(q,oe,he){return f(_,q,oe,he)}),_}function nD(u,f){return u==null?!0:ng(u,f)}function iD(u,f,_){return u==null?u:qb(u,f,sg(_))}function rD(u,f,_,M){return M=typeof M=="function"?M:t,u==null?u:qb(u,f,sg(_),M)}function Vl(u){return u==null?[]:Fm(u,gi(u))}function sD(u){return u==null?[]:Fm(u,hr(u))}function oD(u,f,_){return _===t&&(_=f,f=t),_!==t&&(_=Br(_),_=_===_?_:0),f!==t&&(f=Br(f),f=f===f?f:0),Oa(Br(u),f,_)}function aD(u,f,_){return f=uo(f),_===t?(_=f,f=0):_=uo(_),u=Br(u),fR(u,f,_)}function lD(u,f,_){if(_&&typeof _!="boolean"&&Ji(u,f,_)&&(f=_=t),_===t&&(typeof f=="boolean"?(_=f,f=t):typeof u=="boolean"&&(_=u,u=t)),u===t&&f===t?(u=0,f=1):(u=uo(u),f===t?(f=u,u=0):f=uo(f)),u>f){var M=u;u=f,f=M}if(_||u%1||f%1){var I=Cb();return Oi(u+I*(f-u+WC("1e-"+((I+"").length-1))),f)}return qm(u,f)}var cD=Ul(function(u,f,_){return f=f.toLowerCase(),u+(_?ow(f):f)});function ow(u){return Eg(nn(u).toLowerCase())}function aw(u){return u=nn(u),u&&u.replace(ce,qC).replace(RC,"")}function uD(u,f,_){u=nn(u),f=wr(f);var M=u.length;_=_===t?M:Oa(Rt(_),0,M);var I=_;return _-=f.length,_>=0&&u.slice(_,I)==f}function hD(u){return u=nn(u),u&&Ye.test(u)?u.replace(ke,e2):u}function dD(u){return u=nn(u),u&&$h.test(u)?u.replace(Tl,"\\$&"):u}var fD=Ul(function(u,f,_){return u+(_?"-":"")+f.toLowerCase()}),pD=Ul(function(u,f,_){return u+(_?" ":"")+f.toLowerCase()}),mD=ux("toLowerCase");function gD(u,f,_){u=nn(u),f=Rt(f);var M=f?Pl(u):0;if(!f||M>=f)return u;var I=(f-M)/2;return Pd(_d(I),_)+u+Pd(yd(I),_)}function yD(u,f,_){u=nn(u),f=Rt(f);var M=f?Pl(u):0;return f&&M<f?u+Pd(f-M,_):u}function _D(u,f,_){u=nn(u),f=Rt(f);var M=f?Pl(u):0;return f&&M<f?Pd(f-M,_)+u:u}function vD(u,f,_){return _||f==null?f=0:f&&(f=+f),E2(nn(u).replace(as,""),f||0)}function bD(u,f,_){return(_?Ji(u,f,_):f===t)?f=1:f=Rt(f),eg(nn(u),f)}function xD(){var u=arguments,f=nn(u[0]);return u.length<3?f:f.replace(u[1],u[2])}var wD=Ul(function(u,f,_){return u+(_?"_":"")+f.toLowerCase()});function SD(u,f,_){return _&&typeof _!="number"&&Ji(u,f,_)&&(f=_=t),_=_===t?Le:_>>>0,_?(u=nn(u),u&&(typeof f=="string"||f!=null&&!Sg(f))&&(f=wr(f),!f&&Rl(u))?Ko(us(u),0,_):u.split(f,_)):[]}var MD=Ul(function(u,f,_){return u+(_?" ":"")+Eg(f)});function TD(u,f,_){return u=nn(u),_=_==null?0:Oa(Rt(_),0,u.length),f=wr(f),u.slice(_,_+f.length)==f}function ED(u,f,_){var M=F.templateSettings;_&&Ji(u,f,_)&&(f=t),u=nn(u),f=Bd({},f,M,yx);var I=Bd({},f.imports,M.imports,yx),W=gi(I),q=Fm(I,W),oe,he,Oe=0,Fe=f.interpolate||ve,ze="__p += '",$e=zm((f.escape||ve).source+"|"+Fe.source+"|"+(Fe===wn?id:ve).source+"|"+(f.evaluate||ve).source+"|$","g"),ct="//# sourceURL="+(ln.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++OC+"]")+`
`;u.replace($e,function(_t,Ot,Bt,Mr,Qi,Tr){return Bt||(Bt=Mr),ze+=u.slice(Oe,Tr).replace(be,t2),Ot&&(oe=!0,ze+=`' +
__e(`+Ot+`) +
'`),Qi&&(he=!0,ze+=`';
`+Qi+`;
__p += '`),Bt&&(ze+=`' +
((__t = (`+Bt+`)) == null ? '' : __t) +
'`),Oe=Tr+_t.length,_t}),ze+=`';
`;var yt=ln.call(f,"variable")&&f.variable;if(!yt)ze=`with (obj) {
`+ze+`
}
`;else if(Ll.test(yt))throw new St(a);ze=(he?ze.replace(Ke,""):ze).replace(ie,"$1").replace(He,"$1;"),ze="function("+(yt||"obj")+`) {
`+(yt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(oe?", __e = _.escape":"")+(he?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ze+`return __p
}`;var Pt=cw(function(){return qt(W,ct+"return "+ze).apply(t,q)});if(Pt.source=ze,wg(Pt))throw Pt;return Pt}function LD(u){return nn(u).toLowerCase()}function AD(u){return nn(u).toUpperCase()}function CD(u,f,_){if(u=nn(u),u&&(_||f===t))return _b(u);if(!u||!(f=wr(f)))return u;var M=us(u),I=us(f),W=vb(M,I),q=bb(M,I)+1;return Ko(M,W,q).join("")}function RD(u,f,_){if(u=nn(u),u&&(_||f===t))return u.slice(0,wb(u)+1);if(!u||!(f=wr(f)))return u;var M=us(u),I=bb(M,us(f))+1;return Ko(M,0,I).join("")}function PD(u,f,_){if(u=nn(u),u&&(_||f===t))return u.replace(as,"");if(!u||!(f=wr(f)))return u;var M=us(u),I=vb(M,us(f));return Ko(M,I).join("")}function ID(u,f){var _=T,M=k;if(Rn(f)){var I="separator"in f?f.separator:I;_="length"in f?Rt(f.length):_,M="omission"in f?wr(f.omission):M}u=nn(u);var W=u.length;if(Rl(u)){var q=us(u);W=q.length}if(_>=W)return u;var oe=_-Pl(M);if(oe<1)return M;var he=q?Ko(q,0,oe).join(""):u.slice(0,oe);if(I===t)return he+M;if(q&&(oe+=he.length-oe),Sg(I)){if(u.slice(oe).search(I)){var Oe,Fe=he;for(I.global||(I=zm(I.source,nn(rd.exec(I))+"g")),I.lastIndex=0;Oe=I.exec(Fe);)var ze=Oe.index;he=he.slice(0,ze===t?oe:ze)}}else if(u.indexOf(wr(I),oe)!=oe){var $e=he.lastIndexOf(I);$e>-1&&(he=he.slice(0,$e))}return he+M}function DD(u){return u=nn(u),u&&qe.test(u)?u.replace(xe,l2):u}var ND=Ul(function(u,f,_){return u+(_?" ":"")+f.toUpperCase()}),Eg=ux("toUpperCase");function lw(u,f,_){return u=nn(u),f=_?t:f,f===t?i2(u)?h2(u):YC(u):u.match(f)||[]}var cw=Dt(function(u,f){try{return br(u,t,f)}catch(_){return wg(_)?_:new St(_)}}),OD=ao(function(u,f){return Fr(f,function(_){_=Ps(_),so(u,_,bg(u[_],u))}),u});function kD(u){var f=u==null?0:u.length,_=mt();return u=f?An(u,function(M){if(typeof M[1]!="function")throw new Ur(o);return[_(M[0]),M[1]]}):[],Dt(function(M){for(var I=-1;++I<f;){var W=u[I];if(br(W[0],this,M))return br(W[1],this,M)}})}function FD(u){return lR(Wr(u,d))}function Lg(u){return function(){return u}}function UD(u,f){return u==null||u!==u?f:u}var zD=dx(),WD=dx(!0);function dr(u){return u}function Ag(u){return Gb(typeof u=="function"?u:Wr(u,d))}function VD(u){return Hb(Wr(u,d))}function GD(u,f){return Zb(u,Wr(f,d))}var BD=Dt(function(u,f){return function(_){return cu(_,u,f)}}),HD=Dt(function(u,f){return function(_){return cu(u,_,f)}});function Cg(u,f,_){var M=gi(f),I=Md(f,M);_==null&&!(Rn(f)&&(I.length||!M.length))&&(_=f,f=u,u=this,I=Md(f,gi(f)));var W=!(Rn(_)&&"chain"in _)||!!_.chain,q=co(u);return Fr(I,function(oe){var he=f[oe];u[oe]=he,q&&(u.prototype[oe]=function(){var Oe=this.__chain__;if(W||Oe){var Fe=u(this.__wrapped__),ze=Fe.__actions__=cr(this.__actions__);return ze.push({func:he,args:arguments,thisArg:u}),Fe.__chain__=Oe,Fe}return he.apply(u,Bo([this.value()],arguments))})}),u}function ZD(){return bi._===this&&(bi._=y2),this}function Rg(){}function XD(u){return u=Rt(u),Dt(function(f){return Xb(f,u)})}var jD=ag(An),YD=ag(fb),KD=ag(Im);function uw(u){return pg(u)?Dm(Ps(u)):TR(u)}function JD(u){return function(f){return u==null?t:ka(u,f)}}var QD=px(),$D=px(!0);function Pg(){return[]}function Ig(){return!1}function qD(){return{}}function eN(){return""}function tN(){return!0}function nN(u,f){if(u=Rt(u),u<1||u>J)return[];var _=Le,M=Oi(u,Le);f=mt(f),u-=Le;for(var I=km(M,f);++_<u;)f(_);return I}function iN(u){return Mt(u)?An(u,Ps):Sr(u)?[u]:cr(Rx(nn(u)))}function rN(u){var f=++m2;return nn(u)+f}var sN=Rd(function(u,f){return u+f},0),oN=lg("ceil"),aN=Rd(function(u,f){return u/f},1),lN=lg("floor");function cN(u){return u&&u.length?Sd(u,dr,jm):t}function uN(u,f){return u&&u.length?Sd(u,mt(f,2),jm):t}function hN(u){return gb(u,dr)}function dN(u,f){return gb(u,mt(f,2))}function fN(u){return u&&u.length?Sd(u,dr,Qm):t}function pN(u,f){return u&&u.length?Sd(u,mt(f,2),Qm):t}var mN=Rd(function(u,f){return u*f},1),gN=lg("round"),yN=Rd(function(u,f){return u-f},0);function _N(u){return u&&u.length?Om(u,dr):0}function vN(u,f){return u&&u.length?Om(u,mt(f,2)):0}return F.after=VI,F.ary=Vx,F.assign=A3,F.assignIn=tw,F.assignInWith=Bd,F.assignWith=C3,F.at=R3,F.before=Gx,F.bind=bg,F.bindAll=OD,F.bindKey=Bx,F.castArray=qI,F.chain=Ux,F.chunk=lP,F.compact=cP,F.concat=uP,F.cond=kD,F.conforms=FD,F.constant=Lg,F.countBy=_I,F.create=P3,F.curry=Hx,F.curryRight=Zx,F.debounce=Xx,F.defaults=I3,F.defaultsDeep=D3,F.defer=GI,F.delay=BI,F.difference=hP,F.differenceBy=dP,F.differenceWith=fP,F.drop=pP,F.dropRight=mP,F.dropRightWhile=gP,F.dropWhile=yP,F.fill=_P,F.filter=bI,F.flatMap=SI,F.flatMapDeep=MI,F.flatMapDepth=TI,F.flatten=Nx,F.flattenDeep=vP,F.flattenDepth=bP,F.flip=HI,F.flow=zD,F.flowRight=WD,F.fromPairs=xP,F.functions=W3,F.functionsIn=V3,F.groupBy=EI,F.initial=SP,F.intersection=MP,F.intersectionBy=TP,F.intersectionWith=EP,F.invert=B3,F.invertBy=H3,F.invokeMap=AI,F.iteratee=Ag,F.keyBy=CI,F.keys=gi,F.keysIn=hr,F.map=Fd,F.mapKeys=X3,F.mapValues=j3,F.matches=VD,F.matchesProperty=GD,F.memoize=zd,F.merge=Y3,F.mergeWith=nw,F.method=BD,F.methodOf=HD,F.mixin=Cg,F.negate=Wd,F.nthArg=XD,F.omit=K3,F.omitBy=J3,F.once=ZI,F.orderBy=RI,F.over=jD,F.overArgs=XI,F.overEvery=YD,F.overSome=KD,F.partial=xg,F.partialRight=jx,F.partition=PI,F.pick=Q3,F.pickBy=iw,F.property=uw,F.propertyOf=JD,F.pull=RP,F.pullAll=kx,F.pullAllBy=PP,F.pullAllWith=IP,F.pullAt=DP,F.range=QD,F.rangeRight=$D,F.rearg=jI,F.reject=NI,F.remove=NP,F.rest=YI,F.reverse=_g,F.sampleSize=kI,F.set=q3,F.setWith=eD,F.shuffle=FI,F.slice=OP,F.sortBy=WI,F.sortedUniq=GP,F.sortedUniqBy=BP,F.split=SD,F.spread=KI,F.tail=HP,F.take=ZP,F.takeRight=XP,F.takeRightWhile=jP,F.takeWhile=YP,F.tap=cI,F.throttle=JI,F.thru=kd,F.toArray=$x,F.toPairs=rw,F.toPairsIn=sw,F.toPath=iN,F.toPlainObject=ew,F.transform=tD,F.unary=QI,F.union=KP,F.unionBy=JP,F.unionWith=QP,F.uniq=$P,F.uniqBy=qP,F.uniqWith=eI,F.unset=nD,F.unzip=vg,F.unzipWith=Fx,F.update=iD,F.updateWith=rD,F.values=Vl,F.valuesIn=sD,F.without=tI,F.words=lw,F.wrap=$I,F.xor=nI,F.xorBy=iI,F.xorWith=rI,F.zip=sI,F.zipObject=oI,F.zipObjectDeep=aI,F.zipWith=lI,F.entries=rw,F.entriesIn=sw,F.extend=tw,F.extendWith=Bd,Cg(F,F),F.add=sN,F.attempt=cw,F.camelCase=cD,F.capitalize=ow,F.ceil=oN,F.clamp=oD,F.clone=e3,F.cloneDeep=n3,F.cloneDeepWith=i3,F.cloneWith=t3,F.conformsTo=r3,F.deburr=aw,F.defaultTo=UD,F.divide=aN,F.endsWith=uD,F.eq=ds,F.escape=hD,F.escapeRegExp=dD,F.every=vI,F.find=xI,F.findIndex=Ix,F.findKey=N3,F.findLast=wI,F.findLastIndex=Dx,F.findLastKey=O3,F.floor=lN,F.forEach=zx,F.forEachRight=Wx,F.forIn=k3,F.forInRight=F3,F.forOwn=U3,F.forOwnRight=z3,F.get=Mg,F.gt=s3,F.gte=o3,F.has=G3,F.hasIn=Tg,F.head=Ox,F.identity=dr,F.includes=LI,F.indexOf=wP,F.inRange=aD,F.invoke=Z3,F.isArguments=za,F.isArray=Mt,F.isArrayBuffer=a3,F.isArrayLike=ur,F.isArrayLikeObject=Bn,F.isBoolean=l3,F.isBuffer=Jo,F.isDate=c3,F.isElement=u3,F.isEmpty=h3,F.isEqual=d3,F.isEqualWith=f3,F.isError=wg,F.isFinite=p3,F.isFunction=co,F.isInteger=Yx,F.isLength=Vd,F.isMap=Kx,F.isMatch=m3,F.isMatchWith=g3,F.isNaN=y3,F.isNative=_3,F.isNil=b3,F.isNull=v3,F.isNumber=Jx,F.isObject=Rn,F.isObjectLike=On,F.isPlainObject=mu,F.isRegExp=Sg,F.isSafeInteger=x3,F.isSet=Qx,F.isString=Gd,F.isSymbol=Sr,F.isTypedArray=Wl,F.isUndefined=w3,F.isWeakMap=S3,F.isWeakSet=M3,F.join=LP,F.kebabCase=fD,F.last=Gr,F.lastIndexOf=AP,F.lowerCase=pD,F.lowerFirst=mD,F.lt=T3,F.lte=E3,F.max=cN,F.maxBy=uN,F.mean=hN,F.meanBy=dN,F.min=fN,F.minBy=pN,F.stubArray=Pg,F.stubFalse=Ig,F.stubObject=qD,F.stubString=eN,F.stubTrue=tN,F.multiply=mN,F.nth=CP,F.noConflict=ZD,F.noop=Rg,F.now=Ud,F.pad=gD,F.padEnd=yD,F.padStart=_D,F.parseInt=vD,F.random=lD,F.reduce=II,F.reduceRight=DI,F.repeat=bD,F.replace=xD,F.result=$3,F.round=gN,F.runInContext=le,F.sample=OI,F.size=UI,F.snakeCase=wD,F.some=zI,F.sortedIndex=kP,F.sortedIndexBy=FP,F.sortedIndexOf=UP,F.sortedLastIndex=zP,F.sortedLastIndexBy=WP,F.sortedLastIndexOf=VP,F.startCase=MD,F.startsWith=TD,F.subtract=yN,F.sum=_N,F.sumBy=vN,F.template=ED,F.times=nN,F.toFinite=uo,F.toInteger=Rt,F.toLength=qx,F.toLower=LD,F.toNumber=Br,F.toSafeInteger=L3,F.toString=nn,F.toUpper=AD,F.trim=CD,F.trimEnd=RD,F.trimStart=PD,F.truncate=ID,F.unescape=DD,F.uniqueId=rN,F.upperCase=ND,F.upperFirst=Eg,F.each=zx,F.eachRight=Wx,F.first=Ox,Cg(F,function(){var u={};return Cs(F,function(f,_){ln.call(F.prototype,_)||(u[_]=f)}),u}(),{chain:!1}),F.VERSION=i,Fr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){F[u].placeholder=F}),Fr(["drop","take"],function(u,f){Wt.prototype[u]=function(_){_=_===t?1:si(Rt(_),0);var M=this.__filtered__&&!f?new Wt(this):this.clone();return M.__filtered__?M.__takeCount__=Oi(_,M.__takeCount__):M.__views__.push({size:Oi(_,Le),type:u+(M.__dir__<0?"Right":"")}),M},Wt.prototype[u+"Right"]=function(_){return this.reverse()[u](_).reverse()}}),Fr(["filter","map","takeWhile"],function(u,f){var _=f+1,M=_==re||_==V;Wt.prototype[u]=function(I){var W=this.clone();return W.__iteratees__.push({iteratee:mt(I,3),type:_}),W.__filtered__=W.__filtered__||M,W}}),Fr(["head","last"],function(u,f){var _="take"+(f?"Right":"");Wt.prototype[u]=function(){return this[_](1).value()[0]}}),Fr(["initial","tail"],function(u,f){var _="drop"+(f?"":"Right");Wt.prototype[u]=function(){return this.__filtered__?new Wt(this):this[_](1)}}),Wt.prototype.compact=function(){return this.filter(dr)},Wt.prototype.find=function(u){return this.filter(u).head()},Wt.prototype.findLast=function(u){return this.reverse().find(u)},Wt.prototype.invokeMap=Dt(function(u,f){return typeof u=="function"?new Wt(this):this.map(function(_){return cu(_,u,f)})}),Wt.prototype.reject=function(u){return this.filter(Wd(mt(u)))},Wt.prototype.slice=function(u,f){u=Rt(u);var _=this;return _.__filtered__&&(u>0||f<0)?new Wt(_):(u<0?_=_.takeRight(-u):u&&(_=_.drop(u)),f!==t&&(f=Rt(f),_=f<0?_.dropRight(-f):_.take(f-u)),_)},Wt.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Wt.prototype.toArray=function(){return this.take(Le)},Cs(Wt.prototype,function(u,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),M=/^(?:head|last)$/.test(f),I=F[M?"take"+(f=="last"?"Right":""):f],W=M||/^find/.test(f);I&&(F.prototype[f]=function(){var q=this.__wrapped__,oe=M?[1]:arguments,he=q instanceof Wt,Oe=oe[0],Fe=he||Mt(q),ze=function(Ot){var Bt=I.apply(F,Bo([Ot],oe));return M&&$e?Bt[0]:Bt};Fe&&_&&typeof Oe=="function"&&Oe.length!=1&&(he=Fe=!1);var $e=this.__chain__,ct=!!this.__actions__.length,yt=W&&!$e,Pt=he&&!ct;if(!W&&Fe){q=Pt?q:new Wt(this);var _t=u.apply(q,oe);return _t.__actions__.push({func:kd,args:[ze],thisArg:t}),new zr(_t,$e)}return yt&&Pt?u.apply(this,oe):(_t=this.thru(ze),yt?M?_t.value()[0]:_t.value():_t)})}),Fr(["pop","push","shift","sort","splice","unshift"],function(u){var f=ld[u],_=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",M=/^(?:pop|shift)$/.test(u);F.prototype[u]=function(){var I=arguments;if(M&&!this.__chain__){var W=this.value();return f.apply(Mt(W)?W:[],I)}return this[_](function(q){return f.apply(Mt(q)?q:[],I)})}}),Cs(Wt.prototype,function(u,f){var _=F[f];if(_){var M=_.name+"";ln.call(Ol,M)||(Ol[M]=[]),Ol[M].push({name:f,func:_})}}),Ol[Cd(t,g).name]=[{name:"wrapper",func:t}],Wt.prototype.clone=D2,Wt.prototype.reverse=N2,Wt.prototype.value=O2,F.prototype.at=uI,F.prototype.chain=hI,F.prototype.commit=dI,F.prototype.next=fI,F.prototype.plant=mI,F.prototype.reverse=gI,F.prototype.toJSON=F.prototype.valueOf=F.prototype.value=yI,F.prototype.first=F.prototype.head,nu&&(F.prototype[nu]=pI),F},Il=d2();Pa?((Pa.exports=Il)._=Il,Am._=Il):bi._=Il}).call(ku)})(Wp,Wp.exports);var l8=Wp.exports,c8=Object.defineProperty,u8=(n,e,t)=>e in n?c8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,h8=(n,e,t)=>u8(n,e+"",t);let Jh=class extends Wo{constructor(n){super(n),h8(this,"_baseType","Point"),this._threeGeometry=this._createThreeGeometry(),this._style&&this._style.applyTo(this._threeGeometry)}_coordsTransform(){const n=this.getMap(),e=new U(this._geometry.coordinates[0],this._geometry.coordinates[1],this._geometry.coordinates[2]||0);return n?n.geo2world(e):e}_toThreeJSGeometry(){}_createThreeGeometry(){return new Xc(new fn,new Zc({size:1,color:8947848}))}};var d8=Object.defineProperty,f8=(n,e,t)=>e in n?d8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,p8=(n,e,t)=>f8(n,e+"",t);const m8={};class Ii extends Jh{constructor(e){super(e),p8(this,"_type","Maker")}async _toThreeJSGeometry(){this._position=this._coordsTransform(),this._style&&(this._threeGeometry&&this._disposeGeometry(),this._threeGeometry=await this._createObject(this._style),this._updateGeometry())}async _createObject(e){switch(e.config.type){case"basic-point":return FA(e.config,new U(0,0,0));case"icon-point":return Jj(e.config,this._position);case"icon-label-point":return sY(e.config,this._position);default:throw new Error(`: ${e.config.type}`)}}_calculateCollisionBoundingBox(e,t){var i;if(!this.visible||!this._threeGeometry||!e||!t)return null;try{switch((i=this._style)==null?void 0:i.config.type){case"icon-point":return this._calculateSpriteBoundingBox(this._threeGeometry);default:return this._getFallbackBoundingBox()}}catch(r){return console.warn(`Maker ${this._id} :`,r),this._getFallbackBoundingBox()}}_calculateSpriteBoundingBox(e){try{const t=Math.max(Math.abs(e.scale.x),Math.abs(e.scale.y))/.002;return{width:t,height:t,offsetX:-t/2,offsetY:-t/2}}catch{return{width:20,height:20,offsetX:-10,offsetY:-10}}}_getFallbackBoundingBox(){var e;switch((e=this.getStyle())==null?void 0:e.config.type){case"icon-point":case"icon-label-point":return{width:20,height:20,offsetX:-10,offsetY:-10};case"basic-point":return{width:10,height:10,offsetX:-5,offsetY:-5};default:return{width:15,height:15,offsetX:-7.5,offsetY:-7.5}}}}Ii.mergeOptions(m8);var g8=Object.defineProperty,y8=(n,e,t)=>e in n?g8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,jM=(n,e,t)=>y8(n,typeof e!="symbol"?e+"":e,t);class ZA extends Wo{constructor(e){super(e),jM(this,"_baseType","Line"),jM(this,"_vertexPoints"),this._threeGeometry=this._createThreeGeometry(),this._vertexPoints=[0,0,0],this._style&&this._style.applyTo(this._threeGeometry)}_coordsTransform(){const e=this.getMap(),t=this._geometry,i=e==null?void 0:e.prjcenter;if(this._geometry.type==="LineString"){let r=t.coordinates.map(o=>{const a=new U(o[0],o[1],o[2]||0);return(e?e.geo2world(a):a).sub(i)}),s=r.flatMap(o=>[o.x,o.y,o.z]);return{_position:r,_vertexPoints:s}}}_toThreeJSGeometry(){}_createThreeGeometry(){const e=new vm,t=new Kh({color:8947848,linewidth:.1,dashed:!1,resolution:new Ie(window.innerWidth,window.innerHeight)});return new kv(e,t)}}var _8=Object.defineProperty,v8=(n,e,t)=>e in n?_8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,b8=(n,e,t)=>v8(n,e+"",t);const x8={};class Ys extends ZA{constructor(e){super(e),b8(this,"_type","LineString")}async _toThreeJSGeometry(){let{_vertexPoints:e}=this._coordsTransform();this._vertexPoints=e,this._style&&(this._threeGeometry&&this._disposeGeometry(),this._threeGeometry=await this._createObject(this._style),this._updateGeometry())}async _createObject(e){switch(e.config.type){case"basic-line":return Vv(e.config,this._vertexPoints);default:throw new Error(`: ${e.config.type}`)}}_updateGeometry(){const e=this.getMap();if(this._disposeGeometry(),this._threeGeometry){const t=this._threeGeometry.geometry;t.setPositions(this._vertexPoints),t.computeBoundingSphere(),t.computeBoundingBox(),this._threeGeometry.position.add(e==null?void 0:e.prjcenter),this._threeGeometry.renderOrder=99,this.add(this._threeGeometry),this.updateMatrixWorld(!0),this._tryProcessQueue()}}}Ys.mergeOptions(x8);var w8=Object.defineProperty,S8=(n,e,t)=>e in n?w8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,YM=(n,e,t)=>S8(n,typeof e!="symbol"?e+"":e,t);class M8 extends Wo{constructor(e){super(e),YM(this,"_baseType","Surface"),YM(this,"_vertexPoints"),this._threeGeometry=this._createThreeGeometry(),this._vertexPoints=[0,0,0],this._style&&this._style.applyTo(this._threeGeometry)}_coordsTransform(){const e=this.getMap(),t=e==null?void 0:e.prjcenter,i=this._geometry;if(!i)throw new Error("");if(i.type==="Polygon"){const r=i.coordinates;let s=[],o=[];return r.forEach(a=>{const l=a.map(c=>{const h=new U(c[0],c[1],c[2]||0);return(e?e.geo2world(h):h).sub(t)});s.push(l),o.push(...l.flatMap(c=>[c.x,c.y,c.z]))}),{_positions:s,_vertexPoints:o}}else if(i.type==="MultiPolygon"){const r=i.coordinates;let s=[],o=[];return r.forEach(a=>{const l=[];a.forEach(c=>{const h=c.map(d=>{const p=new U(d[0],d[1],d[2]||0);return(e?e.geo2world(p):p).sub(t)});l.push(h),o.push(...h.flatMap(d=>[d.x,d.y,d.z]))}),s.push(l)}),{_positions:s,_vertexPoints:o}}else throw new Error(`: ${i.type}`)}_updateGeometry(){var i,r;const e=(i=this._style)==null?void 0:i.config.type;if(this.clear(),!this._threeGeometry||!((r=this._vertexPoints)!=null&&r.length)){console.warn("");return}const t=this.getMap();try{e==="basic-polygon"?(this._threeGeometry.renderOrder=90,this._threeGeometry.position.add(t==null?void 0:t.prjcenter),this._threeGeometry.updateMatrix(),this.add(this._threeGeometry)):(e==="extrude-polygon"||e!=null&&e.includes("water"))&&(this._threeGeometry.renderOrder=90,this._threeGeometry.position.add(t==null?void 0:t.prjcenter),this._threeGeometry.updateMatrix(),this.add(this._threeGeometry))}catch(s){throw console.error(":",s),s}}_createThreeGeometry(){const e=new vm,t=new Kh({color:8947848,linewidth:.1,dashed:!1,resolution:new Ie(window.innerWidth,window.innerHeight)});return new kv(e,t)}}var T8=Object.defineProperty,E8=(n,e,t)=>e in n?T8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,L8=(n,e,t)=>E8(n,e+"",t);const A8={};class $s extends M8{constructor(e){super(e),L8(this,"_type","Polygon")}async _toThreeJSGeometry(){let{_vertexPoints:e}=this._coordsTransform();this._vertexPoints=e,this._style&&(this._threeGeometry&&this.remove(this._threeGeometry),this._threeGeometry=await this._createObject(this._style),this._updateGeometry(),await this._style.applyTo(this._threeGeometry))}async _createObject(e){switch(e.config.type){case"basic-polygon":return $j(e.config,this._vertexPoints);case"extrude-polygon":return qj(e.config,this._vertexPoints);case"water":return eY(e.config,this.getMap(),this._vertexPoints);case"base-water":return tY(e.config,this._vertexPoints);default:throw new Error(`: ${e.config.type}`)}}_calculateCollisionBoundingBox(){return null}}$s.mergeOptions(A8);var C8=Object.defineProperty,R8=(n,e,t)=>e in n?C8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ky=(n,e,t)=>R8(n,typeof e!="symbol"?e+"":e,t);const P8={};class Zv extends ZA{constructor(e){super(e),Ky(this,"_type","MultiLineString"),Ky(this,"_lineObjects",[]),Ky(this,"_linesContainer"),this._linesContainer=new sr}async _toThreeJSGeometry(){const{_position:e}=this._coordsTransform(),t=this.getMap();if(this.clearLines(),this._disposeGeometry(),this._style){for(const i of e){const r=i.flatMap(o=>[o.x,o.y,o.z]),s=await this._createLineObject(this._style,r);s.position.add(t==null?void 0:t.prjcenter),s.updateMatrixWorld(!0),s.renderOrder=99,this._lineObjects.push(s),this._linesContainer.add(s)}this._linesContainer.renderOrder=99,this._threeGeometry=this._linesContainer,this.add(this._threeGeometry),this._updateContainer(),this.updateMatrixWorld(!0),this._threeGeometry.updateMatrixWorld(!0),this._tryProcessQueue()}}async _createLineObject(e,t){switch(e.config.type){case"basic-line":return Vv(e.config,t);default:throw new Error(`: ${e.config.type}`)}}_coordsTransform(){const e=this.getMap(),t=this._geometry;if(this._geometry.type==="MultiLineString"){const i=e==null?void 0:e.prjcenter;return{_position:t.coordinates.map(r=>r.map(s=>{const o=new U(s[0],s[1],s[2]||0);return(e?e.geo2world(o):o).sub(i)}))}}}_updateContainer(){this._linesContainer.updateMatrixWorld(!0)}clearLines(){this._lineObjects.forEach(e=>{this._linesContainer.remove(e),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}),this._lineObjects=[]}_updateGeometry(){this._toThreeJSGeometry()}_disposeObject(){}}Zv.mergeOptions(P8);var I8=Object.defineProperty,D8=(n,e,t)=>e in n?I8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Fu=(n,e,t)=>D8(n,typeof e!="symbol"?e+"":e,t);const Jy=64;class N8 extends Sl{constructor(e={}){const{shaderOption:t,regionOverlay:i,...r}=e;if(super({color:"rgb(58,126,182)",roughness:.7,metalness:.1,transparent:!0,opacity:.9,envMapIntensity:.8,depthWrite:!0,depthTest:!0,...r}),Fu(this,"shaderOption"),Fu(this,"clock"),Fu(this,"time"),Fu(this,"startTime"),Fu(this,"regionOverlay"),i&&i.vertices&&i.vertices.length>0){const s=i.vertices.slice(0,Jy).map(a=>a.clone()),o=s.length;for(;s.length<Jy;)s.push(new Ie(0,0));this.regionOverlay={color:i.color,opacity:i.opacity,vertices:s,vertexCount:o}}this.shaderOption={minY:0,maxY:100,minRate:.3,maxRate:1.5,effects:{diffusion:{enabled:!1,color:new Ge("#9ECDEC"),width:20,speed:1,maxDistance:100,center:void 0},flow:{enabled:!1,color:new Ge("#00E4FF"),range:10,speed:20},sweep:{enabled:!1,color:new Ge("#FFFFFF"),width:1.5,speed:10}},...t},this.clock=new gm,this.time={value:0},this.startTime={value:0},this.animate()}onBeforeCompile(e){var c,h,d,p,m,y,b,v,g,x,w,S,C,A,E,O,R,T;const{minY:t,maxY:i,minRate:r,maxRate:s,effects:o}=this.shaderOption,a=i-t,l=!!this.regionOverlay;e.uniforms={...e.uniforms,time:this.time,uStartTime:this.startTime,uMinY:{value:t},uMaxY:{value:i},uHeightRange:{value:a},uMinRate:{value:r},uMaxRate:{value:s},uDiffusionEnabled:{value:(c=o==null?void 0:o.diffusion)!=null&&c.enabled?1:0},uDiffusionColor:{value:((h=o==null?void 0:o.diffusion)==null?void 0:h.color)||new Ge("#9ECDEC")},uDiffusionWidth:{value:((d=o==null?void 0:o.diffusion)==null?void 0:d.width)||20},uDiffusionSpeed:{value:((p=o==null?void 0:o.diffusion)==null?void 0:p.speed)||1},uDiffusionMaxDistance:{value:((m=o==null?void 0:o.diffusion)==null?void 0:m.maxDistance)||100},uDiffusionCenter:{value:((y=o==null?void 0:o.diffusion)==null?void 0:y.center)||new U(0,0,0)},uFlowEnabled:{value:(b=o==null?void 0:o.flow)!=null&&b.enabled?1:0},uFlowColor:{value:((v=o==null?void 0:o.flow)==null?void 0:v.color)||new Ge("#00E4FF")},uFlowRange:{value:((g=o==null?void 0:o.flow)==null?void 0:g.range)||10},uFlowSpeed:{value:((x=o==null?void 0:o.flow)==null?void 0:x.speed)||20},uSweepEnabled:{value:(w=o==null?void 0:o.sweep)!=null&&w.enabled?1:0},uSweepColor:{value:((S=o==null?void 0:o.sweep)==null?void 0:S.color)||new Ge("#FFFFFF")},uSweepWidth:{value:((C=o==null?void 0:o.sweep)==null?void 0:C.width)||1.5},uSweepSpeed:{value:((A=o==null?void 0:o.sweep)==null?void 0:A.speed)||10},uRegionOverlayEnabled:{value:l?1:0},uRegionOverlayColor:{value:((E=this.regionOverlay)==null?void 0:E.color)||new Ge("#00FF88")},uRegionOverlayOpacity:{value:((O=this.regionOverlay)==null?void 0:O.opacity)??0},uRegionOverlayVertexCount:{value:((R=this.regionOverlay)==null?void 0:R.vertexCount)??0},uRegionOverlayVertices:{value:((T=this.regionOverlay)==null?void 0:T.vertices)||new Array(Jy).fill(0).map(()=>new Ie(0,0))}},e.vertexShader=`
      varying vec3 vWorldPosition;
      varying vec3 vPosition;
      varying float vHeight;
      ${e.vertexShader}
    `.replace("#include <begin_vertex>",`
      #include <begin_vertex>
      vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
      vPosition = position;
      vHeight = position.y;
      `),e.fragmentShader=`
      #define PI 3.141592653589793
      #define REGION_OVERLAY_MAX_VERTS 64
      varying vec3 vWorldPosition;
      varying vec3 vPosition;
      varying float vHeight;
      uniform float uMinY;
      uniform float uMaxY;
      uniform float uHeightRange;
      uniform float uMinRate;
      uniform float uMaxRate;
      uniform float time;
      uniform float uStartTime;
      uniform int uDiffusionEnabled;
      uniform vec3 uDiffusionColor;
      uniform float uDiffusionWidth;
      uniform float uDiffusionSpeed;
      uniform float uDiffusionMaxDistance;
      uniform vec3 uDiffusionCenter;
      uniform int uFlowEnabled;
      uniform vec3 uFlowColor;
      uniform float uFlowRange;
      uniform float uFlowSpeed;
      uniform int uSweepEnabled;
      uniform vec3 uSweepColor;
      uniform float uSweepWidth;
      uniform float uSweepSpeed;

       //  uniform 
      uniform int uRegionOverlayEnabled;
      uniform vec3 uRegionOverlayColor;
      uniform float uRegionOverlayOpacity;
      uniform int uRegionOverlayVertexCount;
      uniform vec2 uRegionOverlayVertices[REGION_OVERLAY_MAX_VERTS];
      
      
      float distanceTo(vec2 src, vec2 dst) {
        return distance(src, dst);
      }
      
      ${e.fragmentShader}
    `.replace("#include <color_fragment>",`
      #include <color_fragment>
      
      // 
      float normalizedHeight = clamp((vWorldPosition.y - uMinY) / uHeightRange, 0.0, 1.0);
      float heightFactor = smoothstep(0.0, 1.0, normalizedHeight);
      diffuseColor.rgb *= mix(uMinRate, uMaxRate, heightFactor);
      
      // 
      if (uDiffusionEnabled == 1) {
        vec2 position2D = vec2(vWorldPosition.x, vWorldPosition.z);
        vec2 center2D = vec2(uDiffusionCenter.x, uDiffusionCenter.z);
        float distToCenter = distance(position2D, center2D);
        
        float progress = mod(time * uDiffusionSpeed, 1.0);
        float currentRadius = progress * uDiffusionMaxDistance;
        
        if (distToCenter > currentRadius - uDiffusionWidth && 
            distToCenter < currentRadius) {
            float ringFactor = smoothstep(
                currentRadius - uDiffusionWidth,
                currentRadius,
                distToCenter
            );
            
            vec3 highBrightnessColor = uDiffusionColor * 5.0;
            diffuseColor.rgb += highBrightnessColor * (1.0 - ringFactor);
            diffuseColor.rgb = min(diffuseColor.rgb, vec3(2.0));
        }
      }
      
      // 
      if (uFlowEnabled == 1) {
        float dTime = mod(time * uFlowSpeed, uFlowRange * 2.0);
        if (vPosition.z > dTime - uFlowRange && vPosition.z < dTime) {
          float dIndex = sin((dTime - vPosition.z) / uFlowRange * PI);
          diffuseColor.rgb = mix(uFlowColor, diffuseColor.rgb, 1.0 - dIndex);
        }
      }
      
      // 
      if (uSweepEnabled == 1) {
        float sweepPos = mod(time * uSweepSpeed, 2.0);
        if (vHeight > sweepPos - uSweepWidth && vHeight < sweepPos) {
          float sweepFactor = smoothstep(sweepPos - uSweepWidth, sweepPos, vHeight);
          diffuseColor.rgb = mix(uSweepColor, diffuseColor.rgb, 1.0 - sweepFactor);
        }
      }
    // Ray casting 
      if (uRegionOverlayEnabled == 1 && uRegionOverlayOpacity > 0.0 && uRegionOverlayVertexCount >= 3) {
        vec2 p = vec2(vWorldPosition.x, vWorldPosition.z);
        bool inside = false;
        int j = 0;
        for (int i = 0; i < REGION_OVERLAY_MAX_VERTS; i++) {
          if (i >= uRegionOverlayVertexCount) break;
          if (i == 0) {
            j = uRegionOverlayVertexCount - 1;
          }
          vec2 pi = uRegionOverlayVertices[i];
          vec2 pj = uRegionOverlayVertices[j];

          bool intersect = ((pi.y > p.y) != (pj.y > p.y)) &&
            (p.x < (pj.x - pi.x) * (p.y - pi.y) / (pj.y - pi.y + 1e-6) + pi.x);
          if (intersect) {
            inside = !inside;
          }
          j = i;
        }

        if (inside) {
          diffuseColor.rgb = mix(
            diffuseColor.rgb,
            uRegionOverlayColor,
            clamp(uRegionOverlayOpacity, 0.0, 1.0)
          );
        }
      }
      `)}setDiffusionFromObject(e){var o;if(!((o=this.shaderOption.effects)!=null&&o.diffusion))return;const t=new ji().setFromObject(e);if(t.isEmpty())return;const i=new U;t.getCenter(i);const r=[new U(t.min.x,t.min.y,t.min.z),new U(t.max.x,t.max.y,t.max.z)];let s=0;r.forEach(a=>{const l=i.distanceTo(a);l>s&&(s=l)}),this.shaderOption.effects.diffusion={...this.shaderOption.effects.diffusion,center:i,maxDistance:s},this.needsUpdate=!0}updateBoundingBox(e,t){this.shaderOption.minY=e,this.shaderOption.maxY=t,this.needsUpdate=!0}updateEffects(e){this.shaderOption.effects={...this.shaderOption.effects,...e},this.needsUpdate=!0}animate(){requestAnimationFrame(()=>this.animate()),this.time.value=this.clock.getElapsedTime(),this.startTime.value<1&&(this.startTime.value+=.01)}}var O8=Object.defineProperty,k8=(n,e,t)=>e in n?O8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_s=(n,e,t)=>k8(n,typeof e!="symbol"?e+"":e,t);const F8={emissive:!1,emissiveIntensity:1,emissiveColor:"#ffffff"};class Vp extends Jh{constructor(e){super(e),_s(this,"_type","Model"),_s(this,"_emissive",!1),_s(this,"_emissiveIntensity",1),_s(this,"_emissiveColor","#ffffff"),_s(this,"_mixer",null),_s(this,"_currentAction",null),_s(this,"_animations",[]),_s(this,"_clock",new gm),_s(this,"_autoUpdate",!0),_s(this,"_animationRequestId",null),_s(this,"_iscity",!1),this._emissive=e.emissive||!1,this._emissiveIntensity=e.emissiveIntensity||1,this._emissiveColor=e.emissiveColor||"#ffffff",this.castShadow=e.castShadow||!1,this.receiveShadow=e.receiveShadow||!1,this._iscity=e.iscity||!1}async _toThreeJSGeometry(){this._position=this._coordsTransform(),this._style&&(this._threeGeometry&&this._disposeGeometry(),this.modelunino=await this._createObject(this._style),this._threeGeometry=this.modelunino.model,this._threeGeometry.userData._type="Model",this.modelunino.animations&&this.modelunino.animations.length>0&&(this._animations=this.modelunino.animations,this._mixer=new a5(this._threeGeometry),this._startAnimationLoop(),this.playAnimation({name:this._animations[0].name,loop:!0,speed:1.5,fadeInDuration:.5,fadeOutDuration:.3})),this._updateGeometry(),this.setShadows({cast:this.castShadow,receive:this.receiveShadow}),this._applyEmissionProperties(),this._iscity&&this._rendercity())}async _createObject(e){switch(e.config.type){case"fbx":case"gltf":return Qj(e.config,this._position);default:throw new Error(`: ${e.config.type}`)}}_applyEmissionProperties(){this._threeGeometry&&this._threeGeometry.traverse(e=>{if("material"in e){const t=e.material;t&&(t.emissiveIntensity=this._emissive?this._emissiveIntensity:0,t.emissive&&t.emissive.setStyle(this._emissiveColor))}})}get emissive(){return this._emissive}set emissive(e){this._emissive=e,this._applyEmissionProperties()}get emissiveIntensity(){return this._emissiveIntensity}set emissiveIntensity(e){this._emissiveIntensity=e,this._applyEmissionProperties()}get emissiveColor(){return this._emissiveColor}set emissiveColor(e){this._emissiveColor=e,this._applyEmissionProperties()}setEmission(e,t,i){this._emissive=e,t!==void 0&&(this._emissiveIntensity=t),i!==void 0&&(this._emissiveColor=i),this._applyEmissionProperties()}async setShadows(e){this.castShadow=e.cast,this.receiveShadow=e.receive,this._threeGeometry&&this._threeGeometry.traverse(t=>{t.isMesh&&t.material&&(t.castShadow=e.cast,t.receiveShadow=e.receive)})}playAnimation(e){if(!this._mixer||this._animations.length===0){console.warn("");return}this._currentAction&&(e.fadeOutDuration&&e.fadeOutDuration>0?this._currentAction.fadeOut(e.fadeOutDuration):this._currentAction.stop());const t=typeof e.name=="number"?this._animations[e.name]:this._animations.find(i=>i.name===e.name);if(!t){console.warn(`: ${e.name}`);return}this._currentAction=this._mixer.clipAction(t),this._currentAction.setLoop(e.loop?PL:RL,e.loop?1/0:1),this._currentAction.timeScale=e.speed||1,this._currentAction.time=e.startAt||0,this._currentAction.setEffectiveWeight(e.weight||1),e.fadeInDuration&&e.fadeInDuration>0&&this._currentAction.fadeIn(e.fadeInDuration),this._currentAction.play(),this._autoUpdate&&this._animationRequestId===null&&this._startAnimationLoop()}stopAnimation(e={}){this._currentAction&&(e.fadeDuration&&e.fadeDuration>0?(this._currentAction.fadeOut(e.fadeDuration),setTimeout(()=>{this._currentAction&&(this._currentAction.stop(),this._currentAction=null)},e.fadeDuration*1e3)):(this._currentAction.stop(),this._currentAction=null))}setAnimationPaused(e){this._currentAction&&(this._currentAction.paused=e.paused)}setAnimationSpeed(e){this._currentAction&&(this._currentAction.timeScale=e.speed)}updateAnimation(e){this._mixer&&this._mixer.update(e.deltaTime)}getAnimationNames(){return this._animations.map(e=>e.name)}getCurrentAnimationName(){return this._currentAction?this._currentAction.getClip().name:null}getAnimationDuration(e){let t;return typeof e.name=="number"?t=this._animations[e.name]:t=this._animations.find(i=>i.name===e.name),t?t.duration:null}dispose(){this._stopAnimationLoop(),this._mixer&&(this._mixer.stopAllAction(),this._mixer.uncacheRoot(this._threeGeometry)),super.dispose()}_startAnimationLoop(){if(!this._autoUpdate||this._animationRequestId!==null)return;const e=()=>{if(this._mixer){const t=this._clock.getDelta();this._mixer.update(t)}this._animationRequestId=requestAnimationFrame(e)};this._clock.start(),this._animationRequestId=requestAnimationFrame(e)}_stopAnimationLoop(){this._animationRequestId!==null&&(cancelAnimationFrame(this._animationRequestId),this._animationRequestId=null),this._clock.stop()}setAutoUpdate(e){this._autoUpdate=e,e?this._startAnimationLoop():this._stopAnimationLoop()}_computeOverlayVertices(e){var l;const t=e.feature;if(t&&Array.isArray(t._vertexPoints)&&t._vertexPoints.length>=6){const c=((l=t.getMap)==null?void 0:l.call(t))||this.getMap();if(c&&c.prjcenter){const h=c.prjcenter,d=t._vertexPoints,p=[];for(let m=0;m+2<d.length;m+=3){const y=d[m],b=d[m+2],v=h.x+y,g=h.z+b;p.push(new Ie(v,g))}if(p.length>=3)return p}}const i=this.getMap();if(!i||!e.geometry)return null;const r=e.geometry;let s;if(r.type==="Polygon")s=r.coordinates;else if(r.type==="MultiPolygon"){if(!r.coordinates.length)return null;s=r.coordinates[0]}else return null;if(!s.length||!s[0].length)return null;const o=s[0],a=[];for(const c of o){const h=c[0],d=c[1],p=i.geo2world(new U(h,d,0));a.push(new Ie(p.x,p.z))}return a.length<3?null:a}_rendercity(){const e=this.getLayer();let t=null;if(e&&e.getRegionOverlays){const i=e.getRegionOverlays()||[];if(i.length){const r=i.filter(o=>(o.mode??"overlay")==="overlay").sort((o,a)=>(o.zIndex??0)-(a.zIndex??0)),s=r[r.length-1];if(s&&(s.geometry||s.feature)){const o=this._computeOverlayVertices(s);o&&o.length>=3&&(t={color:new Ge(s.color??"#00FF88"),opacity:s.opacity??.3,vertices:o})}}}this.traverse(async i=>{if(i instanceof Xt&&i.material){if(i.castShadow=!0,i.name==="building"){const r=new N8({color:new Ge("#6BA7EC").multiplyScalar(1.8),opacity:.9,shaderOption:{minY:0,maxY:50,minRate:.3,maxRate:1.5,effects:{diffusion:{enabled:!0,color:new Ge("#FFFFF"),width:300,speed:.05},flow:{enabled:!1,color:new Ge("#FFFFF"),range:1e3,speed:3e3},sweep:{enabled:!0,color:new Ge("#ffffff"),width:3,speed:5}}},regionOverlay:t||void 0}),s=new ji().setFromObject(i);r.updateBoundingBox(s.min.y,s.max.y),r.setDiffusionFromObject(i),i.receiveShadow=!1,i.material=r,i.material.needsUpdate=!0}i.name==="grass"&&(i.castShadow=!1,i.receiveShadow=!0,i.material.color=new Ge("#81e4d8ff)").multiplyScalar(.7),i.material.metalness=.2,i.material.roughness=.8,["metalnessMap","normalMap","roughnessMap","specularColorMap"].forEach(r=>{const s=i.material[r];s&&(s.wrapS=s.wrapT=is,s.repeat.set(.3,.3),s.needsUpdate=!0)}),i.material.normalScale=new Ie(3,3))}})}}Vp.mergeOptions(F8);var U8=Object.defineProperty,z8=(n,e,t)=>e in n?U8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,W8=(n,e,t)=>z8(n,e+"",t);const V8={};class XA extends Jh{constructor(e){super(e),W8(this,"_type","Cloud")}async _toThreeJSGeometry(){this._position=this._coordsTransform(),this._style&&(this._threeGeometry&&this._disposeGeometry(),this._threeGeometry=await this._createObject(this._style),this._updateGeometry())}_updateGeometry(){this._disposeGeometry();const e=this.getLayer();this._threeGeometry&&(this._threeGeometry.position.copy(this._position),this._threeGeometry.renderOrder=99,e&&(e._clouds.add(this._threeGeometry),e._clouds.updateMatrixWorld()))}async _createObject(e){switch(e.config.type){case"cloud":return nY(e.config,this._position);default:throw new Error(`: ${e.config.type}`)}}}XA.mergeOptions(V8);var G8=Object.defineProperty,B8=(n,e,t)=>e in n?G8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,H8=(n,e,t)=>B8(n,e+"",t);const Z8={};class jA extends Jh{constructor(e){super(e),H8(this,"_type","Label")}async _toThreeJSGeometry(){this._position=this._coordsTransform(),this._style&&(this._threeGeometry&&this._disposeGeometry(),this._threeGeometry=await this._createObject(this._style),this._updateGeometry())}async _createObject(e){switch(e.config.type){case"canvas-label-fixed":return rY(e.config,new U(0,0,0),this.getMap());case"canvas-label":return iY(e.config,new U(0,0,0));default:throw new Error(`: ${e.config.type}`)}}}jA.mergeOptions(Z8);var X8=Object.defineProperty,j8=(n,e,t)=>e in n?X8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,KM=(n,e,t)=>j8(n,typeof e!="symbol"?e+"":e,t);const Y8={};class YA extends Jh{constructor(e){super(e),KM(this,"_type","TPoints"),KM(this,"_geometries"),this._geometries=e.geometries}async _toThreeJSGeometry(){this._position=this._coordsTransform(),this._style&&(this._threeGeometry&&this._disposeGeometry(),this._threeGeometry=await this._createObject(this._style),this._updateGeometry())}_updateGeometry(){this._threeGeometry&&(this._threeGeometry.points&&this.add(this._threeGeometry.points),this._threeGeometry.InstancedCol&&this.add(this._threeGeometry.InstancedCol),this.updateMatrixWorld(!0))}async _createObject(e){switch(e.config.type){case"light":return fY(e.config,this._geometries,this.getMap());default:throw new Error(`: ${e.config.type}`)}}}YA.mergeOptions(Y8);function gp(n,e){if(!n||n===!0)return!0;if(!Array.isArray(n))return!!n;switch(n[0]){case"all":return n.slice(1).every(t=>gp(t,e));case"any":return n.slice(1).some(t=>gp(t,e));case"!":return!gp(n[1],e);case"==":{const t=zi(n[1],e),i=zi(n[2],e);return Zf(t)==Zf(i)}case"!=":{const t=zi(n[1],e),i=zi(n[2],e);return Zf(t)!=Zf(i)}case">":{const t=zi(n[1],e),i=zi(n[2],e);return aa(t)>aa(i)}case"<":{const t=zi(n[1],e),i=zi(n[2],e);return aa(t)<aa(i)}case">=":{const t=zi(n[1],e),i=zi(n[2],e);return aa(t)>=aa(i)}case"<=":{const t=zi(n[1],e),i=zi(n[2],e);return aa(t)<=aa(i)}case"in":{const t=zi(n[1],e);return n.slice(2).map(i=>zi(i,e)).includes(t)}case"!in":{const t=zi(n[1],e);return!n.slice(2).map(i=>zi(i,e)).includes(t)}case"has":{const t=n[1];return e!=null&&Object.prototype.hasOwnProperty.call(e,t)}case"!has":{const t=n[1];return!(e!=null&&Object.prototype.hasOwnProperty.call(e,t))}default:return!0}}function zi(n,e){if(Array.isArray(n))switch(n[0]){case"get":return e?e[n[1]]:void 0;default:return n}return n}function Zf(n){if(n==null)return null;if(typeof n=="string"){const e=Number(n);if(!isNaN(e)&&n.trim()!=="")return e}return typeof n=="boolean"?n?1:0:n}function aa(n){if(n==null)return 0;if(typeof n=="number")return n;if(typeof n=="boolean")return n?1:0;if(typeof n=="string"){const e=Number(n);return isNaN(e)?0:e}return Number(n)}var K8=Object.defineProperty,J8=(n,e,t)=>e in n?K8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Uu=(n,e,t)=>J8(n,typeof e!="symbol"?e+"":e,t);class Qy extends Ta{constructor(e,t){super(e,t),Uu(this,"TILE_SIZE"),Uu(this,"EXTENT"),Uu(this,"style"),Uu(this,"_tileFeatureMap",new Map),Uu(this,"_activeFeatureFilter"),this.TILE_SIZE=t.tileSize??256,this.EXTENT=t.extent??4096,this.style=t.style||[],this._onMapUpdate=this._onMapUpdate.bind(this)}processTileData(e,t){const i=this.getMap(),r=`${e.z}-${e.x}-${e.y}`,s=this._tileFeatureMap.get(r);if(s&&s.length>0){s.forEach(c=>{c.visible=!0,this.children.some(h=>h&&c&&h.uuid===c.uuid)||c.addTo(this)});return}const o=t.vectorData;if(!o||!o.layers||!i||this.style.length===0)return;const a=[],l=this.style;Object.keys(o.layers).forEach(c=>{const h=o.layers[c];for(let d=0;d<h.length;d++){const p=h[d],m=p.geometry;if(this._activeFeatureFilter&&!this._activeFeatureFilter(p.properties))continue;let y=null;for(const b of l)if(this._evaluateFilter(b.filter,p.properties,c,p.geometry.type)){y=b.style;break}if(y){const b={isVectorTile:!0,tileZ:e.z,tileX:e.x,tileY:e.y,rawCoordinates:m,extent:this.EXTENT,tileSize:this.TILE_SIZE},v=this._createFeatureInstance(p.geometry,p.geometry.type,y,p.properties);v&&(v.userData.tileData=b,v.style=Ms.create(y),v.addTo(this),v.initializeGeometry(),a.push(v))}}}),this._tileFeatureMap.set(r,a)}_evaluateFilter(e,t,i,r){if(!e||e===!0)return!0;const s={...t,$layer:i,$type:r};return gp(e,s)}hideFeaturesByTileKey(e){const t=this._tileFeatureMap.get(e);t&&t.forEach(i=>{i.visible=!1})}removeFeaturesByTileKey(e){this._removeFeaturesByTileKey(e)}_removeFeaturesByTileKey(e){const t=this._tileFeatureMap.get(e);t&&(t.forEach(i=>{i._remove()}),this._tileFeatureMap.delete(e))}_createFeatureInstance(e,t,i,r){const s={geometry:{ismvt:!0,...e},style:i,userData:r};switch(t){case"Point":return new Ii(s);case"LineString":return new Ys(s);default:return null}}setFeatureFilter(e){this._activeFeatureFilter=e}clearFeatureFilter(){this._activeFeatureFilter=void 0}setOpacity(e){this.opacity=e,this._tileFeatureMap.forEach(t=>{t.forEach(i=>{i.material&&(i.material.opacity=e,i.material.transparent=e<1)})})}_onMapUpdate(){}validateFeature(e){return e instanceof Wo}dispose(){this._tileFeatureMap.forEach((e,t)=>{this._removeFeaturesByTileKey(t)}),super.dispose()}}var Q8=Object.defineProperty,$8=(n,e,t)=>e in n?Q8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pr=(n,e,t)=>$8(n,typeof e!="symbol"?e+"":e,t);class KA extends bm{constructor(e,t){super(e,t),this.layerId=e,pr(this,"isTileLayer",!0),pr(this,"layerType","base"),pr(this,"isBaseLayer",!1),pr(this,"_enabled",!0),pr(this,"_visible",!0),pr(this,"_rootTile"),pr(this,"_loader"),pr(this,"_LODThreshold",1),pr(this,"isSceneLayer",!1),pr(this,"opacity",1),pr(this,"source"),pr(this,"projection"),pr(this,"minLevel",2),pr(this,"maxLevel",19),this.source=t.source,this.projection=t.projection,this.minLevel=t.minLevel??2,this.maxLevel=t.maxLevel??19,this._LODThreshold=t.LODThreshold??1,this.opacity=t.opacity??1,this.name=`Layer-${e}`,this._loader=this.createLoader(),this._rootTile=new al,this._rootTile.matrixAutoUpdate=!0,this._rootTile.scale.set(this.projection.mapWidth,this.projection.mapHeight,1),this.add(this._rootTile),this._rootTile.updateMatrix(),this.layerId=e,this.name==="Layer-label-layer"&&this.position.set(0,0,1)}get LODThreshold(){return this._LODThreshold}set LODThreshold(e){this._LODThreshold=e}get loader(){return this._loader}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._rootTile&&(this._rootTile.visible=e&&this._visible)}get ivisible(){return this._visible&&super._visible}set ivisible(e){this._visible=e,this._rootTile&&(this._rootTile.visible=e&&this._enabled)}update(e){if(!(!this._enabled||!this._visible)){try{this._rootTile.update({camera:e,loader:this._loader,minLevel:this.minLevel,maxLevel:this.maxLevel,LODThreshold:this.LODThreshold})}catch{}console.groupEnd()}}_debugTileTree(){this._rootTile.traverse(e=>{e.isTile&&(e.loaded,e.visible,e.inFrustum,e.loaded)})}_getLODThreshold(){return 1}_getCurrentTileLevel(){let e=0;return this._rootTile.traverse(t=>{t.isTile&&t.loaded&&(e=Math.max(e,t.z))}),`: ${e}`}dispose(){this.remove(this._rootTile),this._rootTile.reload(this._loader)}reload(){this._rootTile.reload(this._loader)}setElevation(e){this.position.y=e,this.updateMatrix(),this.updateMatrixWorld(!0)}raiseElevation(e){this.position.z+=e,this.updateMatrix(),this.updateMatrixWorld(!0)}getElevation(){return this.position.y}}var q8=Object.defineProperty,eK=(n,e,t)=>e in n?q8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,tK=(n,e,t)=>eK(n,e+"",t);class nK extends rA{constructor(){super(...arguments),tK(this,"onParseEnd")}parseEnd(e){this.onParseEnd&&this.onParseEnd(e)}}const Jn={manager:new nK,demLoaderMap:new Map,meshLoaderMap:new Map,imgLoaderMap:new Map,registerMaterialLoader(n){Jn.imgLoaderMap.set(n.dataType,n),n.info.author=n.info.author??Dy.name},registerGeometryLoader(n){Jn.demLoaderMap.set(n.dataType,n),n.info.author=n.info.author??Dy.name},registerMeshLoader(n){Jn.meshLoaderMap.set(n.dataType,n),n.info.author=n.info.author??Dy.name},getMaterialLoader(n){const e=Jn.imgLoaderMap.get(n.dataType);if(e)return e;throw`Source dataType "${n.dataType}" is not support!`},getGeometryLoader(n){const e=Jn.demLoaderMap.get(n.dataType);if(e)return e;throw`Source dataType "${n.dataType}" is not support!`},getMeshLoader(n){const e=Jn.meshLoaderMap.get(n.dataType);if(e)return e;throw`Source dataType "${n.dataType}" is not support!`}};function JA(n,e){const t=Math.floor(n[0]*e),i=Math.floor(n[1]*e),r=Math.floor((n[2]-n[0])*e),s=Math.floor((n[3]-n[1])*e);return{sx:t,sy:i,sw:r,sh:s}}function QA(n,e,t,i){if(i<n.minLevel)return{url:void 0,clipBounds:[0,0,1,1]};if(i<=n.maxLevel)return{url:n._getUrl(e,t,i),clipBounds:[0,0,1,1]};const r=iK(e,t,i,n.maxLevel),s=r.parentNO;return{url:n._getUrl(s.x,s.y,s.z),clipBounds:r.bounds}}function iK(n,e,t,i){const r=t-i,s={x:n>>r,y:e>>r,z:t-r},o=Math.pow(2,r),a=Math.pow(.5,r),l=n%o/o-.5+a/2,c=e%o/o-.5+a/2,h=new Ie(l,c),d=new l5().setFromCenterAndSize(h,new Ie(a,a)),p=[d.min.x+.5,d.min.y+.5,d.max.x+.5,d.max.y+.5];return{parentNO:s,bounds:p}}var rK=Object.defineProperty,sK=(n,e,t)=>e in n?rK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Xf=(n,e,t)=>sK(n,typeof e!="symbol"?e+"":e,t);class Xv{constructor(){Xf(this,"_imgSource",[]),Xf(this,"_demSource"),Xf(this,"_vtSource"),Xf(this,"manager",Jn.manager)}get imgSource(){return this._imgSource}set imgSource(e){this._imgSource=e}get demSource(){return this._demSource}set demSource(e){this._demSource=e}get vtSource(){return this._vtSource}set vtSource(e){this._vtSource=e}async load(e){const t=await this.loadGeometry(e),i=await this.loadMaterial(e);console.assert(!!i&&!!t);for(let r=0;r<i.length;r++)t.addGroup(0,1/0,r);return{materials:i,geometry:t}}unload(e){const t=e.material,i=e.geometry;for(let r=0;r<t.length;r++)t[r].dispose();i.dispose()}async loadGeometry(e){let t;if(this.demSource&&e.z>=this.demSource.minLevel&&this._isBoundsInSourceBounds(this.demSource,e.bounds)){const i=Jn.getGeometryLoader(this.demSource),r=this.demSource;t=await i.load({source:r,...e}).catch(s=>(console.error("Load material error",r.dataType,e.x,e.y,e.z),new js)),t.addEventListener("dispose",()=>{i.unload&&i.unload(t)})}else if(this.vtSource&&e.z>=this.vtSource.minLevel&&this._isBoundsInSourceBounds(this.vtSource,e.bounds)){const i=Jn.getMeshLoader(this.vtSource),r=this.vtSource;t=await i.load({source:r,...e}).catch(s=>(console.error("Load geometry error",r.dataType,e.x,e.y,e.z),new js)),t.addEventListener("dispose",()=>{i.unload&&i.unload(t)})}else t=new js;return t}async loadMaterial(e){const t=this.imgSource.filter(i=>e.z>=i.minLevel&&this._isBoundsInSourceBounds(i,e.bounds)).map(async i=>{const r=Jn.getMaterialLoader(i),s=await r.load({source:i,...e}).catch(a=>(console.error("Load material error",i.dataType,e.x,e.y,e.z),new Ir)),o=a=>{r.unload&&r.unload(a.target),a.target.removeEventListener("dispose",o)};return s instanceof Ir||s.addEventListener("dispose",o),s});return Promise.all(t)}_isBoundsInSourceBounds(e,t){const i=e._projectionBounds;return!(t[2]<i[0]||t[3]<i[1]||t[0]>i[2]||t[1]>i[3])}}function jf(...n){const e=n,t=e&&e.length>1&&e[0].constructor||null;if(!t)throw new Error("concatenateTypedArrays - incorrect quantity of arguments or arguments have incompatible data types");const i=e.reduce((o,a)=>o+a.length,0),r=new t(i);let s=0;for(const o of e)r.set(o,s),s+=o.length;return r}function oK(n,e,t,i){const r=aK(e),s=r.length,o=new Float32Array(s*6),a=new Float32Array(s*4),l=new e.constructor(s*6),c=new Float32Array(s*6);for(let d=0;d<s;d++)lK({edge:r[d],edgeIndex:d,attributes:n,skirtHeight:t,newPosition:o,newTexcoord0:a,newTriangles:l,newNormals:c});n.position.value=jf(n.position.value,o),n.texcoord.value=jf(n.texcoord.value,a),n.normal.value=jf(n.normal.value,c);const h=jf(e,l);return{attributes:n,indices:h}}function aK(n){const e=[],t=Array.isArray(n)?n:Array.from(n);for(let r=0;r<t.length;r+=3){const s=t[r],o=t[r+1],a=t[r+2];e.push([s,o],[o,a],[a,s])}e.sort(([r,s],[o,a])=>{const l=Math.min(r,s),c=Math.min(o,a);return l!==c?l-c:Math.max(r,s)-Math.max(o,a)});const i=[];for(let r=0;r<e.length;r++)r+1<e.length&&e[r][0]===e[r+1][1]&&e[r][1]===e[r+1][0]?r++:i.push(e[r]);return i}function lK({edge:n,edgeIndex:e,attributes:t,skirtHeight:i,newPosition:r,newTexcoord0:s,newTriangles:o,newNormals:a}){const l=t.position.value.length,c=e*2,h=c+1;r.set(t.position.value.subarray(n[0]*3,n[0]*3+3),c*3),r[c*3+2]=r[c*3+2]-i,r.set(t.position.value.subarray(n[1]*3,n[1]*3+3),h*3),r[h*3+2]=r[h*3+2]-i,s.set(t.texcoord.value.subarray(n[0]*2,n[0]*2+2),c*2),s.set(t.texcoord.value.subarray(n[1]*2,n[1]*2+2),h*2);const d=e*2*3;o[d]=n[0],o[d+1]=l/3+h,o[d+2]=n[1],o[d+3]=l/3+h,o[d+4]=n[0],o[d+5]=l/3+c,a[d]=0,a[d+1]=0,a[d+2]=1,a[d+3]=0,a[d+4]=0,a[d+5]=1}function cK(n){if(n.length<4)throw new Error(`DEM4: ${n.length}!`);const e=Math.floor(Math.sqrt(n.length)),t=e,i=e,r=$A(i,t);return{attributes:uK(n,i,t),indices:r}}function uK(n,e,t){const i=t*e,r=new Float32Array(i*3),s=new Float32Array(i*2);let o=0;for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=l/(t-1),h=a/(e-1);s[o*2]=c,s[o*2+1]=h,r[o*3]=c-.5,r[o*3+1]=h-.5,r[o*3+2]=n[(e-a-1)*t+l],o++}return{position:{value:r,size:3},texcoord:{value:s,size:2},normal:{value:qA(r,$A(e,t)),size:3}}}function $A(n,e){const t=6*(e-1)*(n-1),i=new Uint16Array(t);let r=0;for(let s=0;s<n-1;s++)for(let o=0;o<e-1;o++){const a=s*e+o,l=a+1,c=a+e,h=c+1,d=r*6;i[d]=a,i[d+1]=l,i[d+2]=c,i[d+3]=c,i[d+4]=l,i[d+5]=h,r++}return i}function qA(n,e){const t=new Float32Array(n.length);for(let i=0;i<e.length;i+=3){const r=e[i]*3,s=e[i+1]*3,o=e[i+2]*3,a=n[r],l=n[r+1],c=n[r+2],h=n[s],d=n[s+1],p=n[s+2],m=n[o],y=n[o+1],b=n[o+2],v=h-a,g=d-l,x=p-c,w=m-a,S=y-l,C=b-c,A=g*C-x*S,E=x*w-v*C,O=v*S-g*w,R=Math.sqrt(A*A+E*E+O*O),T=[0,0,1];if(R>0){const k=1/R;T[0]=A*k,T[1]=E*k,T[2]=O*k}for(let k=0;k<3;k++)t[r+k]=t[s+k]=t[o+k]=T[k]}return t}var hK=Object.defineProperty,dK=(n,e,t)=>e in n?hK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fK=(n,e,t)=>dK(n,e+"",t);class Dh extends js{constructor(){super(...arguments),fK(this,"type","TileGeometry")}setData(e,t=1e3){let i=e instanceof Float32Array?cK(e):e;i=oK(i.attributes,i.indices,t);const{attributes:r,indices:s}=i;return this.setIndex(new Ln(s,1)),this.setAttribute("position",new Ln(r.position.value,r.position.size)),this.setAttribute("uv",new Ln(r.texcoord.value,r.texcoord.size)),this.setAttribute("normal",new Ln(r.normal.value,r.normal.size)),this.computeBoundingBox(),this.computeBoundingSphere(),this}}var pK=Object.defineProperty,mK=(n,e,t)=>e in n?pK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fa=(n,e,t)=>mK(n,typeof e!="symbol"?e+"":e,t);class gK{constructor(e=257){fa(this,"gridSize"),fa(this,"numTriangles"),fa(this,"numParentTriangles"),fa(this,"indices"),fa(this,"coords"),this.gridSize=e;const t=e-1;if(t&t-1)throw new Error(`Expected grid size to be 2^n+1, got ${e}.`);this.numTriangles=t*t*2-2,this.numParentTriangles=this.numTriangles-t*t,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let i=0;i<this.numTriangles;i++){let r=i+2,s=0,o=0,a=0,l=0,c=0,h=0;for(r&1?a=l=c=t:s=o=h=t;(r>>=1)>1;){const p=s+a>>1,m=o+l>>1;r&1?(a=s,l=o,s=c,o=h):(s=a,o=l,a=c,l=h),c=p,h=m}const d=i*4;this.coords[d+0]=s,this.coords[d+1]=o,this.coords[d+2]=a,this.coords[d+3]=l}}createTile(e){return new yK(e,this)}}class yK{constructor(e,t){fa(this,"martini"),fa(this,"terrain"),fa(this,"errors");const i=t.gridSize;if(e.length!==i*i)throw new Error(`Expected terrain data of length ${i*i} (${i} x ${i}), got ${e.length}.`);this.terrain=e,this.martini=t,this.errors=new Float32Array(e.length),this.update()}update(){const{numTriangles:e,numParentTriangles:t,coords:i,gridSize:r}=this.martini,{terrain:s,errors:o}=this;for(let a=e-1;a>=0;a--){const l=a*4,c=i[l+0],h=i[l+1],d=i[l+2],p=i[l+3],m=c+d>>1,y=h+p>>1,b=m+y-h,v=y+c-m,g=(s[h*r+c]+s[p*r+d])/2,x=y*r+m,w=Math.abs(g-s[x]);if(o[x]=Math.max(o[x],w),a<t){const S=(h+v>>1)*r+(c+b>>1),C=(p+v>>1)*r+(d+b>>1);o[x]=Math.max(o[x],o[S],o[C])}}}getGeometryData(e=0){const{gridSize:t,indices:i}=this.martini,{errors:r}=this;let s=0,o=0;const a=t-1;let l,c,h=0;i.fill(0);function d(x,w,S,C,A,E){const O=x+S>>1,R=w+C>>1;Math.abs(x-A)+Math.abs(w-E)>1&&r[R*t+O]>e?(d(A,E,x,w,O,R),d(S,C,A,E,O,R)):(l=w*t+x,c=C*t+S,h=E*t+A,i[l]===0&&(i[l]=++s),i[c]===0&&(i[c]=++s),i[h]===0&&(i[h]=++s),o++)}d(0,0,a,a,a,0),d(a,a,0,0,0,a);const p=s*2,m=o*3,y=new Uint16Array(p),b=new Uint32Array(m);let v=0;function g(x,w,S,C,A,E){const O=x+S>>1,R=w+C>>1;if(Math.abs(x-A)+Math.abs(w-E)>1&&r[R*t+O]>e)g(A,E,x,w,O,R),g(S,C,A,E,O,R);else{const T=i[w*t+x]-1,k=i[C*t+S]-1,Y=i[E*t+A]-1;y[2*T]=x,y[2*T+1]=w,y[2*k]=S,y[2*k+1]=C,y[2*Y]=A,y[2*Y+1]=E,b[v++]=T,b[v++]=k,b[v++]=Y}}return g(0,0,a,a,a,0),g(a,a,0,0,0,a),{attributes:this._getMeshAttributes(this.terrain,y,b),indices:b}}_getMeshAttributes(e,t,i){const r=Math.floor(Math.sqrt(e.length)),s=r-1,o=t.length/2,a=new Float32Array(o*3),l=new Float32Array(o*2);for(let h=0;h<o;h++){const d=t[h*2],p=t[h*2+1],m=p*r+d;a[3*h+0]=d/s-.5,a[3*h+1]=.5-p/s,a[3*h+2]=e[m],l[2*h+0]=d/s,l[2*h+1]=1-p/s}const c=qA(a,i);return{position:{value:a,size:3},texcoord:{value:l,size:2},normal:{value:c,size:3}}}}var _K=Object.defineProperty,vK=(n,e,t)=>e in n?_K(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,JM=(n,e,t)=>vK(n,typeof e!="symbol"?e+"":e,t);class eC{constructor(){JM(this,"info",{version:"0.10.0",description:"Terrain loader base class"}),JM(this,"dataType","")}async load(e){const{source:t,x:i,y:r,z:s}=e,{url:o,clipBounds:a}=QA(t,i,r,s);if(!o)return new Dh;const l=await this.doLoad(o,{source:t,x:i,y:r,z:s,bounds:a});return Jn.manager.parseEnd(o),l}}class bK extends Sl{constructor(e={}){super({transparent:!0,side:ns,...e})}setTexture(e){this.map=e,this.needsUpdate=!0}dispose(){const e=this.map;e&&(e.image instanceof ImageBitmap&&e.image.close(),e.dispose())}}var Vi=(n=>(n[n.Unknown=0]="Unknown",n[n.Point=1]="Point",n[n.Linestring=2]="Linestring",n[n.Polygon=3]="Polygon",n))(Vi||{});class xK{render(e,t,i,r,s=1){switch(e.lineCap="round",e.lineJoin="round",(r.shadowBlur??0)>0&&(e.shadowBlur=r.shadowBlur??2,e.shadowColor=r.shadowColor??"black",e.shadowOffsetX=r.shadowOffset?r.shadowOffset[0]:0,e.shadowOffsetY=r.shadowOffset?r.shadowOffset[1]:0),t){case Vi.Point:e.textAlign="center",e.textBaseline="middle",e.font=r.font??"14px Arial",e.fillStyle=r.fontColor??"white",this._renderPointText(e,i,s,r.textField??"name",r.fontOffset??[0,-8]);break;case Vi.Linestring:this._renderLineString(e,i,s);break;case Vi.Polygon:this._renderPolygon(e,i,s);break;default:console.warn(`Unknown feature type: ${t}`)}(r.fill||t===Vi.Point)&&(e.globalAlpha=r.fillOpacity||.5,e.fillStyle=r.fillColor||r.color||"#3388ff",e.fill(r.fillRule||"evenodd")),(r.stroke??!0)&&(r.weight??1)>0&&(e.globalAlpha=r.opacity||1,e.lineWidth=r.weight||1,e.strokeStyle=r.color||"#3388ff",e.setLineDash(r.dashArray||[]),e.stroke())}_renderPointText(e,t,i=1,r="name",s=[0,0]){const o=t.geometry;e.beginPath();for(const l of o)for(let c=0;c<l.length;c++){const h=l[c];e.arc(h.x*i,h.y*i,2,0,2*Math.PI)}const a=t.properties;a&&a[r]&&e.fillText(a[r],o[0][0].x*i+s[0],o[0][0].y*i+s[1])}_renderLineString(e,t,i){const r=t.geometry;e.beginPath();for(const s of r)for(let o=0;o<s.length;o++){const{x:a,y:l}=s[o];o===0?e.moveTo(a*i,l*i):e.lineTo(a*i,l*i)}}_renderPolygon(e,t,i){const r=t.geometry;e.beginPath();for(let s=0;s<r.length;s++){const o=r[s];for(let a=0;a<o.length;a++){const{x:l,y:c}=o[a];a===0?e.moveTo(l*i,c*i):e.lineTo(l*i,c*i)}e.closePath()}}}var wK=Object.defineProperty,SK=(n,e,t)=>e in n?wK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,QM=(n,e,t)=>SK(n,typeof e!="symbol"?e+"":e,t);class tC{constructor(){QM(this,"info",{version:"0.10.0",description:"Image loader base class"}),QM(this,"dataType","")}async load(e){const{source:t,x:i,y:r,z:s}=e,o=new bK,{url:a,clipBounds:l}=QA(t,i,r,s);if(a){const c=await this.doLoad(a,{source:t,x:i,y:r,z:s,bounds:l});o.map=c,Jn.manager.parseEnd(a)}return o}}var MK=Object.defineProperty,TK=(n,e,t)=>e in n?MK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$y=(n,e,t)=>TK(n,typeof e!="symbol"?e+"":e,t);class EK extends tC{constructor(){super(...arguments),$y(this,"info",{version:"0.10.0",description:"Tile image loader. It can load xyz tile image."}),$y(this,"dataType","image"),$y(this,"loader",new pm(Jn.manager))}async doLoad(e,t){const i=await this.loader.loadAsync(e).catch(o=>new Image(1,1)),r=new In;r.colorSpace=Li;const{bounds:s}=t;return s[2]-s[0]<1?r.image=LK(i,s):r.image=i,r.needsUpdate=!0,r}}function LK(n,e){const t=n.width,i=new OffscreenCanvas(t,t),r=i.getContext("2d"),{sx:s,sy:o,sw:a,sh:l}=JA(e,n.width);return r.drawImage(n,s,o,a,l,0,0,t,t),i}const AK=`{
	"name": "@terra.gl/core",
	"version": "0.0.1-alpha.35",
	"type": "module",
	"files": [
		"dist"
	],
	"main": "./dist/index.umd.cjs",
	"module": "./dist/index.js",
	"types": "./dist/index.d.ts",
	"exports": {
		".": {
			"import": "./dist/index.js",
			"require": "./dist/index.umd.cjs",
			"types": "./dist/index.d.ts"
		}
	},
	"author": {
		"name": "Criska"
	},
	"description": "a map using threejs",
	"license": "Apache-2.0",
	"keywords": [
		"three",
		"gis",
		"tile",
		"map",
		"3D",
		"cesium",
		"mapbox"
	],
	"scripts": {
		"dev": "vite build --watch",
		"build": "tsc && vite build",
		"doc": "npx typedoc --options typedoc.json"
	},
	"peerDependencies": {
		"three": "^0.171.0"
	},
	"publishConfig": {
		"registry": "https://registry.npmjs.org/",
		"access": "public"
	},
	"dependencies": {
		"@mapbox/vector-tile": "^2.0.4",
		"@pmndrs/vanilla": "^1.20.4",
		"@types/earcut": "^3.0.0",
		"@types/geojson": "^7946.0.16",
		"d3-quadtree": "^3.0.1",
		"earcut": "^3.0.1",
		"lodash": "^4.17.21",
		"pbf": "^4.0.1",
		"postprocessing": "^6.37.3",
		"three-stdlib": "^2.36.0"
	},
	"devDependencies": {
		"@types/lodash": "^4.17.20",
		"@types/node": "^24.2.0",
		"typedoc": "^0.28.8",
		"typedoc-plugin-markdown": "^4.7.1",
		"typedoc-vitepress-theme": "^1.0.0-next.0",
		"vue": "^3.5.18"
	}
}
`;var CK=Object.defineProperty,RK=(n,e,t)=>e in n?CK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ar=(n,e,t)=>RK(n,typeof e!="symbol"?e+"":e,t);class xm{constructor(e){Ar(this,"dataType","image"),Ar(this,"attribution","isource"),Ar(this,"minLevel",0),Ar(this,"maxLevel",18),Ar(this,"projectionID","3857"),Ar(this,"url",""),Ar(this,"subdomains",[]),Ar(this,"s",""),Ar(this,"opacity",1),Ar(this,"isTMS",!1),Ar(this,"bounds",[-180,-85,180,85]),Ar(this,"_projectionBounds",[-1/0,-1/0,1/0,1/0]),Ar(this,"tileMaterial"),Object.assign(this,e)}getUrl(e,t,i){const r={...this,x:e,y:t,z:i};return PK(this.url,r)}_getUrl(e,t,i){const r=this.subdomains.length;if(r>0){const o=Math.floor(Math.random()*r);this.s=this.subdomains[o]}const s=this.isTMS?Math.pow(2,i)-1-t:t;return this.getUrl(e,s,i)}static create(e){return new xm(e)}}function PK(n,e){const t=/\{ *([\w_-]+) *\}/g;return n.replace(t,(i,r)=>{const s=e[r]??(()=>{throw new Error(`source url template error, No value provided for variable: ${i}`)})();return typeof s=="function"?s(e):s})}const{version:Vq,author:Gq}=JSON.parse(AK);function nC(n){return Jn.registerMaterialLoader(n),n}function iC(n){return Jn.registerGeometryLoader(n),n}function IK(n){return Jn.registerMeshLoader(n),n}nC(new EK);const rC="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEsoayxkKXtjb25zdCB5PW5ldyBGbG9hdDMyQXJyYXkoay5sZW5ndGgpO2ZvcihsZXQgVj0wO1Y8ZC5sZW5ndGg7Vis9Myl7Y29uc3QgYT1kW1ZdKjMsZT1kW1YrMV0qMyxyPWRbVisyXSozLHM9a1thXSx0PWtbYSsxXSxuPWtbYSsyXSxoPWtbZV0saT1rW2UrMV0sbz1rW2UrMl0sYz1rW3JdLHU9a1tyKzFdLG09a1tyKzJdLHc9aC1zLGw9aS10LGY9by1uLGc9Yy1zLE09dS10LEQ9bS1uLHA9bCpELWYqTSxVPWYqZy13KkQsST13Kk0tbCpnLHo9TWF0aC5zcXJ0KHAqcCtVKlUrSSpJKSx4PVswLDAsMV07aWYoej4wKXtjb25zdCB2PTEvejt4WzBdPXAqdix4WzFdPVUqdix4WzJdPUkqdn1mb3IobGV0IHY9MDt2PDM7disrKXlbYSt2XT15W2Urdl09eVtyK3ZdPXhbdl19cmV0dXJuIHl9dmFyIFc9T2JqZWN0LmRlZmluZVByb3BlcnR5LFA9KGssZCx5KT0+ZCBpbiBrP1coayxkLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTp5fSk6a1tkXT15LF89KGssZCx5KT0+UChrLHR5cGVvZiBkIT0ic3ltYm9sIj9kKyIiOmQseSk7Y2xhc3MgZWV7Y29uc3RydWN0b3IoZD0yNTcpe18odGhpcywiZ3JpZFNpemUiKSxfKHRoaXMsIm51bVRyaWFuZ2xlcyIpLF8odGhpcywibnVtUGFyZW50VHJpYW5nbGVzIiksXyh0aGlzLCJpbmRpY2VzIiksXyh0aGlzLCJjb29yZHMiKSx0aGlzLmdyaWRTaXplPWQ7Y29uc3QgeT1kLTE7aWYoeSZ5LTEpdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBncmlkIHNpemUgdG8gYmUgMl5uKzEsIGdvdCAke2R9LmApO3RoaXMubnVtVHJpYW5nbGVzPXkqeSoyLTIsdGhpcy5udW1QYXJlbnRUcmlhbmdsZXM9dGhpcy5udW1UcmlhbmdsZXMteSp5LHRoaXMuaW5kaWNlcz1uZXcgVWludDMyQXJyYXkodGhpcy5ncmlkU2l6ZSp0aGlzLmdyaWRTaXplKSx0aGlzLmNvb3Jkcz1uZXcgVWludDE2QXJyYXkodGhpcy5udW1UcmlhbmdsZXMqNCk7Zm9yKGxldCBWPTA7Vjx0aGlzLm51bVRyaWFuZ2xlcztWKyspe2xldCBhPVYrMixlPTAscj0wLHM9MCx0PTAsbj0wLGg9MDtmb3IoYSYxP3M9dD1uPXk6ZT1yPWg9eTsoYT4+PTEpPjE7KXtjb25zdCBvPWUrcz4+MSxjPXIrdD4+MTthJjE/KHM9ZSx0PXIsZT1uLHI9aCk6KGU9cyxyPXQscz1uLHQ9aCksbj1vLGg9Y31jb25zdCBpPVYqNDt0aGlzLmNvb3Jkc1tpKzBdPWUsdGhpcy5jb29yZHNbaSsxXT1yLHRoaXMuY29vcmRzW2krMl09cyx0aGlzLmNvb3Jkc1tpKzNdPXR9fWNyZWF0ZVRpbGUoZCl7cmV0dXJuIG5ldyByZShkLHRoaXMpfX1jbGFzcyByZXtjb25zdHJ1Y3RvcihkLHkpe18odGhpcywibWFydGluaSIpLF8odGhpcywidGVycmFpbiIpLF8odGhpcywiZXJyb3JzIik7Y29uc3QgVj15LmdyaWRTaXplO2lmKGQubGVuZ3RoIT09VipWKXRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgdGVycmFpbiBkYXRhIG9mIGxlbmd0aCAke1YqVn0gKCR7Vn0geCAke1Z9KSwgZ290ICR7ZC5sZW5ndGh9LmApO3RoaXMudGVycmFpbj1kLHRoaXMubWFydGluaT15LHRoaXMuZXJyb3JzPW5ldyBGbG9hdDMyQXJyYXkoZC5sZW5ndGgpLHRoaXMudXBkYXRlKCl9dXBkYXRlKCl7Y29uc3R7bnVtVHJpYW5nbGVzOmQsbnVtUGFyZW50VHJpYW5nbGVzOnksY29vcmRzOlYsZ3JpZFNpemU6YX09dGhpcy5tYXJ0aW5pLHt0ZXJyYWluOmUsZXJyb3JzOnJ9PXRoaXM7Zm9yKGxldCBzPWQtMTtzPj0wO3MtLSl7Y29uc3QgdD1zKjQsbj1WW3QrMF0saD1WW3QrMV0saT1WW3QrMl0sbz1WW3QrM10sYz1uK2k+PjEsdT1oK28+PjEsbT1jK3UtaCx3PXUrbi1jLGw9KGVbaCphK25dK2VbbyphK2ldKS8yLGY9dSphK2MsZz1NYXRoLmFicyhsLWVbZl0pO2lmKHJbZl09TWF0aC5tYXgocltmXSxnKSxzPHkpe2NvbnN0IE09KGgrdz4+MSkqYSsobittPj4xKSxEPShvK3c+PjEpKmErKGkrbT4+MSk7cltmXT1NYXRoLm1heChyW2ZdLHJbTV0scltEXSl9fX1nZXRHZW9tZXRyeURhdGEoZD0wKXtjb25zdHtncmlkU2l6ZTp5LGluZGljZXM6Vn09dGhpcy5tYXJ0aW5pLHtlcnJvcnM6YX09dGhpcztsZXQgZT0wLHI9MDtjb25zdCBzPXktMTtsZXQgdCxuLGg9MDtWLmZpbGwoMCk7ZnVuY3Rpb24gaShmLGcsTSxELHAsVSl7Y29uc3QgST1mK00+PjEsej1nK0Q+PjE7TWF0aC5hYnMoZi1wKStNYXRoLmFicyhnLVUpPjEmJmFbeip5K0ldPmQ/KGkocCxVLGYsZyxJLHopLGkoTSxELHAsVSxJLHopKToodD1nKnkrZixuPUQqeStNLGg9VSp5K3AsVlt0XT09PTAmJihWW3RdPSsrZSksVltuXT09PTAmJihWW25dPSsrZSksVltoXT09PTAmJihWW2hdPSsrZSkscisrKX1pKDAsMCxzLHMscywwKSxpKHMscywwLDAsMCxzKTtjb25zdCBvPWUqMixjPXIqMyx1PW5ldyBVaW50MTZBcnJheShvKSxtPW5ldyBVaW50MzJBcnJheShjKTtsZXQgdz0wO2Z1bmN0aW9uIGwoZixnLE0sRCxwLFUpe2NvbnN0IEk9ZitNPj4xLHo9ZytEPj4xO2lmKE1hdGguYWJzKGYtcCkrTWF0aC5hYnMoZy1VKT4xJiZhW3oqeStJXT5kKWwocCxVLGYsZyxJLHopLGwoTSxELHAsVSxJLHopO2Vsc2V7Y29uc3QgeD1WW2cqeStmXS0xLHY9VltEKnkrTV0tMSxBPVZbVSp5K3BdLTE7dVsyKnhdPWYsdVsyKngrMV09Zyx1WzIqdl09TSx1WzIqdisxXT1ELHVbMipBXT1wLHVbMipBKzFdPVUsbVt3KytdPXgsbVt3KytdPXYsbVt3KytdPUF9fXJldHVybiBsKDAsMCxzLHMscywwKSxsKHMscywwLDAsMCxzKSx7YXR0cmlidXRlczp0aGlzLl9nZXRNZXNoQXR0cmlidXRlcyh0aGlzLnRlcnJhaW4sdSxtKSxpbmRpY2VzOm19fV9nZXRNZXNoQXR0cmlidXRlcyhkLHksVil7Y29uc3QgYT1NYXRoLmZsb29yKE1hdGguc3FydChkLmxlbmd0aCkpLGU9YS0xLHI9eS5sZW5ndGgvMixzPW5ldyBGbG9hdDMyQXJyYXkociozKSx0PW5ldyBGbG9hdDMyQXJyYXkocioyKTtmb3IobGV0IGg9MDtoPHI7aCsrKXtjb25zdCBpPXlbaCoyXSxvPXlbaCoyKzFdLGM9byphK2k7c1szKmgrMF09aS9lLS41LHNbMypoKzFdPS41LW8vZSxzWzMqaCsyXT1kW2NdLHRbMipoKzBdPWkvZSx0WzIqaCsxXT0xLW8vZX1jb25zdCBuPUsocyxWKTtyZXR1cm57cG9zaXRpb246e3ZhbHVlOnMsc2l6ZTozfSx0ZXhjb29yZDp7dmFsdWU6dCxzaXplOjJ9LG5vcm1hbDp7dmFsdWU6bixzaXplOjN9fX19Y29uc3QgbmU9ZnVuY3Rpb24oKXt2YXIgaz17fTtrLmRlZmF1bHROb0RhdGFWYWx1ZT0tMzQwMjc5OTkzODc5MDE0ODRlMjIsay5kZWNvZGU9ZnVuY3Rpb24ocixzKXtzPXN8fHt9O3ZhciB0PXMuZW5jb2RlZE1hc2tEYXRhfHxzLmVuY29kZWRNYXNrRGF0YT09PW51bGwsbj1hKHIscy5pbnB1dE9mZnNldHx8MCx0KSxoPXMubm9EYXRhVmFsdWUhPT1udWxsP3Mubm9EYXRhVmFsdWU6ay5kZWZhdWx0Tm9EYXRhVmFsdWUsaT1kKG4scy5waXhlbFR5cGV8fEZsb2F0MzJBcnJheSxzLmVuY29kZWRNYXNrRGF0YSxoLHMucmV0dXJuTWFzayksbz17d2lkdGg6bi53aWR0aCxoZWlnaHQ6bi5oZWlnaHQscGl4ZWxEYXRhOmkucmVzdWx0UGl4ZWxzLG1pblZhbHVlOmkubWluVmFsdWUsbWF4VmFsdWU6bi5waXhlbHMubWF4VmFsdWUsbm9EYXRhVmFsdWU6aH07cmV0dXJuIGkucmVzdWx0TWFzayYmKG8ubWFza0RhdGE9aS5yZXN1bHRNYXNrKSxzLnJldHVybkVuY29kZWRNYXNrJiZuLm1hc2smJihvLmVuY29kZWRNYXNrRGF0YT1uLm1hc2suYml0c2V0P24ubWFzay5iaXRzZXQ6bnVsbCkscy5yZXR1cm5GaWxlSW5mbyYmKG8uZmlsZUluZm89eShuKSxzLmNvbXB1dGVVc2VkQml0RGVwdGhzJiYoby5maWxlSW5mby5iaXREZXB0aHM9VihuKSkpLG99O3ZhciBkPWZ1bmN0aW9uKHIscyx0LG4saCl7dmFyIGk9MCxvPXIucGl4ZWxzLm51bUJsb2Nrc1gsYz1yLnBpeGVscy5udW1CbG9ja3NZLHU9TWF0aC5mbG9vcihyLndpZHRoL28pLG09TWF0aC5mbG9vcihyLmhlaWdodC9jKSx3PTIqci5tYXhaRXJyb3IsbD1OdW1iZXIuTUFYX1ZBTFVFLGY7dD10fHwoci5tYXNrP3IubWFzay5iaXRzZXQ6bnVsbCk7dmFyIGcsTTtnPW5ldyBzKHIud2lkdGgqci5oZWlnaHQpLGgmJnQmJihNPW5ldyBVaW50OEFycmF5KHIud2lkdGgqci5oZWlnaHQpKTtmb3IodmFyIEQ9bmV3IEZsb2F0MzJBcnJheSh1Km0pLHAsVSxJPTA7STw9YztJKyspe3ZhciB6PUkhPT1jP206ci5oZWlnaHQlYztpZih6IT09MClmb3IodmFyIHg9MDt4PD1vO3grKyl7dmFyIHY9eCE9PW8/dTpyLndpZHRoJW87aWYodiE9PTApe3ZhciBBPUkqci53aWR0aCptK3gqdSxUPXIud2lkdGgtdixTPXIucGl4ZWxzLmJsb2Nrc1tpXSxiLEwsRjtTLmVuY29kaW5nPDI/KFMuZW5jb2Rpbmc9PT0wP2I9Uy5yYXdEYXRhOihlKFMuc3R1ZmZlZERhdGEsUy5iaXRzUGVyUGl4ZWwsUy5udW1WYWxpZFBpeGVscyxTLm9mZnNldCx3LEQsci5waXhlbHMubWF4VmFsdWUpLGI9RCksTD0wKTpTLmVuY29kaW5nPT09Mj9GPTA6Rj1TLm9mZnNldDt2YXIgQjtpZih0KWZvcihVPTA7VTx6O1UrKyl7Zm9yKEEmNyYmKEI9dFtBPj4zXSxCPDw9QSY3KSxwPTA7cDx2O3ArKylBJjd8fChCPXRbQT4+M10pLEImMTI4PyhNJiYoTVtBXT0xKSxmPVMuZW5jb2Rpbmc8Mj9iW0wrK106RixsPWw+Zj9mOmwsZ1tBKytdPWYpOihNJiYoTVtBXT0wKSxnW0ErK109biksQjw8PTE7QSs9VH1lbHNlIGlmKFMuZW5jb2Rpbmc8Milmb3IoVT0wO1U8ejtVKyspe2ZvcihwPTA7cDx2O3ArKylmPWJbTCsrXSxsPWw+Zj9mOmwsZ1tBKytdPWY7QSs9VH1lbHNlIGZvcihsPWw+Rj9GOmwsVT0wO1U8ejtVKyspe2ZvcihwPTA7cDx2O3ArKylnW0ErK109RjtBKz1UfWlmKFMuZW5jb2Rpbmc9PT0xJiZMIT09Uy5udW1WYWxpZFBpeGVscyl0aHJvdyJCbG9jayBhbmQgTWFzayBkbyBub3QgbWF0Y2giO2krK319fXJldHVybntyZXN1bHRQaXhlbHM6ZyxyZXN1bHRNYXNrOk0sbWluVmFsdWU6bH19LHk9ZnVuY3Rpb24ocil7cmV0dXJue2ZpbGVJZGVudGlmaWVyU3RyaW5nOnIuZmlsZUlkZW50aWZpZXJTdHJpbmcsZmlsZVZlcnNpb246ci5maWxlVmVyc2lvbixpbWFnZVR5cGU6ci5pbWFnZVR5cGUsaGVpZ2h0OnIuaGVpZ2h0LHdpZHRoOnIud2lkdGgsbWF4WkVycm9yOnIubWF4WkVycm9yLGVvZk9mZnNldDpyLmVvZk9mZnNldCxtYXNrOnIubWFzaz97bnVtQmxvY2tzWDpyLm1hc2subnVtQmxvY2tzWCxudW1CbG9ja3NZOnIubWFzay5udW1CbG9ja3NZLG51bUJ5dGVzOnIubWFzay5udW1CeXRlcyxtYXhWYWx1ZTpyLm1hc2subWF4VmFsdWV9Om51bGwscGl4ZWxzOntudW1CbG9ja3NYOnIucGl4ZWxzLm51bUJsb2Nrc1gsbnVtQmxvY2tzWTpyLnBpeGVscy5udW1CbG9ja3NZLG51bUJ5dGVzOnIucGl4ZWxzLm51bUJ5dGVzLG1heFZhbHVlOnIucGl4ZWxzLm1heFZhbHVlLG5vRGF0YVZhbHVlOnIubm9EYXRhVmFsdWV9fX0sVj1mdW5jdGlvbihyKXtmb3IodmFyIHM9ci5waXhlbHMubnVtQmxvY2tzWCpyLnBpeGVscy5udW1CbG9ja3NZLHQ9e30sbj0wO248cztuKyspe3ZhciBoPXIucGl4ZWxzLmJsb2Nrc1tuXTtoLmVuY29kaW5nPT09MD90LmZsb2F0MzI9ITA6aC5lbmNvZGluZz09PTE/dFtoLmJpdHNQZXJQaXhlbF09ITA6dFswXT0hMH1yZXR1cm4gT2JqZWN0LmtleXModCl9LGE9ZnVuY3Rpb24ocixzLHQpe3ZhciBuPXt9LGg9bmV3IFVpbnQ4QXJyYXkocixzLDEwKTtpZihuLmZpbGVJZGVudGlmaWVyU3RyaW5nPVN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxoKSxuLmZpbGVJZGVudGlmaWVyU3RyaW5nLnRyaW0oKSE9PSJDbnRaSW1hZ2UiKXRocm93IlVuZXhwZWN0ZWQgZmlsZSBpZGVudGlmaWVyIHN0cmluZzogIituLmZpbGVJZGVudGlmaWVyU3RyaW5nO3MrPTEwO3ZhciBpPW5ldyBEYXRhVmlldyhyLHMsMjQpO2lmKG4uZmlsZVZlcnNpb249aS5nZXRJbnQzMigwLCEwKSxuLmltYWdlVHlwZT1pLmdldEludDMyKDQsITApLG4uaGVpZ2h0PWkuZ2V0VWludDMyKDgsITApLG4ud2lkdGg9aS5nZXRVaW50MzIoMTIsITApLG4ubWF4WkVycm9yPWkuZ2V0RmxvYXQ2NCgxNiwhMCkscys9MjQsIXQpaWYoaT1uZXcgRGF0YVZpZXcocixzLDE2KSxuLm1hc2s9e30sbi5tYXNrLm51bUJsb2Nrc1k9aS5nZXRVaW50MzIoMCwhMCksbi5tYXNrLm51bUJsb2Nrc1g9aS5nZXRVaW50MzIoNCwhMCksbi5tYXNrLm51bUJ5dGVzPWkuZ2V0VWludDMyKDgsITApLG4ubWFzay5tYXhWYWx1ZT1pLmdldEZsb2F0MzIoMTIsITApLHMrPTE2LG4ubWFzay5udW1CeXRlcz4wKXt2YXIgbz1uZXcgVWludDhBcnJheShNYXRoLmNlaWwobi53aWR0aCpuLmhlaWdodC84KSk7aT1uZXcgRGF0YVZpZXcocixzLG4ubWFzay5udW1CeXRlcyk7dmFyIGM9aS5nZXRJbnQxNigwLCEwKSx1PTIsbT0wO2Rve2lmKGM+MClmb3IoO2MtLTspb1ttKytdPWkuZ2V0VWludDgodSsrKTtlbHNle3ZhciB3PWkuZ2V0VWludDgodSsrKTtmb3IoYz0tYztjLS07KW9bbSsrXT13fWM9aS5nZXRJbnQxNih1LCEwKSx1Kz0yfXdoaWxlKHU8bi5tYXNrLm51bUJ5dGVzKTtpZihjIT09LTMyNzY4fHxtPG8ubGVuZ3RoKXRocm93IlVuZXhwZWN0ZWQgZW5kIG9mIG1hc2sgUkxFIGVuY29kaW5nIjtuLm1hc2suYml0c2V0PW8scys9bi5tYXNrLm51bUJ5dGVzfWVsc2Ugbi5tYXNrLm51bUJ5dGVzfG4ubWFzay5udW1CbG9ja3NZfG4ubWFzay5tYXhWYWx1ZXx8KG4ubWFzay5iaXRzZXQ9bmV3IFVpbnQ4QXJyYXkoTWF0aC5jZWlsKG4ud2lkdGgqbi5oZWlnaHQvOCkpKTtpPW5ldyBEYXRhVmlldyhyLHMsMTYpLG4ucGl4ZWxzPXt9LG4ucGl4ZWxzLm51bUJsb2Nrc1k9aS5nZXRVaW50MzIoMCwhMCksbi5waXhlbHMubnVtQmxvY2tzWD1pLmdldFVpbnQzMig0LCEwKSxuLnBpeGVscy5udW1CeXRlcz1pLmdldFVpbnQzMig4LCEwKSxuLnBpeGVscy5tYXhWYWx1ZT1pLmdldEZsb2F0MzIoMTIsITApLHMrPTE2O3ZhciBsPW4ucGl4ZWxzLm51bUJsb2Nrc1gsZj1uLnBpeGVscy5udW1CbG9ja3NZLGc9bCsobi53aWR0aCVsPjA/MTowKSxNPWYrKG4uaGVpZ2h0JWY+MD8xOjApO24ucGl4ZWxzLmJsb2Nrcz1uZXcgQXJyYXkoZypNKTtmb3IodmFyIEQ9MCxwPTA7cDxNO3ArKylmb3IodmFyIFU9MDtVPGc7VSsrKXt2YXIgST0wLHo9ci5ieXRlTGVuZ3RoLXM7aT1uZXcgRGF0YVZpZXcocixzLE1hdGgubWluKDEwLHopKTt2YXIgeD17fTtuLnBpeGVscy5ibG9ja3NbRCsrXT14O3ZhciB2PWkuZ2V0VWludDgoMCk7aWYoSSsrLHguZW5jb2Rpbmc9diY2Myx4LmVuY29kaW5nPjMpdGhyb3ciSW52YWxpZCBibG9jayBlbmNvZGluZyAoIit4LmVuY29kaW5nKyIpIjtpZih4LmVuY29kaW5nPT09Mil7cysrO2NvbnRpbnVlfWlmKHYhPT0wJiZ2IT09Mil7aWYodj4+PTYseC5vZmZzZXRUeXBlPXYsdj09PTIpeC5vZmZzZXQ9aS5nZXRJbnQ4KDEpLEkrKztlbHNlIGlmKHY9PT0xKXgub2Zmc2V0PWkuZ2V0SW50MTYoMSwhMCksSSs9MjtlbHNlIGlmKHY9PT0wKXgub2Zmc2V0PWkuZ2V0RmxvYXQzMigxLCEwKSxJKz00O2Vsc2UgdGhyb3ciSW52YWxpZCBibG9jayBvZmZzZXQgdHlwZSI7aWYoeC5lbmNvZGluZz09PTEpaWYodj1pLmdldFVpbnQ4KEkpLEkrKyx4LmJpdHNQZXJQaXhlbD12JjYzLHY+Pj02LHgubnVtVmFsaWRQaXhlbHNUeXBlPXYsdj09PTIpeC5udW1WYWxpZFBpeGVscz1pLmdldFVpbnQ4KEkpLEkrKztlbHNlIGlmKHY9PT0xKXgubnVtVmFsaWRQaXhlbHM9aS5nZXRVaW50MTYoSSwhMCksSSs9MjtlbHNlIGlmKHY9PT0wKXgubnVtVmFsaWRQaXhlbHM9aS5nZXRVaW50MzIoSSwhMCksSSs9NDtlbHNlIHRocm93IkludmFsaWQgdmFsaWQgcGl4ZWwgY291bnQgdHlwZSJ9aWYocys9SSx4LmVuY29kaW5nIT09Myl7dmFyIEEsVDtpZih4LmVuY29kaW5nPT09MCl7dmFyIFM9KG4ucGl4ZWxzLm51bUJ5dGVzLTEpLzQ7aWYoUyE9PU1hdGguZmxvb3IoUykpdGhyb3cidW5jb21wcmVzc2VkIGJsb2NrIGhhcyBpbnZhbGlkIGxlbmd0aCI7QT1uZXcgQXJyYXlCdWZmZXIoUyo0KSxUPW5ldyBVaW50OEFycmF5KEEpLFQuc2V0KG5ldyBVaW50OEFycmF5KHIscyxTKjQpKTt2YXIgYj1uZXcgRmxvYXQzMkFycmF5KEEpO3gucmF3RGF0YT1iLHMrPVMqNH1lbHNlIGlmKHguZW5jb2Rpbmc9PT0xKXt2YXIgTD1NYXRoLmNlaWwoeC5udW1WYWxpZFBpeGVscyp4LmJpdHNQZXJQaXhlbC84KSxGPU1hdGguY2VpbChMLzQpO0E9bmV3IEFycmF5QnVmZmVyKEYqNCksVD1uZXcgVWludDhBcnJheShBKSxULnNldChuZXcgVWludDhBcnJheShyLHMsTCkpLHguc3R1ZmZlZERhdGE9bmV3IFVpbnQzMkFycmF5KEEpLHMrPUx9fX1yZXR1cm4gbi5lb2ZPZmZzZXQ9cyxufSxlPWZ1bmN0aW9uKHIscyx0LG4saCxpLG8pe3ZhciBjPSgxPDxzKS0xLHU9MCxtLHc9MCxsLGYsZz1NYXRoLmNlaWwoKG8tbikvaCksTT1yLmxlbmd0aCo0LU1hdGguY2VpbChzKnQvOCk7Zm9yKHJbci5sZW5ndGgtMV08PD04Kk0sbT0wO208dDttKyspe2lmKHc9PT0wJiYoZj1yW3UrK10sdz0zMiksdz49cylsPWY+Pj53LXMmYyx3LT1zO2Vsc2V7dmFyIEQ9cy13O2w9KGYmYyk8PEQmYyxmPXJbdSsrXSx3PTMyLUQsbCs9Zj4+Pnd9aVttXT1sPGc/bitsKmg6b31yZXR1cm4gaX07cmV0dXJuIGt9KCksaWU9ZnVuY3Rpb24oKXt2YXIgaz17dW5zdHVmZjpmdW5jdGlvbihhLGUscixzLHQsbixoLGkpe3ZhciBvPSgxPDxyKS0xLGM9MCx1LG09MCx3LGwsZixnLE09YS5sZW5ndGgqNC1NYXRoLmNlaWwocipzLzgpO2lmKGFbYS5sZW5ndGgtMV08PD04Kk0sdClmb3IodT0wO3U8czt1KyspbT09PTAmJihsPWFbYysrXSxtPTMyKSxtPj1yPyh3PWw+Pj5tLXImbyxtLT1yKTooZj1yLW0sdz0obCZvKTw8ZiZvLGw9YVtjKytdLG09MzItZix3Kz1sPj4+bSksZVt1XT10W3ddO2Vsc2UgZm9yKGc9TWF0aC5jZWlsKChpLW4pL2gpLHU9MDt1PHM7dSsrKW09PT0wJiYobD1hW2MrK10sbT0zMiksbT49cj8odz1sPj4+bS1yJm8sbS09cik6KGY9ci1tLHc9KGwmbyk8PGYmbyxsPWFbYysrXSxtPTMyLWYsdys9bD4+Pm0pLGVbdV09dzxnP24rdypoOml9LHVuc3R1ZmZMVVQ6ZnVuY3Rpb24oYSxlLHIscyx0LG4pe3ZhciBoPSgxPDxlKS0xLGk9MCxvPTAsYz0wLHU9MCxtPTAsdyxsPVtdLGY9YS5sZW5ndGgqNC1NYXRoLmNlaWwoZSpyLzgpO2FbYS5sZW5ndGgtMV08PD04KmY7dmFyIGc9TWF0aC5jZWlsKChuLXMpL3QpO2ZvcihvPTA7bzxyO28rKyl1PT09MCYmKHc9YVtpKytdLHU9MzIpLHU+PWU/KG09dz4+PnUtZSZoLHUtPWUpOihjPWUtdSxtPSh3JmgpPDxjJmgsdz1hW2krK10sdT0zMi1jLG0rPXc+Pj51KSxsW29dPW08Zz9zK20qdDpuO3JldHVybiBsLnVuc2hpZnQocyksbH0sdW5zdHVmZjI6ZnVuY3Rpb24oYSxlLHIscyx0LG4saCxpKXt2YXIgbz0oMTw8ciktMSxjPTAsdSxtPTAsdz0wLGwsZixnO2lmKHQpZm9yKHU9MDt1PHM7dSsrKW09PT0wJiYoZj1hW2MrK10sbT0zMix3PTApLG0+PXI/KGw9Zj4+PncmbyxtLT1yLHcrPXIpOihnPXItbSxsPWY+Pj53Jm8sZj1hW2MrK10sbT0zMi1nLGx8PShmJigxPDxnKS0xKTw8ci1nLHc9ZyksZVt1XT10W2xdO2Vsc2V7dmFyIE09TWF0aC5jZWlsKChpLW4pL2gpO2Zvcih1PTA7dTxzO3UrKyltPT09MCYmKGY9YVtjKytdLG09MzIsdz0wKSxtPj1yPyhsPWY+Pj53Jm8sbS09cix3Kz1yKTooZz1yLW0sbD1mPj4+dyZvLGY9YVtjKytdLG09MzItZyxsfD0oZiYoMTw8ZyktMSk8PHItZyx3PWcpLGVbdV09bDxNP24rbCpoOml9cmV0dXJuIGV9LHVuc3R1ZmZMVVQyOmZ1bmN0aW9uKGEsZSxyLHMsdCxuKXt2YXIgaD0oMTw8ZSktMSxpPTAsbz0wLGM9MCx1PTAsbT0wLHc9MCxsLGY9W10sZz1NYXRoLmNlaWwoKG4tcykvdCk7Zm9yKG89MDtvPHI7bysrKXU9PT0wJiYobD1hW2krK10sdT0zMix3PTApLHU+PWU/KG09bD4+PncmaCx1LT1lLHcrPWUpOihjPWUtdSxtPWw+Pj53JmgsbD1hW2krK10sdT0zMi1jLG18PShsJigxPDxjKS0xKTw8ZS1jLHc9YyksZltvXT1tPGc/cyttKnQ6bjtyZXR1cm4gZi51bnNoaWZ0KHMpLGZ9LG9yaWdpbmFsVW5zdHVmZjpmdW5jdGlvbihhLGUscixzKXt2YXIgdD0oMTw8ciktMSxuPTAsaCxpPTAsbyxjLHUsbT1hLmxlbmd0aCo0LU1hdGguY2VpbChyKnMvOCk7Zm9yKGFbYS5sZW5ndGgtMV08PD04Km0saD0wO2g8cztoKyspaT09PTAmJihjPWFbbisrXSxpPTMyKSxpPj1yPyhvPWM+Pj5pLXImdCxpLT1yKToodT1yLWksbz0oYyZ0KTw8dSZ0LGM9YVtuKytdLGk9MzItdSxvKz1jPj4+aSksZVtoXT1vO3JldHVybiBlfSxvcmlnaW5hbFVuc3R1ZmYyOmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0PSgxPDxyKS0xLG49MCxoLGk9MCxvPTAsYyx1LG07Zm9yKGg9MDtoPHM7aCsrKWk9PT0wJiYodT1hW24rK10saT0zMixvPTApLGk+PXI/KGM9dT4+Pm8mdCxpLT1yLG8rPXIpOihtPXItaSxjPXU+Pj5vJnQsdT1hW24rK10saT0zMi1tLGN8PSh1JigxPDxtKS0xKTw8ci1tLG89bSksZVtoXT1jO3JldHVybiBlfX0sZD17SFVGRk1BTl9MVVRfQklUU19NQVg6MTIsY29tcHV0ZUNoZWNrc3VtRmxldGNoZXIzMjpmdW5jdGlvbihhKXtmb3IodmFyIGU9NjU1MzUscj02NTUzNSxzPWEubGVuZ3RoLHQ9TWF0aC5mbG9vcihzLzIpLG49MDt0Oyl7dmFyIGg9dD49MzU5PzM1OTp0O3QtPWg7ZG8gZSs9YVtuKytdPDw4LHIrPWUrPWFbbisrXTt3aGlsZSgtLWgpO2U9KGUmNjU1MzUpKyhlPj4+MTYpLHI9KHImNjU1MzUpKyhyPj4+MTYpfXJldHVybiBzJjEmJihyKz1lKz1hW25dPDw4KSxlPShlJjY1NTM1KSsoZT4+PjE2KSxyPShyJjY1NTM1KSsocj4+PjE2KSwocjw8MTZ8ZSk+Pj4wfSxyZWFkSGVhZGVySW5mbzpmdW5jdGlvbihhLGUpe3ZhciByPWUucHRyLHM9bmV3IFVpbnQ4QXJyYXkoYSxyLDYpLHQ9e307aWYodC5maWxlSWRlbnRpZmllclN0cmluZz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwscyksdC5maWxlSWRlbnRpZmllclN0cmluZy5sYXN0SW5kZXhPZigiTGVyYzIiLDApIT09MCl0aHJvdyJVbmV4cGVjdGVkIGZpbGUgaWRlbnRpZmllciBzdHJpbmcgKGV4cGVjdCBMZXJjMiApOiAiK3QuZmlsZUlkZW50aWZpZXJTdHJpbmc7cis9Njt2YXIgbj1uZXcgRGF0YVZpZXcoYSxyLDgpLGg9bi5nZXRJbnQzMigwLCEwKTt0LmZpbGVWZXJzaW9uPWgscis9NCxoPj0zJiYodC5jaGVja3N1bT1uLmdldFVpbnQzMig0LCEwKSxyKz00KSxuPW5ldyBEYXRhVmlldyhhLHIsMTIpLHQuaGVpZ2h0PW4uZ2V0VWludDMyKDAsITApLHQud2lkdGg9bi5nZXRVaW50MzIoNCwhMCkscis9OCxoPj00Pyh0Lm51bURpbXM9bi5nZXRVaW50MzIoOCwhMCkscis9NCk6dC5udW1EaW1zPTEsbj1uZXcgRGF0YVZpZXcoYSxyLDQwKSx0Lm51bVZhbGlkUGl4ZWw9bi5nZXRVaW50MzIoMCwhMCksdC5taWNyb0Jsb2NrU2l6ZT1uLmdldEludDMyKDQsITApLHQuYmxvYlNpemU9bi5nZXRJbnQzMig4LCEwKSx0LmltYWdlVHlwZT1uLmdldEludDMyKDEyLCEwKSx0Lm1heFpFcnJvcj1uLmdldEZsb2F0NjQoMTYsITApLHQuek1pbj1uLmdldEZsb2F0NjQoMjQsITApLHQuek1heD1uLmdldEZsb2F0NjQoMzIsITApLHIrPTQwLGUuaGVhZGVySW5mbz10LGUucHRyPXI7dmFyIGksbztpZihoPj0zJiYobz1oPj00PzUyOjQ4LGk9dGhpcy5jb21wdXRlQ2hlY2tzdW1GbGV0Y2hlcjMyKG5ldyBVaW50OEFycmF5KGEsci1vLHQuYmxvYlNpemUtMTQpKSxpIT09dC5jaGVja3N1bSkpdGhyb3ciQ2hlY2tzdW0gZmFpbGVkLiI7cmV0dXJuITB9LGNoZWNrTWluTWF4UmFuZ2VzOmZ1bmN0aW9uKGEsZSl7dmFyIHI9ZS5oZWFkZXJJbmZvLHM9dGhpcy5nZXREYXRhVHlwZUFycmF5KHIuaW1hZ2VUeXBlKSx0PXIubnVtRGltcyp0aGlzLmdldERhdGFUeXBlU2l6ZShyLmltYWdlVHlwZSksbj10aGlzLnJlYWRTdWJBcnJheShhLGUucHRyLHMsdCksaD10aGlzLnJlYWRTdWJBcnJheShhLGUucHRyK3Qscyx0KTtlLnB0cis9Mip0O3ZhciBpLG89ITA7Zm9yKGk9MDtpPHIubnVtRGltcztpKyspaWYobltpXSE9PWhbaV0pe289ITE7YnJlYWt9cmV0dXJuIHIubWluVmFsdWVzPW4sci5tYXhWYWx1ZXM9aCxvfSxyZWFkU3ViQXJyYXk6ZnVuY3Rpb24oYSxlLHIscyl7dmFyIHQ7aWYocj09PVVpbnQ4QXJyYXkpdD1uZXcgVWludDhBcnJheShhLGUscyk7ZWxzZXt2YXIgbj1uZXcgQXJyYXlCdWZmZXIocyksaD1uZXcgVWludDhBcnJheShuKTtoLnNldChuZXcgVWludDhBcnJheShhLGUscykpLHQ9bmV3IHIobil9cmV0dXJuIHR9LHJlYWRNYXNrOmZ1bmN0aW9uKGEsZSl7dmFyIHI9ZS5wdHIscz1lLmhlYWRlckluZm8sdD1zLndpZHRoKnMuaGVpZ2h0LG49cy5udW1WYWxpZFBpeGVsLGg9bmV3IERhdGFWaWV3KGEsciw0KSxpPXt9O2lmKGkubnVtQnl0ZXM9aC5nZXRVaW50MzIoMCwhMCkscis9NCwobj09PTB8fHQ9PT1uKSYmaS5udW1CeXRlcyE9PTApdGhyb3ciaW52YWxpZCBtYXNrIjt2YXIgbyxjO2lmKG49PT0wKW89bmV3IFVpbnQ4QXJyYXkoTWF0aC5jZWlsKHQvOCkpLGkuYml0c2V0PW8sYz1uZXcgVWludDhBcnJheSh0KSxlLnBpeGVscy5yZXN1bHRNYXNrPWMscis9aS5udW1CeXRlcztlbHNlIGlmKGkubnVtQnl0ZXM+MCl7bz1uZXcgVWludDhBcnJheShNYXRoLmNlaWwodC84KSksaD1uZXcgRGF0YVZpZXcoYSxyLGkubnVtQnl0ZXMpO3ZhciB1PWguZ2V0SW50MTYoMCwhMCksbT0yLHc9MCxsPTA7ZG97aWYodT4wKWZvcig7dS0tOylvW3crK109aC5nZXRVaW50OChtKyspO2Vsc2UgZm9yKGw9aC5nZXRVaW50OChtKyspLHU9LXU7dS0tOylvW3crK109bDt1PWguZ2V0SW50MTYobSwhMCksbSs9Mn13aGlsZShtPGkubnVtQnl0ZXMpO2lmKHUhPT0tMzI3Njh8fHc8by5sZW5ndGgpdGhyb3ciVW5leHBlY3RlZCBlbmQgb2YgbWFzayBSTEUgZW5jb2RpbmciO2M9bmV3IFVpbnQ4QXJyYXkodCk7dmFyIGY9MCxnPTA7Zm9yKGc9MDtnPHQ7ZysrKWcmNz8oZj1vW2c+PjNdLGY8PD1nJjcpOmY9b1tnPj4zXSxmJjEyOCYmKGNbZ109MSk7ZS5waXhlbHMucmVzdWx0TWFzaz1jLGkuYml0c2V0PW8scis9aS5udW1CeXRlc31yZXR1cm4gZS5wdHI9cixlLm1hc2s9aSwhMH0scmVhZERhdGFPbmVTd2VlcDpmdW5jdGlvbihhLGUscixzKXt2YXIgdD1lLnB0cixuPWUuaGVhZGVySW5mbyxoPW4ubnVtRGltcyxpPW4ud2lkdGgqbi5oZWlnaHQsbz1uLmltYWdlVHlwZSxjPW4ubnVtVmFsaWRQaXhlbCpkLmdldERhdGFUeXBlU2l6ZShvKSpoLHUsbT1lLnBpeGVscy5yZXN1bHRNYXNrO2lmKHI9PT1VaW50OEFycmF5KXU9bmV3IFVpbnQ4QXJyYXkoYSx0LGMpO2Vsc2V7dmFyIHc9bmV3IEFycmF5QnVmZmVyKGMpLGw9bmV3IFVpbnQ4QXJyYXkodyk7bC5zZXQobmV3IFVpbnQ4QXJyYXkoYSx0LGMpKSx1PW5ldyByKHcpfWlmKHUubGVuZ3RoPT09aSpoKXM/ZS5waXhlbHMucmVzdWx0UGl4ZWxzPWQuc3dhcERpbWVuc2lvbk9yZGVyKHUsaSxoLHIsITApOmUucGl4ZWxzLnJlc3VsdFBpeGVscz11O2Vsc2V7ZS5waXhlbHMucmVzdWx0UGl4ZWxzPW5ldyByKGkqaCk7dmFyIGY9MCxnPTAsTT0wLEQ9MDtpZihoPjEpe2lmKHMpe2ZvcihnPTA7ZzxpO2crKylpZihtW2ddKWZvcihEPWcsTT0wO008aDtNKyssRCs9aSllLnBpeGVscy5yZXN1bHRQaXhlbHNbRF09dVtmKytdfWVsc2UgZm9yKGc9MDtnPGk7ZysrKWlmKG1bZ10pZm9yKEQ9ZypoLE09MDtNPGg7TSsrKWUucGl4ZWxzLnJlc3VsdFBpeGVsc1tEK01dPXVbZisrXX1lbHNlIGZvcihnPTA7ZzxpO2crKyltW2ddJiYoZS5waXhlbHMucmVzdWx0UGl4ZWxzW2ddPXVbZisrXSl9cmV0dXJuIHQrPWMsZS5wdHI9dCwhMH0scmVhZEh1ZmZtYW5UcmVlOmZ1bmN0aW9uKGEsZSl7dmFyIHI9dGhpcy5IVUZGTUFOX0xVVF9CSVRTX01BWCxzPW5ldyBEYXRhVmlldyhhLGUucHRyLDE2KTtlLnB0cis9MTY7dmFyIHQ9cy5nZXRJbnQzMigwLCEwKTtpZih0PDIpdGhyb3cidW5zdXBwb3J0ZWQgSHVmZm1hbiB2ZXJzaW9uIjt2YXIgbj1zLmdldEludDMyKDQsITApLGg9cy5nZXRJbnQzMig4LCEwKSxpPXMuZ2V0SW50MzIoMTIsITApO2lmKGg+PWkpcmV0dXJuITE7dmFyIG89bmV3IFVpbnQzMkFycmF5KGktaCk7ZC5kZWNvZGVCaXRzKGEsZSxvKTt2YXIgYz1bXSx1LG0sdyxsO2Zvcih1PWg7dTxpO3UrKyltPXUtKHU8bj8wOm4pLGNbbV09e2ZpcnN0Om9bdS1oXSxzZWNvbmQ6bnVsbH07dmFyIGY9YS5ieXRlTGVuZ3RoLWUucHRyLGc9TWF0aC5jZWlsKGYvNCksTT1uZXcgQXJyYXlCdWZmZXIoZyo0KSxEPW5ldyBVaW50OEFycmF5KE0pO0Quc2V0KG5ldyBVaW50OEFycmF5KGEsZS5wdHIsZikpO3ZhciBwPW5ldyBVaW50MzJBcnJheShNKSxVPTAsSSx6PTA7Zm9yKEk9cFswXSx1PWg7dTxpO3UrKyltPXUtKHU8bj8wOm4pLGw9Y1ttXS5maXJzdCxsPjAmJihjW21dLnNlY29uZD1JPDxVPj4+MzItbCwzMi1VPj1sPyhVKz1sLFU9PT0zMiYmKFU9MCx6KyssST1wW3pdKSk6KFUrPWwtMzIseisrLEk9cFt6XSxjW21dLnNlY29uZHw9ST4+PjMyLVUpKTt2YXIgeD0wLHY9MCxBPW5ldyB5O2Zvcih1PTA7dTxjLmxlbmd0aDt1KyspY1t1XSE9PXZvaWQgMCYmKHg9TWF0aC5tYXgoeCxjW3VdLmZpcnN0KSk7eD49cj92PXI6dj14O3ZhciBUPVtdLFMsYixMLEYsQixDO2Zvcih1PWg7dTxpO3UrKylpZihtPXUtKHU8bj8wOm4pLGw9Y1ttXS5maXJzdCxsPjApaWYoUz1bbCxtXSxsPD12KWZvcihiPWNbbV0uc2Vjb25kPDx2LWwsTD0xPDx2LWwsdz0wO3c8TDt3KyspVFtifHddPVM7ZWxzZSBmb3IoYj1jW21dLnNlY29uZCxDPUEsRj1sLTE7Rj49MDtGLS0pQj1iPj4+RiYxLEI/KEMucmlnaHR8fChDLnJpZ2h0PW5ldyB5KSxDPUMucmlnaHQpOihDLmxlZnR8fChDLmxlZnQ9bmV3IHkpLEM9Qy5sZWZ0KSxGPT09MCYmIUMudmFsJiYoQy52YWw9U1sxXSk7cmV0dXJue2RlY29kZUx1dDpULG51bUJpdHNMVVRRaWNrOnYsbnVtQml0c0xVVDp4LHRyZWU6QSxzdHVmZmVkRGF0YTpwLHNyY1B0cjp6LGJpdFBvczpVfX0scmVhZEh1ZmZtYW46ZnVuY3Rpb24oYSxlLHIscyl7dmFyIHQ9ZS5oZWFkZXJJbmZvLG49dC5udW1EaW1zLGg9ZS5oZWFkZXJJbmZvLmhlaWdodCxpPWUuaGVhZGVySW5mby53aWR0aCxvPWkqaCxjPXRoaXMucmVhZEh1ZmZtYW5UcmVlKGEsZSksdT1jLmRlY29kZUx1dCxtPWMudHJlZSx3PWMuc3R1ZmZlZERhdGEsbD1jLnNyY1B0cixmPWMuYml0UG9zLGc9Yy5udW1CaXRzTFVUUWljayxNPWMubnVtQml0c0xVVCxEPWUuaGVhZGVySW5mby5pbWFnZVR5cGU9PT0wPzEyODowLHAsVSxJLHo9ZS5waXhlbHMucmVzdWx0TWFzayx4LHYsQSxULFMsYixMLEY9MDtmPjAmJihsKyssZj0wKTt2YXIgQj13W2xdLEM9ZS5lbmNvZGVNb2RlPT09MSxIPW5ldyByKG8qbiksTz1ILFg7aWYobjwyfHxDKXtmb3IoWD0wO1g8bjtYKyspaWYobj4xJiYoTz1uZXcgcihILmJ1ZmZlcixvKlgsbyksRj0wKSxlLmhlYWRlckluZm8ubnVtVmFsaWRQaXhlbD09PWkqaClmb3IoYj0wLFQ9MDtUPGg7VCsrKWZvcihTPTA7UzxpO1MrKyxiKyspe2lmKFU9MCx4PUI8PGY+Pj4zMi1nLHY9eCwzMi1mPGcmJih4fD13W2wrMV0+Pj42NC1mLWcsdj14KSx1W3ZdKVU9dVt2XVsxXSxmKz11W3ZdWzBdO2Vsc2UgZm9yKHg9Qjw8Zj4+PjMyLU0sdj14LDMyLWY8TSYmKHh8PXdbbCsxXT4+PjY0LWYtTSx2PXgpLHA9bSxMPTA7TDxNO0wrKylpZihBPXg+Pj5NLUwtMSYxLHA9QT9wLnJpZ2h0OnAubGVmdCwhKHAubGVmdHx8cC5yaWdodCkpe1U9cC52YWwsZj1mK0wrMTticmVha31mPj0zMiYmKGYtPTMyLGwrKyxCPXdbbF0pLEk9VS1ELEM/KFM+MD9JKz1GOlQ+MD9JKz1PW2ItaV06SSs9RixJJj0yNTUsT1tiXT1JLEY9SSk6T1tiXT1JfWVsc2UgZm9yKGI9MCxUPTA7VDxoO1QrKylmb3IoUz0wO1M8aTtTKyssYisrKWlmKHpbYl0pe2lmKFU9MCx4PUI8PGY+Pj4zMi1nLHY9eCwzMi1mPGcmJih4fD13W2wrMV0+Pj42NC1mLWcsdj14KSx1W3ZdKVU9dVt2XVsxXSxmKz11W3ZdWzBdO2Vsc2UgZm9yKHg9Qjw8Zj4+PjMyLU0sdj14LDMyLWY8TSYmKHh8PXdbbCsxXT4+PjY0LWYtTSx2PXgpLHA9bSxMPTA7TDxNO0wrKylpZihBPXg+Pj5NLUwtMSYxLHA9QT9wLnJpZ2h0OnAubGVmdCwhKHAubGVmdHx8cC5yaWdodCkpe1U9cC52YWwsZj1mK0wrMTticmVha31mPj0zMiYmKGYtPTMyLGwrKyxCPXdbbF0pLEk9VS1ELEM/KFM+MCYmeltiLTFdP0krPUY6VD4wJiZ6W2ItaV0/SSs9T1tiLWldOkkrPUYsSSY9MjU1LE9bYl09SSxGPUkpOk9bYl09SX19ZWxzZSBmb3IoYj0wLFQ9MDtUPGg7VCsrKWZvcihTPTA7UzxpO1MrKylpZihiPVQqaStTLCF6fHx6W2JdKWZvcihYPTA7WDxuO1grKyxiKz1vKXtpZihVPTAseD1CPDxmPj4+MzItZyx2PXgsMzItZjxnJiYoeHw9d1tsKzFdPj4+NjQtZi1nLHY9eCksdVt2XSlVPXVbdl1bMV0sZis9dVt2XVswXTtlbHNlIGZvcih4PUI8PGY+Pj4zMi1NLHY9eCwzMi1mPE0mJih4fD13W2wrMV0+Pj42NC1mLU0sdj14KSxwPW0sTD0wO0w8TTtMKyspaWYoQT14Pj4+TS1MLTEmMSxwPUE/cC5yaWdodDpwLmxlZnQsIShwLmxlZnR8fHAucmlnaHQpKXtVPXAudmFsLGY9ZitMKzE7YnJlYWt9Zj49MzImJihmLT0zMixsKyssQj13W2xdKSxJPVUtRCxPW2JdPUl9ZS5wdHI9ZS5wdHIrKGwrMSkqNCsoZj4wPzQ6MCksZS5waXhlbHMucmVzdWx0UGl4ZWxzPUgsbj4xJiYhcyYmKGUucGl4ZWxzLnJlc3VsdFBpeGVscz1kLnN3YXBEaW1lbnNpb25PcmRlcihILG8sbixyKSl9LGRlY29kZUJpdHM6ZnVuY3Rpb24oYSxlLHIscyx0KXt7dmFyIG49ZS5oZWFkZXJJbmZvLGg9bi5maWxlVmVyc2lvbixpPTAsbz1hLmJ5dGVMZW5ndGgtZS5wdHI+PTU/NTphLmJ5dGVMZW5ndGgtZS5wdHIsYz1uZXcgRGF0YVZpZXcoYSxlLnB0cixvKSx1PWMuZ2V0VWludDgoMCk7aSsrO3ZhciBtPXU+PjYsdz1tPT09MD80OjMtbSxsPSh1JjMyKT4wLGY9dSYzMSxnPTA7aWYodz09PTEpZz1jLmdldFVpbnQ4KGkpLGkrKztlbHNlIGlmKHc9PT0yKWc9Yy5nZXRVaW50MTYoaSwhMCksaSs9MjtlbHNlIGlmKHc9PT00KWc9Yy5nZXRVaW50MzIoaSwhMCksaSs9NDtlbHNlIHRocm93IkludmFsaWQgdmFsaWQgcGl4ZWwgY291bnQgdHlwZSI7dmFyIE09MipuLm1heFpFcnJvcixELHAsVSxJLHoseCx2LEEsVCxTPW4ubnVtRGltcz4xP24ubWF4VmFsdWVzW3RdOm4uek1heDtpZihsKXtmb3IoZS5jb3VudGVyLmx1dCsrLEE9Yy5nZXRVaW50OChpKSxpKyssST1NYXRoLmNlaWwoKEEtMSkqZi84KSx6PU1hdGguY2VpbChJLzQpLHA9bmV3IEFycmF5QnVmZmVyKHoqNCksVT1uZXcgVWludDhBcnJheShwKSxlLnB0cis9aSxVLnNldChuZXcgVWludDhBcnJheShhLGUucHRyLEkpKSx2PW5ldyBVaW50MzJBcnJheShwKSxlLnB0cis9SSxUPTA7QS0xPj4+VDspVCsrO0k9TWF0aC5jZWlsKGcqVC84KSx6PU1hdGguY2VpbChJLzQpLHA9bmV3IEFycmF5QnVmZmVyKHoqNCksVT1uZXcgVWludDhBcnJheShwKSxVLnNldChuZXcgVWludDhBcnJheShhLGUucHRyLEkpKSxEPW5ldyBVaW50MzJBcnJheShwKSxlLnB0cis9SSxoPj0zP3g9ay51bnN0dWZmTFVUMih2LGYsQS0xLHMsTSxTKTp4PWsudW5zdHVmZkxVVCh2LGYsQS0xLHMsTSxTKSxoPj0zP2sudW5zdHVmZjIoRCxyLFQsZyx4KTprLnVuc3R1ZmYoRCxyLFQsZyx4KX1lbHNlIGUuY291bnRlci5iaXRzdHVmZmVyKyssVD1mLGUucHRyKz1pLFQ+MCYmKEk9TWF0aC5jZWlsKGcqVC84KSx6PU1hdGguY2VpbChJLzQpLHA9bmV3IEFycmF5QnVmZmVyKHoqNCksVT1uZXcgVWludDhBcnJheShwKSxVLnNldChuZXcgVWludDhBcnJheShhLGUucHRyLEkpKSxEPW5ldyBVaW50MzJBcnJheShwKSxlLnB0cis9SSxoPj0zP3M9PW51bGw/ay5vcmlnaW5hbFVuc3R1ZmYyKEQscixULGcpOmsudW5zdHVmZjIoRCxyLFQsZywhMSxzLE0sUyk6cz09bnVsbD9rLm9yaWdpbmFsVW5zdHVmZihELHIsVCxnKTprLnVuc3R1ZmYoRCxyLFQsZywhMSxzLE0sUykpfX0scmVhZFRpbGVzOmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0PWUuaGVhZGVySW5mbyxuPXQud2lkdGgsaD10LmhlaWdodCxpPW4qaCxvPXQubWljcm9CbG9ja1NpemUsYz10LmltYWdlVHlwZSx1PWQuZ2V0RGF0YVR5cGVTaXplKGMpLG09TWF0aC5jZWlsKG4vbyksdz1NYXRoLmNlaWwoaC9vKTtlLnBpeGVscy5udW1CbG9ja3NZPXcsZS5waXhlbHMubnVtQmxvY2tzWD1tLGUucGl4ZWxzLnB0cj0wO3ZhciBsPTAsZj0wLGc9MCxNPTAsRD0wLHA9MCxVPTAsST0wLHo9MCx4PTAsdj0wLEE9MCxUPTAsUz0wLGI9MCxMPTAsRixCLEMsSCxPLFgsJD1uZXcgcihvKm8pLGhlPWglb3x8byxjZT1uJW98fG8sUSxSLHE9dC5udW1EaW1zLGosRT1lLnBpeGVscy5yZXN1bHRNYXNrLFk9ZS5waXhlbHMucmVzdWx0UGl4ZWxzLG1lPXQuZmlsZVZlcnNpb24sSj1tZT49NT8xNDoxNSxaLEc9dC56TWF4LE47Zm9yKGc9MDtnPHc7ZysrKWZvcihEPWchPT13LTE/bzpoZSxNPTA7TTxtO00rKylmb3IocD1NIT09bS0xP286Y2Usdj1nKm4qbytNKm8sQT1uLXAsaj0wO2o8cTtqKyspe2lmKHE+MT8oTj1ZLHY9ZypuKm8rTSpvLFk9bmV3IHIoZS5waXhlbHMucmVzdWx0UGl4ZWxzLmJ1ZmZlcixpKmoqdSxpKSxHPXQubWF4VmFsdWVzW2pdKTpOPW51bGwsVT1hLmJ5dGVMZW5ndGgtZS5wdHIsRj1uZXcgRGF0YVZpZXcoYSxlLnB0cixNYXRoLm1pbigxMCxVKSksQj17fSxMPTAsST1GLmdldFVpbnQ4KDApLEwrKyxaPXQuZmlsZVZlcnNpb24+PTU/SSY0OjAsej1JPj42JjI1NSx4PUk+PjImSix4IT09KE0qbz4+MyZKKXx8WiYmaj09PTApdGhyb3ciaW50ZWdyaXR5IGlzc3VlIjtpZihYPUkmMyxYPjMpdGhyb3cgZS5wdHIrPUwsIkludmFsaWQgYmxvY2sgZW5jb2RpbmcgKCIrWCsiKSI7aWYoWD09PTIpe2lmKFopaWYoRSlmb3IobD0wO2w8RDtsKyspZm9yKGY9MDtmPHA7ZisrKUVbdl0mJihZW3ZdPU5bdl0pLHYrKztlbHNlIGZvcihsPTA7bDxEO2wrKylmb3IoZj0wO2Y8cDtmKyspWVt2XT1OW3ZdLHYrKztlLmNvdW50ZXIuY29uc3RhbnQrKyxlLnB0cis9TDtjb250aW51ZX1lbHNlIGlmKFg9PT0wKXtpZihaKXRocm93ImludGVncml0eSBpc3N1ZSI7aWYoZS5jb3VudGVyLnVuY29tcHJlc3NlZCsrLGUucHRyKz1MLFQ9RCpwKnUsUz1hLmJ5dGVMZW5ndGgtZS5wdHIsVD1UPFM/VDpTLEM9bmV3IEFycmF5QnVmZmVyKFQldT09PTA/VDpUK3UtVCV1KSxIPW5ldyBVaW50OEFycmF5KEMpLEguc2V0KG5ldyBVaW50OEFycmF5KGEsZS5wdHIsVCkpLE89bmV3IHIoQyksYj0wLEUpZm9yKGw9MDtsPEQ7bCsrKXtmb3IoZj0wO2Y8cDtmKyspRVt2XSYmKFlbdl09T1tiKytdKSx2Kys7dis9QX1lbHNlIGZvcihsPTA7bDxEO2wrKyl7Zm9yKGY9MDtmPHA7ZisrKVlbdisrXT1PW2IrK107dis9QX1lLnB0cis9Yip1fWVsc2UgaWYoUT1kLmdldERhdGFUeXBlVXNlZChaJiZjPDY/NDpjLHopLFI9ZC5nZXRPbmVQaXhlbChCLEwsUSxGKSxMKz1kLmdldERhdGFUeXBlU2l6ZShRKSxYPT09MylpZihlLnB0cis9TCxlLmNvdW50ZXIuY29uc3RhbnRvZmZzZXQrKyxFKWZvcihsPTA7bDxEO2wrKyl7Zm9yKGY9MDtmPHA7ZisrKUVbdl0mJihZW3ZdPVo/TWF0aC5taW4oRyxOW3ZdK1IpOlIpLHYrKzt2Kz1BfWVsc2UgZm9yKGw9MDtsPEQ7bCsrKXtmb3IoZj0wO2Y8cDtmKyspWVt2XT1aP01hdGgubWluKEcsTlt2XStSKTpSLHYrKzt2Kz1BfWVsc2UgaWYoZS5wdHIrPUwsZC5kZWNvZGVCaXRzKGEsZSwkLFIsaiksTD0wLFopaWYoRSlmb3IobD0wO2w8RDtsKyspe2ZvcihmPTA7ZjxwO2YrKylFW3ZdJiYoWVt2XT0kW0wrK10rTlt2XSksdisrO3YrPUF9ZWxzZSBmb3IobD0wO2w8RDtsKyspe2ZvcihmPTA7ZjxwO2YrKylZW3ZdPSRbTCsrXStOW3ZdLHYrKzt2Kz1BfWVsc2UgaWYoRSlmb3IobD0wO2w8RDtsKyspe2ZvcihmPTA7ZjxwO2YrKylFW3ZdJiYoWVt2XT0kW0wrK10pLHYrKzt2Kz1BfWVsc2UgZm9yKGw9MDtsPEQ7bCsrKXtmb3IoZj0wO2Y8cDtmKyspWVt2KytdPSRbTCsrXTt2Kz1BfX1xPjEmJiFzJiYoZS5waXhlbHMucmVzdWx0UGl4ZWxzPWQuc3dhcERpbWVuc2lvbk9yZGVyKGUucGl4ZWxzLnJlc3VsdFBpeGVscyxpLHEscikpfSxmb3JtYXRGaWxlSW5mbzpmdW5jdGlvbihhKXtyZXR1cm57ZmlsZUlkZW50aWZpZXJTdHJpbmc6YS5oZWFkZXJJbmZvLmZpbGVJZGVudGlmaWVyU3RyaW5nLGZpbGVWZXJzaW9uOmEuaGVhZGVySW5mby5maWxlVmVyc2lvbixpbWFnZVR5cGU6YS5oZWFkZXJJbmZvLmltYWdlVHlwZSxoZWlnaHQ6YS5oZWFkZXJJbmZvLmhlaWdodCx3aWR0aDphLmhlYWRlckluZm8ud2lkdGgsbnVtVmFsaWRQaXhlbDphLmhlYWRlckluZm8ubnVtVmFsaWRQaXhlbCxtaWNyb0Jsb2NrU2l6ZTphLmhlYWRlckluZm8ubWljcm9CbG9ja1NpemUsYmxvYlNpemU6YS5oZWFkZXJJbmZvLmJsb2JTaXplLG1heFpFcnJvcjphLmhlYWRlckluZm8ubWF4WkVycm9yLHBpeGVsVHlwZTpkLmdldFBpeGVsVHlwZShhLmhlYWRlckluZm8uaW1hZ2VUeXBlKSxlb2ZPZmZzZXQ6YS5lb2ZPZmZzZXQsbWFzazphLm1hc2s/e251bUJ5dGVzOmEubWFzay5udW1CeXRlc306bnVsbCxwaXhlbHM6e251bUJsb2Nrc1g6YS5waXhlbHMubnVtQmxvY2tzWCxudW1CbG9ja3NZOmEucGl4ZWxzLm51bUJsb2Nrc1ksbWF4VmFsdWU6YS5oZWFkZXJJbmZvLnpNYXgsbWluVmFsdWU6YS5oZWFkZXJJbmZvLnpNaW4sbm9EYXRhVmFsdWU6YS5ub0RhdGFWYWx1ZX19fSxjb25zdHJ1Y3RDb25zdGFudFN1cmZhY2U6ZnVuY3Rpb24oYSxlKXt2YXIgcj1hLmhlYWRlckluZm8uek1heCxzPWEuaGVhZGVySW5mby56TWluLHQ9YS5oZWFkZXJJbmZvLm1heFZhbHVlcyxuPWEuaGVhZGVySW5mby5udW1EaW1zLGg9YS5oZWFkZXJJbmZvLmhlaWdodCphLmhlYWRlckluZm8ud2lkdGgsaT0wLG89MCxjPTAsdT1hLnBpeGVscy5yZXN1bHRNYXNrLG09YS5waXhlbHMucmVzdWx0UGl4ZWxzO2lmKHUpaWYobj4xKXtpZihlKWZvcihpPTA7aTxuO2krKylmb3IoYz1pKmgscj10W2ldLG89MDtvPGg7bysrKXVbb10mJihtW2Mrb109cik7ZWxzZSBmb3Iobz0wO288aDtvKyspaWYodVtvXSlmb3IoYz1vKm4saT0wO2k8bjtpKyspbVtjK25dPXRbaV19ZWxzZSBmb3Iobz0wO288aDtvKyspdVtvXSYmKG1bb109cik7ZWxzZSBpZihuPjEmJnMhPT1yKWlmKGUpZm9yKGk9MDtpPG47aSsrKWZvcihjPWkqaCxyPXRbaV0sbz0wO288aDtvKyspbVtjK29dPXI7ZWxzZSBmb3Iobz0wO288aDtvKyspZm9yKGM9bypuLGk9MDtpPG47aSsrKW1bYytpXT10W2ldO2Vsc2UgZm9yKG89MDtvPGgqbjtvKyspbVtvXT1yfSxnZXREYXRhVHlwZUFycmF5OmZ1bmN0aW9uKGEpe3ZhciBlO3N3aXRjaChhKXtjYXNlIDA6ZT1JbnQ4QXJyYXk7YnJlYWs7Y2FzZSAxOmU9VWludDhBcnJheTticmVhaztjYXNlIDI6ZT1JbnQxNkFycmF5O2JyZWFrO2Nhc2UgMzplPVVpbnQxNkFycmF5O2JyZWFrO2Nhc2UgNDplPUludDMyQXJyYXk7YnJlYWs7Y2FzZSA1OmU9VWludDMyQXJyYXk7YnJlYWs7Y2FzZSA2OmU9RmxvYXQzMkFycmF5O2JyZWFrO2Nhc2UgNzplPUZsb2F0NjRBcnJheTticmVhaztkZWZhdWx0OmU9RmxvYXQzMkFycmF5fXJldHVybiBlfSxnZXRQaXhlbFR5cGU6ZnVuY3Rpb24oYSl7dmFyIGU7c3dpdGNoKGEpe2Nhc2UgMDplPSJTOCI7YnJlYWs7Y2FzZSAxOmU9IlU4IjticmVhaztjYXNlIDI6ZT0iUzE2IjticmVhaztjYXNlIDM6ZT0iVTE2IjticmVhaztjYXNlIDQ6ZT0iUzMyIjticmVhaztjYXNlIDU6ZT0iVTMyIjticmVhaztjYXNlIDY6ZT0iRjMyIjticmVhaztjYXNlIDc6ZT0iRjY0IjticmVhaztkZWZhdWx0OmU9IkYzMiJ9cmV0dXJuIGV9LGlzVmFsaWRQaXhlbFZhbHVlOmZ1bmN0aW9uKGEsZSl7aWYoZT09bnVsbClyZXR1cm4hMTt2YXIgcjtzd2l0Y2goYSl7Y2FzZSAwOnI9ZT49LTEyOCYmZTw9MTI3O2JyZWFrO2Nhc2UgMTpyPWU+PTAmJmU8PTI1NTticmVhaztjYXNlIDI6cj1lPj0tMzI3NjgmJmU8PTMyNzY3O2JyZWFrO2Nhc2UgMzpyPWU+PTAmJmU8PTY1NTM2O2JyZWFrO2Nhc2UgNDpyPWU+PS0yMTQ3NDgzNjQ4JiZlPD0yMTQ3NDgzNjQ3O2JyZWFrO2Nhc2UgNTpyPWU+PTAmJmU8PTQyOTQ5NjcyOTY7YnJlYWs7Y2FzZSA2OnI9ZT49LTM0MDI3OTk5Mzg3OTAxNDg0ZTIyJiZlPD0zNDAyNzk5OTM4NzkwMTQ4NGUyMjticmVhaztjYXNlIDc6cj1lPj0tMTc5NzY5MzEzNDg2MjMxNTdlMjkyJiZlPD0xNzk3NjkzMTM0ODYyMzE1N2UyOTI7YnJlYWs7ZGVmYXVsdDpyPSExfXJldHVybiByfSxnZXREYXRhVHlwZVNpemU6ZnVuY3Rpb24oYSl7dmFyIGU9MDtzd2l0Y2goYSl7Y2FzZSAwOmNhc2UgMTplPTE7YnJlYWs7Y2FzZSAyOmNhc2UgMzplPTI7YnJlYWs7Y2FzZSA0OmNhc2UgNTpjYXNlIDY6ZT00O2JyZWFrO2Nhc2UgNzplPTg7YnJlYWs7ZGVmYXVsdDplPWF9cmV0dXJuIGV9LGdldERhdGFUeXBlVXNlZDpmdW5jdGlvbihhLGUpe3ZhciByPWE7c3dpdGNoKGEpe2Nhc2UgMjpjYXNlIDQ6cj1hLWU7YnJlYWs7Y2FzZSAzOmNhc2UgNTpyPWEtMiplO2JyZWFrO2Nhc2UgNjplPT09MD9yPWE6ZT09PTE/cj0yOnI9MTticmVhaztjYXNlIDc6ZT09PTA/cj1hOnI9YS0yKmUrMTticmVhaztkZWZhdWx0OnI9YTticmVha31yZXR1cm4gcn0sZ2V0T25lUGl4ZWw6ZnVuY3Rpb24oYSxlLHIscyl7dmFyIHQ9MDtzd2l0Y2gocil7Y2FzZSAwOnQ9cy5nZXRJbnQ4KGUpO2JyZWFrO2Nhc2UgMTp0PXMuZ2V0VWludDgoZSk7YnJlYWs7Y2FzZSAyOnQ9cy5nZXRJbnQxNihlLCEwKTticmVhaztjYXNlIDM6dD1zLmdldFVpbnQxNihlLCEwKTticmVhaztjYXNlIDQ6dD1zLmdldEludDMyKGUsITApO2JyZWFrO2Nhc2UgNTp0PXMuZ2V0VUludDMyKGUsITApO2JyZWFrO2Nhc2UgNjp0PXMuZ2V0RmxvYXQzMihlLCEwKTticmVhaztjYXNlIDc6dD1zLmdldEZsb2F0NjQoZSwhMCk7YnJlYWs7ZGVmYXVsdDp0aHJvdyJ0aGUgZGVjb2RlciBkb2VzIG5vdCB1bmRlcnN0YW5kIHRoaXMgcGl4ZWwgdHlwZSJ9cmV0dXJuIHR9LHN3YXBEaW1lbnNpb25PcmRlcjpmdW5jdGlvbihhLGUscixzLHQpe3ZhciBuPTAsaD0wLGk9MCxvPTAsYz1hO2lmKHI+MSlpZihjPW5ldyBzKGUqciksdClmb3Iobj0wO248ZTtuKyspZm9yKG89bixpPTA7aTxyO2krKyxvKz1lKWNbb109YVtoKytdO2Vsc2UgZm9yKG49MDtuPGU7bisrKWZvcihvPW4saT0wO2k8cjtpKyssbys9ZSljW2grK109YVtvXTtyZXR1cm4gY319LHk9ZnVuY3Rpb24oYSxlLHIpe3RoaXMudmFsPWEsdGhpcy5sZWZ0PWUsdGhpcy5yaWdodD1yfSxWPXtkZWNvZGU6ZnVuY3Rpb24oYSxlKXtlPWV8fHt9O3ZhciByPWUubm9EYXRhVmFsdWUscz0wLHQ9e307aWYodC5wdHI9ZS5pbnB1dE9mZnNldHx8MCx0LnBpeGVscz17fSwhIWQucmVhZEhlYWRlckluZm8oYSx0KSl7dmFyIG49dC5oZWFkZXJJbmZvLGg9bi5maWxlVmVyc2lvbixpPWQuZ2V0RGF0YVR5cGVBcnJheShuLmltYWdlVHlwZSk7aWYoaD41KXRocm93InVuc3VwcG9ydGVkIGxlcmMgdmVyc2lvbiAyLiIraDtkLnJlYWRNYXNrKGEsdCksbi5udW1WYWxpZFBpeGVsIT09bi53aWR0aCpuLmhlaWdodCYmIXQucGl4ZWxzLnJlc3VsdE1hc2smJih0LnBpeGVscy5yZXN1bHRNYXNrPWUubWFza0RhdGEpO3ZhciBvPW4ud2lkdGgqbi5oZWlnaHQ7dC5waXhlbHMucmVzdWx0UGl4ZWxzPW5ldyBpKG8qbi5udW1EaW1zKSx0LmNvdW50ZXI9e29uZXN3ZWVwOjAsdW5jb21wcmVzc2VkOjAsbHV0OjAsYml0c3R1ZmZlcjowLGNvbnN0YW50OjAsY29uc3RhbnRvZmZzZXQ6MH07dmFyIGM9IWUucmV0dXJuUGl4ZWxJbnRlcmxlYXZlZERpbXM7aWYobi5udW1WYWxpZFBpeGVsIT09MClpZihuLnpNYXg9PT1uLnpNaW4pZC5jb25zdHJ1Y3RDb25zdGFudFN1cmZhY2UodCxjKTtlbHNlIGlmKGg+PTQmJmQuY2hlY2tNaW5NYXhSYW5nZXMoYSx0KSlkLmNvbnN0cnVjdENvbnN0YW50U3VyZmFjZSh0LGMpO2Vsc2V7dmFyIHU9bmV3IERhdGFWaWV3KGEsdC5wdHIsMiksbT11LmdldFVpbnQ4KDApO2lmKHQucHRyKyssbSlkLnJlYWREYXRhT25lU3dlZXAoYSx0LGksYyk7ZWxzZSBpZihoPjEmJm4uaW1hZ2VUeXBlPD0xJiZNYXRoLmFicyhuLm1heFpFcnJvci0uNSk8MWUtNSl7dmFyIHc9dS5nZXRVaW50OCgxKTtpZih0LnB0cisrLHQuZW5jb2RlTW9kZT13LHc+Mnx8aDw0JiZ3PjEpdGhyb3ciSW52YWxpZCBIdWZmbWFuIGZsYWcgIit3O3c/ZC5yZWFkSHVmZm1hbihhLHQsaSxjKTpkLnJlYWRUaWxlcyhhLHQsaSxjKX1lbHNlIGQucmVhZFRpbGVzKGEsdCxpLGMpfXQuZW9mT2Zmc2V0PXQucHRyO3ZhciBsO2UuaW5wdXRPZmZzZXQ/KGw9dC5oZWFkZXJJbmZvLmJsb2JTaXplK2UuaW5wdXRPZmZzZXQtdC5wdHIsTWF0aC5hYnMobCk+PTEmJih0LmVvZk9mZnNldD1lLmlucHV0T2Zmc2V0K3QuaGVhZGVySW5mby5ibG9iU2l6ZSkpOihsPXQuaGVhZGVySW5mby5ibG9iU2l6ZS10LnB0cixNYXRoLmFicyhsKT49MSYmKHQuZW9mT2Zmc2V0PXQuaGVhZGVySW5mby5ibG9iU2l6ZSkpO3ZhciBmPXt3aWR0aDpuLndpZHRoLGhlaWdodDpuLmhlaWdodCxwaXhlbERhdGE6dC5waXhlbHMucmVzdWx0UGl4ZWxzLG1pblZhbHVlOm4uek1pbixtYXhWYWx1ZTpuLnpNYXgsdmFsaWRQaXhlbENvdW50Om4ubnVtVmFsaWRQaXhlbCxkaW1Db3VudDpuLm51bURpbXMsZGltU3RhdHM6e21pblZhbHVlczpuLm1pblZhbHVlcyxtYXhWYWx1ZXM6bi5tYXhWYWx1ZXN9LG1hc2tEYXRhOnQucGl4ZWxzLnJlc3VsdE1hc2t9O2lmKHQucGl4ZWxzLnJlc3VsdE1hc2smJmQuaXNWYWxpZFBpeGVsVmFsdWUobi5pbWFnZVR5cGUscikpe3ZhciBnPXQucGl4ZWxzLnJlc3VsdE1hc2s7Zm9yKHM9MDtzPG87cysrKWdbc118fChmLnBpeGVsRGF0YVtzXT1yKTtmLm5vRGF0YVZhbHVlPXJ9cmV0dXJuIHQubm9EYXRhVmFsdWU9cixlLnJldHVybkZpbGVJbmZvJiYoZi5maWxlSW5mbz1kLmZvcm1hdEZpbGVJbmZvKHQpKSxmfX0sZ2V0QmFuZENvdW50OmZ1bmN0aW9uKGEpe3ZhciBlPTAscj0wLHM9e307Zm9yKHMucHRyPTAscy5waXhlbHM9e307cjxhLmJ5dGVMZW5ndGgtNTg7KWQucmVhZEhlYWRlckluZm8oYSxzKSxyKz1zLmhlYWRlckluZm8uYmxvYlNpemUsZSsrLHMucHRyPXI7cmV0dXJuIGV9fTtyZXR1cm4gVn0oKTt2YXIgdGU9ZnVuY3Rpb24oKXt2YXIgaz1uZXcgQXJyYXlCdWZmZXIoNCksZD1uZXcgVWludDhBcnJheShrKSx5PW5ldyBVaW50MzJBcnJheShrKTtyZXR1cm4geVswXT0xLGRbMF09PT0xfSgpLGFlPXtkZWNvZGU6ZnVuY3Rpb24oayxkKXtpZighdGUpdGhyb3ciQmlnIGVuZGlhbiBzeXN0ZW0gaXMgbm90IHN1cHBvcnRlZC4iO2Q9ZHx8e307dmFyIHk9ZC5pbnB1dE9mZnNldHx8MCxWPW5ldyBVaW50OEFycmF5KGsseSwxMCksYT1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsViksZSxyO2lmKGEudHJpbSgpPT09IkNudFpJbWFnZSIpZT1uZSxyPTE7ZWxzZSBpZihhLnN1YnN0cmluZygwLDUpPT09IkxlcmMyIillPWllLHI9MjtlbHNlIHRocm93IlVuZXhwZWN0ZWQgZmlsZSBpZGVudGlmaWVyIHN0cmluZzogIithO2Zvcih2YXIgcz0wLHQ9ay5ieXRlTGVuZ3RoLTEwLG4saD1bXSxpLG8sYz17d2lkdGg6MCxoZWlnaHQ6MCxwaXhlbHM6W10scGl4ZWxUeXBlOmQucGl4ZWxUeXBlLG1hc2s6bnVsbCxzdGF0aXN0aWNzOltdfSx1PTA7eTx0Oyl7dmFyIG09ZS5kZWNvZGUoayx7aW5wdXRPZmZzZXQ6eSxlbmNvZGVkTWFza0RhdGE6bixtYXNrRGF0YTpvLHJldHVybk1hc2s6cz09PTAscmV0dXJuRW5jb2RlZE1hc2s6cz09PTAscmV0dXJuRmlsZUluZm86ITAscmV0dXJuUGl4ZWxJbnRlcmxlYXZlZERpbXM6ZC5yZXR1cm5QaXhlbEludGVybGVhdmVkRGltcyxwaXhlbFR5cGU6ZC5waXhlbFR5cGV8fG51bGwsbm9EYXRhVmFsdWU6ZC5ub0RhdGFWYWx1ZXx8bnVsbH0pO3k9bS5maWxlSW5mby5lb2ZPZmZzZXQsbz1tLm1hc2tEYXRhLHM9PT0wJiYobj1tLmVuY29kZWRNYXNrRGF0YSxjLndpZHRoPW0ud2lkdGgsYy5oZWlnaHQ9bS5oZWlnaHQsYy5kaW1Db3VudD1tLmRpbUNvdW50fHwxLGMucGl4ZWxUeXBlPW0ucGl4ZWxUeXBlfHxtLmZpbGVJbmZvLnBpeGVsVHlwZSxjLm1hc2s9bykscj4xJiYobyYmaC5wdXNoKG8pLG0uZmlsZUluZm8ubWFzayYmbS5maWxlSW5mby5tYXNrLm51bUJ5dGVzPjAmJnUrKykscysrLGMucGl4ZWxzLnB1c2gobS5waXhlbERhdGEpLGMuc3RhdGlzdGljcy5wdXNoKHttaW5WYWx1ZTptLm1pblZhbHVlLG1heFZhbHVlOm0ubWF4VmFsdWUsbm9EYXRhVmFsdWU6bS5ub0RhdGFWYWx1ZSxkaW1TdGF0czptLmRpbVN0YXRzfSl9dmFyIHcsbCxmO2lmKHI+MSYmdT4xKXtmb3IoZj1jLndpZHRoKmMuaGVpZ2h0LGMuYmFuZE1hc2tzPWgsbz1uZXcgVWludDhBcnJheShmKSxvLnNldChoWzBdKSx3PTE7dzxoLmxlbmd0aDt3KyspZm9yKGk9aFt3XSxsPTA7bDxmO2wrKylvW2xdPW9bbF0maVtsXTtjLm1hc2tEYXRhPW99cmV0dXJuIGN9fTtjb25zdCBzZT17MDo3ZTMsMTo2ZTMsMjo1ZTMsMzo0ZTMsNDozZTMsNToyNTAwLDY6MmUzLDc6MTUwMCw4OjgwMCw5OjUwMCwxMDoyMDAsMTE6MTAwLDEyOjQwLDEzOjEyLDE0OjUsMTU6MiwxNjoxLDE3Oi41LDE4Oi4yLDE5Oi4xLDIwOi4wMX07ZnVuY3Rpb24gZmUoayl7Y29uc3R7aGVpZ2h0OmQsd2lkdGg6eSxwaXhlbHM6Vn09YWUuZGVjb2RlKGspLGE9bmV3IEZsb2F0MzJBcnJheShkKnkpO2ZvcihsZXQgZT0wO2U8YS5sZW5ndGg7ZSsrKWFbZV09VlswXVtlXTtyZXR1cm57YXJyYXk6YSx3aWR0aDp5LGhlaWdodDpkfX1mdW5jdGlvbiBvZShrLGQseSl7bGV0IFY9ZmUoayk7eVsyXS15WzBdPDEmJihWPWxlKFYseSkpO2NvbnN0e2FycmF5OmEsd2lkdGg6ZX09VixzPW5ldyBlZShlKS5jcmVhdGVUaWxlKGEpLHQ9c2VbZF18fDA7cmV0dXJuIHMuZ2V0R2VvbWV0cnlEYXRhKHQpfWZ1bmN0aW9uIGxlKGssZCl7ZnVuY3Rpb24geShzLHQsbixoLGksbyxjLHUpe2NvbnN0IG09bmV3IEZsb2F0MzJBcnJheShpKm8pO2ZvcihsZXQgbD0wO2w8bztsKyspZm9yKGxldCBmPTA7ZjxpO2YrKyl7Y29uc3QgZz0obCtoKSp0KyhmK24pLE09bCppK2Y7bVtNXT1zW2ddfWNvbnN0IHc9bmV3IEZsb2F0MzJBcnJheSh1KmMpO2ZvcihsZXQgbD0wO2w8dTtsKyspZm9yKGxldCBmPTA7ZjxjO2YrKyl7Y29uc3QgZz1sKnUrZixNPU1hdGgucm91bmQoZipvL3UpLHA9TWF0aC5yb3VuZChsKmkvYykqaStNO3dbZ109bVtwXX1yZXR1cm4gd31jb25zdCBWPXVlKGQsay53aWR0aCksYT1WLnN3KzEsZT1WLnNoKzE7cmV0dXJue2FycmF5Onkoay5hcnJheSxrLndpZHRoLFYuc3gsVi5zeSxWLnN3LFYuc2gsYSxlKSx3aWR0aDphLGhlaWdodDplfX1mdW5jdGlvbiB1ZShrLGQpe2NvbnN0IHk9TWF0aC5mbG9vcihrWzBdKmQpLFY9TWF0aC5mbG9vcihrWzFdKmQpLGE9TWF0aC5mbG9vcigoa1syXS1rWzBdKSpkKSxlPU1hdGguZmxvb3IoKGtbM10ta1sxXSkqZCk7cmV0dXJue3N4Onksc3k6VixzdzphLHNoOmV9fXNlbGYub25tZXNzYWdlPWs9Pntjb25zdCBkPWsuZGF0YSx5PW9lKGQuZGVtRGF0YSxkLnosZC5jbGlwQm91bmRzKTtzZWxmLnBvc3RNZXNzYWdlKHkpfX0pKCk7Cg==",DK=n=>Uint8Array.from(atob(n),e=>e.charCodeAt(0)),$M=typeof self<"u"&&self.Blob&&new Blob([DK(rC)],{type:"text/javascript;charset=utf-8"});function NK(n){let e;try{if(e=$M&&(self.URL||self.webkitURL).createObjectURL($M),!e)throw"";const t=new Worker(e,{name:n==null?void 0:n.name});return t.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),t}catch{return new Worker("data:text/javascript;base64,"+rC,{name:n==null?void 0:n.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}const OK=function(){var n={};n.defaultNoDataValue=-34027999387901484e22,n.decode=function(o,a){a=a||{};var l=a.encodedMaskData||a.encodedMaskData===null,c=r(o,a.inputOffset||0,l),h=a.noDataValue!==null?a.noDataValue:n.defaultNoDataValue,d=e(c,a.pixelType||Float32Array,a.encodedMaskData,h,a.returnMask),p={width:c.width,height:c.height,pixelData:d.resultPixels,minValue:d.minValue,maxValue:c.pixels.maxValue,noDataValue:h};return d.resultMask&&(p.maskData=d.resultMask),a.returnEncodedMask&&c.mask&&(p.encodedMaskData=c.mask.bitset?c.mask.bitset:null),a.returnFileInfo&&(p.fileInfo=t(c),a.computeUsedBitDepths&&(p.fileInfo.bitDepths=i(c))),p};var e=function(o,a,l,c,h){var d=0,p=o.pixels.numBlocksX,m=o.pixels.numBlocksY,y=Math.floor(o.width/p),b=Math.floor(o.height/m),v=2*o.maxZError,g=Number.MAX_VALUE,x;l=l||(o.mask?o.mask.bitset:null);var w,S;w=new a(o.width*o.height),h&&l&&(S=new Uint8Array(o.width*o.height));for(var C=new Float32Array(y*b),A,E,O=0;O<=m;O++){var R=O!==m?b:o.height%m;if(R!==0)for(var T=0;T<=p;T++){var k=T!==p?y:o.width%p;if(k!==0){var Y=O*o.width*b+T*y,$=o.width-k,re=o.pixels.blocks[d],ae,V,te;re.encoding<2?(re.encoding===0?ae=re.rawData:(s(re.stuffedData,re.bitsPerPixel,re.numValidPixels,re.offset,v,C,o.pixels.maxValue),ae=C),V=0):re.encoding===2?te=0:te=re.offset;var J;if(l)for(E=0;E<R;E++){for(Y&7&&(J=l[Y>>3],J<<=Y&7),A=0;A<k;A++)Y&7||(J=l[Y>>3]),J&128?(S&&(S[Y]=1),x=re.encoding<2?ae[V++]:te,g=g>x?x:g,w[Y++]=x):(S&&(S[Y]=0),w[Y++]=c),J<<=1;Y+=$}else if(re.encoding<2)for(E=0;E<R;E++){for(A=0;A<k;A++)x=ae[V++],g=g>x?x:g,w[Y++]=x;Y+=$}else for(g=g>te?te:g,E=0;E<R;E++){for(A=0;A<k;A++)w[Y++]=te;Y+=$}if(re.encoding===1&&V!==re.numValidPixels)throw"Block and Mask do not match";d++}}}return{resultPixels:w,resultMask:S,minValue:g}},t=function(o){return{fileIdentifierString:o.fileIdentifierString,fileVersion:o.fileVersion,imageType:o.imageType,height:o.height,width:o.width,maxZError:o.maxZError,eofOffset:o.eofOffset,mask:o.mask?{numBlocksX:o.mask.numBlocksX,numBlocksY:o.mask.numBlocksY,numBytes:o.mask.numBytes,maxValue:o.mask.maxValue}:null,pixels:{numBlocksX:o.pixels.numBlocksX,numBlocksY:o.pixels.numBlocksY,numBytes:o.pixels.numBytes,maxValue:o.pixels.maxValue,noDataValue:o.noDataValue}}},i=function(o){for(var a=o.pixels.numBlocksX*o.pixels.numBlocksY,l={},c=0;c<a;c++){var h=o.pixels.blocks[c];h.encoding===0?l.float32=!0:h.encoding===1?l[h.bitsPerPixel]=!0:l[0]=!0}return Object.keys(l)},r=function(o,a,l){var c={},h=new Uint8Array(o,a,10);if(c.fileIdentifierString=String.fromCharCode.apply(null,h),c.fileIdentifierString.trim()!=="CntZImage")throw"Unexpected file identifier string: "+c.fileIdentifierString;a+=10;var d=new DataView(o,a,24);if(c.fileVersion=d.getInt32(0,!0),c.imageType=d.getInt32(4,!0),c.height=d.getUint32(8,!0),c.width=d.getUint32(12,!0),c.maxZError=d.getFloat64(16,!0),a+=24,!l)if(d=new DataView(o,a,16),c.mask={},c.mask.numBlocksY=d.getUint32(0,!0),c.mask.numBlocksX=d.getUint32(4,!0),c.mask.numBytes=d.getUint32(8,!0),c.mask.maxValue=d.getFloat32(12,!0),a+=16,c.mask.numBytes>0){var p=new Uint8Array(Math.ceil(c.width*c.height/8));d=new DataView(o,a,c.mask.numBytes);var m=d.getInt16(0,!0),y=2,b=0;do{if(m>0)for(;m--;)p[b++]=d.getUint8(y++);else{var v=d.getUint8(y++);for(m=-m;m--;)p[b++]=v}m=d.getInt16(y,!0),y+=2}while(y<c.mask.numBytes);if(m!==-32768||b<p.length)throw"Unexpected end of mask RLE encoding";c.mask.bitset=p,a+=c.mask.numBytes}else c.mask.numBytes|c.mask.numBlocksY|c.mask.maxValue||(c.mask.bitset=new Uint8Array(Math.ceil(c.width*c.height/8)));d=new DataView(o,a,16),c.pixels={},c.pixels.numBlocksY=d.getUint32(0,!0),c.pixels.numBlocksX=d.getUint32(4,!0),c.pixels.numBytes=d.getUint32(8,!0),c.pixels.maxValue=d.getFloat32(12,!0),a+=16;var g=c.pixels.numBlocksX,x=c.pixels.numBlocksY,w=g+(c.width%g>0?1:0),S=x+(c.height%x>0?1:0);c.pixels.blocks=new Array(w*S);for(var C=0,A=0;A<S;A++)for(var E=0;E<w;E++){var O=0,R=o.byteLength-a;d=new DataView(o,a,Math.min(10,R));var T={};c.pixels.blocks[C++]=T;var k=d.getUint8(0);if(O++,T.encoding=k&63,T.encoding>3)throw"Invalid block encoding ("+T.encoding+")";if(T.encoding===2){a++;continue}if(k!==0&&k!==2){if(k>>=6,T.offsetType=k,k===2)T.offset=d.getInt8(1),O++;else if(k===1)T.offset=d.getInt16(1,!0),O+=2;else if(k===0)T.offset=d.getFloat32(1,!0),O+=4;else throw"Invalid block offset type";if(T.encoding===1)if(k=d.getUint8(O),O++,T.bitsPerPixel=k&63,k>>=6,T.numValidPixelsType=k,k===2)T.numValidPixels=d.getUint8(O),O++;else if(k===1)T.numValidPixels=d.getUint16(O,!0),O+=2;else if(k===0)T.numValidPixels=d.getUint32(O,!0),O+=4;else throw"Invalid valid pixel count type"}if(a+=O,T.encoding!==3){var Y,$;if(T.encoding===0){var re=(c.pixels.numBytes-1)/4;if(re!==Math.floor(re))throw"uncompressed block has invalid length";Y=new ArrayBuffer(re*4),$=new Uint8Array(Y),$.set(new Uint8Array(o,a,re*4));var ae=new Float32Array(Y);T.rawData=ae,a+=re*4}else if(T.encoding===1){var V=Math.ceil(T.numValidPixels*T.bitsPerPixel/8),te=Math.ceil(V/4);Y=new ArrayBuffer(te*4),$=new Uint8Array(Y),$.set(new Uint8Array(o,a,V)),T.stuffedData=new Uint32Array(Y),a+=V}}}return c.eofOffset=a,c},s=function(o,a,l,c,h,d,p){var m=(1<<a)-1,y=0,b,v=0,g,x,w=Math.ceil((p-c)/h),S=o.length*4-Math.ceil(a*l/8);for(o[o.length-1]<<=8*S,b=0;b<l;b++){if(v===0&&(x=o[y++],v=32),v>=a)g=x>>>v-a&m,v-=a;else{var C=a-v;g=(x&m)<<C&m,x=o[y++],v=32-C,g+=x>>>v}d[b]=g<w?c+g*h:p}return d};return n}(),kK=function(){var n={unstuff:function(r,s,o,a,l,c,h,d){var p=(1<<o)-1,m=0,y,b=0,v,g,x,w,S=r.length*4-Math.ceil(o*a/8);if(r[r.length-1]<<=8*S,l)for(y=0;y<a;y++)b===0&&(g=r[m++],b=32),b>=o?(v=g>>>b-o&p,b-=o):(x=o-b,v=(g&p)<<x&p,g=r[m++],b=32-x,v+=g>>>b),s[y]=l[v];else for(w=Math.ceil((d-c)/h),y=0;y<a;y++)b===0&&(g=r[m++],b=32),b>=o?(v=g>>>b-o&p,b-=o):(x=o-b,v=(g&p)<<x&p,g=r[m++],b=32-x,v+=g>>>b),s[y]=v<w?c+v*h:d},unstuffLUT:function(r,s,o,a,l,c){var h=(1<<s)-1,d=0,p=0,m=0,y=0,b=0,v,g=[],x=r.length*4-Math.ceil(s*o/8);r[r.length-1]<<=8*x;var w=Math.ceil((c-a)/l);for(p=0;p<o;p++)y===0&&(v=r[d++],y=32),y>=s?(b=v>>>y-s&h,y-=s):(m=s-y,b=(v&h)<<m&h,v=r[d++],y=32-m,b+=v>>>y),g[p]=b<w?a+b*l:c;return g.unshift(a),g},unstuff2:function(r,s,o,a,l,c,h,d){var p=(1<<o)-1,m=0,y,b=0,v=0,g,x,w;if(l)for(y=0;y<a;y++)b===0&&(x=r[m++],b=32,v=0),b>=o?(g=x>>>v&p,b-=o,v+=o):(w=o-b,g=x>>>v&p,x=r[m++],b=32-w,g|=(x&(1<<w)-1)<<o-w,v=w),s[y]=l[g];else{var S=Math.ceil((d-c)/h);for(y=0;y<a;y++)b===0&&(x=r[m++],b=32,v=0),b>=o?(g=x>>>v&p,b-=o,v+=o):(w=o-b,g=x>>>v&p,x=r[m++],b=32-w,g|=(x&(1<<w)-1)<<o-w,v=w),s[y]=g<S?c+g*h:d}return s},unstuffLUT2:function(r,s,o,a,l,c){var h=(1<<s)-1,d=0,p=0,m=0,y=0,b=0,v=0,g,x=[],w=Math.ceil((c-a)/l);for(p=0;p<o;p++)y===0&&(g=r[d++],y=32,v=0),y>=s?(b=g>>>v&h,y-=s,v+=s):(m=s-y,b=g>>>v&h,g=r[d++],y=32-m,b|=(g&(1<<m)-1)<<s-m,v=m),x[p]=b<w?a+b*l:c;return x.unshift(a),x},originalUnstuff:function(r,s,o,a){var l=(1<<o)-1,c=0,h,d=0,p,m,y,b=r.length*4-Math.ceil(o*a/8);for(r[r.length-1]<<=8*b,h=0;h<a;h++)d===0&&(m=r[c++],d=32),d>=o?(p=m>>>d-o&l,d-=o):(y=o-d,p=(m&l)<<y&l,m=r[c++],d=32-y,p+=m>>>d),s[h]=p;return s},originalUnstuff2:function(r,s,o,a){var l=(1<<o)-1,c=0,h,d=0,p=0,m,y,b;for(h=0;h<a;h++)d===0&&(y=r[c++],d=32,p=0),d>=o?(m=y>>>p&l,d-=o,p+=o):(b=o-d,m=y>>>p&l,y=r[c++],d=32-b,m|=(y&(1<<b)-1)<<o-b,p=b),s[h]=m;return s}},e={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(r){for(var s=65535,o=65535,a=r.length,l=Math.floor(a/2),c=0;l;){var h=l>=359?359:l;l-=h;do s+=r[c++]<<8,o+=s+=r[c++];while(--h);s=(s&65535)+(s>>>16),o=(o&65535)+(o>>>16)}return a&1&&(o+=s+=r[c]<<8),s=(s&65535)+(s>>>16),o=(o&65535)+(o>>>16),(o<<16|s)>>>0},readHeaderInfo:function(r,s){var o=s.ptr,a=new Uint8Array(r,o,6),l={};if(l.fileIdentifierString=String.fromCharCode.apply(null,a),l.fileIdentifierString.lastIndexOf("Lerc2",0)!==0)throw"Unexpected file identifier string (expect Lerc2 ): "+l.fileIdentifierString;o+=6;var c=new DataView(r,o,8),h=c.getInt32(0,!0);l.fileVersion=h,o+=4,h>=3&&(l.checksum=c.getUint32(4,!0),o+=4),c=new DataView(r,o,12),l.height=c.getUint32(0,!0),l.width=c.getUint32(4,!0),o+=8,h>=4?(l.numDims=c.getUint32(8,!0),o+=4):l.numDims=1,c=new DataView(r,o,40),l.numValidPixel=c.getUint32(0,!0),l.microBlockSize=c.getInt32(4,!0),l.blobSize=c.getInt32(8,!0),l.imageType=c.getInt32(12,!0),l.maxZError=c.getFloat64(16,!0),l.zMin=c.getFloat64(24,!0),l.zMax=c.getFloat64(32,!0),o+=40,s.headerInfo=l,s.ptr=o;var d,p;if(h>=3&&(p=h>=4?52:48,d=this.computeChecksumFletcher32(new Uint8Array(r,o-p,l.blobSize-14)),d!==l.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(r,s){var o=s.headerInfo,a=this.getDataTypeArray(o.imageType),l=o.numDims*this.getDataTypeSize(o.imageType),c=this.readSubArray(r,s.ptr,a,l),h=this.readSubArray(r,s.ptr+l,a,l);s.ptr+=2*l;var d,p=!0;for(d=0;d<o.numDims;d++)if(c[d]!==h[d]){p=!1;break}return o.minValues=c,o.maxValues=h,p},readSubArray:function(r,s,o,a){var l;if(o===Uint8Array)l=new Uint8Array(r,s,a);else{var c=new ArrayBuffer(a),h=new Uint8Array(c);h.set(new Uint8Array(r,s,a)),l=new o(c)}return l},readMask:function(r,s){var o=s.ptr,a=s.headerInfo,l=a.width*a.height,c=a.numValidPixel,h=new DataView(r,o,4),d={};if(d.numBytes=h.getUint32(0,!0),o+=4,(c===0||l===c)&&d.numBytes!==0)throw"invalid mask";var p,m;if(c===0)p=new Uint8Array(Math.ceil(l/8)),d.bitset=p,m=new Uint8Array(l),s.pixels.resultMask=m,o+=d.numBytes;else if(d.numBytes>0){p=new Uint8Array(Math.ceil(l/8)),h=new DataView(r,o,d.numBytes);var y=h.getInt16(0,!0),b=2,v=0,g=0;do{if(y>0)for(;y--;)p[v++]=h.getUint8(b++);else for(g=h.getUint8(b++),y=-y;y--;)p[v++]=g;y=h.getInt16(b,!0),b+=2}while(b<d.numBytes);if(y!==-32768||v<p.length)throw"Unexpected end of mask RLE encoding";m=new Uint8Array(l);var x=0,w=0;for(w=0;w<l;w++)w&7?(x=p[w>>3],x<<=w&7):x=p[w>>3],x&128&&(m[w]=1);s.pixels.resultMask=m,d.bitset=p,o+=d.numBytes}return s.ptr=o,s.mask=d,!0},readDataOneSweep:function(r,s,o,a){var l=s.ptr,c=s.headerInfo,h=c.numDims,d=c.width*c.height,p=c.imageType,m=c.numValidPixel*e.getDataTypeSize(p)*h,y,b=s.pixels.resultMask;if(o===Uint8Array)y=new Uint8Array(r,l,m);else{var v=new ArrayBuffer(m),g=new Uint8Array(v);g.set(new Uint8Array(r,l,m)),y=new o(v)}if(y.length===d*h)a?s.pixels.resultPixels=e.swapDimensionOrder(y,d,h,o,!0):s.pixels.resultPixels=y;else{s.pixels.resultPixels=new o(d*h);var x=0,w=0,S=0,C=0;if(h>1){if(a){for(w=0;w<d;w++)if(b[w])for(C=w,S=0;S<h;S++,C+=d)s.pixels.resultPixels[C]=y[x++]}else for(w=0;w<d;w++)if(b[w])for(C=w*h,S=0;S<h;S++)s.pixels.resultPixels[C+S]=y[x++]}else for(w=0;w<d;w++)b[w]&&(s.pixels.resultPixels[w]=y[x++])}return l+=m,s.ptr=l,!0},readHuffmanTree:function(r,s){var o=this.HUFFMAN_LUT_BITS_MAX,a=new DataView(r,s.ptr,16);s.ptr+=16;var l=a.getInt32(0,!0);if(l<2)throw"unsupported Huffman version";var c=a.getInt32(4,!0),h=a.getInt32(8,!0),d=a.getInt32(12,!0);if(h>=d)return!1;var p=new Uint32Array(d-h);e.decodeBits(r,s,p);var m=[],y,b,v,g;for(y=h;y<d;y++)b=y-(y<c?0:c),m[b]={first:p[y-h],second:null};var x=r.byteLength-s.ptr,w=Math.ceil(x/4),S=new ArrayBuffer(w*4),C=new Uint8Array(S);C.set(new Uint8Array(r,s.ptr,x));var A=new Uint32Array(S),E=0,O,R=0;for(O=A[0],y=h;y<d;y++)b=y-(y<c?0:c),g=m[b].first,g>0&&(m[b].second=O<<E>>>32-g,32-E>=g?(E+=g,E===32&&(E=0,R++,O=A[R])):(E+=g-32,R++,O=A[R],m[b].second|=O>>>32-E));var T=0,k=0,Y=new t;for(y=0;y<m.length;y++)m[y]!==void 0&&(T=Math.max(T,m[y].first));T>=o?k=o:k=T;var $=[],re,ae,V,te,J,pe;for(y=h;y<d;y++)if(b=y-(y<c?0:c),g=m[b].first,g>0)if(re=[g,b],g<=k)for(ae=m[b].second<<k-g,V=1<<k-g,v=0;v<V;v++)$[ae|v]=re;else for(ae=m[b].second,pe=Y,te=g-1;te>=0;te--)J=ae>>>te&1,J?(pe.right||(pe.right=new t),pe=pe.right):(pe.left||(pe.left=new t),pe=pe.left),te===0&&!pe.val&&(pe.val=re[1]);return{decodeLut:$,numBitsLUTQick:k,numBitsLUT:T,tree:Y,stuffedData:A,srcPtr:R,bitPos:E}},readHuffman:function(r,s,o,a){var l=s.headerInfo,c=l.numDims,h=s.headerInfo.height,d=s.headerInfo.width,p=d*h,m=this.readHuffmanTree(r,s),y=m.decodeLut,b=m.tree,v=m.stuffedData,g=m.srcPtr,x=m.bitPos,w=m.numBitsLUTQick,S=m.numBitsLUT,C=s.headerInfo.imageType===0?128:0,A,E,O,R=s.pixels.resultMask,T,k,Y,$,re,ae,V,te=0;x>0&&(g++,x=0);var J=v[g],pe=s.encodeMode===1,Te=new o(p*c),Le=Te,Ue;if(c<2||pe){for(Ue=0;Ue<c;Ue++)if(c>1&&(Le=new o(Te.buffer,p*Ue,p),te=0),s.headerInfo.numValidPixel===d*h)for(ae=0,$=0;$<h;$++)for(re=0;re<d;re++,ae++){if(E=0,T=J<<x>>>32-w,k=T,32-x<w&&(T|=v[g+1]>>>64-x-w,k=T),y[k])E=y[k][1],x+=y[k][0];else for(T=J<<x>>>32-S,k=T,32-x<S&&(T|=v[g+1]>>>64-x-S,k=T),A=b,V=0;V<S;V++)if(Y=T>>>S-V-1&1,A=Y?A.right:A.left,!(A.left||A.right)){E=A.val,x=x+V+1;break}x>=32&&(x-=32,g++,J=v[g]),O=E-C,pe?(re>0?O+=te:$>0?O+=Le[ae-d]:O+=te,O&=255,Le[ae]=O,te=O):Le[ae]=O}else for(ae=0,$=0;$<h;$++)for(re=0;re<d;re++,ae++)if(R[ae]){if(E=0,T=J<<x>>>32-w,k=T,32-x<w&&(T|=v[g+1]>>>64-x-w,k=T),y[k])E=y[k][1],x+=y[k][0];else for(T=J<<x>>>32-S,k=T,32-x<S&&(T|=v[g+1]>>>64-x-S,k=T),A=b,V=0;V<S;V++)if(Y=T>>>S-V-1&1,A=Y?A.right:A.left,!(A.left||A.right)){E=A.val,x=x+V+1;break}x>=32&&(x-=32,g++,J=v[g]),O=E-C,pe?(re>0&&R[ae-1]?O+=te:$>0&&R[ae-d]?O+=Le[ae-d]:O+=te,O&=255,Le[ae]=O,te=O):Le[ae]=O}}else for(ae=0,$=0;$<h;$++)for(re=0;re<d;re++)if(ae=$*d+re,!R||R[ae])for(Ue=0;Ue<c;Ue++,ae+=p){if(E=0,T=J<<x>>>32-w,k=T,32-x<w&&(T|=v[g+1]>>>64-x-w,k=T),y[k])E=y[k][1],x+=y[k][0];else for(T=J<<x>>>32-S,k=T,32-x<S&&(T|=v[g+1]>>>64-x-S,k=T),A=b,V=0;V<S;V++)if(Y=T>>>S-V-1&1,A=Y?A.right:A.left,!(A.left||A.right)){E=A.val,x=x+V+1;break}x>=32&&(x-=32,g++,J=v[g]),O=E-C,Le[ae]=O}s.ptr=s.ptr+(g+1)*4+(x>0?4:0),s.pixels.resultPixels=Te,c>1&&!a&&(s.pixels.resultPixels=e.swapDimensionOrder(Te,p,c,o))},decodeBits:function(r,s,o,a,l){{var c=s.headerInfo,h=c.fileVersion,d=0,p=r.byteLength-s.ptr>=5?5:r.byteLength-s.ptr,m=new DataView(r,s.ptr,p),y=m.getUint8(0);d++;var b=y>>6,v=b===0?4:3-b,g=(y&32)>0,x=y&31,w=0;if(v===1)w=m.getUint8(d),d++;else if(v===2)w=m.getUint16(d,!0),d+=2;else if(v===4)w=m.getUint32(d,!0),d+=4;else throw"Invalid valid pixel count type";var S=2*c.maxZError,C,A,E,O,R,T,k,Y,$,re=c.numDims>1?c.maxValues[l]:c.zMax;if(g){for(s.counter.lut++,Y=m.getUint8(d),d++,O=Math.ceil((Y-1)*x/8),R=Math.ceil(O/4),A=new ArrayBuffer(R*4),E=new Uint8Array(A),s.ptr+=d,E.set(new Uint8Array(r,s.ptr,O)),k=new Uint32Array(A),s.ptr+=O,$=0;Y-1>>>$;)$++;O=Math.ceil(w*$/8),R=Math.ceil(O/4),A=new ArrayBuffer(R*4),E=new Uint8Array(A),E.set(new Uint8Array(r,s.ptr,O)),C=new Uint32Array(A),s.ptr+=O,h>=3?T=n.unstuffLUT2(k,x,Y-1,a,S,re):T=n.unstuffLUT(k,x,Y-1,a,S,re),h>=3?n.unstuff2(C,o,$,w,T):n.unstuff(C,o,$,w,T)}else s.counter.bitstuffer++,$=x,s.ptr+=d,$>0&&(O=Math.ceil(w*$/8),R=Math.ceil(O/4),A=new ArrayBuffer(R*4),E=new Uint8Array(A),E.set(new Uint8Array(r,s.ptr,O)),C=new Uint32Array(A),s.ptr+=O,h>=3?a==null?n.originalUnstuff2(C,o,$,w):n.unstuff2(C,o,$,w,!1,a,S,re):a==null?n.originalUnstuff(C,o,$,w):n.unstuff(C,o,$,w,!1,a,S,re))}},readTiles:function(r,s,o,a){var l=s.headerInfo,c=l.width,h=l.height,d=c*h,p=l.microBlockSize,m=l.imageType,y=e.getDataTypeSize(m),b=Math.ceil(c/p),v=Math.ceil(h/p);s.pixels.numBlocksY=v,s.pixels.numBlocksX=b,s.pixels.ptr=0;var g=0,x=0,w=0,S=0,C=0,A=0,E=0,O=0,R=0,T=0,k=0,Y=0,$=0,re=0,ae=0,V=0,te,J,pe,Te,Le,Ue,tt=new o(p*p),_e=h%p||p,Ae=c%p||p,We,se,Se=l.numDims,Me,De=s.pixels.resultMask,Be=s.pixels.resultPixels,H=l.fileVersion,X=H>=5?14:15,D,ge=l.zMax,me;for(w=0;w<v;w++)for(C=w!==v-1?p:_e,S=0;S<b;S++)for(A=S!==b-1?p:Ae,k=w*c*p+S*p,Y=c-A,Me=0;Me<Se;Me++){if(Se>1?(me=Be,k=w*c*p+S*p,Be=new o(s.pixels.resultPixels.buffer,d*Me*y,d),ge=l.maxValues[Me]):me=null,E=r.byteLength-s.ptr,te=new DataView(r,s.ptr,Math.min(10,E)),J={},V=0,O=te.getUint8(0),V++,D=l.fileVersion>=5?O&4:0,R=O>>6&255,T=O>>2&X,T!==(S*p>>3&X)||D&&Me===0)throw"integrity issue";if(Ue=O&3,Ue>3)throw s.ptr+=V,"Invalid block encoding ("+Ue+")";if(Ue===2){if(D)if(De)for(g=0;g<C;g++)for(x=0;x<A;x++)De[k]&&(Be[k]=me[k]),k++;else for(g=0;g<C;g++)for(x=0;x<A;x++)Be[k]=me[k],k++;s.counter.constant++,s.ptr+=V;continue}else if(Ue===0){if(D)throw"integrity issue";if(s.counter.uncompressed++,s.ptr+=V,$=C*A*y,re=r.byteLength-s.ptr,$=$<re?$:re,pe=new ArrayBuffer($%y===0?$:$+y-$%y),Te=new Uint8Array(pe),Te.set(new Uint8Array(r,s.ptr,$)),Le=new o(pe),ae=0,De)for(g=0;g<C;g++){for(x=0;x<A;x++)De[k]&&(Be[k]=Le[ae++]),k++;k+=Y}else for(g=0;g<C;g++){for(x=0;x<A;x++)Be[k++]=Le[ae++];k+=Y}s.ptr+=ae*y}else if(We=e.getDataTypeUsed(D&&m<6?4:m,R),se=e.getOnePixel(J,V,We,te),V+=e.getDataTypeSize(We),Ue===3)if(s.ptr+=V,s.counter.constantoffset++,De)for(g=0;g<C;g++){for(x=0;x<A;x++)De[k]&&(Be[k]=D?Math.min(ge,me[k]+se):se),k++;k+=Y}else for(g=0;g<C;g++){for(x=0;x<A;x++)Be[k]=D?Math.min(ge,me[k]+se):se,k++;k+=Y}else if(s.ptr+=V,e.decodeBits(r,s,tt,se,Me),V=0,D)if(De)for(g=0;g<C;g++){for(x=0;x<A;x++)De[k]&&(Be[k]=tt[V++]+me[k]),k++;k+=Y}else for(g=0;g<C;g++){for(x=0;x<A;x++)Be[k]=tt[V++]+me[k],k++;k+=Y}else if(De)for(g=0;g<C;g++){for(x=0;x<A;x++)De[k]&&(Be[k]=tt[V++]),k++;k+=Y}else for(g=0;g<C;g++){for(x=0;x<A;x++)Be[k++]=tt[V++];k+=Y}}Se>1&&!a&&(s.pixels.resultPixels=e.swapDimensionOrder(s.pixels.resultPixels,d,Se,o))},formatFileInfo:function(r){return{fileIdentifierString:r.headerInfo.fileIdentifierString,fileVersion:r.headerInfo.fileVersion,imageType:r.headerInfo.imageType,height:r.headerInfo.height,width:r.headerInfo.width,numValidPixel:r.headerInfo.numValidPixel,microBlockSize:r.headerInfo.microBlockSize,blobSize:r.headerInfo.blobSize,maxZError:r.headerInfo.maxZError,pixelType:e.getPixelType(r.headerInfo.imageType),eofOffset:r.eofOffset,mask:r.mask?{numBytes:r.mask.numBytes}:null,pixels:{numBlocksX:r.pixels.numBlocksX,numBlocksY:r.pixels.numBlocksY,maxValue:r.headerInfo.zMax,minValue:r.headerInfo.zMin,noDataValue:r.noDataValue}}},constructConstantSurface:function(r,s){var o=r.headerInfo.zMax,a=r.headerInfo.zMin,l=r.headerInfo.maxValues,c=r.headerInfo.numDims,h=r.headerInfo.height*r.headerInfo.width,d=0,p=0,m=0,y=r.pixels.resultMask,b=r.pixels.resultPixels;if(y)if(c>1){if(s)for(d=0;d<c;d++)for(m=d*h,o=l[d],p=0;p<h;p++)y[p]&&(b[m+p]=o);else for(p=0;p<h;p++)if(y[p])for(m=p*c,d=0;d<c;d++)b[m+c]=l[d]}else for(p=0;p<h;p++)y[p]&&(b[p]=o);else if(c>1&&a!==o)if(s)for(d=0;d<c;d++)for(m=d*h,o=l[d],p=0;p<h;p++)b[m+p]=o;else for(p=0;p<h;p++)for(m=p*c,d=0;d<c;d++)b[m+d]=l[d];else for(p=0;p<h*c;p++)b[p]=o},getDataTypeArray:function(r){var s;switch(r){case 0:s=Int8Array;break;case 1:s=Uint8Array;break;case 2:s=Int16Array;break;case 3:s=Uint16Array;break;case 4:s=Int32Array;break;case 5:s=Uint32Array;break;case 6:s=Float32Array;break;case 7:s=Float64Array;break;default:s=Float32Array}return s},getPixelType:function(r){var s;switch(r){case 0:s="S8";break;case 1:s="U8";break;case 2:s="S16";break;case 3:s="U16";break;case 4:s="S32";break;case 5:s="U32";break;case 6:s="F32";break;case 7:s="F64";break;default:s="F32"}return s},isValidPixelValue:function(r,s){if(s==null)return!1;var o;switch(r){case 0:o=s>=-128&&s<=127;break;case 1:o=s>=0&&s<=255;break;case 2:o=s>=-32768&&s<=32767;break;case 3:o=s>=0&&s<=65536;break;case 4:o=s>=-2147483648&&s<=2147483647;break;case 5:o=s>=0&&s<=4294967296;break;case 6:o=s>=-34027999387901484e22&&s<=34027999387901484e22;break;case 7:o=s>=-17976931348623157e292&&s<=17976931348623157e292;break;default:o=!1}return o},getDataTypeSize:function(r){var s=0;switch(r){case 0:case 1:s=1;break;case 2:case 3:s=2;break;case 4:case 5:case 6:s=4;break;case 7:s=8;break;default:s=r}return s},getDataTypeUsed:function(r,s){var o=r;switch(r){case 2:case 4:o=r-s;break;case 3:case 5:o=r-2*s;break;case 6:s===0?o=r:s===1?o=2:o=1;break;case 7:s===0?o=r:o=r-2*s+1;break;default:o=r;break}return o},getOnePixel:function(r,s,o,a){var l=0;switch(o){case 0:l=a.getInt8(s);break;case 1:l=a.getUint8(s);break;case 2:l=a.getInt16(s,!0);break;case 3:l=a.getUint16(s,!0);break;case 4:l=a.getInt32(s,!0);break;case 5:l=a.getUInt32(s,!0);break;case 6:l=a.getFloat32(s,!0);break;case 7:l=a.getFloat64(s,!0);break;default:throw"the decoder does not understand this pixel type"}return l},swapDimensionOrder:function(r,s,o,a,l){var c=0,h=0,d=0,p=0,m=r;if(o>1)if(m=new a(s*o),l)for(c=0;c<s;c++)for(p=c,d=0;d<o;d++,p+=s)m[p]=r[h++];else for(c=0;c<s;c++)for(p=c,d=0;d<o;d++,p+=s)m[h++]=r[p];return m}},t=function(r,s,o){this.val=r,this.left=s,this.right=o},i={decode:function(r,s){s=s||{};var o=s.noDataValue,a=0,l={};if(l.ptr=s.inputOffset||0,l.pixels={},!!e.readHeaderInfo(r,l)){var c=l.headerInfo,h=c.fileVersion,d=e.getDataTypeArray(c.imageType);if(h>5)throw"unsupported lerc version 2."+h;e.readMask(r,l),c.numValidPixel!==c.width*c.height&&!l.pixels.resultMask&&(l.pixels.resultMask=s.maskData);var p=c.width*c.height;l.pixels.resultPixels=new d(p*c.numDims),l.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var m=!s.returnPixelInterleavedDims;if(c.numValidPixel!==0)if(c.zMax===c.zMin)e.constructConstantSurface(l,m);else if(h>=4&&e.checkMinMaxRanges(r,l))e.constructConstantSurface(l,m);else{var y=new DataView(r,l.ptr,2),b=y.getUint8(0);if(l.ptr++,b)e.readDataOneSweep(r,l,d,m);else if(h>1&&c.imageType<=1&&Math.abs(c.maxZError-.5)<1e-5){var v=y.getUint8(1);if(l.ptr++,l.encodeMode=v,v>2||h<4&&v>1)throw"Invalid Huffman flag "+v;v?e.readHuffman(r,l,d,m):e.readTiles(r,l,d,m)}else e.readTiles(r,l,d,m)}l.eofOffset=l.ptr;var g;s.inputOffset?(g=l.headerInfo.blobSize+s.inputOffset-l.ptr,Math.abs(g)>=1&&(l.eofOffset=s.inputOffset+l.headerInfo.blobSize)):(g=l.headerInfo.blobSize-l.ptr,Math.abs(g)>=1&&(l.eofOffset=l.headerInfo.blobSize));var x={width:c.width,height:c.height,pixelData:l.pixels.resultPixels,minValue:c.zMin,maxValue:c.zMax,validPixelCount:c.numValidPixel,dimCount:c.numDims,dimStats:{minValues:c.minValues,maxValues:c.maxValues},maskData:l.pixels.resultMask};if(l.pixels.resultMask&&e.isValidPixelValue(c.imageType,o)){var w=l.pixels.resultMask;for(a=0;a<p;a++)w[a]||(x.pixelData[a]=o);x.noDataValue=o}return l.noDataValue=o,s.returnFileInfo&&(x.fileInfo=e.formatFileInfo(l)),x}},getBandCount:function(r){var s=0,o=0,a={};for(a.ptr=0,a.pixels={};o<r.byteLength-58;)e.readHeaderInfo(r,a),o+=a.headerInfo.blobSize,s++,a.ptr=o;return s}};return i}();var FK=function(){var n=new ArrayBuffer(4),e=new Uint8Array(n),t=new Uint32Array(n);return t[0]=1,e[0]===1}(),UK={decode:function(n,e){if(!FK)throw"Big endian system is not supported.";e=e||{};var t=e.inputOffset||0,i=new Uint8Array(n,t,10),r=String.fromCharCode.apply(null,i),s,o;if(r.trim()==="CntZImage")s=OK,o=1;else if(r.substring(0,5)==="Lerc2")s=kK,o=2;else throw"Unexpected file identifier string: "+r;for(var a=0,l=n.byteLength-10,c,h=[],d,p,m={width:0,height:0,pixels:[],pixelType:e.pixelType,mask:null,statistics:[]},y=0;t<l;){var b=s.decode(n,{inputOffset:t,encodedMaskData:c,maskData:p,returnMask:a===0,returnEncodedMask:a===0,returnFileInfo:!0,returnPixelInterleavedDims:e.returnPixelInterleavedDims,pixelType:e.pixelType||null,noDataValue:e.noDataValue||null});t=b.fileInfo.eofOffset,p=b.maskData,a===0&&(c=b.encodedMaskData,m.width=b.width,m.height=b.height,m.dimCount=b.dimCount||1,m.pixelType=b.pixelType||b.fileInfo.pixelType,m.mask=p),o>1&&(p&&h.push(p),b.fileInfo.mask&&b.fileInfo.mask.numBytes>0&&y++),a++,m.pixels.push(b.pixelData),m.statistics.push({minValue:b.minValue,maxValue:b.maxValue,noDataValue:b.noDataValue,dimStats:b.dimStats})}var v,g,x;if(o>1&&y>1){for(x=m.width*m.height,m.bandMasks=h,p=new Uint8Array(x),p.set(h[0]),v=1;v<h.length;v++)for(d=h[v],g=0;g<x;g++)p[g]=p[g]&d[g];m.maskData=p}return m}};const zK={0:7e3,1:6e3,2:5e3,3:4e3,4:3e3,5:2500,6:2e3,7:1500,8:800,9:500,10:200,11:100,12:40,13:12,14:5,15:2,16:1,17:.5,18:.2,19:.1,20:.01};function WK(n){const{height:e,width:t,pixels:i}=UK.decode(n),r=new Float32Array(e*t);for(let s=0;s<r.length;s++)r[s]=i[0][s];return{array:r,width:t,height:e}}function VK(n,e,t){let i=WK(n);t[2]-t[0]<1&&(i=GK(i,t));const{array:r,width:s}=i,o=new gK(s).createTile(r),a=zK[e]||0;return o.getGeometryData(a)}function GK(n,e){function t(o,a,l,c,h,d,p,m){const y=new Float32Array(h*d);for(let v=0;v<d;v++)for(let g=0;g<h;g++){const x=(v+c)*a+(g+l),w=v*h+g;y[w]=o[x]}const b=new Float32Array(m*p);for(let v=0;v<m;v++)for(let g=0;g<p;g++){const x=v*m+g,w=Math.round(g*d/m),S=Math.round(v*h/p)*h+w;b[x]=y[S]}return b}const i=BK(e,n.width),r=i.sw+1,s=i.sh+1;return{array:t(n.array,n.width,i.sx,i.sy,i.sw,i.sh,r,s),width:r,height:s}}function BK(n,e){const t=Math.floor(n[0]*e),i=Math.floor(n[1]*e),r=Math.floor((n[2]-n[0])*e),s=Math.floor((n[3]-n[1])*e);return{sx:t,sy:i,sw:r,sh:s}}var HK=Object.defineProperty,ZK=(n,e,t)=>e in n?HK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Yf=(n,e,t)=>ZK(n,typeof e!="symbol"?e+"":e,t);const XK=10;class jK extends eC{constructor(){super(),Yf(this,"info",{version:"0.10.0",description:"Tile LERC terrain loader. It can load ArcGis-lerc format terrain data."}),Yf(this,"dataType","lerc"),Yf(this,"fileLoader",new zo(Jn.manager)),Yf(this,"_workerPool",new Wv(0)),this.fileLoader.setResponseType("arraybuffer"),this._workerPool.setWorkerCreator(()=>new NK)}async doLoad(e,t){this._workerPool.pool===0&&this._workerPool.setWorkerLimit(XK);const{z:i,bounds:r}=t,s=await this.fileLoader.loadAsync(e).catch(()=>new Float32Array(256*256)),o=VK(s,i,r);return new Dh().setData(o)}}iC(new jK);const sC="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGModCl7cmV0dXJuIGEodC5kYXRhKX1mdW5jdGlvbiBhKHQpe2Z1bmN0aW9uIG4oZSx1KXtjb25zdCByPXUqNCxbaSxmLGcsbF09ZS5zbGljZShyLHIrNCk7cmV0dXJuIGw9PT0wPzA6LTFlNCsoaTw8MTZ8Zjw8OHxnKSouMX1jb25zdCBvPXQubGVuZ3RoPj4+MixzPW5ldyBGbG9hdDMyQXJyYXkobyk7Zm9yKGxldCBlPTA7ZTxvO2UrKylzW2VdPW4odCxlKTtyZXR1cm4gc31zZWxmLm9ubWVzc2FnZT10PT57Y29uc3Qgbj1jKHQuZGF0YS5pbWdEYXRhKTtzZWxmLnBvc3RNZXNzYWdlKG4pfX0pKCk7Cg==",YK=n=>Uint8Array.from(atob(n),e=>e.charCodeAt(0)),qM=typeof self<"u"&&self.Blob&&new Blob([YK(sC)],{type:"text/javascript;charset=utf-8"});function KK(n){let e;try{if(e=qM&&(self.URL||self.webkitURL).createObjectURL(qM),!e)throw"";const t=new Worker(e,{name:n==null?void 0:n.name});return t.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),t}catch{return new Worker("data:text/javascript;base64,"+sC,{name:n==null?void 0:n.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}var JK=Object.defineProperty,QK=(n,e,t)=>e in n?JK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Kf=(n,e,t)=>QK(n,typeof e!="symbol"?e+"":e,t);const $K=10;class qK extends eC{constructor(){super(),Kf(this,"info",{version:"0.10.0",description:"Mapbox-RGB terrain loader, It can load Mapbox-RGB terrain data."}),Kf(this,"dataType","terrain-rgb"),Kf(this,"imageLoader",new pm(Jn.manager)),Kf(this,"_workerPool",new Wv(0)),this._workerPool.setWorkerCreator(()=>new KK)}async doLoad(e,t){const i=await this.imageLoader.loadAsync(e).catch(l=>new Image),r=Ai.clamp((t.z+2)*3,2,64),s=e6(i,t.bounds,r);let o;this._workerPool.pool===0&&this._workerPool.setWorkerLimit($K),o=(await this._workerPool.postMessage({imgData:s},[s.data.buffer])).data;const a=new Dh;return a.setData(o),a}}function e6(n,e,t){const i=JA(e,n.width);t=Math.min(t,i.sw);const r=new OffscreenCanvas(t,t).getContext("2d");return r.imageSmoothingEnabled=!1,r.drawImage(n,i.sx,i.sy,i.sw,i.sh,0,0,t,t),r.getImageData(0,0,t,t)}iC(new qK);function ga(n,e){this.x=n,this.y=e}ga.prototype={clone(){return new ga(this.x,this.y)},add(n){return this.clone()._add(n)},sub(n){return this.clone()._sub(n)},multByPoint(n){return this.clone()._multByPoint(n)},divByPoint(n){return this.clone()._divByPoint(n)},mult(n){return this.clone()._mult(n)},div(n){return this.clone()._div(n)},rotate(n){return this.clone()._rotate(n)},rotateAround(n,e){return this.clone()._rotateAround(n,e)},matMult(n){return this.clone()._matMult(n)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(n){return this.x===n.x&&this.y===n.y},dist(n){return Math.sqrt(this.distSqr(n))},distSqr(n){const e=n.x-this.x,t=n.y-this.y;return e*e+t*t},angle(){return Math.atan2(this.y,this.x)},angleTo(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith(n){return this.angleWithSep(n.x,n.y)},angleWithSep(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult(n){const e=n[0]*this.x+n[1]*this.y,t=n[2]*this.x+n[3]*this.y;return this.x=e,this.y=t,this},_add(n){return this.x+=n.x,this.y+=n.y,this},_sub(n){return this.x-=n.x,this.y-=n.y,this},_mult(n){return this.x*=n,this.y*=n,this},_div(n){return this.x/=n,this.y/=n,this},_multByPoint(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint(n){return this.x/=n.x,this.y/=n.y,this},_unit(){return this._div(this.mag()),this},_perp(){const n=this.y;return this.y=this.x,this.x=-n,this},_rotate(n){const e=Math.cos(n),t=Math.sin(n),i=e*this.x-t*this.y,r=t*this.x+e*this.y;return this.x=i,this.y=r,this},_rotateAround(n,e){const t=Math.cos(n),i=Math.sin(n),r=e.x+t*(this.x-e.x)-i*(this.y-e.y),s=e.y+i*(this.x-e.x)+t*(this.y-e.y);return this.x=r,this.y=s,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:ga};ga.convert=function(n){if(n instanceof ga)return n;if(Array.isArray(n))return new ga(+n[0],+n[1]);if(n.x!==void 0&&n.y!==void 0)return new ga(+n.x,+n.y);throw new Error("Expected [x, y] or {x, y} point format")};class oC{constructor(e,t,i,r,s){this.properties={},this.extent=i,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=s,e.readFields(t6,this,t)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos,i=[];let r,s=1,o=0,a=0,l=0;for(;e.pos<t;){if(o<=0){const c=e.readVarint();s=c&7,o=c>>3}if(o--,s===1||s===2)a+=e.readSVarint(),l+=e.readSVarint(),s===1&&(r&&i.push(r),r=[]),r&&r.push(new ga(a,l));else if(s===7)r&&r.push(r[0].clone());else throw new Error(`unknown command ${s}`)}return r&&i.push(r),i}bbox(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos;let i=1,r=0,s=0,o=0,a=1/0,l=-1/0,c=1/0,h=-1/0;for(;e.pos<t;){if(r<=0){const d=e.readVarint();i=d&7,r=d>>3}if(r--,i===1||i===2)s+=e.readSVarint(),o+=e.readSVarint(),s<a&&(a=s),s>l&&(l=s),o<c&&(c=o),o>h&&(h=o);else if(i!==7)throw new Error(`unknown command ${i}`)}return[a,c,l,h]}toGeoJSON(e,t,i){const r=this.extent*Math.pow(2,i),s=this.extent*e,o=this.extent*t,a=this.loadGeometry();function l(p){return[(p.x+s)*360/r-180,360/Math.PI*Math.atan(Math.exp((1-(p.y+o)*2/r)*Math.PI))-90]}function c(p){return p.map(l)}let h;if(this.type===1){const p=[];for(const y of a)p.push(y[0]);const m=c(p);h=p.length===1?{type:"Point",coordinates:m[0]}:{type:"MultiPoint",coordinates:m}}else if(this.type===2){const p=a.map(c);h=p.length===1?{type:"LineString",coordinates:p[0]}:{type:"MultiLineString",coordinates:p}}else if(this.type===3){const p=i6(a),m=[];for(const y of p)m.push(y.map(c));h=m.length===1?{type:"Polygon",coordinates:m[0]}:{type:"MultiPolygon",coordinates:m}}else throw new Error("unknown feature type");const d={type:"Feature",geometry:h,properties:this.properties};return this.id!=null&&(d.id=this.id),d}}oC.types=["Unknown","Point","LineString","Polygon"];function t6(n,e,t){n===1?e.id=t.readVarint():n===2?n6(t,e):n===3?e.type=t.readVarint():n===4&&(e._geometry=t.pos)}function n6(n,e){const t=n.readVarint()+n.pos;for(;n.pos<t;){const i=e._keys[n.readVarint()],r=e._values[n.readVarint()];e.properties[i]=r}}function i6(n){const e=n.length;if(e<=1)return[n];const t=[];let i,r;for(let s=0;s<e;s++){const o=r6(n[s]);o!==0&&(r===void 0&&(r=o<0),r===o<0?(i&&t.push(i),i=[n[s]]):i&&i.push(n[s]))}return i&&t.push(i),t}function r6(n){let e=0;for(let t=0,i=n.length,r=i-1,s,o;t<i;r=t++)s=n[t],o=n[r],e+=(o.x-s.x)*(s.y+o.y);return e}let s6=class{constructor(n,e){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(o6,this,e),this.length=this._features.length}feature(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];const e=this._pbf.readVarint()+this._pbf.pos;return new oC(this._pbf,e,this.extent,this._keys,this._values)}};function o6(n,e,t){n===15?e.version=t.readVarint():n===1?e.name=t.readString():n===5?e.extent=t.readVarint():n===2?e._features.push(t.pos):n===3?e._keys.push(t.readString()):n===4&&e._values.push(a6(t))}function a6(n){let e=null;const t=n.readVarint()+n.pos;for(;n.pos<t;){const i=n.readVarint()>>3;e=i===1?n.readString():i===2?n.readFloat():i===3?n.readDouble():i===4?n.readVarint64():i===5?n.readVarint():i===6?n.readSVarint():i===7?n.readBoolean():null}if(e==null)throw new Error("unknown feature value");return e}class l6{constructor(e,t){this.layers=e.readFields(c6,{},t)}}function c6(n,e,t){if(n===3){const i=new s6(t,t.readVarint()+t.pos);i.length&&(e[i.name]=i)}}const E_=65536*65536,eT=1/E_,u6=12,tT=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),qy=0,Jf=1,zu=2,Qf=5;class h6{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,i=this.length){for(;this.pos<i;){const r=this.readVarint(),s=r>>3,o=this.pos;this.type=r&7,e(s,t,this),this.pos===o&&this.skip(r)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*E_;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*E_;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let i,r;return r=t[this.pos++],i=r&127,r<128||(r=t[this.pos++],i|=(r&127)<<7,r<128)||(r=t[this.pos++],i|=(r&127)<<14,r<128)||(r=t[this.pos++],i|=(r&127)<<21,r<128)?i:(r=t[this.pos],i|=(r&15)<<28,d6(i,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=u6&&tT?tT.decode(this.buf.subarray(t,e)):E6(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===zu?this.readVarint()+this.pos:this.pos+1}skip(e){const t=e&7;if(t===qy)for(;this.buf[this.pos++]>127;);else if(t===zu)this.pos=this.readVarint()+this.pos;else if(t===Qf)this.pos+=4;else if(t===Jf)this.pos+=8;else throw new Error(`Unimplemented type: ${t}`)}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.dataView=new DataView(i.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*eT),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*eT),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){p6(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;const t=this.pos;this.pos=L6(this.buf,e,this.pos);const i=this.pos-t;i>=128&&nT(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let i=0;i<t;i++)this.buf[this.pos++]=e[i]}writeRawMessage(e,t){this.pos++;const i=this.pos;e(t,this);const r=this.pos-i;r>=128&&nT(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r}writeMessage(e,t,i){this.writeTag(e,zu),this.writeRawMessage(t,i)}writePackedVarint(e,t){t.length&&this.writeMessage(e,y6,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,_6,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,x6,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,v6,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,b6,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,w6,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,S6,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,M6,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,T6,t)}writeBytesField(e,t){this.writeTag(e,zu),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,Qf),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,Qf),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,Jf),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,Jf),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,qy),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,qy),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,zu),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,Qf),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,Jf),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function d6(n,e,t){const i=t.buf;let r,s;if(s=i[t.pos++],r=(s&112)>>4,s<128||(s=i[t.pos++],r|=(s&127)<<3,s<128)||(s=i[t.pos++],r|=(s&127)<<10,s<128)||(s=i[t.pos++],r|=(s&127)<<17,s<128)||(s=i[t.pos++],r|=(s&127)<<24,s<128)||(s=i[t.pos++],r|=(s&1)<<31,s<128))return f6(n,r,e);throw new Error("Expected varint not more than 10 bytes")}function f6(n,e,t){return t?e*4294967296+(n>>>0):(e>>>0)*4294967296+(n>>>0)}function p6(n,e){let t,i;if(n>=0?(t=n%4294967296|0,i=n/4294967296|0):(t=~(-n%4294967296),i=~(-n/4294967296),t^4294967295?t=t+1|0:(t=0,i=i+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),m6(t,i,e),g6(i,e)}function m6(n,e,t){t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos]=n&127}function g6(n,e){const t=(n&7)<<4;e.buf[e.pos++]|=t|((n>>>=3)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127)))))}function nT(n,e,t){const i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(i);for(let r=t.pos-1;r>=n;r--)t.buf[r+i]=t.buf[r]}function y6(n,e){for(let t=0;t<n.length;t++)e.writeVarint(n[t])}function _6(n,e){for(let t=0;t<n.length;t++)e.writeSVarint(n[t])}function v6(n,e){for(let t=0;t<n.length;t++)e.writeFloat(n[t])}function b6(n,e){for(let t=0;t<n.length;t++)e.writeDouble(n[t])}function x6(n,e){for(let t=0;t<n.length;t++)e.writeBoolean(n[t])}function w6(n,e){for(let t=0;t<n.length;t++)e.writeFixed32(n[t])}function S6(n,e){for(let t=0;t<n.length;t++)e.writeSFixed32(n[t])}function M6(n,e){for(let t=0;t<n.length;t++)e.writeFixed64(n[t])}function T6(n,e){for(let t=0;t<n.length;t++)e.writeSFixed64(n[t])}function E6(n,e,t){let i="",r=e;for(;r<t;){const s=n[r];let o=null,a=s>239?4:s>223?3:s>191?2:1;if(r+a>t)break;let l,c,h;a===1?s<128&&(o=s):a===2?(l=n[r+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=n[r+1],c=n[r+2],(l&192)===128&&(c&192)===128&&(o=(s&15)<<12|(l&63)<<6|c&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=n[r+1],c=n[r+2],h=n[r+3],(l&192)===128&&(c&192)===128&&(h&192)===128&&(o=(s&15)<<18|(l&63)<<12|(c&63)<<6|h&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),r+=a}return i}function L6(n,e,t){for(let i=0,r,s;i<e.length;i++){if(r=e.charCodeAt(i),r>55295&&r<57344)if(s)if(r<56320){n[t++]=239,n[t++]=191,n[t++]=189,s=r;continue}else r=s-55296<<10|r-56320|65536,s=null;else{r>56319||i+1===e.length?(n[t++]=239,n[t++]=191,n[t++]=189):s=r;continue}else s&&(n[t++]=239,n[t++]=191,n[t++]=189,s=null);r<128?n[t++]=r:(r<2048?n[t++]=r>>6|192:(r<65536?n[t++]=r>>12|224:(n[t++]=r>>18|240,n[t++]=r>>12&63|128),n[t++]=r>>6&63|128),n[t++]=r&63|128)}return t}var A6=Object.defineProperty,C6=(n,e,t)=>e in n?A6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,e0=(n,e,t)=>C6(n,typeof e!="symbol"?e+"":e,t);class R6 extends tC{constructor(){super(),e0(this,"dataType","mvt"),e0(this,"_loader",new zo(Jn.manager)),e0(this,"_render",new xK),console.log("MVTLoader constructor"),this._loader.setResponseType("arraybuffer")}async doLoad(e,t){const i=await this._loader.loadAsync(e),r=new l6(new h6(i)),s=this.drawTile(r,t.source.style,t.z);return console.log("drawTile",s),new xv(s)}drawTile(e,t,i){const r=new OffscreenCanvas(256,256).getContext("2d");if(r){if(t)for(const s in t.layer){const o=t.layer[s];if(t&&(i<(o.minLevel??1)||i>(o.maxLevel??20)))continue;const a=e.layers[s];if(a){const l=256/a.extent;this._renderLayer(r,a,o,l)}}else for(const s in e.layers){const o=e.layers[s],a=256/o.extent;this._renderLayer(r,o,void 0,a)}return r.canvas}else throw new Error("Canvas context is not available")}_renderLayer(e,t,i,r=1){e.save();for(let s=0;s<t.length;s++){const o=t.feature(s);this._renderFeature(e,o,i,r)}return e.restore(),this}_renderFeature(e,t,i={},r=1){const s=[Vi.Unknown,Vi.Point,Vi.Linestring,Vi.Polygon][t.type],o={geometry:t.loadGeometry(),properties:t.properties};this._render.render(e,s,o,i,r)}_convertToGeoJSONFeature(e,t){const i=this._convertGeometryToGeoJSON(e.geometry,t);return i?{type:"Feature",geometry:i,properties:e.properties||{},id:e.id}:null}_convertGeometryToGeoJSON(e,t){switch(t){case Vi.Point:return this._convertPointGeometry(e);case Vi.Linestring:return this._convertLineGeometry(e);case Vi.Polygon:return this._convertPolygonGeometry(e);default:return console.warn(":",t),null}}_convertPointGeometry(e){const t=[];for(const i of e)for(const r of i)t.push([r.x,r.y]);return t.length===0?null:t.length===1?{type:"Point",coordinates:t[0]}:{type:"MultiPoint",coordinates:t}}_convertLineGeometry(e){const t=[];for(const i of e){const r=[];for(const s of i)r.push([s.x,s.y]);r.length>=2&&t.push(r)}return t.length===0?null:t.length===1?{type:"LineString",coordinates:t[0]}:{type:"MultiLineString",coordinates:t}}_convertPolygonGeometry(e){const t=[];let i=[];for(const r of e){const s=[];for(const o of r)s.push([o.x,o.y]);s.length>=4&&(this._isRingClockwise(s)||i.length===0?(i.length>0&&t.push(i),i=[s]):i.push(s))}return i.length>0&&t.push(i),t.length===0?null:t.length===1?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t}}_isRingClockwise(e){let t=0;for(let i=0;i<e.length-1;i++){const[r,s]=e[i],[o,a]=e[i+1];t+=(o-r)*(a+s)}return t>0}convertVectorTileToGeoJSON(e){const t=[];for(const i in e.layers){const r=e.layers[i];for(let s=0;s<r.length;s++){const o=r.feature(s),a=[Vi.Unknown,Vi.Point,Vi.Linestring,Vi.Polygon][o.type],l={geometry:o.loadGeometry(),properties:o.properties},c=this._convertToGeoJSONFeature(l,a);c&&(c.properties._layer=i,t.push(c))}}return{type:"FeatureCollection",features:t}}}nC(new R6);const aC="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IF89MjMyODMwNjQzNjUzODY5NjNlLTI2LG09MTIsUD10eXBlb2YgVGV4dERlY29kZXI+InUiP251bGw6bmV3IFRleHREZWNvZGVyKCJ1dGYtOCIpLGc9MCx5PTEsRj0yLHA9NTtjbGFzcyBNe2NvbnN0cnVjdG9yKHQ9bmV3IFVpbnQ4QXJyYXkoMTYpKXt0aGlzLmJ1Zj1BcnJheUJ1ZmZlci5pc1ZpZXcodCk/dDpuZXcgVWludDhBcnJheSh0KSx0aGlzLmRhdGFWaWV3PW5ldyBEYXRhVmlldyh0aGlzLmJ1Zi5idWZmZXIpLHRoaXMucG9zPTAsdGhpcy50eXBlPTAsdGhpcy5sZW5ndGg9dGhpcy5idWYubGVuZ3RofXJlYWRGaWVsZHModCxlLHI9dGhpcy5sZW5ndGgpe2Zvcig7dGhpcy5wb3M8cjspe2NvbnN0IHM9dGhpcy5yZWFkVmFyaW50KCksbj1zPj4zLG89dGhpcy5wb3M7dGhpcy50eXBlPXMmNyx0KG4sZSx0aGlzKSx0aGlzLnBvcz09PW8mJnRoaXMuc2tpcChzKX1yZXR1cm4gZX1yZWFkTWVzc2FnZSh0LGUpe3JldHVybiB0aGlzLnJlYWRGaWVsZHModCxlLHRoaXMucmVhZFZhcmludCgpK3RoaXMucG9zKX1yZWFkRml4ZWQzMigpe2NvbnN0IHQ9dGhpcy5kYXRhVmlldy5nZXRVaW50MzIodGhpcy5wb3MsITApO3JldHVybiB0aGlzLnBvcys9NCx0fXJlYWRTRml4ZWQzMigpe2NvbnN0IHQ9dGhpcy5kYXRhVmlldy5nZXRJbnQzMih0aGlzLnBvcywhMCk7cmV0dXJuIHRoaXMucG9zKz00LHR9cmVhZEZpeGVkNjQoKXtjb25zdCB0PXRoaXMuZGF0YVZpZXcuZ2V0VWludDMyKHRoaXMucG9zLCEwKSt0aGlzLmRhdGFWaWV3LmdldFVpbnQzMih0aGlzLnBvcys0LCEwKSo0Mjk0OTY3Mjk2O3JldHVybiB0aGlzLnBvcys9OCx0fXJlYWRTRml4ZWQ2NCgpe2NvbnN0IHQ9dGhpcy5kYXRhVmlldy5nZXRVaW50MzIodGhpcy5wb3MsITApK3RoaXMuZGF0YVZpZXcuZ2V0SW50MzIodGhpcy5wb3MrNCwhMCkqNDI5NDk2NzI5NjtyZXR1cm4gdGhpcy5wb3MrPTgsdH1yZWFkRmxvYXQoKXtjb25zdCB0PXRoaXMuZGF0YVZpZXcuZ2V0RmxvYXQzMih0aGlzLnBvcywhMCk7cmV0dXJuIHRoaXMucG9zKz00LHR9cmVhZERvdWJsZSgpe2NvbnN0IHQ9dGhpcy5kYXRhVmlldy5nZXRGbG9hdDY0KHRoaXMucG9zLCEwKTtyZXR1cm4gdGhpcy5wb3MrPTgsdH1yZWFkVmFyaW50KHQpe2NvbnN0IGU9dGhpcy5idWY7bGV0IHIscztyZXR1cm4gcz1lW3RoaXMucG9zKytdLHI9cyYxMjcsczwxMjh8fChzPWVbdGhpcy5wb3MrK10scnw9KHMmMTI3KTw8NyxzPDEyOCl8fChzPWVbdGhpcy5wb3MrK10scnw9KHMmMTI3KTw8MTQsczwxMjgpfHwocz1lW3RoaXMucG9zKytdLHJ8PShzJjEyNyk8PDIxLHM8MTI4KT9yOihzPWVbdGhpcy5wb3NdLHJ8PShzJjE1KTw8MjgsRShyLHQsdGhpcykpfXJlYWRWYXJpbnQ2NCgpe3JldHVybiB0aGlzLnJlYWRWYXJpbnQoITApfXJlYWRTVmFyaW50KCl7Y29uc3QgdD10aGlzLnJlYWRWYXJpbnQoKTtyZXR1cm4gdCUyPT09MT8odCsxKS8tMjp0LzJ9cmVhZEJvb2xlYW4oKXtyZXR1cm4hIXRoaXMucmVhZFZhcmludCgpfXJlYWRTdHJpbmcoKXtjb25zdCB0PXRoaXMucmVhZFZhcmludCgpK3RoaXMucG9zLGU9dGhpcy5wb3M7cmV0dXJuIHRoaXMucG9zPXQsdC1lPj1tJiZQP1AuZGVjb2RlKHRoaXMuYnVmLnN1YmFycmF5KGUsdCkpOlIodGhpcy5idWYsZSx0KX1yZWFkQnl0ZXMoKXtjb25zdCB0PXRoaXMucmVhZFZhcmludCgpK3RoaXMucG9zLGU9dGhpcy5idWYuc3ViYXJyYXkodGhpcy5wb3MsdCk7cmV0dXJuIHRoaXMucG9zPXQsZX1yZWFkUGFja2VkVmFyaW50KHQ9W10sZSl7Y29uc3Qgcj10aGlzLnJlYWRQYWNrZWRFbmQoKTtmb3IoO3RoaXMucG9zPHI7KXQucHVzaCh0aGlzLnJlYWRWYXJpbnQoZSkpO3JldHVybiB0fXJlYWRQYWNrZWRTVmFyaW50KHQ9W10pe2NvbnN0IGU9dGhpcy5yZWFkUGFja2VkRW5kKCk7Zm9yKDt0aGlzLnBvczxlOyl0LnB1c2godGhpcy5yZWFkU1ZhcmludCgpKTtyZXR1cm4gdH1yZWFkUGFja2VkQm9vbGVhbih0PVtdKXtjb25zdCBlPXRoaXMucmVhZFBhY2tlZEVuZCgpO2Zvcig7dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZEJvb2xlYW4oKSk7cmV0dXJuIHR9cmVhZFBhY2tlZEZsb2F0KHQ9W10pe2NvbnN0IGU9dGhpcy5yZWFkUGFja2VkRW5kKCk7Zm9yKDt0aGlzLnBvczxlOyl0LnB1c2godGhpcy5yZWFkRmxvYXQoKSk7cmV0dXJuIHR9cmVhZFBhY2tlZERvdWJsZSh0PVtdKXtjb25zdCBlPXRoaXMucmVhZFBhY2tlZEVuZCgpO2Zvcig7dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZERvdWJsZSgpKTtyZXR1cm4gdH1yZWFkUGFja2VkRml4ZWQzMih0PVtdKXtjb25zdCBlPXRoaXMucmVhZFBhY2tlZEVuZCgpO2Zvcig7dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZEZpeGVkMzIoKSk7cmV0dXJuIHR9cmVhZFBhY2tlZFNGaXhlZDMyKHQ9W10pe2NvbnN0IGU9dGhpcy5yZWFkUGFja2VkRW5kKCk7Zm9yKDt0aGlzLnBvczxlOyl0LnB1c2godGhpcy5yZWFkU0ZpeGVkMzIoKSk7cmV0dXJuIHR9cmVhZFBhY2tlZEZpeGVkNjQodD1bXSl7Y29uc3QgZT10aGlzLnJlYWRQYWNrZWRFbmQoKTtmb3IoO3RoaXMucG9zPGU7KXQucHVzaCh0aGlzLnJlYWRGaXhlZDY0KCkpO3JldHVybiB0fXJlYWRQYWNrZWRTRml4ZWQ2NCh0PVtdKXtjb25zdCBlPXRoaXMucmVhZFBhY2tlZEVuZCgpO2Zvcig7dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZFNGaXhlZDY0KCkpO3JldHVybiB0fXJlYWRQYWNrZWRFbmQoKXtyZXR1cm4gdGhpcy50eXBlPT09Rj90aGlzLnJlYWRWYXJpbnQoKSt0aGlzLnBvczp0aGlzLnBvcysxfXNraXAodCl7Y29uc3QgZT10Jjc7aWYoZT09PWcpZm9yKDt0aGlzLmJ1Zlt0aGlzLnBvcysrXT4xMjc7KTtlbHNlIGlmKGU9PT1GKXRoaXMucG9zPXRoaXMucmVhZFZhcmludCgpK3RoaXMucG9zO2Vsc2UgaWYoZT09PXApdGhpcy5wb3MrPTQ7ZWxzZSBpZihlPT09eSl0aGlzLnBvcys9ODtlbHNlIHRocm93IG5ldyBFcnJvcihgVW5pbXBsZW1lbnRlZCB0eXBlOiAke2V9YCl9d3JpdGVUYWcodCxlKXt0aGlzLndyaXRlVmFyaW50KHQ8PDN8ZSl9cmVhbGxvYyh0KXtsZXQgZT10aGlzLmxlbmd0aHx8MTY7Zm9yKDtlPHRoaXMucG9zK3Q7KWUqPTI7aWYoZSE9PXRoaXMubGVuZ3RoKXtjb25zdCByPW5ldyBVaW50OEFycmF5KGUpO3Iuc2V0KHRoaXMuYnVmKSx0aGlzLmJ1Zj1yLHRoaXMuZGF0YVZpZXc9bmV3IERhdGFWaWV3KHIuYnVmZmVyKSx0aGlzLmxlbmd0aD1lfX1maW5pc2goKXtyZXR1cm4gdGhpcy5sZW5ndGg9dGhpcy5wb3MsdGhpcy5wb3M9MCx0aGlzLmJ1Zi5zdWJhcnJheSgwLHRoaXMubGVuZ3RoKX13cml0ZUZpeGVkMzIodCl7dGhpcy5yZWFsbG9jKDQpLHRoaXMuZGF0YVZpZXcuc2V0SW50MzIodGhpcy5wb3MsdCwhMCksdGhpcy5wb3MrPTR9d3JpdGVTRml4ZWQzMih0KXt0aGlzLnJlYWxsb2MoNCksdGhpcy5kYXRhVmlldy5zZXRJbnQzMih0aGlzLnBvcyx0LCEwKSx0aGlzLnBvcys9NH13cml0ZUZpeGVkNjQodCl7dGhpcy5yZWFsbG9jKDgpLHRoaXMuZGF0YVZpZXcuc2V0SW50MzIodGhpcy5wb3MsdCYtMSwhMCksdGhpcy5kYXRhVmlldy5zZXRJbnQzMih0aGlzLnBvcys0LE1hdGguZmxvb3IodCpfKSwhMCksdGhpcy5wb3MrPTh9d3JpdGVTRml4ZWQ2NCh0KXt0aGlzLnJlYWxsb2MoOCksdGhpcy5kYXRhVmlldy5zZXRJbnQzMih0aGlzLnBvcyx0Ji0xLCEwKSx0aGlzLmRhdGFWaWV3LnNldEludDMyKHRoaXMucG9zKzQsTWF0aC5mbG9vcih0Kl8pLCEwKSx0aGlzLnBvcys9OH13cml0ZVZhcmludCh0KXtpZih0PSt0fHwwLHQ+MjY4NDM1NDU1fHx0PDApe0IodCx0aGlzKTtyZXR1cm59dGhpcy5yZWFsbG9jKDQpLHRoaXMuYnVmW3RoaXMucG9zKytdPXQmMTI3fCh0PjEyNz8xMjg6MCksISh0PD0xMjcpJiYodGhpcy5idWZbdGhpcy5wb3MrK109KHQ+Pj49NykmMTI3fCh0PjEyNz8xMjg6MCksISh0PD0xMjcpJiYodGhpcy5idWZbdGhpcy5wb3MrK109KHQ+Pj49NykmMTI3fCh0PjEyNz8xMjg6MCksISh0PD0xMjcpJiYodGhpcy5idWZbdGhpcy5wb3MrK109dD4+PjcmMTI3KSkpfXdyaXRlU1ZhcmludCh0KXt0aGlzLndyaXRlVmFyaW50KHQ8MD8tdCoyLTE6dCoyKX13cml0ZUJvb2xlYW4odCl7dGhpcy53cml0ZVZhcmludCgrdCl9d3JpdGVTdHJpbmcodCl7dD1TdHJpbmcodCksdGhpcy5yZWFsbG9jKHQubGVuZ3RoKjQpLHRoaXMucG9zKys7Y29uc3QgZT10aGlzLnBvczt0aGlzLnBvcz1xKHRoaXMuYnVmLHQsdGhpcy5wb3MpO2NvbnN0IHI9dGhpcy5wb3MtZTtyPj0xMjgmJlMoZSxyLHRoaXMpLHRoaXMucG9zPWUtMSx0aGlzLndyaXRlVmFyaW50KHIpLHRoaXMucG9zKz1yfXdyaXRlRmxvYXQodCl7dGhpcy5yZWFsbG9jKDQpLHRoaXMuZGF0YVZpZXcuc2V0RmxvYXQzMih0aGlzLnBvcyx0LCEwKSx0aGlzLnBvcys9NH13cml0ZURvdWJsZSh0KXt0aGlzLnJlYWxsb2MoOCksdGhpcy5kYXRhVmlldy5zZXRGbG9hdDY0KHRoaXMucG9zLHQsITApLHRoaXMucG9zKz04fXdyaXRlQnl0ZXModCl7Y29uc3QgZT10Lmxlbmd0aDt0aGlzLndyaXRlVmFyaW50KGUpLHRoaXMucmVhbGxvYyhlKTtmb3IobGV0IHI9MDtyPGU7cisrKXRoaXMuYnVmW3RoaXMucG9zKytdPXRbcl19d3JpdGVSYXdNZXNzYWdlKHQsZSl7dGhpcy5wb3MrKztjb25zdCByPXRoaXMucG9zO3QoZSx0aGlzKTtjb25zdCBzPXRoaXMucG9zLXI7cz49MTI4JiZTKHIscyx0aGlzKSx0aGlzLnBvcz1yLTEsdGhpcy53cml0ZVZhcmludChzKSx0aGlzLnBvcys9c313cml0ZU1lc3NhZ2UodCxlLHIpe3RoaXMud3JpdGVUYWcodCxGKSx0aGlzLndyaXRlUmF3TWVzc2FnZShlLHIpfXdyaXRlUGFja2VkVmFyaW50KHQsZSl7ZS5sZW5ndGgmJnRoaXMud3JpdGVNZXNzYWdlKHQsSSxlKX13cml0ZVBhY2tlZFNWYXJpbnQodCxlKXtlLmxlbmd0aCYmdGhpcy53cml0ZU1lc3NhZ2UodCxDLGUpfXdyaXRlUGFja2VkQm9vbGVhbih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LFUsZSl9d3JpdGVQYWNrZWRGbG9hdCh0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LEwsZSl9d3JpdGVQYWNrZWREb3VibGUodCxlKXtlLmxlbmd0aCYmdGhpcy53cml0ZU1lc3NhZ2UodCxBLGUpfXdyaXRlUGFja2VkRml4ZWQzMih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LHYsZSl9d3JpdGVQYWNrZWRTRml4ZWQzMih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LE4sZSl9d3JpdGVQYWNrZWRGaXhlZDY0KHQsZSl7ZS5sZW5ndGgmJnRoaXMud3JpdGVNZXNzYWdlKHQsRyxlKX13cml0ZVBhY2tlZFNGaXhlZDY0KHQsZSl7ZS5sZW5ndGgmJnRoaXMud3JpdGVNZXNzYWdlKHQsSCxlKX13cml0ZUJ5dGVzRmllbGQodCxlKXt0aGlzLndyaXRlVGFnKHQsRiksdGhpcy53cml0ZUJ5dGVzKGUpfXdyaXRlRml4ZWQzMkZpZWxkKHQsZSl7dGhpcy53cml0ZVRhZyh0LHApLHRoaXMud3JpdGVGaXhlZDMyKGUpfXdyaXRlU0ZpeGVkMzJGaWVsZCh0LGUpe3RoaXMud3JpdGVUYWcodCxwKSx0aGlzLndyaXRlU0ZpeGVkMzIoZSl9d3JpdGVGaXhlZDY0RmllbGQodCxlKXt0aGlzLndyaXRlVGFnKHQseSksdGhpcy53cml0ZUZpeGVkNjQoZSl9d3JpdGVTRml4ZWQ2NEZpZWxkKHQsZSl7dGhpcy53cml0ZVRhZyh0LHkpLHRoaXMud3JpdGVTRml4ZWQ2NChlKX13cml0ZVZhcmludEZpZWxkKHQsZSl7dGhpcy53cml0ZVRhZyh0LGcpLHRoaXMud3JpdGVWYXJpbnQoZSl9d3JpdGVTVmFyaW50RmllbGQodCxlKXt0aGlzLndyaXRlVGFnKHQsZyksdGhpcy53cml0ZVNWYXJpbnQoZSl9d3JpdGVTdHJpbmdGaWVsZCh0LGUpe3RoaXMud3JpdGVUYWcodCxGKSx0aGlzLndyaXRlU3RyaW5nKGUpfXdyaXRlRmxvYXRGaWVsZCh0LGUpe3RoaXMud3JpdGVUYWcodCxwKSx0aGlzLndyaXRlRmxvYXQoZSl9d3JpdGVEb3VibGVGaWVsZCh0LGUpe3RoaXMud3JpdGVUYWcodCx5KSx0aGlzLndyaXRlRG91YmxlKGUpfXdyaXRlQm9vbGVhbkZpZWxkKHQsZSl7dGhpcy53cml0ZVZhcmludEZpZWxkKHQsK2UpfX1mdW5jdGlvbiBFKGksdCxlKXtjb25zdCByPWUuYnVmO2xldCBzLG47aWYobj1yW2UucG9zKytdLHM9KG4mMTEyKT4+NCxuPDEyOHx8KG49cltlLnBvcysrXSxzfD0obiYxMjcpPDwzLG48MTI4KXx8KG49cltlLnBvcysrXSxzfD0obiYxMjcpPDwxMCxuPDEyOCl8fChuPXJbZS5wb3MrK10sc3w9KG4mMTI3KTw8MTcsbjwxMjgpfHwobj1yW2UucG9zKytdLHN8PShuJjEyNyk8PDI0LG48MTI4KXx8KG49cltlLnBvcysrXSxzfD0obiYxKTw8MzEsbjwxMjgpKXJldHVybiBmKGkscyx0KTt0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIHZhcmludCBub3QgbW9yZSB0aGFuIDEwIGJ5dGVzIil9ZnVuY3Rpb24gZihpLHQsZSl7cmV0dXJuIGU/dCo0Mjk0OTY3Mjk2KyhpPj4+MCk6KHQ+Pj4wKSo0Mjk0OTY3Mjk2KyhpPj4+MCl9ZnVuY3Rpb24gQihpLHQpe2xldCBlLHI7aWYoaT49MD8oZT1pJTQyOTQ5NjcyOTZ8MCxyPWkvNDI5NDk2NzI5NnwwKTooZT1+KC1pJTQyOTQ5NjcyOTYpLHI9figtaS80Mjk0OTY3Mjk2KSxlXjQyOTQ5NjcyOTU/ZT1lKzF8MDooZT0wLHI9cisxfDApKSxpPj0xODQ0Njc0NDA3MzcwOTU1MmUzfHxpPC0xODQ0Njc0NDA3MzcwOTU1MmUzKXRocm93IG5ldyBFcnJvcigiR2l2ZW4gdmFyaW50IGRvZXNuJ3QgZml0IGludG8gMTAgYnl0ZXMiKTt0LnJlYWxsb2MoMTApLFQoZSxyLHQpLEQocix0KX1mdW5jdGlvbiBUKGksdCxlKXtlLmJ1ZltlLnBvcysrXT1pJjEyN3wxMjgsaT4+Pj03LGUuYnVmW2UucG9zKytdPWkmMTI3fDEyOCxpPj4+PTcsZS5idWZbZS5wb3MrK109aSYxMjd8MTI4LGk+Pj49NyxlLmJ1ZltlLnBvcysrXT1pJjEyN3wxMjgsaT4+Pj03LGUuYnVmW2UucG9zXT1pJjEyN31mdW5jdGlvbiBEKGksdCl7Y29uc3QgZT0oaSY3KTw8NDt0LmJ1Zlt0LnBvcysrXXw9ZXwoKGk+Pj49Myk/MTI4OjApLGkmJih0LmJ1Zlt0LnBvcysrXT1pJjEyN3woKGk+Pj49Nyk/MTI4OjApLGkmJih0LmJ1Zlt0LnBvcysrXT1pJjEyN3woKGk+Pj49Nyk/MTI4OjApLGkmJih0LmJ1Zlt0LnBvcysrXT1pJjEyN3woKGk+Pj49Nyk/MTI4OjApLGkmJih0LmJ1Zlt0LnBvcysrXT1pJjEyN3woKGk+Pj49Nyk/MTI4OjApLGkmJih0LmJ1Zlt0LnBvcysrXT1pJjEyNykpKSkpfWZ1bmN0aW9uIFMoaSx0LGUpe2NvbnN0IHI9dDw9MTYzODM/MTp0PD0yMDk3MTUxPzI6dDw9MjY4NDM1NDU1PzM6TWF0aC5mbG9vcihNYXRoLmxvZyh0KS8oTWF0aC5MTjIqNykpO2UucmVhbGxvYyhyKTtmb3IobGV0IHM9ZS5wb3MtMTtzPj1pO3MtLSllLmJ1ZltzK3JdPWUuYnVmW3NdfWZ1bmN0aW9uIEkoaSx0KXtmb3IobGV0IGU9MDtlPGkubGVuZ3RoO2UrKyl0LndyaXRlVmFyaW50KGlbZV0pfWZ1bmN0aW9uIEMoaSx0KXtmb3IobGV0IGU9MDtlPGkubGVuZ3RoO2UrKyl0LndyaXRlU1ZhcmludChpW2VdKX1mdW5jdGlvbiBMKGksdCl7Zm9yKGxldCBlPTA7ZTxpLmxlbmd0aDtlKyspdC53cml0ZUZsb2F0KGlbZV0pfWZ1bmN0aW9uIEEoaSx0KXtmb3IobGV0IGU9MDtlPGkubGVuZ3RoO2UrKyl0LndyaXRlRG91YmxlKGlbZV0pfWZ1bmN0aW9uIFUoaSx0KXtmb3IobGV0IGU9MDtlPGkubGVuZ3RoO2UrKyl0LndyaXRlQm9vbGVhbihpW2VdKX1mdW5jdGlvbiB2KGksdCl7Zm9yKGxldCBlPTA7ZTxpLmxlbmd0aDtlKyspdC53cml0ZUZpeGVkMzIoaVtlXSl9ZnVuY3Rpb24gTihpLHQpe2ZvcihsZXQgZT0wO2U8aS5sZW5ndGg7ZSsrKXQud3JpdGVTRml4ZWQzMihpW2VdKX1mdW5jdGlvbiBHKGksdCl7Zm9yKGxldCBlPTA7ZTxpLmxlbmd0aDtlKyspdC53cml0ZUZpeGVkNjQoaVtlXSl9ZnVuY3Rpb24gSChpLHQpe2ZvcihsZXQgZT0wO2U8aS5sZW5ndGg7ZSsrKXQud3JpdGVTRml4ZWQ2NChpW2VdKX1mdW5jdGlvbiBSKGksdCxlKXtsZXQgcj0iIixzPXQ7Zm9yKDtzPGU7KXtjb25zdCBuPWlbc107bGV0IG89bnVsbCxoPW4+MjM5PzQ6bj4yMjM/MzpuPjE5MT8yOjE7aWYocytoPmUpYnJlYWs7bGV0IGEsZCx1O2g9PT0xP248MTI4JiYobz1uKTpoPT09Mj8oYT1pW3MrMV0sKGEmMTkyKT09PTEyOCYmKG89KG4mMzEpPDw2fGEmNjMsbzw9MTI3JiYobz1udWxsKSkpOmg9PT0zPyhhPWlbcysxXSxkPWlbcysyXSwoYSYxOTIpPT09MTI4JiYoZCYxOTIpPT09MTI4JiYobz0obiYxNSk8PDEyfChhJjYzKTw8NnxkJjYzLChvPD0yMDQ3fHxvPj01NTI5NiYmbzw9NTczNDMpJiYobz1udWxsKSkpOmg9PT00JiYoYT1pW3MrMV0sZD1pW3MrMl0sdT1pW3MrM10sKGEmMTkyKT09PTEyOCYmKGQmMTkyKT09PTEyOCYmKHUmMTkyKT09PTEyOCYmKG89KG4mMTUpPDwxOHwoYSY2Myk8PDEyfChkJjYzKTw8Nnx1JjYzLChvPD02NTUzNXx8bz49MTExNDExMikmJihvPW51bGwpKSksbz09PW51bGw/KG89NjU1MzMsaD0xKTpvPjY1NTM1JiYoby09NjU1MzYscis9U3RyaW5nLmZyb21DaGFyQ29kZShvPj4+MTAmMTAyM3w1NTI5Niksbz01NjMyMHxvJjEwMjMpLHIrPVN0cmluZy5mcm9tQ2hhckNvZGUobykscys9aH1yZXR1cm4gcn1mdW5jdGlvbiBxKGksdCxlKXtmb3IobGV0IHI9MCxzLG47cjx0Lmxlbmd0aDtyKyspe2lmKHM9dC5jaGFyQ29kZUF0KHIpLHM+NTUyOTUmJnM8NTczNDQpaWYobilpZihzPDU2MzIwKXtpW2UrK109MjM5LGlbZSsrXT0xOTEsaVtlKytdPTE4OSxuPXM7Y29udGludWV9ZWxzZSBzPW4tNTUyOTY8PDEwfHMtNTYzMjB8NjU1MzYsbj1udWxsO2Vsc2V7cz41NjMxOXx8cisxPT09dC5sZW5ndGg/KGlbZSsrXT0yMzksaVtlKytdPTE5MSxpW2UrK109MTg5KTpuPXM7Y29udGludWV9ZWxzZSBuJiYoaVtlKytdPTIzOSxpW2UrK109MTkxLGlbZSsrXT0xODksbj1udWxsKTtzPDEyOD9pW2UrK109czooczwyMDQ4P2lbZSsrXT1zPj42fDE5Mjooczw2NTUzNj9pW2UrK109cz4+MTJ8MjI0OihpW2UrK109cz4+MTh8MjQwLGlbZSsrXT1zPj4xMiY2M3wxMjgpLGlbZSsrXT1zPj42JjYzfDEyOCksaVtlKytdPXMmNjN8MTI4KX1yZXR1cm4gZX1mdW5jdGlvbiB4KGksdCl7dGhpcy54PWksdGhpcy55PXR9eC5wcm90b3R5cGU9e2Nsb25lKCl7cmV0dXJuIG5ldyB4KHRoaXMueCx0aGlzLnkpfSxhZGQoaSl7cmV0dXJuIHRoaXMuY2xvbmUoKS5fYWRkKGkpfSxzdWIoaSl7cmV0dXJuIHRoaXMuY2xvbmUoKS5fc3ViKGkpfSxtdWx0QnlQb2ludChpKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9tdWx0QnlQb2ludChpKX0sZGl2QnlQb2ludChpKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9kaXZCeVBvaW50KGkpfSxtdWx0KGkpe3JldHVybiB0aGlzLmNsb25lKCkuX211bHQoaSl9LGRpdihpKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9kaXYoaSl9LHJvdGF0ZShpKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9yb3RhdGUoaSl9LHJvdGF0ZUFyb3VuZChpLHQpe3JldHVybiB0aGlzLmNsb25lKCkuX3JvdGF0ZUFyb3VuZChpLHQpfSxtYXRNdWx0KGkpe3JldHVybiB0aGlzLmNsb25lKCkuX21hdE11bHQoaSl9LHVuaXQoKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl91bml0KCl9LHBlcnAoKXtyZXR1cm4gdGhpcy5jbG9uZSgpLl9wZXJwKCl9LHJvdW5kKCl7cmV0dXJuIHRoaXMuY2xvbmUoKS5fcm91bmQoKX0sbWFnKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLngqdGhpcy54K3RoaXMueSp0aGlzLnkpfSxlcXVhbHMoaSl7cmV0dXJuIHRoaXMueD09PWkueCYmdGhpcy55PT09aS55fSxkaXN0KGkpe3JldHVybiBNYXRoLnNxcnQodGhpcy5kaXN0U3FyKGkpKX0sZGlzdFNxcihpKXtjb25zdCB0PWkueC10aGlzLngsZT1pLnktdGhpcy55O3JldHVybiB0KnQrZSplfSxhbmdsZSgpe3JldHVybiBNYXRoLmF0YW4yKHRoaXMueSx0aGlzLngpfSxhbmdsZVRvKGkpe3JldHVybiBNYXRoLmF0YW4yKHRoaXMueS1pLnksdGhpcy54LWkueCl9LGFuZ2xlV2l0aChpKXtyZXR1cm4gdGhpcy5hbmdsZVdpdGhTZXAoaS54LGkueSl9LGFuZ2xlV2l0aFNlcChpLHQpe3JldHVybiBNYXRoLmF0YW4yKHRoaXMueCp0LXRoaXMueSppLHRoaXMueCppK3RoaXMueSp0KX0sX21hdE11bHQoaSl7Y29uc3QgdD1pWzBdKnRoaXMueCtpWzFdKnRoaXMueSxlPWlbMl0qdGhpcy54K2lbM10qdGhpcy55O3JldHVybiB0aGlzLng9dCx0aGlzLnk9ZSx0aGlzfSxfYWRkKGkpe3JldHVybiB0aGlzLngrPWkueCx0aGlzLnkrPWkueSx0aGlzfSxfc3ViKGkpe3JldHVybiB0aGlzLngtPWkueCx0aGlzLnktPWkueSx0aGlzfSxfbXVsdChpKXtyZXR1cm4gdGhpcy54Kj1pLHRoaXMueSo9aSx0aGlzfSxfZGl2KGkpe3JldHVybiB0aGlzLngvPWksdGhpcy55Lz1pLHRoaXN9LF9tdWx0QnlQb2ludChpKXtyZXR1cm4gdGhpcy54Kj1pLngsdGhpcy55Kj1pLnksdGhpc30sX2RpdkJ5UG9pbnQoaSl7cmV0dXJuIHRoaXMueC89aS54LHRoaXMueS89aS55LHRoaXN9LF91bml0KCl7cmV0dXJuIHRoaXMuX2Rpdih0aGlzLm1hZygpKSx0aGlzfSxfcGVycCgpe2NvbnN0IGk9dGhpcy55O3JldHVybiB0aGlzLnk9dGhpcy54LHRoaXMueD0taSx0aGlzfSxfcm90YXRlKGkpe2NvbnN0IHQ9TWF0aC5jb3MoaSksZT1NYXRoLnNpbihpKSxyPXQqdGhpcy54LWUqdGhpcy55LHM9ZSp0aGlzLngrdCp0aGlzLnk7cmV0dXJuIHRoaXMueD1yLHRoaXMueT1zLHRoaXN9LF9yb3RhdGVBcm91bmQoaSx0KXtjb25zdCBlPU1hdGguY29zKGkpLHI9TWF0aC5zaW4oaSkscz10LngrZSoodGhpcy54LXQueCktcioodGhpcy55LXQueSksbj10LnkrcioodGhpcy54LXQueCkrZSoodGhpcy55LXQueSk7cmV0dXJuIHRoaXMueD1zLHRoaXMueT1uLHRoaXN9LF9yb3VuZCgpe3JldHVybiB0aGlzLng9TWF0aC5yb3VuZCh0aGlzLngpLHRoaXMueT1NYXRoLnJvdW5kKHRoaXMueSksdGhpc30sY29uc3RydWN0b3I6eH0seC5jb252ZXJ0PWZ1bmN0aW9uKGkpe2lmKGkgaW5zdGFuY2VvZiB4KXJldHVybiBpO2lmKEFycmF5LmlzQXJyYXkoaSkpcmV0dXJuIG5ldyB4KCtpWzBdLCtpWzFdKTtpZihpLnghPT12b2lkIDAmJmkueSE9PXZvaWQgMClyZXR1cm4gbmV3IHgoK2kueCwraS55KTt0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIFt4LCB5XSBvciB7eCwgeX0gcG9pbnQgZm9ybWF0Iil9O2NsYXNzIGt7Y29uc3RydWN0b3IodCxlLHIscyxuKXt0aGlzLnByb3BlcnRpZXM9e30sdGhpcy5leHRlbnQ9cix0aGlzLnR5cGU9MCx0aGlzLmlkPXZvaWQgMCx0aGlzLl9wYmY9dCx0aGlzLl9nZW9tZXRyeT0tMSx0aGlzLl9rZXlzPXMsdGhpcy5fdmFsdWVzPW4sdC5yZWFkRmllbGRzKGosdGhpcyxlKX1sb2FkR2VvbWV0cnkoKXtjb25zdCB0PXRoaXMuX3BiZjt0LnBvcz10aGlzLl9nZW9tZXRyeTtjb25zdCBlPXQucmVhZFZhcmludCgpK3QucG9zLHI9W107bGV0IHMsbj0xLG89MCxoPTAsYT0wO2Zvcig7dC5wb3M8ZTspe2lmKG88PTApe2NvbnN0IGQ9dC5yZWFkVmFyaW50KCk7bj1kJjcsbz1kPj4zfWlmKG8tLSxuPT09MXx8bj09PTIpaCs9dC5yZWFkU1ZhcmludCgpLGErPXQucmVhZFNWYXJpbnQoKSxuPT09MSYmKHMmJnIucHVzaChzKSxzPVtdKSxzJiZzLnB1c2gobmV3IHgoaCxhKSk7ZWxzZSBpZihuPT09NylzJiZzLnB1c2goc1swXS5jbG9uZSgpKTtlbHNlIHRocm93IG5ldyBFcnJvcihgdW5rbm93biBjb21tYW5kICR7bn1gKX1yZXR1cm4gcyYmci5wdXNoKHMpLHJ9YmJveCgpe2NvbnN0IHQ9dGhpcy5fcGJmO3QucG9zPXRoaXMuX2dlb21ldHJ5O2NvbnN0IGU9dC5yZWFkVmFyaW50KCkrdC5wb3M7bGV0IHI9MSxzPTAsbj0wLG89MCxoPTEvMCxhPS0xLzAsZD0xLzAsdT0tMS8wO2Zvcig7dC5wb3M8ZTspe2lmKHM8PTApe2NvbnN0IHc9dC5yZWFkVmFyaW50KCk7cj13Jjcscz13Pj4zfWlmKHMtLSxyPT09MXx8cj09PTIpbis9dC5yZWFkU1ZhcmludCgpLG8rPXQucmVhZFNWYXJpbnQoKSxuPGgmJihoPW4pLG4+YSYmKGE9biksbzxkJiYoZD1vKSxvPnUmJih1PW8pO2Vsc2UgaWYociE9PTcpdGhyb3cgbmV3IEVycm9yKGB1bmtub3duIGNvbW1hbmQgJHtyfWApfXJldHVybltoLGQsYSx1XX10b0dlb0pTT04odCxlLHIpe2NvbnN0IHM9dGhpcy5leHRlbnQqTWF0aC5wb3coMixyKSxuPXRoaXMuZXh0ZW50KnQsbz10aGlzLmV4dGVudCplLGg9dGhpcy5sb2FkR2VvbWV0cnkoKTtmdW5jdGlvbiBhKGwpe3JldHVyblsobC54K24pKjM2MC9zLTE4MCwzNjAvTWF0aC5QSSpNYXRoLmF0YW4oTWF0aC5leHAoKDEtKGwueStvKSoyL3MpKk1hdGguUEkpKS05MF19ZnVuY3Rpb24gZChsKXtyZXR1cm4gbC5tYXAoYSl9bGV0IHU7aWYodGhpcy50eXBlPT09MSl7Y29uc3QgbD1bXTtmb3IoY29uc3QgViBvZiBoKWwucHVzaChWWzBdKTtjb25zdCBjPWQobCk7dT1sLmxlbmd0aD09PTE/e3R5cGU6IlBvaW50Iixjb29yZGluYXRlczpjWzBdfTp7dHlwZToiTXVsdGlQb2ludCIsY29vcmRpbmF0ZXM6Y319ZWxzZSBpZih0aGlzLnR5cGU9PT0yKXtjb25zdCBsPWgubWFwKGQpO3U9bC5sZW5ndGg9PT0xP3t0eXBlOiJMaW5lU3RyaW5nIixjb29yZGluYXRlczpsWzBdfTp7dHlwZToiTXVsdGlMaW5lU3RyaW5nIixjb29yZGluYXRlczpsfX1lbHNlIGlmKHRoaXMudHlwZT09PTMpe2NvbnN0IGw9VyhoKSxjPVtdO2Zvcihjb25zdCBWIG9mIGwpYy5wdXNoKFYubWFwKGQpKTt1PWMubGVuZ3RoPT09MT97dHlwZToiUG9seWdvbiIsY29vcmRpbmF0ZXM6Y1swXX06e3R5cGU6Ik11bHRpUG9seWdvbiIsY29vcmRpbmF0ZXM6Y319ZWxzZSB0aHJvdyBuZXcgRXJyb3IoInVua25vd24gZmVhdHVyZSB0eXBlIik7Y29uc3Qgdz17dHlwZToiRmVhdHVyZSIsZ2VvbWV0cnk6dSxwcm9wZXJ0aWVzOnRoaXMucHJvcGVydGllc307cmV0dXJuIHRoaXMuaWQhPW51bGwmJih3LmlkPXRoaXMuaWQpLHd9fWsudHlwZXM9WyJVbmtub3duIiwiUG9pbnQiLCJMaW5lU3RyaW5nIiwiUG9seWdvbiJdO2Z1bmN0aW9uIGooaSx0LGUpe2k9PT0xP3QuaWQ9ZS5yZWFkVmFyaW50KCk6aT09PTI/TyhlLHQpOmk9PT0zP3QudHlwZT1lLnJlYWRWYXJpbnQoKTppPT09NCYmKHQuX2dlb21ldHJ5PWUucG9zKX1mdW5jdGlvbiBPKGksdCl7Y29uc3QgZT1pLnJlYWRWYXJpbnQoKStpLnBvcztmb3IoO2kucG9zPGU7KXtjb25zdCByPXQuX2tleXNbaS5yZWFkVmFyaW50KCldLHM9dC5fdmFsdWVzW2kucmVhZFZhcmludCgpXTt0LnByb3BlcnRpZXNbcl09c319ZnVuY3Rpb24gVyhpKXtjb25zdCB0PWkubGVuZ3RoO2lmKHQ8PTEpcmV0dXJuW2ldO2NvbnN0IGU9W107bGV0IHIscztmb3IobGV0IG49MDtuPHQ7bisrKXtjb25zdCBvPUooaVtuXSk7byE9PTAmJihzPT09dm9pZCAwJiYocz1vPDApLHM9PT1vPDA/KHImJmUucHVzaChyKSxyPVtpW25dXSk6ciYmci5wdXNoKGlbbl0pKX1yZXR1cm4gciYmZS5wdXNoKHIpLGV9ZnVuY3Rpb24gSihpKXtsZXQgdD0wO2ZvcihsZXQgZT0wLHI9aS5sZW5ndGgscz1yLTEsbixvO2U8cjtzPWUrKyluPWlbZV0sbz1pW3NdLHQrPShvLngtbi54KSoobi55K28ueSk7cmV0dXJuIHR9Y2xhc3MgWHtjb25zdHJ1Y3Rvcih0LGUpe3RoaXMudmVyc2lvbj0xLHRoaXMubmFtZT0iIix0aGlzLmV4dGVudD00MDk2LHRoaXMubGVuZ3RoPTAsdGhpcy5fcGJmPXQsdGhpcy5fa2V5cz1bXSx0aGlzLl92YWx1ZXM9W10sdGhpcy5fZmVhdHVyZXM9W10sdC5yZWFkRmllbGRzKCQsdGhpcyxlKSx0aGlzLmxlbmd0aD10aGlzLl9mZWF0dXJlcy5sZW5ndGh9ZmVhdHVyZSh0KXtpZih0PDB8fHQ+PXRoaXMuX2ZlYXR1cmVzLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImZlYXR1cmUgaW5kZXggb3V0IG9mIGJvdW5kcyIpO3RoaXMuX3BiZi5wb3M9dGhpcy5fZmVhdHVyZXNbdF07Y29uc3QgZT10aGlzLl9wYmYucmVhZFZhcmludCgpK3RoaXMuX3BiZi5wb3M7cmV0dXJuIG5ldyBrKHRoaXMuX3BiZixlLHRoaXMuZXh0ZW50LHRoaXMuX2tleXMsdGhpcy5fdmFsdWVzKX19ZnVuY3Rpb24gJChpLHQsZSl7aT09PTE1P3QudmVyc2lvbj1lLnJlYWRWYXJpbnQoKTppPT09MT90Lm5hbWU9ZS5yZWFkU3RyaW5nKCk6aT09PTU/dC5leHRlbnQ9ZS5yZWFkVmFyaW50KCk6aT09PTI/dC5fZmVhdHVyZXMucHVzaChlLnBvcyk6aT09PTM/dC5fa2V5cy5wdXNoKGUucmVhZFN0cmluZygpKTppPT09NCYmdC5fdmFsdWVzLnB1c2goYihlKSl9ZnVuY3Rpb24gYihpKXtsZXQgdD1udWxsO2NvbnN0IGU9aS5yZWFkVmFyaW50KCkraS5wb3M7Zm9yKDtpLnBvczxlOyl7Y29uc3Qgcj1pLnJlYWRWYXJpbnQoKT4+Mzt0PXI9PT0xP2kucmVhZFN0cmluZygpOnI9PT0yP2kucmVhZEZsb2F0KCk6cj09PTM/aS5yZWFkRG91YmxlKCk6cj09PTQ/aS5yZWFkVmFyaW50NjQoKTpyPT09NT9pLnJlYWRWYXJpbnQoKTpyPT09Nj9pLnJlYWRTVmFyaW50KCk6cj09PTc/aS5yZWFkQm9vbGVhbigpOm51bGx9aWYodD09bnVsbCl0aHJvdyBuZXcgRXJyb3IoInVua25vd24gZmVhdHVyZSB2YWx1ZSIpO3JldHVybiB0fWNsYXNzIHp7Y29uc3RydWN0b3IodCxlKXt0aGlzLmxheWVycz10LnJlYWRGaWVsZHMoWSx7fSxlKX19ZnVuY3Rpb24gWShpLHQsZSl7aWYoaT09PTMpe2NvbnN0IHI9bmV3IFgoZSxlLnJlYWRWYXJpbnQoKStlLnBvcyk7ci5sZW5ndGgmJih0W3IubmFtZV09cil9fWFzeW5jIGZ1bmN0aW9uIEsoaSx0LGUscil7dHJ5e2NvbnN0IHM9UShpLHQsZSxyKTtyZXR1cm57eDp0LHk6ZSx6OnIsbGF5ZXJzOnMsdGltZXN0YW1wOkRhdGUubm93KCksZGF0YUZvcm1hdDoibXZ0In19Y2F0Y2gocyl7dGhyb3cgY29uc29sZS5lcnJvcigi6Kej5p6Q55+i6YeP55Om54mH5pWw5o2u5pe25Ye66ZSZOiIscyksc319ZnVuY3Rpb24gUShpLHQsZSxyKXtjb25zdCBzPW5ldyBNKGkpLG49bmV3IHoocyksbz17fTtmb3IoY29uc3QgaCBpbiBuLmxheWVycyl7Y29uc3QgYT1uLmxheWVyc1toXSxkPVtdO2ZvcihsZXQgdT0wO3U8YS5sZW5ndGg7dSsrKXtjb25zdCBsPWEuZmVhdHVyZSh1KS50b0dlb0pTT04odCxlLHIpO2QucHVzaChsKX1vW2hdPWR9cmV0dXJuIG99c2VsZi5vbm1lc3NhZ2U9YXN5bmMgaT0+e2NvbnN0IHQ9aS5kYXRhO3RyeXtjb25zdCBlPWF3YWl0IEsodC5hcnJheUJ1ZmZlcix0LngsdC55LHQueik7c2VsZi5wb3N0TWVzc2FnZShlKX1jYXRjaChlKXtjb25zb2xlLmVycm9yKCJXb3JrZXIgTVZUIOino+aekOWksei0pToiLGUpLHNlbGYucG9zdE1lc3NhZ2Uoe2Vycm9yOmUubWVzc2FnZX0pfX19KSgpOwo=",P6=n=>Uint8Array.from(atob(n),e=>e.charCodeAt(0)),iT=typeof self<"u"&&self.Blob&&new Blob([P6(aC)],{type:"text/javascript;charset=utf-8"});function I6(n){let e;try{if(e=iT&&(self.URL||self.webkitURL).createObjectURL(iT),!e)throw"";const t=new Worker(e,{name:n==null?void 0:n.name});return t.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),t}catch{return new Worker("data:text/javascript;base64,"+aC,{name:n==null?void 0:n.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}var D6=Object.defineProperty,N6=(n,e,t)=>e in n?D6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$f=(n,e,t)=>N6(n,typeof e!="symbol"?e+"":e,t);const O6=10;class k6{constructor(){$f(this,"info",{version:"1.0.0",description:"Vector Tile loader for Mapbox Vector Tile format. It can load and parse MVT data."}),$f(this,"dataType","VectorTile"),$f(this,"fileLoader",new zo(Jn.manager)),$f(this,"_workerPool",new Wv(0)),this.fileLoader.setResponseType("arraybuffer"),this._workerPool.setWorkerCreator(()=>new I6)}async load(e){const{source:t,x:i,y:r,z:s}=e,o=typeof t._getUrl=="function"?t._getUrl(i,r,s):this.buildTileUrl(t.url,i,r,s);if(!o)return this.createErrorGeometry(i,r,s,new Error("VectorTileLoader: source._getUrl  URL"));this._workerPool.pool===0&&this._workerPool.setWorkerLimit(O6);try{const a=await this.fetchVectorData(o),l={arrayBuffer:a,x:i,y:r,z:s},c=(await this._workerPool.postMessage(l,[a])).data;if(c.error)throw new Error(c.error);const h=this.createGeometryWithVectorData(c,e);return Jn.manager.parseEnd(o),h}catch(a){return this.createErrorGeometry(i,r,s,a)}}async fetchVectorData(e){try{const t=await this.fileLoader.loadAsync(e);if(!t||t.byteLength===0)throw new Error("Empty response");return t}catch(t){throw new Error(`Failed to fetch vector tile: ${t.message}`)}}calculateTileBounds(e,t,i){const r=4007501668557849e-8/Math.pow(2,i),s=-20037508342789244e-9+e*r,o=s+r,a=20037508342789244e-9-(t+1)*r,l=a+r;return{min:new Ie(s,a),max:new Ie(o,l),world:new Ie(r,r)}}buildTileUrl(e,t,i,r){return e.replace("{x}",t.toString()).replace("{y}",i.toString()).replace("{z}",r.toString()).replace("{-y}",(Math.pow(2,r)-1-i).toString())}createGeometryWithVectorData(e,t){const i=new Dh;return i.userData={vectorData:e,tileInfo:{x:t.x,y:t.y,z:t.z,bounds:t.bounds},metadata:{dataType:"vector-tile",version:"1.0.0",loadedAt:Date.now()}},i}createErrorGeometry(e,t,i,r){const s=new Dh;return s.userData={vectorData:{x:e,y:t,z:i,layers:{},totalFeatures:0,bounds:this.calculateTileBounds(e,t,i),error:r.message,timestamp:Date.now(),dataFormat:"error"},tileInfo:{x:e,y:t,z:i,bounds:[0,0,0,0]},metadata:{dataType:"vector-tile-error",error:!0,errorMessage:r.message}},s}unload(e){var t;(t=e.userData)!=null&&t.vectorData&&(e.userData.vectorData=null),e.dispose&&e.dispose()}static getVectorData(e){var t;return((t=e.userData)==null?void 0:t.vectorData)||null}static hasValidVectorData(e){const t=this.getVectorData(e);return t&&!t.error&&t.totalFeatures>0}static getLayerNames(e){const t=this.getVectorData(e);return t?Object.keys(t.layers||{}):[]}static getFeaturesByLayer(e,t){var i,r,s;return((s=(r=(i=this.getVectorData(e))==null?void 0:i.layers)==null?void 0:r[t])==null?void 0:s.convertedFeatures)||[]}}IK(new k6);var F6=Object.defineProperty,U6=(n,e,t)=>e in n?F6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Qa=(n,e,t)=>U6(n,typeof e!="symbol"?e+"":e,t);class rT extends KA{constructor(e,t){if(super(e,t),Qa(this,"layerType","vector"),Qa(this,"_tileDataMap",new Map),Qa(this,"_renderer"),Qa(this,"_style"),Qa(this,"_feaList",[]),Qa(this,"_collision",!1),Qa(this,"_renderAltitude",0),!t.style)throw new Error("VectorTileLayer ");this._style=t.style,this._collision=t.collision||!1,this._featureFilter=t.featureFilter,this._renderAltitude=t.altitude||0,this._rootTile.setDataOnlyMode(!0),this._setupDataModeAndListenersForChildren(),this._setupLifeCycleListeners()}_setupDataModeAndListenersForChildren(){const e=t=>{t!==this._rootTile&&t.setDataOnlyMode(!0),this._addShownListenerToTile(t),this._addUnloadListenerToTile(t)};this._rootTile.addEventListener("tile-created",t=>{const i=t.tile;e(i)}),this._rootTile.traverse(t=>{t.isTile&&e(t)})}_addShownListenerToTile(e){const t=i=>{const r=i.tile,s=`${r.z}-${r.x}-${r.y}`,o=!!this._renderer,a=this._tileDataMap.get(s);o&&a&&this._renderer.processTileData(r,a.data)};e.addEventListener("tile-shown",t)}_addUnloadListenerToTile(e){const t=i=>{const r=i.tile||i.target,s=`${r.z}-${r.x}-${r.y}`;if(this._renderer)try{this._renderer.removeFeaturesByTileKey(s)}catch{}this._tileDataMap.delete(s)};e.addEventListener("unload",t)}setAltitude(e){return super.setAltitude(0),this._renderAltitude=e,this._renderer&&this._renderer.setAltitude(e),this}getAltitude(){return this._renderAltitude}_addHiddenListenerToTile(e){const t=i=>{const r=i.tile,s=`${r.z}-${r.x}-${r.y}`;if(this._renderer)try{this._renderer.hideFeaturesByTileKey(s)}catch{}};e.addEventListener("tile-hidden",t)}_setupLifeCycleListeners(){this._rootTile.addEventListener("tile-loaded",e=>{var s,o;const t=e.tile,i=`${t.z}-${t.x}-${t.y}`,r=this.getVectorDataFromTile(t);if(!r){console.warn(`[VectorTileLayer] Tile ${i} loaded but has no vector data.`);return}if(((s=r.vectorData)==null?void 0:s.dataFormat)==="mvt"&&this._tileDataMap.set(i,{data:r,tile:t,timestamp:Date.now(),pending:!1}),t.showing&&this._renderer&&((o=r.vectorData)==null?void 0:o.dataFormat)==="mvt")try{this._renderer.processTileData(t,r)}catch{}})}getVectorDataFromTile(e){return!e.geometry||!e.getVectorData()?null:e.getVectorData()}createLoader(){const e=new Xv;return e.vtSource=this.source,e}getVisibleVectorTiles(){const e=[];return this._rootTile.traverse(t=>{if(t.isTile&&t.loaded&&t.inFrustum){const i=`${t.z}-${t.x}-${t.y}`,r=this._tileDataMap.get(i);r&&e.push({tileKey:i,data:r.data,tile:r.tile})}}),e}getAllVectorData(){return new Map(this._tileDataMap)}getVectorData(e,t,i){const r=`${i}-${e}-${t}`,s=this._tileDataMap.get(r);return s?s.data:null}setFeatureFilter(e){this._featureFilter=e,this._renderer&&this._renderer.setFeatureFilter(e)}clearFeatureFilter(){this._featureFilter=void 0,this._renderer&&this._renderer.clearFeatureFilter()}setOpacity(e){this.opacity=e,this._renderer&&this._renderer.setOpacity(e)}update(e){!this.enabled||!this.visible||super.update(e)}dispose(){this._renderer&&this._renderer.dispose(),super.dispose()}_setRenderer(e){this._renderer=e}_getRenderer(){return this._renderer||null}getStyle(){return this._style}}var z6=Object.defineProperty,W6=(n,e,t)=>e in n?z6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ni=(n,e,t)=>W6(n,typeof e!="symbol"?e+"":e,t);class V6{constructor(...e){}}const G6={};let xn=class lC extends zv(Jc(Qc(V6))){constructor(e,t){var v;Fv(e,"container","Map container element must be specified");const i=["center","basemap"];for(const g of i)CA(t,g);const r={...t,viewer:{antialias:!0,stencil:!0,logarithmicDepthBuffer:!0,...t.viewer}};super(r),ni(this,"viewer"),ni(this,"tilemap"),ni(this,"center"),ni(this,"prjcenter"),ni(this,"_layerContainer"),ni(this,"_EventMap",{loaded:{listened:!1}}),ni(this,"_canvasManager",new PY),ni(this,"collisionEngine"),ni(this,"_onLoadHooks"),ni(this,"_minZoom",0),ni(this,"_maxZoom",22),ni(this,"_ZOOM_MIN_CONST",0),ni(this,"_ZOOM_MAX_CONST",22),ni(this,"_minZoomDistance",500),ni(this,"_maxZoomDistance",8e4),ni(this,"_isZooming",!1),ni(this,"_zoomStartValue",0),ni(this,"_lastZoomForControls",0),ni(this,"_overZoom",0),ni(this,"_lastCameraDistance",0),this.tilemap=this.initTileMap(r.basemap),this.center=this.options.center,this.viewer=new ij(e,{...r.viewer,map:this}),this.tilemap.receiveShadow=!0,this.viewer.scene.add(this.tilemap);const s=this.tilemap.geo2world(new U(this.center[0],this.center[1],0));this.prjcenter=s;const o=this.options.viewer??{};this.viewer.flyToPoint({center:this.center,distance:typeof this.center[2]=="number"?this.center[2]:void 0,polarDeg:typeof o.polarDeg=="number"?o.polarDeg:void 0,azimuthDeg:typeof o.azimuthDeg=="number"?o.azimuthDeg:void 0,polarAngle:o.polarAngle,azimuthAngle:o.azimuthAngle,duration:0,curvePath:!1}),this._minZoomDistance=this.viewer.controls.minDistance,this._maxZoomDistance=this.viewer.controls.maxDistance;const a=this._getCameraDistance();this._lastCameraDistance=a,this._layerContainer=new LY,this.viewer.scene.add(this._layerContainer);const l=this.viewer.controls;this._minZoomDistance=typeof(l==null?void 0:l.minDistance)=="number"?l.minDistance:500,this._maxZoomDistance=typeof(l==null?void 0:l.maxDistance)=="number"?l.maxDistance:8e4;const c=((v=this.tilemap.getLayers().find(g=>g.isBaseLayer===!0))==null?void 0:v.minLevel)??this.tilemap.minLevel;this._minZoom=Math.max(this._ZOOM_MIN_CONST,Math.min(this._ZOOM_MAX_CONST,c)),this._maxZoom=this._ZOOM_MAX_CONST;const h=this.prjcenter,d=this.viewer.camera.position.clone().clone().sub(h).normalize(),p=zp(t.zoom)?13:t.zoom,m=Math.max(this._minZoom,Math.min(this._maxZoom,p)),y=this._computeDistanceFromZoom(m);s.clone().addScaledVector(d,y);const b=this.getZoom();this._lastZoomForControls=b,this._zoomStartValue=b,this.collisionEngine=new a8(this.viewer.renderer,{padding:8,updateInterval:16,animationDuration:200,maxFeaturesPerFrame:2e4,strategies:{priority:!0,grouping:!0,proximity:!0}}),this.on("control-change",l8.debounce(g=>{var T;const x=this.tilemap,w=x.getDataZoom(),S=((T=x.getLayers().find(k=>k.isBaseLayer===!0))==null?void 0:T.maxLevel)??x.maxLevel,C=this._getCameraDistance(),A=C-this._lastCameraDistance;this._lastCameraDistance=C;const{max:E}=this._getViewZoomRange(),O=Math.max(0,E-S);w<S?this._overZoom=0:A<-.001?this._overZoom=Math.min(this._overZoom+1,O):A>.001&&(this._overZoom=Math.max(this._overZoom-1,0));const R=this.getZoom();Math.abs(R-this._lastZoomForControls)>.001&&(this._isZooming?this.trigger("zooming",{from:this._zoomStartValue,to:R}):(this._isZooming=!0,this._zoomStartValue=this._lastZoomForControls,this.trigger("zoomstart",{from:this._zoomStartValue,to:R})),this._lastZoomForControls=R),this.collisionEngine.update(g.camera)},10,{leading:!1,trailing:!0})),this.on("control-end",()=>{this._isZooming&&(this._isZooming=!1,this.trigger("zoomend",{from:this._zoomStartValue,to:this.getZoom()}))}),this._callOnLoadHooks()}static addOnLoadHook(e,...t){const i=typeof e=="function"?e:function(){this[e].apply(this,t)},r=this.prototype;return r._onLoadHooks=r._onLoadHooks||[],r._onLoadHooks.push(i),this}_callOnLoadHooks(){const e=lC.prototype;if(e._onLoadHooks)for(let t=0,i=e._onLoadHooks.length;t<i;t++)e._onLoadHooks[t].call(this)}getZoom(){var r;const e=this.tilemap,t=e.getDataZoom(),i=((r=e.getLayers().find(s=>s.isBaseLayer===!0))==null?void 0:r.maxLevel)??e.maxLevel;return t<i?t:i+this._overZoom}getDataZoom(){return this.tilemap.getDataZoom()}getMinZoom(){return this._minZoom}getMaxZoom(){return this._maxZoom}setZoomRange(e,t){if(e>t){const r=e;e=t,t=r}this._minZoom=e,this._maxZoom=t;const i=this.viewer.controls;if(i){const r=this._computeDistanceFromZoom(this._maxZoom),s=this._computeDistanceFromZoom(this._minZoom);i.minDistance=r,i.maxDistance=s}return this}setMinZoom(e){return this.setZoomRange(e,this._maxZoom)}setMaxZoom(e){return this.setZoomRange(this._minZoom,e)}setZoom(e){const t=this.getMinZoom(),i=this.getMaxZoom(),r=Math.max(t,Math.min(i,e)),s=this.getZoom(),o=this._computeDistanceFromZoom(r),a=this.viewer.controls,l=(a==null?void 0:a.target)??this.prjcenter,c=this.viewer.camera,h=c.position.clone().sub(l).normalize();return c.position.copy(l).addScaledVector(h,o),c.updateProjectionMatrix(),typeof(a==null?void 0:a.update)=="function"&&a.update(),this._lastZoomForControls=r,this.trigger("zoomend",{from:s,to:this.getZoom()}),this}zoomIn(e=1){return this.setZoom(this.getZoom()+e)}zoomOut(e=1){return this.setZoom(this.getZoom()-e)}_computeDistanceFromZoom(e){const t=this._ZOOM_MIN_CONST,i=this._ZOOM_MAX_CONST,r=this._minZoomDistance,s=this._maxZoomDistance;if(r<=0||r>=s){const l=Math.max(t,Math.min(i,e)),c=(i-l)/(i-t);return r+c*(s-r)}const o=(Math.max(t,Math.min(i,e))-t)/(i-t),a=r/s;return s*Math.pow(a,o)}initTileMap(e){var i;const t=new Uv({...e});try{if((i=e.Baselayers)!=null&&i.length)for(const r of e.Baselayers)r.isBaseLayer=!0,t.addLayer(r)}catch(r){console.error(" :",r)}return t.rotateX(-Math.PI/2),t.receiveShadow=!0,setTimeout(()=>{const r={timestamp:Rj(),targrt:this};this._EventMap.loaded={listened:!0},this.trigger("loaded",r)},0),t}addLayer(e,...t){if(!e)return this;Array.isArray(e)||(e=[e]),t!=null&&t.length&&(e=e.concat(t)),t!=null&&t.length&&(e=e.concat(t));for(let i=0,r=e.length;i<r;i++){const s=e[i],o=s.getId();if(zp(o))throw new Error("Invalid id for the layer: "+o);s.isTileLayer?this.addTileLayer(s):this.addRegularLayer(s)}return this}removeLayer(e){const t=this.tilemap.getLayer(e);if(t){if(t instanceof rT){const r=t._getRenderer();r&&this._layerContainer.remove(r)}return this.tilemap.removeLayer(e),!0}const i=this._layerContainer.getLayerById(e);return i?(this._layerContainer.remove(i),i instanceof Ta&&(i==null||i._collision),!0):(console.warn(` : ${e}`),!1)}addRegularLayer(e){const t=e.getId();this._layerContainer.add(e),e._bindMap(this),e instanceof Ta&&(e!=null&&e._collision)&&(this.collisionEngine.registerLayer(e),e.setCollisionEngine(this.collisionEngine)),console.log(` : ${t}`)}addTileLayer(e){if(this.tilemap.addLayer(e),e._bindMap(this),e instanceof rT){const t=e.options||{},i=new Qy(e.getId()+"-vtrender",{altitude:e.getAltitude(),style:e.getStyle(),collision:e._collision,zIndex:typeof t.zIndex=="number"?t.zIndex:void 0,depthOffset:typeof t.depthOffset=="number"?t.depthOffset:void 0});e._setRenderer(i),this.addRegularLayer(i)}return this}clearLayers(){return this._layerContainer.clear(),this.tilemap.clearLayers(),this}getLayers(){const e=this._layerContainer.getLayers().filter(i=>!(i instanceof Qy)),t=this.tilemap.getLayers();return[...e,...t]}getLayerById(e){const t=this._layerContainer.getLayerById(e);return t?t instanceof Qy?void 0:t:this.tilemap.getLayer(e)}geo2world(e){return this.tilemap.geo2world(e)}world2geo(e){return this.tilemap.world2geo(e)}geo2map(e){return this.tilemap.geo2map(e)}_getCanvas(e=40,t=30,i){return this._canvasManager.getCanvas(e,t,1,i)}getContainer(){return this.viewer.container}getRenderer(){return this.viewer.renderer}getCamera(){return this.viewer.camera}_findFeaturesAt(e){const t=this,i=t.getRenderer(),r=t.getCamera(),s=i.domElement.getBoundingClientRect(),o=e.x/s.width*2-1,a=-(e.y/s.height)*2+1,l=new Iv;l.setFromCamera(new Ie(o,a),r);const c=t.getLayers().filter(d=>!(d!=null&&d.isSceneLayer)),h=l.intersectObjects(c,!0).map(d=>{let p=d.object,m=null;for(;p;){if(p instanceof Wo){m=p;break}p=p.parent}return m?{feature:m,distance:d.distance,object:d.object}:null}).filter(d=>!!d);return h.length?h.sort((d,p)=>d.distance-p.distance):[]}getCenter(){const e=this.viewer.controls.target.clone(),t=this.world2geo(e);return[t.x,t.y,t.z]}_getEventPosition(e){let t,i;if("touches"in e){if(e.touches.length===0)return null;t=e.touches[0].clientX,i=e.touches[0].clientY}else t=e.clientX,i=e.clientY;const r=this.getContainer();if(!r)return null;const s=r.getBoundingClientRect();return{x:t-s.left,y:i-s.top}}get isInteracting(){return this.viewer.isInteracting}_getCameraDistance(){const e=this.viewer.controls,t=this.viewer.camera,i=(e==null?void 0:e.target)??this.prjcenter;return e&&typeof e.getDistance=="function"?e.getDistance():t.position.distanceTo(i)}_getViewZoomRange(){const e=this.viewer.controls,t=typeof(e==null?void 0:e.minDistance)=="number"?e.minDistance:this._minZoomDistance,i=typeof(e==null?void 0:e.maxDistance)=="number"?e.maxDistance:this._maxZoomDistance;if(t<=0||t>=i){const d=this.tilemap.getDataZoom();return{min:d,max:d}}const r=i/t,s=Math.log2(r),o=this.tilemap.getLayers().find(d=>d.isBaseLayer===!0),a=(o==null?void 0:o.minLevel)??this.tilemap.minLevel,l=(o==null?void 0:o.maxLevel)??this.tilemap.maxLevel,c=a,h=l+s;return{min:c,max:h}}flyTo(e){this.viewer.flyToAdvanced(e)}flyToPoint(e){this.viewer.flyToPoint(e)}};xn.mergeOptions(G6);function cC(n,e,t){var o;const{currentTarget:i,clientX:r,clientY:s}=n;if(i instanceof HTMLElement){const a=i.clientWidth,l=i.clientHeight,c=new Ie(r/a*2-1,-(s/l)*2+1);return(o=e.getLocalInfoFromScreen(t,c))==null?void 0:o.location}else return}const B6=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout"];xn.prototype._removeDomEvents=function(){console.log("removeDomEvents",this)};xn.prototype._registerDomEvents=function(){const n=this.viewer.container;if(n){let e=null;B6.forEach(t=>{n.addEventListener(t,i=>{if(t==="mousedown"&&(e={x:i.clientX,y:i.clientY}),t==="click"&&e){const o=i.clientX-e.x,a=i.clientY-e.y;if(Math.sqrt(o*o+a*a)>5)return}let r=cC(i,this.tilemap,this.viewer.camera),s={target:this,originEvent:i,eventName:t,screenXY:{X:i.screenX,Y:i.screenY}};if(r){let o=[r.x,r.y,r.z];s={target:this,originEvent:i,coordinate:o,eventName:t,screenXY:{X:i.screenX,Y:i.screenY}}}this.trigger(t,s)})})}};xn.addOnLoadHook("_registerDomEvents");var H6=Object.defineProperty,Z6=(n,e,t)=>e in n?H6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,sT=(n,e,t)=>Z6(n,typeof e!="symbol"?e+"":e,t);const X6=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","contextmenu","touchstart","touchmove","touchend"];class j6 extends NA{constructor(){super(...arguments),sT(this,"_registeredEvents",[]),sT(this,"_eventCommon",e=>{(e.type==="mousedown"||e.type==="touchstart")&&(this._mouseDownTime=Date.now()),!(e.type==="click"&&Date.now()-this._mouseDownTime>300)&&this._handleEvent(e,e.type)})}addHooks(){const e=this.target.getContainer();e&&X6.forEach(t=>{e.addEventListener(t,this._eventCommon),this._registeredEvents.push(t)})}removeHooks(){const e=this.target.getContainer();e&&this._registeredEvents.length>0&&(this._registeredEvents.forEach(t=>{const i=t;e.removeEventListener(i,this._eventCommon)}),this._registeredEvents=[])}_handleEvent(e,t){const i=this.target;if(this._shouldIgnoreEvent()||(t==="mousemove"||t==="mouseenter"||t==="mouseleave"||t==="mouseover"||t==="mouseout"||t==="touchmove")&&!i.getLayers().some(a=>{var l;return!a.isSceneLayer&&((l=a._feaList)==null?void 0:l.length)>0}))return;const r=i._getEventPosition(e);if(!r)return;const s=i._findFeaturesAt(r);if(s.length===0)return;const o=s[0].feature;switch(t){case"click":this._handleClickEvent(o,e);break;case"mousemove":case"mouseenter":case"mouseleave":case"mouseover":case"mouseout":case"touchmove":this.handleMoveEvent(o,e);break;default:if(o){this._fireFeatureEvent(o,t,e);const a=o.getLayer();a&&a.trigger("feature"+t,{feature:o,domEvent:e,type:"feature"+t})}}}_handleClickEvent(e,t){if(!e)return;this._fireFeatureEvent(e,"click",t);const i=e.getLayer();i&&i.trigger("featureclick",{feature:e,domEvent:t,type:"featureclick"})}handleMoveEvent(e,t){if(!e)return;this._fireFeatureEvent(e,t.type,t);const i=e.getLayer();i&&i.trigger("feature"+t.type,{feature:e,domEvent:t,type:"feature"+t.type})}_fireFeatureEvent(e,t,i){const r=this.target;let s=i,o,a;if("touches"in i){const d=i.touches[0]||i.changedTouches[0];if(!d)return;s={currentTarget:i.currentTarget,clientX:d.clientX,clientY:d.clientY},o=d.screenX,a=d.screenY}else{const d=i;s=d,o=d.screenX,a=d.screenY}const l=cC(s,r.tilemap,r.viewer.camera);if(!l)return;const c=[l.x,l.y,l.z],h={target:e,originEvent:i,coordinate:c,eventName:t,screenXY:{X:o,Y:a}};e.trigger(t,h)}_shouldIgnoreEvent(){return!!this.target.isInteracting}}xn.mergeOptions({FeatureEvents:!0,onlyVisibleFeatureEvents:!0});xn.addOnLoadHook("addHandler","FeatureEvents",j6);var Y6=Object.defineProperty,K6=(n,e,t)=>e in n?Y6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Us=(n,e,t)=>K6(n,typeof e!="symbol"?e+"":e,t);let J6=class{constructor(...n){}};const uC=class yp extends Jc(Qc(J6)){constructor(e={}){super(e),Us(this,"_owner"),Us(this,"_map"),Us(this,"_worldPosition"),Us(this,"_coordinate"),Us(this,"_dom"),Us(this,"_visible",!1),Us(this,"_boundMapHandlers",new Map),Us(this,"_viewerUpdateHandler"),Us(this,"_positionedOnce",!1)}_getClassName(){return"UIComponent"}getOffset(){return{x:this.options.dx??0,y:this.options.dy??0}}addTo(e){if(!e)return this;this._owner=e;const t=typeof e.getMap=="function"?e.getMap():e;return t?(this._map=t,this._bindMapEvents(!0),this.options.single&&(yp._singletons.forEach(i=>{i!==this&&i.options.single&&i._map===t&&i.hide()}),yp._singletons.add(this)),this.onAdd&&this.onAdd(),this.trigger("add",{owner:e,map:t}),this):this}remove(){const e=this._map;return this.hideDom(),this._bindMapEvents(!1),this.options.single&&yp._singletons.delete(this),this.onRemove&&this.onRemove(),this.trigger("remove",{owner:this._owner,map:e}),this._owner=void 0,this._map=void 0,this}show(e){const t=this._map??(this._owner&&typeof this._owner.getMap=="function"?this._owner.getMap():void 0);if(!t)return this;if(this._map=t,!this._dom){const i=this.buildOn();this._dom=i,i.style.position="absolute",typeof this.options.zIndex=="number"&&(i.style.zIndex=String(this.options.zIndex));const r=t.getContainer();if(!r)return this;r.appendChild(i)}return this._coordinate=e?[...e]:void 0,this._visible=!0,this._positionedOnce=!1,this._dom&&(this._dom.style.display="none"),this.trigger("show",{owner:this._owner,map:t}),this}hide(){return this._visible=!1,this._dom&&(this._dom.style.display="none"),this._coordinate=void 0,this.trigger("hide",{owner:this._owner,map:this._map}),this}hideDom(){return this._dom&&this._dom.parentElement&&(this._dom.parentElement.removeChild(this._dom),this.onDomRemove&&this.onDomRemove()),this._dom=void 0,this._visible=!1,this._coordinate=void 0,this}getMap(){return this._map}isVisible(){return this._visible}_bindMapEvents(e){const t=this._map;if(!t)return;const i=t,r=e?"on":"off",s=(o,a)=>{e?this._boundMapHandlers.set(o,a):this._boundMapHandlers.delete(o)};if(e){const o=()=>{this._visible&&this._updatePosition()};i[r]("control-change",o),s("control-change",o);const a=t.viewer;if(a&&!this._viewerUpdateHandler){const l=()=>{this._visible&&this._updatePosition()};this._viewerUpdateHandler=l,a.addEventListener("update",l)}}else{this._boundMapHandlers.forEach((a,l)=>{i[r](l,a)}),this._boundMapHandlers.clear();const o=t.viewer;o&&this._viewerUpdateHandler&&(o.removeEventListener("update",this._viewerUpdateHandler),this._viewerUpdateHandler=void 0)}}_resolveWorldPosition(){var i,r;const e=this._map;if(!e)return;if(this._coordinate){const[s,o,a=0]=this._coordinate,l=new U(s,o,a);return e.geo2world(l)}const t=this._owner;if(t&&t._geometry){const s=t._geometry;if(s&&(s.type==="Point"||s.type==="MultiPoint")){let o;if(s.type==="Point"?o=s.coordinates:s.type==="MultiPoint"&&Array.isArray(s.coordinates)&&s.coordinates.length>0&&(o=s.coordinates[0]),o&&o.length>=2){const a=new U(o[0],o[1],o[2]??0);return e.geo2world(a)}}if(t._threeGeometry&&typeof t._threeGeometry.getWorldPosition=="function"){const o=new U;if(t._threeGeometry.getWorldPosition(o),!(o.x===0&&o.y===0&&o.z===0))return o}if(t._position instanceof U){const o=t._position;if(!(o.x===0&&o.y===0&&o.z===0))return o.clone()}}if(t&&typeof t.getWorldPosition=="function"){const s=new U;return t.getWorldPosition(s),s}return((r=(i=e.prjcenter)==null?void 0:i.clone)==null?void 0:r.call(i))??void 0}_updatePosition(){if(!this._dom||!this._map)return;if(this._visible){const c=this._resolveWorldPosition();if(!c){this._dom.style.display="none";return}this._worldPosition=c}if(!this._worldPosition)return;const e=this._map.viewer,t=e.camera,i=e.renderer,r=this._worldPosition.clone().project(t);if(r.x<-1.1||r.x>1.1||r.y<-1.1||r.y>1.1||r.z<-1||r.z>1){this._dom.style.display="none";return}const s=new Ie;i.getSize(s);const o=(r.x*.5+.5)*s.width,a=(-r.y*.5+.5)*s.height,l=this.getOffset();if(this._dom.style.left=`${o+l.x}px`,this._dom.style.top=`${a+l.y}px`,!this._positionedOnce){this._positionedOnce=!0;return}this._dom.style.display=""}};Us(uC,"_singletons",new Set);let Q6=uC;var $6=Object.defineProperty,q6=(n,e,t)=>e in n?$6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,oT=(n,e,t)=>q6(n,typeof e!="symbol"?e+"":e,t);class aT extends Q6{constructor(e){super({single:!0,...e}),oT(this,"_titleEl"),oT(this,"_contentEl")}_getClassName(){return"InfoWindow"}buildOn(){if(this.options.custom){let a;this.options.content instanceof HTMLElement?a=this.options.content:(a=document.createElement("div"),typeof this.options.content=="string"&&(a.innerHTML=this.options.content));const l=this.options.containerClass;return l&&(Array.isArray(l)?l:[l]).forEach(c=>{a.classList.add(c)}),this.options.minWidth&&(a.style.minWidth=`${this.options.minWidth}px`),this.options.minHeight&&(a.style.minHeight=`${this.options.minHeight}px`),this._titleEl=void 0,this._contentEl=a,a}const e=document.createElement("div");e.className="terra-infowindow";const t=this.options.containerClass;t&&(Array.isArray(t)?t:[t]).forEach(a=>{e.classList.add(a)}),typeof this.options.zIndex=="number"&&(e.style.zIndex=String(this.options.zIndex)),this.options.minWidth&&(e.style.minWidth=`${this.options.minWidth}px`),this.options.minHeight&&(e.style.minHeight=`${this.options.minHeight}px`);const i=document.createElement("div");i.className="terra-infowindow-header";const r=document.createElement("div");r.className="terra-infowindow-title",this.options.title&&(r.innerText=this.options.title);const s=document.createElement("span");s.className="terra-infowindow-close",s.innerHTML="",s.title="",s.addEventListener("click",a=>{a.stopPropagation(),a.preventDefault(),this.close()}),s.addEventListener("mousedown",a=>{a.preventDefault()}),s.style.cursor="pointer",s.style.userSelect="none",i.appendChild(r),i.appendChild(s);const o=document.createElement("div");return o.className="terra-infowindow-content",this.options.content instanceof HTMLElement?o.appendChild(this.options.content):typeof this.options.content=="string"&&(o.innerHTML=this.options.content),e.appendChild(i),e.appendChild(o),this._titleEl=r,this._contentEl=o,e}getOffset(){const e=super.getOffset(),t=this._dom;if(!t)return e;const i=t.offsetWidth,r=t.offsetHeight;return{x:e.x-i/2,y:e.y-r-10}}setTitle(e){return this.options.title=e,this._titleEl&&(this._titleEl.innerText=e??""),this}setContent(e){return this.options.content=e,this._contentEl?(this._contentEl.innerHTML="",e instanceof HTMLElement?this._contentEl.appendChild(e):this._contentEl.innerHTML=e,this):this}open(e){var s;super.show(e);const t=this,i=()=>{!t._dom||!t._map||!t._visible||(t._positionedOnce=!0,t._updatePosition())},r=(s=this.getMap())==null?void 0:s.viewer;if(r&&typeof r.addEventListener=="function"){const o=()=>{r.removeEventListener("update",o),i()};r.addEventListener("update",o)}else requestAnimationFrame(i);return this}close(){return this.hide()}}Wo.include({setInfoWindow(n){this.removeInfoWindow();let e;return n instanceof aT?e=n:e=new aT(n),this._infoWindow=e,this.getMap()&&e.addTo(this),this},getInfoWindow(){return this._infoWindow},openInfoWindow(n){const e=this._infoWindow;return e?(e.getMap()||this.getMap()&&e.addTo(this),requestAnimationFrame(()=>{e.open(n)}),this):this},closeInfoWindow(){return this._infoWindow&&this._infoWindow.close(),this},removeInfoWindow(){return this._infoWindow&&(this._infoWindow.remove(),this._infoWindow=void 0),this}});var e7=Object.defineProperty,t7=(n,e,t)=>e in n?e7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,t0=(n,e,t)=>t7(n,typeof e!="symbol"?e+"":e,t);class n7{constructor(...e){}}class i7 extends Jc(Qc(n7)){constructor(e={}){super(e),t0(this,"_map"),t0(this,"_enabled",!1),t0(this,"_boundHandlers",new Map)}addTo(e){if(!e)return this;const t=e;return t._activeMapTool&&t._activeMapTool!==this&&t._activeMapTool.disable(),t._activeMapTool=this,this._map=e,this.onAdd&&this.onAdd(),this.enable(),this.trigger("add",{map:e}),this}getMap(){return this._map}enable(){return!this._map||this._enabled?this:(this._enabled=!0,this._bindEvents(),this.onEnable&&this.onEnable(),this.trigger("enable",{map:this._map}),this)}disable(){return!this._map||!this._enabled?this:(this._enabled=!1,this._unbindEvents(),this.onDisable&&this.onDisable(),this.trigger("disable",{map:this._map}),this)}isEnabled(){return!!this._enabled}remove(){if(!this._map)return this;this.disable();const e=this._map;return e._activeMapTool===this&&delete e._activeMapTool,this._map=void 0,this.trigger("remove"),this}_bindEvents(){const e=this._map;if(!e)return;const t=this.getEvents()||{};Object.keys(t).forEach(i=>{const r=t[i];if(!r)return;const s=o=>r.call(this,o);this._boundHandlers.set(i,s),e.on(i,s)})}_unbindEvents(){const e=this._map;e&&(this._boundHandlers.forEach((t,i)=>{e.off(i,t)}),this._boundHandlers.clear())}}var r7=Object.defineProperty,s7=(n,e,t)=>e in n?r7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Wu=(n,e,t)=>s7(n,typeof e!="symbol"?e+"":e,t);class o7 extends Ta{constructor(e){super(e,{altitude:1})}validateFeature(e){return!!e}}const lT={};class $c extends i7{constructor(e){super(e),Wu(this,"_modeDef"),Wu(this,"_clickCoords",[]),Wu(this,"_isDrawing",!1),Wu(this,"_geometry"),Wu(this,"_draftLayer"),this.options.once=this.options.once??!1,this._ensureMode()}static registerMode(e,t){lT[e.toLowerCase()]=t}static getModeDefinition(e){return lT[e.toLowerCase()]}getMode(){return(this.options.mode||"").toLowerCase()}setMode(e){return this._finishDrawingSilently(),this.options.mode=e,this._ensureMode(),this}setStyle(e){return e.geometryStyle!==void 0&&(this.options.geometryStyle=e.geometryStyle),Object.prototype.hasOwnProperty.call(e,"vertexStyle")&&(this.options.vertexStyle=e.vertexStyle??null),this}getEvents(){return{click:this._handleClick.bind(this),mousemove:this._handleMouseMove.bind(this),dblclick:this._handleDblClick.bind(this)}}onEnable(){this._ensureMode()}onDisable(){this._finishDrawingSilently(),this._destroyDraftLayer()}_ensureMode(){const e=this.getMode(),t=$c.getModeDefinition(e);if(!t)throw new Error(`DrawTool: mode "${e}"  DrawTool.registerMode`);this._modeDef=t}_handleClick(e){if(!this._modeDef||!e.coordinate)return;const t=e.coordinate,i=this._modeDef,r={...e,drawTool:this};this._isDrawing?(this._clickCoords.push(t),i.update(this._clickCoords,this._geometry,r),this.trigger("drawvertex",{coordinate:t,geometry:this._geometry,coords:[...this._clickCoords],originEvent:r})):(this._isDrawing=!0,this._clickCoords=[t],this._geometry=i.create(t,r),this.trigger("drawstart",{coordinate:t,geometry:this._geometry,coords:[...this._clickCoords],originEvent:r})),i.clickLimit&&this._clickCoords.length>=i.clickLimit&&this._finishDrawing(r)}_handleMouseMove(e){if(!this._modeDef||!this._isDrawing||!e.coordinate)return;const t=this._modeDef,i=[...this._clickCoords,e.coordinate],r={...e,drawTool:this};t.update(i,this._geometry,r),this.trigger("drawing",{coordinate:e.coordinate,geometry:this._geometry,coords:i,originEvent:r})}_handleDblClick(e){if(!this._modeDef||!this._isDrawing)return;const t={...e,drawTool:this};this._finishDrawing(t)}_finishDrawing(e){if(!this._modeDef||!this._isDrawing)return;const t=this._modeDef.generate(this._geometry,[...this._clickCoords]);this.trigger("drawend",{geometry:t,coords:[...this._clickCoords],originEvent:e}),this._isDrawing=!1,this._clickCoords=[],this._geometry=void 0,this.options.once&&this.disable()}_finishDrawingSilently(){this._isDrawing=!1,this._clickCoords=[],this._geometry=void 0}_getOrCreateDraftLayer(){if(this._draftLayer)return this._draftLayer;const e=this.getMap();if(!e)throw new Error("DrawTool:  addTo(map)");const t=`__draw_draft_${Date.now().toString(36)}`,i=new o7(t);return e.addLayer(i),this._draftLayer=i,i}_destroyDraftLayer(){const e=this.getMap();e&&this._draftLayer&&e.removeLayer(this._draftLayer.getId()),this._draftLayer=void 0}}const a7={actions:["click","mousemove"],create(n,e){const t=e.drawTool,i=t._getOrCreateDraftLayer(),r=Sa(t.options.geometryStyle,{type:"basic-point",size:10,color:"#00ffff"}),s={type:"Point",coordinates:n},o=new Ii({geometry:s,style:r});return o.addTo(i),o.initializeGeometry(),{tool:t,draftLayer:i,draftMarker:o}},update(n,e,t){const i=e==null?void 0:e.draftMarker;if(!i)return;const r=n[n.length-1];i._geometry={type:"Point",coordinates:r},i._position=i._coordsTransform(),i._toThreeJSGeometry&&i._toThreeJSGeometry()},generate(n,e){const t=n.tool;if(!e.length)return null;n.draftMarker&&(n.draftMarker._remove(),n.draftMarker=null);const i=Sa(t.options.geometryStyle,{type:"basic-point",size:10,color:"#00ffff"}),r=e[e.length-1];return new Ii({geometry:{type:"Point",coordinates:r},style:i})},clickLimit:1},l7={actions:["click","mousemove","dblclick"],create(n,e){const t=e.drawTool,i=t._getOrCreateDraftLayer(),r=Sa(t.options.geometryStyle,{type:"basic-line",color:"#ff0000",width:2}),s=t.options.vertexStyle===null?void 0:Sa(t.options.vertexStyle,{type:"basic-point",size:8,color:"#00ffff"}),o={type:"LineString",coordinates:[n]},a=new Ys({geometry:o,style:r});a.addTo(i);const l=[];if(s){const c={type:"Point",coordinates:n},h=new Ii({geometry:c,style:s});h.addTo(i),l.push(h)}return{tool:t,draftLayer:i,draftLine:a,draftAnchors:l,lineStyle:r,vertexStyle:s}},update(n,e,t){if(!e)return;const i=e.draftLayer;if(!n||n.length<2)return;e.draftLine&&(e.draftLine._remove(),e.draftLine=null);const r={type:"LineString",coordinates:n},s=new Ys({geometry:r,style:e.lineStyle});if(s.addTo(i),e.draftLine=s,t.eventName==="click"&&e.vertexStyle){const o={type:"Point",coordinates:n[n.length-1]},a=new Ii({geometry:o,style:e.vertexStyle});a.addTo(i),e.draftAnchors.push(a)}},generate(n,e){const t=n.tool;if(!e.length)return null;if(n.draftLine&&(n.draftLine._remove(),n.draftLine=null),Array.isArray(n.draftAnchors)){for(const r of n.draftAnchors)r==null||r._remove();n.draftAnchors=[]}const i=Sa(t.options.geometryStyle,{type:"basic-line",color:"#ff0000",width:2});return new Ys({geometry:{type:"LineString",coordinates:e},style:i})}},c7={actions:["click","mousemove","dblclick"],create(n,e){const t=e.drawTool,i=t._getOrCreateDraftLayer(),r=Sa(t.options.geometryStyle,{type:"basic-polygon",color:"#00ff00",opacity:.5}),s=t.options.vertexStyle===null?void 0:Sa(t.options.vertexStyle,{type:"basic-point",size:8,color:"#00ffff"}),o=[];if(s){const a={type:"Point",coordinates:n},l=new Ii({geometry:a,style:s});l.addTo(i),l.initializeGeometry(),o.push(l)}return{tool:t,draftLayer:i,draftPolygon:null,draftEdgeLine:null,draftAnchors:o,polygonStyle:r,vertexStyle:s}},update(n,e,t){var c;if(!e)return;const i=e.draftLayer;if(t.eventName==="click"&&e.vertexStyle){const h={type:"Point",coordinates:n[n.length-1]},d=new Ii({geometry:h,style:e.vertexStyle});d.addTo(i),d.initializeGeometry(),e.draftAnchors.push(d)}if(!n||n.length<2){e.draftEdgeLine&&(e.draftEdgeLine._remove(),e.draftEdgeLine=null),e.draftPolygon&&(e.draftPolygon._remove(),e.draftPolygon=null);return}if(n.length===2){e.draftPolygon&&(e.draftPolygon._remove(),e.draftPolygon=null),e.draftEdgeLine&&(e.draftEdgeLine._remove(),e.draftEdgeLine=null);const h={type:"LineString",coordinates:n},d=((c=e.polygonStyle)==null?void 0:c.config)&&e.polygonStyle.config.color||"#00ff00",p=new Ms({type:"basic-line",color:d,width:2}),m=new Ys({geometry:h,style:p});m.addTo(i),e.draftEdgeLine=m;return}e.draftEdgeLine&&(e.draftEdgeLine._remove(),e.draftEdgeLine=null);const r=n.slice(),s=r[0],o=r[r.length-1];(s[0]!==o[0]||s[1]!==o[1]||(s[2]||0)!==(o[2]||0))&&r.push(s),e.draftPolygon&&(e.draftPolygon._remove(),e.draftPolygon=null);const a={type:"Polygon",coordinates:[r]},l=new $s({geometry:a,style:e.polygonStyle});l.addTo(i),e.draftPolygon=l},generate(n,e){const t=n.tool;if(e.length<3)return null;if(n.draftPolygon&&(n.draftPolygon._remove(),n.draftPolygon=null),n.draftEdgeLine&&(n.draftEdgeLine._remove(),n.draftEdgeLine=null),Array.isArray(n.draftAnchors)){for(const a of n.draftAnchors)a==null||a._remove();n.draftAnchors=[]}const i=Sa(t.options.geometryStyle,{type:"basic-polygon",color:"#00ff00",opacity:.5}),r=e.slice(),s=r[0],o=r[r.length-1];return(s[0]!==o[0]||s[1]!==o[1]||(s[2]||0)!==(o[2]||0))&&r.push(s),new $s({geometry:{type:"Polygon",coordinates:[r]},style:i})}};$c.registerMode("point",a7);$c.registerMode("line",l7);$c.registerMode("polygon",c7);function Sa(n,e){return Ms.create(n||e)}var u7=Object.defineProperty,h7=(n,e,t)=>e in n?u7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,cT=(n,e,t)=>h7(n,typeof e!="symbol"?e+"":e,t);class qn extends xm{constructor(e){super({...e,url:e.urlTemplate,isTMS:e.isTMS||!1}),cT(this,"minLevel",2),cT(this,"maxLevel",24)}getUrl(e,t,i){const r=this.isTMS?Math.pow(2,i)-1-t:t;return Cj(this.url,{...this,x:e,y:r,z:i,tileMatrix:i,tileRow:r,tileCol:e})}}var d7=Object.defineProperty,f7=(n,e,t)=>e in n?d7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qf=(n,e,t)=>f7(n,typeof e!="symbol"?e+"":e,t);class p7 extends xm{constructor(e){super(e),qf(this,"dataType","image"),qf(this,"attribution","ArcGIS"),qf(this,"style","World_Imagery"),qf(this,"url","https://services.arcgisonline.com/arcgis/rest/services/{style}/MapServer/tile/{z}/{y}/{x}"),Object.assign(this,e)}}class Qh extends Ta{constructor(e,t){super(e,t)}validateFeature(e){return e._baseType==="Line"}}class Ks extends Ta{constructor(e,t){super(e,t)}validateFeature(e){return e._baseType==="Point"}}class qc extends Ta{constructor(e,t){super(e,t)}validateFeature(e){return e._baseType==="Surface"}}var m7=Object.defineProperty,g7=(n,e,t)=>e in n?m7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,y7=(n,e,t)=>g7(n,e+"",t);class _7 extends Ta{constructor(e,t){super(e,t),y7(this,"_clouds",null);const i=["texture"];for(const r of i)CA(t,r);this._createClouds(t.texture)}async _createClouds(e){const t=await Ms._loadTexture(e),i=new jj({texture:t,material:Ir});i.castShadow=!0,this._clouds=i}validateFeature(e){return e._type==="Cloud"}animate(e,t){this._clouds&&this._clouds.update(this.map.viewer.camera,t,e)}}var v7=Object.defineProperty,b7=(n,e,t)=>e in n?v7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,x7=(n,e,t)=>b7(n,e+"",t);class w7 extends KA{constructor(e,t){super(e,t),x7(this,"layerType","raster")}createLoader(){const e=new Xv;return Array.isArray(this.source)?e.imgSource=this.source:e.imgSource=[this.source],e}}var S7=Object.defineProperty,M7=(n,e,t)=>e in n?S7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ep=(n,e,t)=>M7(n,typeof e!="symbol"?e+"":e,t);class ei extends w7{constructor(e,t){super(e,t),ep(this,"layerType","wmts"),ep(this,"_layerName"),ep(this,"_style"),ep(this,"_matrixSet"),this._layerName=t.layerName,this._style=t.style||"default",this._matrixSet=t.matrixSet||"GoogleMapsCompatible"}get layerName(){return this._layerName}get style(){return this._style}get matrixSet(){return this._matrixSet}createLoader(){const e=new Xv;return Array.isArray(this.source)?e.imgSource=this.source:e.imgSource=[this.source],e}update(e){this.loader&&super.update(e)}}console.log("%c terra.gl V"+b9+" ","color:rgb(255, 255, 255); font-weight: bold; background: linear-gradient(90deg, #ffb6c1, #ff69b4); padding: 5px; border-radius: 5px;");const T7={class:"absolute top-4 right-4 bg-gray-900/90 backdrop-blur p-4 rounded-lg shadow-xl text-white w-64 border border-gray-700 z-10"},E7={class:"mb-4"},L7={class:"block text-xs text-gray-400 mb-1"},A7=["value"],C7={class:"mb-4"},R7={class:"block text-xs text-gray-400 mb-1"},P7=["value"],I7=gt({__name:"ControlPanel",props:{pitch:{},bearing:{},zoom:{}},emits:["update:pitch","update:bearing"],setup(n,{emit:e}){const t=e;return(i,r)=>(ot(),At("div",T7,[r[2]||(r[2]=ee("h3",{class:"font-bold mb-4 text-lg"},"3D Terrain Demo",-1)),ee("div",E7,[ee("label",L7,"Pitch (Tilt): "+Ze(n.pitch.toFixed(0))+"",1),ee("input",{type:"range",min:"0",max:"85",step:"1",value:n.pitch,onInput:r[0]||(r[0]=s=>t("update:pitch",Number(s.target.value))),class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,40,A7)]),ee("div",C7,[ee("label",R7,"Bearing (Rotation): "+Ze(n.bearing.toFixed(0))+"",1),ee("input",{type:"range",min:"0",max:"360",step:"1",value:n.bearing,onInput:r[1]||(r[1]=s=>t("update:bearing",Number(s.target.value))),class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,40,P7)]),r[3]||(r[3]=ee("div",{class:"text-xs text-gray-500 mt-4"},[ee("p",null,"Use left mouse to pan."),ee("p",null,"Use right mouse or Ctrl+drag to tilt/rotate.")],-1))]))}}),D7={class:"w-full h-full relative bg-gray-900"},N7=gt({__name:"Terrain3D",emits:["view-change","map-loaded"],setup(n,{emit:e}){const t=zt(null);let i=null;const r=zt(60),s=zt(0),o=zt(12),a=e,l=h=>{if(!i)return;r.value=h;const d=i.getCenter();i.viewer.flyToPoint({center:d,polarDeg:h,duration:100})},c=h=>{if(!i)return;s.value=h;const d=i.getCenter();i.viewer.flyToPoint({center:d,azimuthDeg:h,duration:100})};return Dn(()=>{if(!t.value)return;const h=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),d=new qn({urlTemplate:"https://demotiles.maplibre.org/terrain-tiles/{z}/{x}/{y}.png",dataType:"terrain-rgb",minLevel:0,maxLevel:15,projectionID:"3857"}),p=new ei("base-layer",{source:h,projection:$n.createFromID("3857",0),layerName:"osm",style:"default",matrixSet:"EPSG:3857"});p.loader&&(p.loader.demSource=d),i=new xn(t.value,{center:[113.6253,34.7466,2e3],zoom:12,viewer:{antialias:!0,logarithmicDepthBuffer:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[p],minLevel:2,maxLevel:19}}),i.on("control-change",()=>{if(!i)return;const m=i.viewer.controls;let y=0,b=0;m.getPolarAngle&&(y=m.getPolarAngle()*180/Math.PI),m.getAzimuthalAngle&&(b=m.getAzimuthalAngle()*180/Math.PI),a("view-change",{pitch:y,bearing:b,zoom:i.getZoom()})}),a("map-loaded"),i.viewer.flyToPoint({center:[113.6253,34.7466,2e3],distance:5e3,polarDeg:70,azimuthDeg:0,duration:0})}),Vn(()=>{if(i){try{const d=i.viewer.renderer.getContext().getExtension("WEBGL_lose_context");d&&d.loseContext()}catch(h){console.warn("Error disposing WebGL context",h)}i.dispose(),i=null}}),(h,d)=>(ot(),At("div",D7,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full absolute inset-0"},null,512),xt(I7,{pitch:r.value,bearing:s.value,zoom:o.value,"onUpdate:pitch":l,"onUpdate:bearing":c},null,8,["pitch","bearing","zoom"])]))}}),O7=Vh(N7,[["__scopeId","data-v-00b668f8"]]);function k7(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function hC(n){return n instanceof Map?n.clear=n.delete=n.set=function(){throw new Error("map is read-only")}:n instanceof Set&&(n.add=n.clear=n.delete=function(){throw new Error("set is read-only")}),Object.freeze(n),Object.getOwnPropertyNames(n).forEach(e=>{const t=n[e],i=typeof t;(i==="object"||i==="function")&&!Object.isFrozen(t)&&hC(t)}),n}let uT=class{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}};function dC(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function ya(n,...e){const t=Object.create(null);for(const i in n)t[i]=n[i];return e.forEach(function(i){for(const r in i)t[r]=i[r]}),t}const F7="</span>",hT=n=>!!n.scope,U7=(n,{prefix:e})=>{if(n.startsWith("language:"))return n.replace("language:","language-");if(n.includes(".")){const t=n.split(".");return[`${e}${t.shift()}`,...t.map((i,r)=>`${i}${"_".repeat(r+1)}`)].join(" ")}return`${e}${n}`};class z7{constructor(e,t){this.buffer="",this.classPrefix=t.classPrefix,e.walk(this)}addText(e){this.buffer+=dC(e)}openNode(e){if(!hT(e))return;const t=U7(e.scope,{prefix:this.classPrefix});this.span(t)}closeNode(e){hT(e)&&(this.buffer+=F7)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const dT=(n={})=>{const e={children:[]};return Object.assign(e,n),e};class jv{constructor(){this.rootNode=dT(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const t=dT({scope:e});this.add(t),this.stack.push(t)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,t){return typeof t=="string"?e.addText(t):t.children&&(e.openNode(t),t.children.forEach(i=>this._walk(e,i)),e.closeNode(t)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(t=>typeof t=="string")?e.children=[e.children.join("")]:e.children.forEach(t=>{jv._collapse(t)}))}}class W7 extends jv{constructor(e){super(),this.options=e}addText(e){e!==""&&this.add(e)}startScope(e){this.openNode(e)}endScope(){this.closeNode()}__addSublanguage(e,t){const i=e.root;t&&(i.scope=`language:${t}`),this.add(i)}toHTML(){return new z7(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function Nh(n){return n?typeof n=="string"?n:n.source:null}function fC(n){return Ml("(?=",n,")")}function V7(n){return Ml("(?:",n,")*")}function G7(n){return Ml("(?:",n,")?")}function Ml(...n){return n.map(t=>Nh(t)).join("")}function B7(n){const e=n[n.length-1];return typeof e=="object"&&e.constructor===Object?(n.splice(n.length-1,1),e):{}}function Yv(...n){return"("+(B7(n).capture?"":"?:")+n.map(i=>Nh(i)).join("|")+")"}function pC(n){return new RegExp(n.toString()+"|").exec("").length-1}function H7(n,e){const t=n&&n.exec(e);return t&&t.index===0}const Z7=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function Kv(n,{joinWith:e}){let t=0;return n.map(i=>{t+=1;const r=t;let s=Nh(i),o="";for(;s.length>0;){const a=Z7.exec(s);if(!a){o+=s;break}o+=s.substring(0,a.index),s=s.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?o+="\\"+String(Number(a[1])+r):(o+=a[0],a[0]==="("&&t++)}return o}).map(i=>`(${i})`).join(e)}const X7=/\b\B/,mC="[a-zA-Z]\\w*",Jv="[a-zA-Z_]\\w*",gC="\\b\\d+(\\.\\d+)?",yC="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",_C="\\b(0b[01]+)",j7="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",Y7=(n={})=>{const e=/^#![ ]*\//;return n.binary&&(n.begin=Ml(e,/.*\b/,n.binary,/\b.*/)),ya({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(t,i)=>{t.index!==0&&i.ignoreMatch()}},n)},Oh={begin:"\\\\[\\s\\S]",relevance:0},K7={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Oh]},J7={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Oh]},Q7={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},wm=function(n,e,t={}){const i=ya({scope:"comment",begin:n,end:e,contains:[]},t);i.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=Yv("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return i.contains.push({begin:Ml(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),i},$7=wm("//","$"),q7=wm("/\\*","\\*/"),eJ=wm("#","$"),tJ={scope:"number",begin:gC,relevance:0},nJ={scope:"number",begin:yC,relevance:0},iJ={scope:"number",begin:_C,relevance:0},rJ={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Oh,{begin:/\[/,end:/\]/,relevance:0,contains:[Oh]}]},sJ={scope:"title",begin:mC,relevance:0},oJ={scope:"title",begin:Jv,relevance:0},aJ={begin:"\\.\\s*"+Jv,relevance:0},lJ=function(n){return Object.assign(n,{"on:begin":(e,t)=>{t.data._beginMatch=e[1]},"on:end":(e,t)=>{t.data._beginMatch!==e[1]&&t.ignoreMatch()}})};var tp=Object.freeze({__proto__:null,APOS_STRING_MODE:K7,BACKSLASH_ESCAPE:Oh,BINARY_NUMBER_MODE:iJ,BINARY_NUMBER_RE:_C,COMMENT:wm,C_BLOCK_COMMENT_MODE:q7,C_LINE_COMMENT_MODE:$7,C_NUMBER_MODE:nJ,C_NUMBER_RE:yC,END_SAME_AS_BEGIN:lJ,HASH_COMMENT_MODE:eJ,IDENT_RE:mC,MATCH_NOTHING_RE:X7,METHOD_GUARD:aJ,NUMBER_MODE:tJ,NUMBER_RE:gC,PHRASAL_WORDS_MODE:Q7,QUOTE_STRING_MODE:J7,REGEXP_MODE:rJ,RE_STARTERS_RE:j7,SHEBANG:Y7,TITLE_MODE:sJ,UNDERSCORE_IDENT_RE:Jv,UNDERSCORE_TITLE_MODE:oJ});function cJ(n,e){n.input[n.index-1]==="."&&e.ignoreMatch()}function uJ(n,e){n.className!==void 0&&(n.scope=n.className,delete n.className)}function hJ(n,e){e&&n.beginKeywords&&(n.begin="\\b("+n.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",n.__beforeBegin=cJ,n.keywords=n.keywords||n.beginKeywords,delete n.beginKeywords,n.relevance===void 0&&(n.relevance=0))}function dJ(n,e){Array.isArray(n.illegal)&&(n.illegal=Yv(...n.illegal))}function fJ(n,e){if(n.match){if(n.begin||n.end)throw new Error("begin & end are not supported with match");n.begin=n.match,delete n.match}}function pJ(n,e){n.relevance===void 0&&(n.relevance=1)}const mJ=(n,e)=>{if(!n.beforeMatch)return;if(n.starts)throw new Error("beforeMatch cannot be used with starts");const t=Object.assign({},n);Object.keys(n).forEach(i=>{delete n[i]}),n.keywords=t.keywords,n.begin=Ml(t.beforeMatch,fC(t.begin)),n.starts={relevance:0,contains:[Object.assign(t,{endsParent:!0})]},n.relevance=0,delete t.beforeMatch},gJ=["of","and","for","in","not","or","if","then","parent","list","value"],yJ="keyword";function vC(n,e,t=yJ){const i=Object.create(null);return typeof n=="string"?r(t,n.split(" ")):Array.isArray(n)?r(t,n):Object.keys(n).forEach(function(s){Object.assign(i,vC(n[s],e,s))}),i;function r(s,o){e&&(o=o.map(a=>a.toLowerCase())),o.forEach(function(a){const l=a.split("|");i[l[0]]=[s,_J(l[0],l[1])]})}}function _J(n,e){return e?Number(e):vJ(n)?0:1}function vJ(n){return gJ.includes(n.toLowerCase())}const fT={},pl=n=>{console.error(n)},pT=(n,...e)=>{console.log(`WARN: ${n}`,...e)},cc=(n,e)=>{fT[`${n}/${e}`]||(console.log(`Deprecated as of ${n}. ${e}`),fT[`${n}/${e}`]=!0)},Gp=new Error;function bC(n,e,{key:t}){let i=0;const r=n[t],s={},o={};for(let a=1;a<=e.length;a++)o[a+i]=r[a],s[a+i]=!0,i+=pC(e[a-1]);n[t]=o,n[t]._emit=s,n[t]._multi=!0}function bJ(n){if(Array.isArray(n.begin)){if(n.skip||n.excludeBegin||n.returnBegin)throw pl("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Gp;if(typeof n.beginScope!="object"||n.beginScope===null)throw pl("beginScope must be object"),Gp;bC(n,n.begin,{key:"beginScope"}),n.begin=Kv(n.begin,{joinWith:""})}}function xJ(n){if(Array.isArray(n.end)){if(n.skip||n.excludeEnd||n.returnEnd)throw pl("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Gp;if(typeof n.endScope!="object"||n.endScope===null)throw pl("endScope must be object"),Gp;bC(n,n.end,{key:"endScope"}),n.end=Kv(n.end,{joinWith:""})}}function wJ(n){n.scope&&typeof n.scope=="object"&&n.scope!==null&&(n.beginScope=n.scope,delete n.scope)}function SJ(n){wJ(n),typeof n.beginScope=="string"&&(n.beginScope={_wrap:n.beginScope}),typeof n.endScope=="string"&&(n.endScope={_wrap:n.endScope}),bJ(n),xJ(n)}function MJ(n){function e(o,a){return new RegExp(Nh(o),"m"+(n.case_insensitive?"i":"")+(n.unicodeRegex?"u":"")+(a?"g":""))}class t{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,a]),this.matchAt+=pC(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(l=>l[1]);this.matcherRe=e(Kv(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(a);if(!l)return null;const c=l.findIndex((d,p)=>p>0&&d!==void 0),h=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,h)}}class i{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const l=new t;return this.rules.slice(a).forEach(([c,h])=>l.addRule(c,h)),l.compile(),this.multiRegexes[a]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,l){this.rules.push([a,l]),l.type==="begin"&&this.count++}exec(a){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(a);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const h=this.getMatcher(0);h.lastIndex=this.lastIndex+1,c=h.exec(a)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function r(o){const a=new i;return o.contains.forEach(l=>a.addRule(l.begin,{rule:l,type:"begin"})),o.terminatorEnd&&a.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&a.addRule(o.illegal,{type:"illegal"}),a}function s(o,a){const l=o;if(o.isCompiled)return l;[uJ,fJ,SJ,mJ].forEach(h=>h(o,a)),n.compilerExtensions.forEach(h=>h(o,a)),o.__beforeBegin=null,[hJ,dJ,pJ].forEach(h=>h(o,a)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=vC(o.keywords,n.case_insensitive)),l.keywordPatternRe=e(c,!0),a&&(o.begin||(o.begin=/\B|\b/),l.beginRe=e(l.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(l.endRe=e(l.end)),l.terminatorEnd=Nh(l.end)||"",o.endsWithParent&&a.terminatorEnd&&(l.terminatorEnd+=(o.end?"|":"")+a.terminatorEnd)),o.illegal&&(l.illegalRe=e(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(h){return TJ(h==="self"?o:h)})),o.contains.forEach(function(h){s(h,l)}),o.starts&&s(o.starts,a),l.matcher=r(l),l}if(n.compilerExtensions||(n.compilerExtensions=[]),n.contains&&n.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return n.classNameAliases=ya(n.classNameAliases||{}),s(n)}function xC(n){return n?n.endsWithParent||xC(n.starts):!1}function TJ(n){return n.variants&&!n.cachedVariants&&(n.cachedVariants=n.variants.map(function(e){return ya(n,{variants:null},e)})),n.cachedVariants?n.cachedVariants:xC(n)?ya(n,{starts:n.starts?ya(n.starts):null}):Object.isFrozen(n)?ya(n):n}var EJ="11.11.1";class LJ extends Error{constructor(e,t){super(e),this.name="HTMLInjectionError",this.html=t}}const n0=dC,mT=ya,gT=Symbol("nomatch"),AJ=7,wC=function(n){const e=Object.create(null),t=Object.create(null),i=[];let r=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:W7};function l(V){return a.noHighlightRe.test(V)}function c(V){let te=V.className+" ";te+=V.parentNode?V.parentNode.className:"";const J=a.languageDetectRe.exec(te);if(J){const pe=O(J[1]);return pe||(pT(s.replace("{}",J[1])),pT("Falling back to no-highlight mode for this block.",V)),pe?J[1]:"no-highlight"}return te.split(/\s+/).find(pe=>l(pe)||O(pe))}function h(V,te,J){let pe="",Te="";typeof te=="object"?(pe=V,J=te.ignoreIllegals,Te=te.language):(cc("10.7.0","highlight(lang, code, ...args) has been deprecated."),cc("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),Te=V,pe=te),J===void 0&&(J=!0);const Le={code:pe,language:Te};re("before:highlight",Le);const Ue=Le.result?Le.result:d(Le.language,Le.code,J);return Ue.code=Le.code,re("after:highlight",Ue),Ue}function d(V,te,J,pe){const Te=Object.create(null);function Le(K,de){return K.keywords[de]}function Ue(){if(!N.keywords){j.addText(L);return}let K=0;N.keywordPatternRe.lastIndex=0;let de=N.keywordPatternRe.exec(L),ye="";for(;de;){ye+=L.substring(K,de.index);const Pe=ge.case_insensitive?de[0].toLowerCase():de[0],Qe=Le(N,Pe);if(Qe){const[Ne,je]=Qe;if(j.addText(ye),ye="",Te[Pe]=(Te[Pe]||0)+1,Te[Pe]<=AJ&&(P+=je),Ne.startsWith("_"))ye+=de[0];else{const lt=ge.classNameAliases[Ne]||Ne;Ae(de[0],lt)}}else ye+=de[0];K=N.keywordPatternRe.lastIndex,de=N.keywordPatternRe.exec(L)}ye+=L.substring(K),j.addText(ye)}function tt(){if(L==="")return;let K=null;if(typeof N.subLanguage=="string"){if(!e[N.subLanguage]){j.addText(L);return}K=d(N.subLanguage,L,!0,B[N.subLanguage]),B[N.subLanguage]=K._top}else K=m(L,N.subLanguage.length?N.subLanguage:null);N.relevance>0&&(P+=K.relevance),j.__addSublanguage(K._emitter,K.language)}function _e(){N.subLanguage!=null?tt():Ue(),L=""}function Ae(K,de){K!==""&&(j.startScope(de),j.addText(K),j.endScope())}function We(K,de){let ye=1;const Pe=de.length-1;for(;ye<=Pe;){if(!K._emit[ye]){ye++;continue}const Qe=ge.classNameAliases[K[ye]]||K[ye],Ne=de[ye];Qe?Ae(Ne,Qe):(L=Ne,Ue(),L=""),ye++}}function se(K,de){return K.scope&&typeof K.scope=="string"&&j.openNode(ge.classNameAliases[K.scope]||K.scope),K.beginScope&&(K.beginScope._wrap?(Ae(L,ge.classNameAliases[K.beginScope._wrap]||K.beginScope._wrap),L=""):K.beginScope._multi&&(We(K.beginScope,de),L="")),N=Object.create(K,{parent:{value:N}}),N}function Se(K,de,ye){let Pe=H7(K.endRe,ye);if(Pe){if(K["on:end"]){const Qe=new uT(K);K["on:end"](de,Qe),Qe.isMatchIgnored&&(Pe=!1)}if(Pe){for(;K.endsParent&&K.parent;)K=K.parent;return K}}if(K.endsWithParent)return Se(K.parent,de,ye)}function Me(K){return N.matcher.regexIndex===0?(L+=K[0],1):(Q=!0,0)}function De(K){const de=K[0],ye=K.rule,Pe=new uT(ye),Qe=[ye.__beforeBegin,ye["on:begin"]];for(const Ne of Qe)if(Ne&&(Ne(K,Pe),Pe.isMatchIgnored))return Me(de);return ye.skip?L+=de:(ye.excludeBegin&&(L+=de),_e(),!ye.returnBegin&&!ye.excludeBegin&&(L=de)),se(ye,K),ye.returnBegin?0:de.length}function Be(K){const de=K[0],ye=te.substring(K.index),Pe=Se(N,K,ye);if(!Pe)return gT;const Qe=N;N.endScope&&N.endScope._wrap?(_e(),Ae(de,N.endScope._wrap)):N.endScope&&N.endScope._multi?(_e(),We(N.endScope,K)):Qe.skip?L+=de:(Qe.returnEnd||Qe.excludeEnd||(L+=de),_e(),Qe.excludeEnd&&(L=de));do N.scope&&j.closeNode(),!N.skip&&!N.subLanguage&&(P+=N.relevance),N=N.parent;while(N!==Pe.parent);return Pe.starts&&se(Pe.starts,K),Qe.returnEnd?0:de.length}function H(){const K=[];for(let de=N;de!==ge;de=de.parent)de.scope&&K.unshift(de.scope);K.forEach(de=>j.openNode(de))}let X={};function D(K,de){const ye=de&&de[0];if(L+=K,ye==null)return _e(),0;if(X.type==="begin"&&de.type==="end"&&X.index===de.index&&ye===""){if(L+=te.slice(de.index,de.index+1),!r){const Pe=new Error(`0 width match regex (${V})`);throw Pe.languageName=V,Pe.badRule=X.rule,Pe}return 1}if(X=de,de.type==="begin")return De(de);if(de.type==="illegal"&&!J){const Pe=new Error('Illegal lexeme "'+ye+'" for mode "'+(N.scope||"<unnamed>")+'"');throw Pe.mode=N,Pe}else if(de.type==="end"){const Pe=Be(de);if(Pe!==gT)return Pe}if(de.type==="illegal"&&ye==="")return L+=`
`,1;if(G>1e5&&G>de.index*3)throw new Error("potential infinite loop, way more iterations than matches");return L+=ye,ye.length}const ge=O(V);if(!ge)throw pl(s.replace("{}",V)),new Error('Unknown language: "'+V+'"');const me=MJ(ge);let fe="",N=pe||me;const B={},j=new a.__emitter(a);H();let L="",P=0,Z=0,G=0,Q=!1;try{if(ge.__emitTokens)ge.__emitTokens(te,j);else{for(N.matcher.considerAll();;){G++,Q?Q=!1:N.matcher.considerAll(),N.matcher.lastIndex=Z;const K=N.matcher.exec(te);if(!K)break;const de=te.substring(Z,K.index),ye=D(de,K);Z=K.index+ye}D(te.substring(Z))}return j.finalize(),fe=j.toHTML(),{language:V,value:fe,relevance:P,illegal:!1,_emitter:j,_top:N}}catch(K){if(K.message&&K.message.includes("Illegal"))return{language:V,value:n0(te),illegal:!0,relevance:0,_illegalBy:{message:K.message,index:Z,context:te.slice(Z-100,Z+100),mode:K.mode,resultSoFar:fe},_emitter:j};if(r)return{language:V,value:n0(te),illegal:!1,relevance:0,errorRaised:K,_emitter:j,_top:N};throw K}}function p(V){const te={value:n0(V),illegal:!1,relevance:0,_top:o,_emitter:new a.__emitter(a)};return te._emitter.addText(V),te}function m(V,te){te=te||a.languages||Object.keys(e);const J=p(V),pe=te.filter(O).filter(T).map(_e=>d(_e,V,!1));pe.unshift(J);const Te=pe.sort((_e,Ae)=>{if(_e.relevance!==Ae.relevance)return Ae.relevance-_e.relevance;if(_e.language&&Ae.language){if(O(_e.language).supersetOf===Ae.language)return 1;if(O(Ae.language).supersetOf===_e.language)return-1}return 0}),[Le,Ue]=Te,tt=Le;return tt.secondBest=Ue,tt}function y(V,te,J){const pe=te&&t[te]||J;V.classList.add("hljs"),V.classList.add(`language-${pe}`)}function b(V){let te=null;const J=c(V);if(l(J))return;if(re("before:highlightElement",{el:V,language:J}),V.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",V);return}if(V.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(V)),a.throwUnescapedHTML))throw new LJ("One of your code blocks includes unescaped HTML.",V.innerHTML);te=V;const pe=te.textContent,Te=J?h(pe,{language:J,ignoreIllegals:!0}):m(pe);V.innerHTML=Te.value,V.dataset.highlighted="yes",y(V,J,Te.language),V.result={language:Te.language,re:Te.relevance,relevance:Te.relevance},Te.secondBest&&(V.secondBest={language:Te.secondBest.language,relevance:Te.secondBest.relevance}),re("after:highlightElement",{el:V,result:Te,text:pe})}function v(V){a=mT(a,V)}const g=()=>{S(),cc("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function x(){S(),cc("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let w=!1;function S(){function V(){S()}if(document.readyState==="loading"){w||window.addEventListener("DOMContentLoaded",V,!1),w=!0;return}document.querySelectorAll(a.cssSelector).forEach(b)}function C(V,te){let J=null;try{J=te(n)}catch(pe){if(pl("Language definition for '{}' could not be registered.".replace("{}",V)),r)pl(pe);else throw pe;J=o}J.name||(J.name=V),e[V]=J,J.rawDefinition=te.bind(null,n),J.aliases&&R(J.aliases,{languageName:V})}function A(V){delete e[V];for(const te of Object.keys(t))t[te]===V&&delete t[te]}function E(){return Object.keys(e)}function O(V){return V=(V||"").toLowerCase(),e[V]||e[t[V]]}function R(V,{languageName:te}){typeof V=="string"&&(V=[V]),V.forEach(J=>{t[J.toLowerCase()]=te})}function T(V){const te=O(V);return te&&!te.disableAutodetect}function k(V){V["before:highlightBlock"]&&!V["before:highlightElement"]&&(V["before:highlightElement"]=te=>{V["before:highlightBlock"](Object.assign({block:te.el},te))}),V["after:highlightBlock"]&&!V["after:highlightElement"]&&(V["after:highlightElement"]=te=>{V["after:highlightBlock"](Object.assign({block:te.el},te))})}function Y(V){k(V),i.push(V)}function $(V){const te=i.indexOf(V);te!==-1&&i.splice(te,1)}function re(V,te){const J=V;i.forEach(function(pe){pe[J]&&pe[J](te)})}function ae(V){return cc("10.7.0","highlightBlock will be removed entirely in v12.0"),cc("10.7.0","Please use highlightElement now."),b(V)}Object.assign(n,{highlight:h,highlightAuto:m,highlightAll:S,highlightElement:b,highlightBlock:ae,configure:v,initHighlighting:g,initHighlightingOnLoad:x,registerLanguage:C,unregisterLanguage:A,listLanguages:E,getLanguage:O,registerAliases:R,autoDetection:T,inherit:mT,addPlugin:Y,removePlugin:$}),n.debugMode=function(){r=!1},n.safeMode=function(){r=!0},n.versionString=EJ,n.regex={concat:Ml,lookahead:fC,either:Yv,optional:G7,anyNumberOfTimes:V7};for(const V in tp)typeof tp[V]=="object"&&hC(tp[V]);return Object.assign(n,tp),n},Hc=wC({});Hc.newInstance=()=>wC({});var CJ=Hc;Hc.HighlightJS=Hc;Hc.default=Hc;const yT=k7(CJ);function RJ(n){const e=n.regex,t=e.concat(/[\p{L}_]/u,e.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),i=/[\p{L}0-9._:-]+/u,r={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},s={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},o=n.inherit(s,{begin:/\(/,end:/\)/}),a=n.inherit(n.APOS_STRING_MODE,{className:"string"}),l=n.inherit(n.QUOTE_STRING_MODE,{className:"string"}),c={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:i,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/,contains:[r]},{begin:/'/,end:/'/,contains:[r]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,unicodeRegex:!0,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[s,l,a,o,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[s,o,l,a]}]}]},n.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},r,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[l]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[c],starts:{end:/<\/style>/,returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[c],starts:{end:/<\/script>/,returnEnd:!0,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:e.concat(/</,e.lookahead(e.concat(t,e.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:t,relevance:0,starts:c}]},{className:"tag",begin:e.concat(/<\//,e.lookahead(e.concat(t,/>/))),contains:[{className:"name",begin:t,relevance:0},{begin:/>/,relevance:0,endsParent:!0}]}]}}const PJ={class:"flex flex-col h-full w-full bg-gray-900"},IJ={class:"flex items-center justify-between px-6 py-4 bg-gray-800 border-b border-gray-700"},DJ={class:"text-xl font-bold text-white"},NJ={key:0,class:"text-sm text-gray-400 mt-1"},OJ={class:"flex items-center gap-4"},kJ={class:"flex bg-gray-900 rounded-lg p-1 border border-gray-700"},FJ={class:"flex-1 relative overflow-hidden"},UJ={class:"w-full h-full"},zJ={class:"w-full h-full relative group"},WJ={class:"w-full h-full overflow-auto bg-[#282c34] p-6"},VJ=["innerHTML"],GJ=gt({__name:"ExampleViewer",props:{code:{},title:{},description:{}},setup(n){yT.registerLanguage("xml",RJ);const e=n,{t}=Ht(),i=zt("preview"),r=zt(!1),s=ci(()=>yT.highlight(e.code,{language:"xml"}).value),o=async()=>{try{await navigator.clipboard.writeText(e.code),r.value=!0,setTimeout(()=>{r.value=!1},2e3)}catch(a){console.error("Failed to copy code:",a)}};return(a,l)=>(ot(),At("div",PJ,[ee("div",IJ,[ee("div",null,[ee("h1",DJ,Ze(n.title),1),n.description?(ot(),At("p",NJ,Ze(n.description),1)):qp("",!0)]),ee("div",OJ,[ee("div",kJ,[ee("button",{onClick:l[0]||(l[0]=c=>i.value="preview"),class:Dr(["px-4 py-1.5 rounded-md text-sm font-medium transition-colors",i.value==="preview"?"bg-blue-600 text-white shadow-sm":"text-gray-400 hover:text-white"])},Ze(Re(t)("viewer.preview")),3),ee("button",{onClick:l[1]||(l[1]=c=>i.value="code"),class:Dr(["px-4 py-1.5 rounded-md text-sm font-medium transition-colors",i.value==="code"?"bg-blue-600 text-white shadow-sm":"text-gray-400 hover:text-white"])},Ze(Re(t)("viewer.code")),3)])])]),ee("div",FJ,[Yn(ee("div",UJ,[MO(a.$slots,"default",{},void 0)],512),[[Pw,i.value==="preview"]]),Yn(ee("div",zJ,[ee("button",{onClick:o,class:"absolute top-4 right-8 px-3 py-1.5 rounded bg-gray-700 hover:bg-gray-600 text-xs text-white transition-all opacity-0 group-hover:opacity-100 z-10 border border-gray-600"},Ze(r.value?Re(t)("viewer.copied"):Re(t)("viewer.copy")),1),ee("div",WJ,[ee("pre",null,[ee("code",{class:"language-xml",innerHTML:s.value},null,8,VJ)])])],512),[[Pw,i.value==="code"]])])]))}}),pi=Vh(GJ,[["__scopeId","data-v-bd460523"]]),BJ=`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra-GL 3D Terrain</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; font-family: sans-serif; }
        #map { width: 100vw; height: 100vh; background-color: #242424; }
        
        /* Control Panel Styles */
        #control-panel {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 16rem; /* 64px * 4 = 256px */
            background-color: rgba(17, 24, 39, 0.9); /* bg-gray-900/90 */
            backdrop-filter: blur(4px);
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            color: white;
            border: 1px solid rgb(55, 65, 81); /* border-gray-700 */
            z-index: 10;
        }

        .panel-title {
            font-weight: bold;
            margin-bottom: 1rem;
            font-size: 1.125rem;
            line-height: 1.75rem;
        }

        .control-group {
            margin-bottom: 1rem;
        }

        .control-label {
            display: block;
            font-size: 0.75rem;
            color: rgb(156, 163, 175); /* text-gray-400 */
            margin-bottom: 0.25rem;
        }

        .range-input {
            width: 100%;
            height: 0.5rem;
            background-color: rgb(55, 65, 81); /* bg-gray-700 */
            border-radius: 0.5rem;
            appearance: none;
            -webkit-appearance: none;
            cursor: pointer;
        }
        
        .range-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 1rem;
            height: 1rem;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
        }

        .instructions {
            font-size: 0.75rem;
            color: rgb(107, 114, 128); /* text-gray-500 */
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <!-- Control Panel -->
    <div id="control-panel">
        <div class="panel-title">3D Terrain Demo</div>
        
        <div class="control-group">
            <label class="control-label" id="pitch-label">Pitch (Tilt): 60</label>
            <input type="range" id="pitch-input" class="range-input" min="0" max="85" step="1" value="60">
        </div>

        <div class="control-group">
            <label class="control-label" id="bearing-label">Bearing (Rotation): 0</label>
            <input type="range" id="bearing-input" class="range-input" min="0" max="360" step="1" value="0">
        </div>

        <div class="instructions">
            <p>Use left mouse to pan.</p>
            <p>Use right mouse or Ctrl+drag to tilt/rotate.</p>
        </div>
    </div>

    <!-- Import Map for managing dependencies -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.171.0/build/three.module.js",
            "@terra.gl/core": "https://unpkg.com/@terra.gl/core@0.0.1-alpha.35/dist/index.js"
        }
    }
    <\/script>

    <script type="module">
        import * as terra from '@terra.gl/core';

        // 1. Create Data Sources
        const osmSource = new terra.WMTSSource({
            urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
            minLevel: 0,
            maxLevel: 19,
            attribution: "&copy; OpenStreetMap &copy; CARTO"
        });

        const terrainSource = new terra.WMTSSource({
            urlTemplate: "https://demotiles.maplibre.org/terrain-tiles/{z}/{x}/{y}.png",
            dataType: "terrain-rgb",
            minLevel: 0,
            maxLevel: 15,
            projectionID: "3857"
        });

        // 2. Create Layer
        const baseLayer = new terra.WMTSTileLayer("base-layer", {
            source: osmSource,
            projection: terra.ProjectFactory.createFromID("3857", 0),
            layerName: "dark-layer",
            style: "default",
            matrixSet: "EPSG:3857"
        });

        // 3. Attach Terrain Source
        if (baseLayer.loader) {
            baseLayer.loader.demSource = terrainSource;
        }

        // 4. Initialize Map
        const mapContainer = document.getElementById('map');
        const map = new terra.Map(mapContainer, {
            center: [113.6253, 34.7466, 2000], // Zhengzhou
            zoom: 12,
            viewer: {
                antialias: true,
                logarithmicDepthBuffer: true,
                polarDeg: 70,
                azimuthDeg: 0,
                skybox: {
                    path: "/image/skyboxall/onemap/",
                    files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
                    defaultColor: '#121E3A'
                }
            },
            basemap: {
                Baselayers: [baseLayer],
                minLevel: 2,
                maxLevel: 19
            }
        });

        // 5. Initial FlyTo
        map.viewer.flyToPoint({
            center: [113.6253, 34.7466, 1000],
            distance: 5000,
            polarDeg: 70,
            azimuthDeg: 0,
            duration: 0
        });

        // 6. UI Interaction Logic
        const pitchInput = document.getElementById('pitch-input');
        const bearingInput = document.getElementById('bearing-input');
        const pitchLabel = document.getElementById('pitch-label');
        const bearingLabel = document.getElementById('bearing-label');

        function updateView() {
            const pitch = parseFloat(pitchInput.value);
            const bearing = parseFloat(bearingInput.value);

            pitchLabel.textContent = \`Pitch (Tilt): \${pitch.toFixed(0)}\`;
            bearingLabel.textContent = \`Bearing (Rotation): \${bearing.toFixed(0)}\`;

            // Use flyToPoint to update camera angle smoothly
            const center = map.getCenter();
            map.viewer.flyToPoint({
                center: center,
                polarDeg: pitch,
                azimuthDeg: bearing,
                duration: 100 // Short duration for responsive slider feel
            });
        }

        pitchInput.addEventListener('input', updateView);
        bearingInput.addEventListener('input', updateView);

        // Optional: Listen to map changes to update sliders (Two-way binding)
        // This is more complex as it requires converting camera quaternion/position back to pitch/bearing
        // For simplicity in this example, we keep it one-way (Slider -> Map) or 
        // rely on user moving map and slider potentially being out of sync, 
        // which is acceptable for a simple demo. 
        // But if we want to sync, we can try hooking into controls.
        
        /*
        map.on('control-change', () => {
             // Logic to sync sliders back if needed
        });
        */

    <\/script>
</body>
</html>`,HJ=gt({__name:"Terrain3DWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.terrain3d.title"),description:Re(e)("examples.terrain3d.description"),code:Re(BJ)},{default:yn(()=>[xt(O7)]),_:1},8,["title","description","code"]))}}),ZJ=gt({__name:"BasicMap",setup(n){const e=zt(null);let t=null;return Dn(()=>{if(!e.value)return;const i=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),r=new ei("base-layer",{source:i,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[113.6253,34.7466,2e3],zoom:10,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}})}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(i,r)=>(ot(),At("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512))}}),XJ=`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra-GL Basic Map</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; }
        #map { width: 100vw; height: 100vh; background-color: #242424; }
    </style>
</head>
<body>
    <div id="map"></div>

    <!-- Import Map for managing dependencies -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.171.0/build/three.module.js",
            "@terra.gl/core": "https://unpkg.com/@terra.gl/core@0.0.1-alpha.35/dist/index.js"
        }
    }
    <\/script>

    <script type="module">
        import * as terra from '@terra.gl/core';

        // 1. Create Data Sources
        const osmSource = new terra.WMTSSource({
            urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
            minLevel: 0,
            maxLevel: 19,
            attribution: "&copy; OpenStreetMap &copy; CARTO"
        });

        // 2. Create Layer
        const baseLayer = new terra.WMTSTileLayer("base-layer", {
            source: osmSource,
            projection: terra.ProjectFactory.createFromID("3857", 0),
            layerName: "dark-layer",
            style: "default",
            matrixSet: "EPSG:3857"
        });

        // 3. Initialize Map
        const mapContainer = document.getElementById('map');
        const map = new terra.Map(mapContainer, {
            center: [113.6253, 34.7466, 2000], // Zhengzhou
            zoom: 10,
            polarDeg: 70,
            azimuthDeg: 0,
            viewer: {
                antialias: true,
                polarDeg: 70,
                azimuthDeg: 0,
                skybox: {
                    path: "/image/skyboxall/onemap/",
                    files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
                    defaultColor: '#121E3A'
                }
            },
            basemap: {
                Baselayers: [baseLayer],
                minLevel: 2,
                maxLevel: 19
            }
        });
    <\/script>
</body>
</html>`,jJ=gt({__name:"BasicMapWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.basicMap.title"),description:Re(e)("examples.basicMap.description"),code:Re(XJ)},{default:yn(()=>[xt(ZJ)]),_:1},8,["title","description","code"]))}}),YJ={class:"relative w-full h-full"},KJ={class:"absolute top-4 right-4 bg-gray-800/90 text-white p-4 rounded-lg shadow-lg w-80 max-h-[500px] overflow-hidden flex flex-col z-10 border border-gray-700"},JJ={class:"font-bold mb-2 border-b border-gray-600 pb-2"},QJ={class:"flex-1 overflow-y-auto font-mono text-xs space-y-1"},$J={key:0,class:"text-gray-500 italic"},qJ=gt({__name:"MapEvents",setup(n){const e=zt(null),t=zt([]);let i=null;const r=s=>{t.value.unshift(`${new Date().toLocaleTimeString()} - ${s}`),t.value.length>20&&t.value.pop()};return Dn(()=>{if(!e.value)return;const s=new qn({urlTemplate:"https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),o=new ei("base-layer",{source:s,projection:$n.createFromID("3857",0),layerName:"light-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(e.value,{center:[116.405467,39.907761,2e3],zoom:12,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[o],minLevel:2,maxLevel:19}}),i.on("click",a=>{const{lng:l,lat:c}=a.lnglat||{};r(`Click at: [${l==null?void 0:l.toFixed(4)}, ${c==null?void 0:c.toFixed(4)}]`)}),i.on("dblclick",()=>{r("Double Click")}),i.on("contextmenu",()=>{r("Context Menu (Right Click)")}),i.on("zoomstart",()=>{r("Zoom Start")}),i.on("zoomend",()=>{r(`Zoom End: Level ${i==null?void 0:i.getZoom().toFixed(2)}`)}),i.on("movestart",()=>{r("Move Start")}),i.on("moveend",()=>{const a=i==null?void 0:i.getCenter();r(`Move End: Center [${a==null?void 0:a[0].toFixed(4)}, ${a==null?void 0:a[1].toFixed(4)}]`)})}),Vn(()=>{i&&(typeof i.dispose=="function"&&i.dispose(),i=null)}),(s,o)=>(ot(),At("div",YJ,[ee("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512),ee("div",KJ,[ee("h3",JJ,Ze(s.$t("examples.mapEvents.panelTitle")),1),ee("div",QJ,[t.value.length===0?(ot(),At("div",$J,Ze(s.$t("examples.mapEvents.placeholder")),1)):qp("",!0),(ot(!0),At(Un,null,Cc(t.value,(a,l)=>(ot(),At("div",{key:l,class:"text-gray-300"},Ze(a),1))),128))])])]))}}),eQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
const logs = ref<string[]>([]);
let map: terra.Map | null = null;

const addLog = (msg: string) => {
  logs.value.unshift(\`\${new Date().toLocaleTimeString()} - \${msg}\`);
  if (logs.value.length > 20) logs.value.pop();
};

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "light-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.405467, 39.907761, 2000],
    zoom: 12,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  

  map.on('click', (e: any) => {
    const { lng, lat } = e.lnglat || {};
    addLog(\`Click at: [\${lng?.toFixed(4)}, \${lat?.toFixed(4)}]\`);
  });

  map.on('zoomend', () => {
    addLog(\`Zoom End: Level \${map?.getZoom().toFixed(2)}\`);
  });

  map.on('moveend', () => {
    const center = map?.getCenter();
    addLog(\`Move End: Center [\${center?.[0].toFixed(4)}, \${center?.[1].toFixed(4)}]\`);
  });
  
  // More events: dblclick, contextmenu, zoomstart, movestart...
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    <div class="absolute top-4 right-4 bg-gray-800/90 text-white p-4 rounded-lg shadow-lg w-80 max-h-[500px] overflow-hidden flex flex-col z-10 border border-gray-700">
      <h3 class="font-bold mb-2 border-b border-gray-600 pb-2">Event Logs</h3>
      <div class="flex-1 overflow-y-auto font-mono text-xs space-y-1">
        <div v-for="(log, index) in logs" :key="index" class="text-gray-300">{{ log }}</div>
      </div>
    </div>
  </div>
</template>`,tQ=gt({__name:"MapEventsWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.mapEvents.title"),description:Re(e)("examples.mapEvents.description"),code:Re(eQ)},{default:yn(()=>[xt(qJ)]),_:1},8,["title","description","code"]))}}),nQ={class:"relative w-full h-full"},iQ={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10"},rQ={class:"space-y-2"},sQ=["value","checked","onChange"],oQ=gt({__name:"TileLayerExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null,r=null;const s=zt("carto_dark"),o=ci(()=>({carto_dark:{name:e("examples.tileLayer.layers.dark"),url:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap &copy; CARTO"},carto_light:{name:e("examples.tileLayer.layers.light"),url:"https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap &copy; CARTO"},osm:{name:e("examples.tileLayer.layers.osm"),url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors"},arcgis:{name:e("examples.tileLayer.layers.satellite"),url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri"}})),a=l=>{if(!i)return;r&&i.removeLayer(r.getId());const c=o.value[l],h=new qn({urlTemplate:c.url,minLevel:0,maxLevel:19,attribution:c.attribution}),d=new ei("base-layer-"+l,{source:h,projection:$n.createFromID("3857",0),layerName:"layer-"+l,style:"default",matrixSet:"EPSG:3857"});i.addLayer(d),r=d,s.value=l};return Dn(()=>{if(!t.value)return;const l=o.value.carto_dark,c=new qn({urlTemplate:l.url,minLevel:0,maxLevel:19,attribution:l.attribution});r=new ei("base-layer-init",{source:c,projection:$n.createFromID("3857",0),layerName:"init-layer",style:"default",matrixSet:"EPSG:3857"}),i=new xn(t.value,{center:[116.405467,39.907761,2e3],zoom:12,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}})}),Vn(()=>{i&&(typeof i.dispose=="function"&&i.dispose(),i=null)}),(l,c)=>(ot(),At("div",nQ,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",iQ,[c[0]||(c[0]=ee("h3",{class:"text-white font-bold mb-3"},"Base Layer",-1)),ee("div",rQ,[(ot(!0),At(Un,null,Cc(o.value,(h,d)=>(ot(),At("label",{key:d,class:"flex items-center gap-2 cursor-pointer text-gray-300 hover:text-white"},[ee("input",{type:"radio",name:"baselayer",value:d,checked:s.value===d,onChange:p=>a(d),class:"text-blue-600 focus:ring-blue-500 bg-gray-700 border-gray-600"},null,40,sQ),ee("span",null,Ze(h.name),1)]))),128))])])]))}}),aQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let currentLayer: terra.WMTSTileLayer | null = null;
const activeLayerId = ref('carto_dark');

const layers = {
  carto_dark: {
    name: 'Carto Dark',
    url: 'https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png',
    attribution: '&copy; OpenStreetMap &copy; CARTO'
  },
  carto_light: {
    name: 'Carto Light',
    url: 'https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',
    attribution: '&copy; OpenStreetMap &copy; CARTO'
  },
  osm: {
    name: 'OpenStreetMap',
    url: 'https://tile.openstreetmap.org/{z}/{x}/{y}.png',
    attribution: '&copy; OpenStreetMap contributors'
  },
  arcgis: {
    name: 'ArcGIS Satellite',
    url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
    attribution: 'Tiles &copy; Esri'
  }
};

const switchLayer = (layerId: string) => {
  if (!map) return;
  if (currentLayer) map.removeLayer(currentLayer.getId());

  const config = layers[layerId];
  const source = new terra.WMTSSource({
    urlTemplate: config.url,
    minLevel: 0,
    maxLevel: 19,
    attribution: config.attribution
  });

  const newLayer = new terra.WMTSTileLayer("base-layer-" + layerId, {
    source: source,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "layer-" + layerId,
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map.addLayer(newLayer); 
  currentLayer = newLayer;
  activeLayerId.value = layerId;
};

onMounted(() => {
  if (!mapContainer.value) return;

  // Initialize with Dark
  const config = layers.carto_dark;
  const source = new terra.WMTSSource({
    urlTemplate: config.url,
    minLevel: 0,
    maxLevel: 19,
    attribution: config.attribution
  });

  currentLayer = new terra.WMTSTileLayer("base-layer-init", {
    source: source,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "init-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.405467, 39.907761, 2000],
    zoom: 12,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
        Baselayers: [currentLayer],
        minLevel: 2,
        maxLevel: 19
      }
    });

});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10">
      <h3 class="text-white font-bold mb-3">Base Layer</h3>
      <div class="space-y-2">
        <label v-for="(config, id) in layers" :key="id" class="flex items-center gap-2 cursor-pointer text-gray-300 hover:text-white">
          <input type="radio" name="baselayer" :value="id" :checked="activeLayerId === id" @change="switchLayer(id)" class="text-blue-600 focus:ring-blue-500 bg-gray-700 border-gray-600">
          <span>{{ config.name }}</span>
        </label>
      </div>
    </div>
  </div>
</template>`,lQ=gt({__name:"TileLayerExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.tileLayer.title"),description:Re(e)("examples.tileLayer.description"),code:Re(aQ)},{default:yn(()=>[xt(oQ)]),_:1},8,["title","description","code"]))}}),cQ=gt({__name:"MarkerExample",setup(n){const e=zt(null);let t=null;return Dn(()=>{if(!e.value)return;const i=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),r=new ei("base-layer",{source:i,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[116.405467,39.907761,2e3],zoom:12,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}});const s=new Ks("marker-layer",{altitude:0});t.addLayer(s);const o=new Ii({geometry:{type:"Point",coordinates:[116.405467,39.907761]},style:{type:"icon-point",url:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",size:[32,32],anchor:[.5,1],sizeAttenuation:!1},userData:{name:"Tiananmen",description:"The Gate of Heavenly Peace."}});o.addTo(s);const a=()=>{const l=document.createElement("div");return l.style.padding="10px",l.style.color="#333",l.innerHTML=`
      <h3 style="margin: 0 0 5px 0;">Tiananmen</h3>
      <p style="margin: 0;">Beijing, China</p>
    `,l};o.setInfoWindow({title:"Tiananmen",custom:!0,content:a(),minWidth:150,dy:-40}),setTimeout(()=>{o.openInfoWindow()},1e3)}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(i,r)=>(ot(),At("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512))}}),uQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

onMounted(() => {
  if (!mapContainer.value) return;

  // 1. Initialize Map
  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.405467, 39.907761, 2000],
    zoom: 12,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  

  // 2. Create Point Layer
  const markerLayer = new terra.PointLayer('marker-layer', { altitude: 0 });
  map.addLayer(markerLayer);

  // 3. Create Marker
  const marker = new terra.Maker({
    geometry: {
      type: 'Point',
      coordinates: [116.405467, 39.907761]
    },
    style: {
      type: 'icon-point',
      url: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png', 
      size: [32, 32],
      anchor: [0.5, 1],
      sizeAttenuation: false
    }
  });

  // 4. Add Marker to Layer
  marker.addTo(markerLayer);

  // 5. Setup InfoWindow
  const createContent = () => {
    const div = document.createElement('div');
    div.style.padding = '10px';
    div.style.color = '#333';
    div.innerHTML = \`
      <h3 style="margin: 0 0 5px 0;">Tiananmen</h3>
      <p style="margin: 0;">Beijing, China</p>
    \`;
    return div;
  };

  marker.setInfoWindow({
    title: "Tiananmen",
    custom: true,
    content: createContent(),
    minWidth: 150,
    dy: -40
  });

  setTimeout(() => {
    marker.openInfoWindow();
  }, 1000);
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
</template>`,hQ=gt({__name:"MarkerExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.markerExample.title"),description:Re(e)("examples.markerExample.description"),code:Re(uQ)},{default:yn(()=>[xt(cQ)]),_:1},8,["title","description","code"]))}}),dQ=gt({__name:"VectorShapes",setup(n){const e=zt(null);let t=null;return Dn(()=>{if(!e.value)return;const i=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),r=new ei("base-layer",{source:i,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[116.397428,39.90923,2e3],zoom:14,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}});const s=new qc("polygon-layer",{altitude:10});t.addLayer(s);const o=[[[116.390428,39.91423],[116.404428,39.91423],[116.404428,39.90423],[116.390428,39.90423],[116.390428,39.91423]]];new $s({geometry:{type:"Polygon",coordinates:o},style:{type:"basic-polygon",color:"#FF0000",opacity:.5,borderColor:"#FFFF00",borderWidth:2}}).addTo(s);const l=new Qh("line-layer",{altitude:20});t.addLayer(l);const c=[[116.397428,39.88],[116.397428,39.94]];new Ys({geometry:{type:"LineString",coordinates:c},style:{type:"basic-line",color:"#00FFFF",width:4}}).addTo(l)}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(i,r)=>(ot(),At("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512))}}),fQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.397428, 39.90923, 2000],
    zoom: 14,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  

  // 1. Polygon Layer
  const polygonLayer = new terra.PolygonLayer('polygon-layer', { altitude: 10 });
  map.addLayer(polygonLayer);

  // Define a polygon
  const forbiddenCityCoords = [[
    [116.390428, 39.91423],
    [116.404428, 39.91423],
    [116.404428, 39.90423],
    [116.390428, 39.90423],
    [116.390428, 39.91423]
  ]];

  const polygon = new terra.Polygon({
    geometry: {
      type: 'Polygon',
      coordinates: forbiddenCityCoords
    },
    style: {
      type: 'basic-polygon',
      color: '#FF0000',
      opacity: 0.5,
      borderColor: '#FFFF00',
      borderWidth: 2,
    }
  });
  polygon.addTo(polygonLayer);

  // 2. Line Layer
  const lineLayer = new terra.LineLayer('line-layer', { altitude: 20 });
  map.addLayer(lineLayer);

  // Define a line
  const axisLine = [
    [116.397428, 39.88],
    [116.397428, 39.94]
  ];

  const line = new terra.LineString({
    geometry: {
      type: 'LineString',
      coordinates: axisLine
    },
    style: {
      type: 'basic-line',
      color: '#00FFFF',
      width: 4
    }
  });
  line.addTo(lineLayer);
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
</template>`,pQ=gt({__name:"VectorShapesWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.vectorShapes.title"),description:Re(e)("examples.vectorShapes.description"),code:Re(fQ)},{default:yn(()=>[xt(dQ)]),_:1},8,["title","description","code"]))}}),mQ={class:"relative w-full h-full"},gQ={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg flex flex-col gap-2 z-10"},yQ={class:"text-white font-bold mb-2"},_Q={class:"flex gap-2"},vQ=gt({__name:"DrawToolExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null,r=null,s=null,o=null,a=null;const l=zt("polygon");Dn(()=>{if(!t.value)return;const d=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),p=new ei("base-layer",{source:d,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(t.value,{center:[116.397428,39.90923,2e3],zoom:14,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[p],minLevel:2,maxLevel:19}}),s=new qc("result-polygons",{altitude:1}),o=new Qh("result-lines",{altitude:2}),a=new Ks("result-points",{altitude:3}),i.addLayer(s),i.addLayer(o),i.addLayer(a),r=new $c({mode:"polygon",geometryStyle:{type:"basic-polygon",color:"#00ff00",opacity:.5,borderColor:"#FF0000",borderWidth:3}}),r.addTo(i),r.on("drawend",m=>{console.log("Draw end:",m);const y=m.geometry;y&&(y instanceof $s&&s?y.addTo(s):y instanceof Ys&&o?y.addTo(o):y instanceof Ii&&a?y.addTo(a):l.value==="polygon"&&s?y.addTo(s):l.value==="line"&&o?y.addTo(o):l.value==="point"&&a&&y.addTo(a))})});const c=d=>{l.value=d,r&&(r.setMode(d),d==="polygon"?r.geometryStyle={type:"basic-polygon",color:"#00ff00",opacity:.5,borderColor:"#FF0000",borderWidth:3}:d==="line"?r.geometryStyle={type:"basic-line",color:"#00FFFF",width:4}:d==="point"&&(r.geometryStyle={type:"basic-point",color:"#FFFF00",size:10}))},h=()=>{s==null||s.clearLayers(),o==null||o.clearLayers(),a==null||a.clearLayers()};return Vn(()=>{i&&(typeof i.dispose=="function"&&i.dispose(),i=null)}),(d,p)=>(ot(),At("div",mQ,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",gQ,[ee("h3",yQ,Ze(d.$t("examples.drawTool.panelTitle")),1),ee("div",_Q,[ee("button",{onClick:p[0]||(p[0]=m=>c("polygon")),class:Dr(["px-3 py-1 rounded text-sm transition-colors",l.value==="polygon"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},Ze(d.$t("examples.drawTool.mode.polygon")),3),ee("button",{onClick:p[1]||(p[1]=m=>c("line")),class:Dr(["px-3 py-1 rounded text-sm transition-colors",l.value==="line"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},Ze(d.$t("examples.drawTool.mode.line")),3),ee("button",{onClick:p[2]||(p[2]=m=>c("point")),class:Dr(["px-3 py-1 rounded text-sm transition-colors",l.value==="point"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},Ze(d.$t("examples.drawTool.mode.point")),3)]),ee("button",{onClick:h,class:"mt-2 w-full px-3 py-1 bg-red-600/80 hover:bg-red-600 text-white rounded text-sm transition-colors"},Ze(d.$t("examples.drawTool.clear")),1)])]))}}),bQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let drawTool: terra.DrawTool | null = null;

// Separate layers for different geometries
let polygonLayer: terra.PolygonLayer | null = null;
let lineLayer: terra.LineLayer | null = null;
let pointLayer: terra.PointLayer | null = null;

const currentMode = ref('polygon');

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.397428, 39.90923, 2000],
    zoom: 14,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
        Baselayers: [baseLayer],
        minLevel: 2,
        maxLevel: 19
      }
    });


  // Initialize Result Layers
  polygonLayer = new terra.PolygonLayer('result-polygons', { altitude: 1 });
  lineLayer = new terra.LineLayer('result-lines', { altitude: 2 });
  pointLayer = new terra.PointLayer('result-points', { altitude: 3 });

  map.addLayer(polygonLayer);
  map.addLayer(lineLayer);
  map.addLayer(pointLayer);

  // Initialize DrawTool
  drawTool = new terra.DrawTool({
    mode: 'polygon',
    geometryStyle: {
      type: 'basic-polygon',
      color: '#00ff00',
      opacity: 0.5,
      borderColor: '#FF0000',
      borderWidth: 3,
    }
  });
  
  drawTool.addTo(map);

  drawTool.on("drawend", (e: any) => {
    const feature = e.geometry;
    if (feature) {
      if (feature instanceof terra.Polygon && polygonLayer) {
        feature.addTo(polygonLayer);
      } else if ((feature instanceof terra.LineString || feature instanceof terra.Line) && lineLayer) {
        feature.addTo(lineLayer);
      } else if ((feature instanceof terra.Point || feature instanceof terra.Maker) && pointLayer) {
        feature.addTo(pointLayer);
      } else {
        if (currentMode.value === 'polygon' && polygonLayer) feature.addTo(polygonLayer);
        else if (currentMode.value === 'line' && lineLayer) feature.addTo(lineLayer);
        else if (currentMode.value === 'point' && pointLayer) feature.addTo(pointLayer);
      }
    }
  });
});

const setMode = (mode: string) => {
  currentMode.value = mode;
  if (drawTool) {
    drawTool.setMode(mode);
    
    if (mode === 'polygon') {
      drawTool.geometryStyle = {
        type: 'basic-polygon',
        color: '#00ff00',
        opacity: 0.5,
        borderColor: '#FF0000',
        borderWidth: 3,
      };
    } else if (mode === 'line') {
      drawTool.geometryStyle = {
        type: 'basic-line',
        color: '#00FFFF',
        width: 4
      };
    } else if (mode === 'point') {
      drawTool.geometryStyle = {
        type: 'basic-point',
        color: '#FFFF00',
        size: 10
      };
    }
  }
};

const clearAll = () => {
  polygonLayer?.clearLayers();
  lineLayer?.clearLayers();
  pointLayer?.clearLayers();
};

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg flex flex-col gap-2 z-10">
      <h3 class="text-white font-bold mb-2">Draw Tool</h3>
      <div class="flex gap-2">
        <button @click="setMode('polygon')" ...>Polygon</button>
        <button @click="setMode('line')" ...>Line</button>
        <button @click="setMode('point')" ...>Point</button>
      </div>
      <button @click="clearAll" ...>Clear All</button>
    </div>
  </div>
</template>`,xQ=gt({__name:"DrawToolExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.drawTool.title"),description:Re(e)("examples.drawTool.description"),code:Re(bQ)},{default:yn(()=>[xt(vQ)]),_:1},8,["title","description","code"]))}}),wQ={class:"relative w-full h-full"},SQ={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700"},MQ={class:"space-y-2"},TQ={class:"grid grid-cols-2 gap-2"},EQ=["onClick"],LQ=gt({__name:"CameraControl",setup(n){const e=zt(null);let t=null;const i=[{name:"Zhengzhou",center:[113.6253,34.7466,2e3]},{name:"Beijing",center:[116.4074,39.9042,2e3]},{name:"Shanghai",center:[121.4737,31.2304,2e3]},{name:"New York",center:[-74.006,40.7128,2e3]},{name:"London",center:[-.1278,51.5074,2e3]}],r=a=>{!t||!t.viewer||t.viewer.flyToPoint({center:a.center,distance:5e4,duration:2e3,polarDeg:45,azimuthDeg:0,curvePath:!0})},s=()=>{!t||!t.viewer||t.viewer.flyToPoint({center:[113.6253,34.7466,2e3],distance:2e5,duration:1500,polarDeg:0,azimuthDeg:0})},o=()=>{!t||!t.viewer||t.viewer.flyToPoint({center:[113.6253,34.7466,2e3],distance:5e4,polarDeg:60,azimuthDeg:t.viewer.controls.getAzimuthalAngle()*180/Math.PI+45})};return Dn(()=>{if(!e.value)return;const a=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),l=new ei("base-layer",{source:a,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[113.6253,34.7466,2e3],zoom:10,viewer:{antialias:!0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[l],minLevel:2,maxLevel:19}})}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(a,l)=>(ot(),At("div",wQ,[ee("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512),ee("div",SQ,[l[1]||(l[1]=ee("h3",{class:"text-white font-bold mb-3 border-b border-gray-600 pb-2"},"Camera Controls",-1)),ee("div",MQ,[l[0]||(l[0]=ee("div",{class:"text-gray-400 text-sm mb-1"},"Fly To City:",-1)),ee("div",TQ,[(ot(),At(Un,null,Cc(i,c=>ee("button",{key:c.name,onClick:h=>r(c),class:"px-3 py-1.5 bg-gray-700 hover:bg-blue-600 text-white text-sm rounded transition-colors"},Ze(c.name),9,EQ)),64))]),ee("div",{class:"mt-4 pt-2 border-t border-gray-600"},[ee("button",{onClick:s,class:"w-full mb-2 px-3 py-1.5 bg-green-700 hover:bg-green-600 text-white text-sm rounded transition-colors"}," Reset View (Top-Down) "),ee("button",{onClick:o,class:"w-full px-3 py-1.5 bg-purple-700 hover:bg-purple-600 text-white text-sm rounded transition-colors"}," Rotate 45 ")])])])]))}}),AQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

// Preset locations
const locations = [
  { name: 'Zhengzhou', center: [113.6253, 34.7466, 2000] },
  { name: 'Beijing', center: [116.4074, 39.9042, 2000] },
  { name: 'Shanghai', center: [121.4737, 31.2304, 2000] },
  { name: 'New York', center: [-74.006, 40.7128, 2000] },
  { name: 'London', center: [-0.1278, 51.5074, 2000] },
];

const flyToCity = (loc: any) => {
  if (!map || !map.viewer) return;
  
  // Use flyToPoint for smooth transition
  map.viewer.flyToPoint({
    center: loc.center,
    distance: 50000,
    duration: 2000,
    polarDeg: 45,
    azimuthDeg: 0,
    curvePath: true // Enable curved path
  });
};

const resetView = () => {
  if (!map || !map.viewer) return;
  map.viewer.flyToPoint({
    center: [113.6253, 34.7466, 2000],
    distance: 200000,
    duration: 1500,
    polarDeg: 0,
    azimuthDeg: 0
  });
};

const rotateCamera = () => {
    if (!map || !map.viewer) return;
    // Simple rotation by adjusting azimuth
     map.viewer.flyToPoint({
        center: [113.6253, 34.7466, 2000],
        distance: 50000,
        polarDeg: 60,
        azimuthDeg: (map.viewer.controls.getAzimuthalAngle() * 180 / Math.PI) + 45
    });
}

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [113.6253, 34.7466, 2000],
    zoom: 10,
    viewer: {
      antialias: true,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });
});

onBeforeUnmount(() => {
  if (map) {
    if (typeof map.dispose === 'function') {
      map.dispose();
    }
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    
    <!-- Control Panel -->
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700">
      <h3 class="text-white font-bold mb-3 border-b border-gray-600 pb-2">Camera Controls</h3>
      
      <div class="space-y-2">
        <div class="text-gray-400 text-sm mb-1">Fly To City:</div>
        <div class="grid grid-cols-2 gap-2">
          <button 
            v-for="loc in locations" 
            :key="loc.name"
            @click="flyToCity(loc)"
            class="px-3 py-1.5 bg-gray-700 hover:bg-blue-600 text-white text-sm rounded transition-colors"
          >
            {{ loc.name }}
          </button>
        </div>
        
        <div class="mt-4 pt-2 border-t border-gray-600">
          <button @click="resetView" class="w-full mb-2 px-3 py-1.5 bg-green-700 hover:bg-green-600 text-white text-sm rounded transition-colors">
            Reset View (Top-Down)
          </button>
           <button @click="rotateCamera" class="w-full px-3 py-1.5 bg-purple-700 hover:bg-purple-600 text-white text-sm rounded transition-colors">
            Rotate 45
          </button>
        </div>
      </div>
    </div>
  </div>
</template>
`,CQ=gt({__name:"CameraControlWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.cameraControl.title"),description:Re(e)("examples.cameraControl.description"),code:Re(AQ)},{default:yn(()=>[xt(LQ)]),_:1},8,["title","description","code"]))}}),RQ={class:"relative w-full h-full"},PQ={class:"absolute top-4 left-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700"},IQ={class:"space-y-4"},DQ={class:"flex items-center justify-between"},NQ={class:"relative inline-flex items-center cursor-pointer"},OQ={class:"flex items-center justify-between"},kQ={class:"relative inline-flex items-center cursor-pointer"},FQ=gt({__name:"LayerManagement",setup(n){const e=zt(null);let t=null,i=null,r=null;const s=zt({osm:{visible:!0,opacity:1},satellite:{visible:!1,opacity:1}}),o=a=>{if(!t)return;const l=a==="osm"?i:r;l&&(l.visible=s.value[a].visible)};return Dn(()=>{if(!e.value)return;const a=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"Dark"});i=new ei("osm-layer",{source:a,projection:$n.createFromID("3857",0),layerName:"osm",style:"default",matrixSet:"EPSG:3857"});const l=new p7({urlTemplate:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",minLevel:0,maxLevel:19,attribution:"ArcGIS"});r=new ei("sat-layer",{source:l,projection:$n.createFromID("3857",0),layerName:"satellite",style:"default",matrixSet:"EPSG:3857"}),r.visible=!1,t=new xn(e.value,{center:[113.6253,34.7466,2e3],zoom:10,viewer:{antialias:!0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r,i],minLevel:2,maxLevel:19}})}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(a,l)=>(ot(),At("div",RQ,[ee("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512),ee("div",PQ,[l[8]||(l[8]=ee("h3",{class:"text-white font-bold mb-3 border-b border-gray-600 pb-2"},"Layer Management",-1)),ee("div",IQ,[ee("div",DQ,[l[5]||(l[5]=ee("span",{class:"text-gray-300"},"Dark Map",-1)),ee("label",NQ,[Yn(ee("input",{type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=c=>s.value.osm.visible=c),onChange:l[1]||(l[1]=c=>o("osm")),class:"sr-only peer"},null,544),[[p0,s.value.osm.visible]]),l[4]||(l[4]=ee("div",{class:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))])]),ee("div",OQ,[l[7]||(l[7]=ee("span",{class:"text-gray-300"},"Satellite",-1)),ee("label",kQ,[Yn(ee("input",{type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=c=>s.value.satellite.visible=c),onChange:l[3]||(l[3]=c=>o("satellite")),class:"sr-only peer"},null,544),[[p0,s.value.satellite.visible]]),l[6]||(l[6]=ee("div",{class:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))])])])])]))}}),UQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let osmLayer: terra.WMTSTileLayer | null = null;
let satelliteLayer: terra.WMTSTileLayer | null = null;

const layerState = ref({
  osm: { visible: true, opacity: 1.0 },
  satellite: { visible: false, opacity: 1.0 }
});

const toggleLayer = (layerName: 'osm' | 'satellite') => {
  if (!map) return;
  
  const layer = layerName === 'osm' ? osmLayer : satelliteLayer;
  if (layer) {
    layerState.value[layerName].visible = !layerState.value[layerName].visible;
    layer.visible = layerState.value[layerName].visible;
  }
};

onMounted(() => {
  if (!mapContainer.value) return;

  // OSM Layer
  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "Dark"
  });
  osmLayer = new terra.WMTSTileLayer("osm-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "osm",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  // Satellite Layer (ArcGIS)
  const arcgisSource = new terra.ArcGisSource({
      urlTemplate: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
      minLevel: 0,
      maxLevel: 19,
      attribution: "ArcGIS"
  });
  satelliteLayer = new terra.WMTSTileLayer("sat-layer", {
      source: arcgisSource,
      projection: terra.ProjectFactory.createFromID("3857", 0),
      layerName: "satellite",
      style: "default",
      matrixSet: "EPSG:3857"
  });
  satelliteLayer.visible = false;

  map = new terra.Map(mapContainer.value, {
    center: [113.6253, 34.7466, 2000],
    zoom: 10,
    viewer: {
      antialias: true,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [satelliteLayer, osmLayer], // Add both, control visibility
      minLevel: 2,
      maxLevel: 19
    }
  });

  
});

onBeforeUnmount(() => {
  if (map) {
    if (typeof map.dispose === 'function') map.dispose();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    
    <div class="absolute top-4 left-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700">
      <h3 class="text-white font-bold mb-3 border-b border-gray-600 pb-2">Layer Management</h3>
      
      <div class="space-y-4">
        <div class="flex items-center justify-between">
          <span class="text-gray-300">Dark Map</span>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" v-model="layerState.osm.visible" @change="toggleLayer('osm')" class="sr-only peer">
            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
          </label>
        </div>

        <div class="flex items-center justify-between">
          <span class="text-gray-300">Satellite</span>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" v-model="layerState.satellite.visible" @change="toggleLayer('satellite')" class="sr-only peer">
            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
          </label>
        </div>
      </div>
    </div>
  </div>
</template>
`,zQ=gt({__name:"LayerManagementWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.layerManagement.title"),description:Re(e)("examples.layerManagement.description"),code:Re(UQ)},{default:yn(()=>[xt(FQ)]),_:1},8,["title","description","code"]))}}),WQ=gt({__name:"UIComponents",setup(n){const e=zt(null);let t=null;return Dn(()=>{if(!e.value)return;const i=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"Dark"}),r=new ei("base-layer",{source:i,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[113.6253,34.7466,2e3],zoom:12,viewer:{antialias:!0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}}),console.log("UI Components (InfoWindow, UIMarker) are temporarily disabled due to API changes.")}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(i,r)=>(ot(),At("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512))}}),VQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "Dark"
  });
  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [113.6253, 34.7466, 2000],
    zoom: 12,
    viewer: {
      antialias: true,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: { Baselayers: [baseLayer], minLevel: 2, maxLevel: 19 }
  });

  

  // 1. Add InfoWindow
  const infoWindow = new terra.InfoWindow({
      title: "Zhengzhou",
      content: "<div style='padding:10px;'>Capital of Henan Province<br/>A major transportation hub.</div>",
      minWidth: 200
  });
  infoWindow.addTo(map);
  infoWindow.open([113.6253, 34.7466, 2000]);

  // 2. Add UIMarker (HTML Marker)
  const markerEl = document.createElement('div');
  markerEl.className = 'custom-marker';
  markerEl.innerHTML = '';
  markerEl.style.fontSize = '30px';
  markerEl.style.cursor = 'pointer';
  markerEl.onclick = () => {
      alert('You clicked the custom marker!');
  };

  const uiMarker = new terra.UIMarker([113.65, 34.75, 2000], {
      content: markerEl,
      alignment: 'bottom'
  });
  uiMarker.addTo(map);
  
});

onBeforeUnmount(() => {
  if (map) {
    if (typeof map.dispose === 'function') map.dispose();
    map = null;
  }
});
<\/script>

<template>
  <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
</template>

<style>
/* Style for InfoWindow is usually handled by terra.css, but we can override or add custom styles */
.custom-marker {
    text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    animation: bounce 1s infinite;
}
@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}
</style>
`,GQ=gt({__name:"UIComponentsWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.uiComponents.title"),description:Re(e)("examples.uiComponents.description"),code:Re(VQ)},{default:yn(()=>[xt(WQ)]),_:1},8,["title","description","code"]))}}),BQ=gt({__name:"PipelineNetwork",setup(n){const e=zt(null);let t=null;return Dn(()=>{if(!e.value)return;const i=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"Dark"}),r=new ei("base-layer",{source:i,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[113.5517,34.7931,1e3],zoom:15,viewer:{antialias:!0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}});const s=new Qh("pipe-layer");t.addLayer(s),fetch("/geojson/public.gsgx_pipe.json").then(a=>a.json()).then(a=>{a.features.forEach(l=>{if(l.geometry&&l.geometry.coordinates){const h=d=>typeof d[0]=="number"?[...d,-1]:d.map(h);l.geometry.coordinates=h(l.geometry.coordinates)}new Zv({geometry:l.geometry,style:{type:"basic-line",color:"#0068F8",width:3}}).addTo(s)})});const o=new Ks("valve-layer",{collision:!0});t.addLayer(o),fetch("/geojson/public.gsss_valve.json").then(a=>a.json()).then(a=>{a.features.forEach(l=>{l.geometry&&l.geometry.coordinates&&(l.geometry.coordinates=[...l.geometry.coordinates,1]);const c=new Ii({geometry:l.geometry,style:{type:"icon-point",url:"/image/point/fxd.png",size:[24,24],anchor:[.5,.5],sizeAttenuation:!1},userData:l.properties});c.on("click",()=>{console.log("Valve clicked",l.properties),alert(`Valve Info
ID: ${l.properties.id||"N/A"}
Type: ${l.properties.type||"Unknown"}`)}),c.addTo(o)})})}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(i,r)=>(ot(),At("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512))}}),HQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

onMounted(() => {
  if (!mapContainer.value) return;

  // 1. Initialize Map
  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "Dark"
  });
  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [113.5517, 34.7931, 1000],
    zoom: 15,
    viewer: {
      antialias: true,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  

  // 2. Add Pipeline Layer (Lines)
  const pipeLayer = new terra.LineLayer('pipe-layer');
  map.addLayer(pipeLayer);

  fetch('/geojson/public.gsgx_pipe.json')
    .then(res => res.json())
    .then(data => {
      data.features.forEach((feature: any) => {
        // Fix coordinates: Add Z=1 to prevent clipping with ground
        if (feature.geometry && feature.geometry.coordinates) {
             // Handle MultiLineString specifically if needed, but for now generic map
             // Flattening complex structures might be needed if strictly MultiLineString
             // But terra.MultiLineString handles GeoJSON geometry structure usually.
             // We just need to inject Z.
             
             // Simple recursive function to inject Z
             const injectZ = (coords: any[]) => {
                 if (typeof coords[0] === 'number') return [...coords, -1]; // [x, y, z]
                 return coords.map(injectZ);
             };
             feature.geometry.coordinates = injectZ(feature.geometry.coordinates);
        }

        const pipe = new terra.MultiLineString({
          geometry: feature.geometry,
          style: {
            type: 'basic-line',
            color: '#0068F8', // Blue
            width: 3
          }
        });
        pipe.addTo(pipeLayer);
      });
    });

  // 3. Add Valve Layer (Points)
  const valveLayer = new terra.PointLayer('valve-layer', { collision: true });
  map.addLayer(valveLayer);

  fetch('/geojson/public.gsss_valve.json')
    .then(res => res.json())
    .then(data => {
       data.features.forEach((feature: any) => {
         if (feature.geometry && feature.geometry.coordinates) {
            feature.geometry.coordinates = [...feature.geometry.coordinates, 1];
         }
         
         const valve = new terra.Maker({
           geometry: feature.geometry,
           style: {
             type: 'icon-point',
             url: '/image/point/fxd.png', // Using available icon
             size: [24, 24],
             anchor: [0.5, 0.5],
             sizeAttenuation: false
           },
           userData: feature.properties
         });
         
         valve.on('click', () => {
             console.log('Valve clicked', feature.properties);
             const info = new terra.InfoWindow({
                 title: "Valve Info",
                 content: \`ID: \${feature.properties.id || 'N/A'}<br>Type: \${feature.properties.type || 'Unknown'}\`
             });
             info.addTo(map!);
             info.open(feature.geometry.coordinates);
         });

         valve.addTo(valveLayer);
       });
    });
});

onBeforeUnmount(() => {
  if (map) {
    if (typeof map.dispose === 'function') map.dispose();
    map = null;
  }
});
<\/script>

<template>
  <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
</template>
`,ZQ=gt({__name:"PipelineNetworkWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.pipelineNetwork.title"),description:Re(e)("examples.pipelineNetwork.description"),code:Re(HQ)},{default:yn(()=>[xt(BQ)]),_:1},8,["title","description","code"]))}}),XQ=gt({__name:"RealisticWater",setup(n){const e=zt(null);let t=null;return Dn(()=>{if(!e.value)return;const i=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"Dark"}),r=new ei("base-layer",{source:i,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[113.5517,34.7931,2e3],zoom:14,viewer:{antialias:!0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}});const s=new qc("water-layer",{isSceneLayer:!0,altitude:1});t.addLayer(s),fetch("/geojson/.json").then(o=>o.json()).then(o=>{o.features.forEach(a=>{if(a.geometry&&a.geometry.coordinates){const c=h=>typeof h[0]=="number"?[...h,1]:h.map(c);a.geometry.coordinates=c(a.geometry.coordinates)}new $s({geometry:a.geometry,style:{type:"base-water",normalMap:"/image/waternormals.jpg",color:"#0c99e5",sunColor:"#FF0597",opacity:.6}}).addTo(s)})})}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(i,r)=>(ot(),At("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512))}}),jQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "Dark"
  });
  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [113.5517, 34.7931, 2000],
    zoom: 14,
    viewer: {
      antialias: true,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  

  // Water Polygon Layer
  const waterLayer = new terra.PolygonLayer('water-layer', { isSceneLayer: true, altitude: 1 });
  map.addLayer(waterLayer);

  fetch('/geojson/.json')
    .then(res => res.json())
    .then(data => {
      data.features.forEach((feature: any) => {
         if (feature.geometry && feature.geometry.coordinates) {
             // Inject Z coordinate for water level
             const injectZ = (coords: any[]) => {
                 if (typeof coords[0] === 'number') return [...coords, 1]; 
                 return coords.map(injectZ);
             };
             feature.geometry.coordinates = injectZ(feature.geometry.coordinates);
         }

         const water = new terra.Polygon({
             geometry: feature.geometry,
             style: {
                 type: 'base-water',
                 normalMap: '/image/waternormals.jpg', // Ensure this exists in public/image
                 color: '#0c99e5',
                 sunColor: '#FF0597',
                 opacity: 0.6
             }
         });
         water.addTo(waterLayer);
      });
    });
});

onBeforeUnmount(() => {
  if (map) {
    if (typeof map.dispose === 'function') map.dispose();
    map = null;
  }
});
<\/script>

<template>
  <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
</template>
`,YQ=gt({__name:"RealisticWaterWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.realisticWater.title"),description:Re(e)("examples.realisticWater.description"),code:Re(jQ)},{default:yn(()=>[xt(XQ)]),_:1},8,["title","description","code"]))}}),KQ=gt({__name:"VolumetricClouds",setup(n){const e=zt(null);let t=null;return Dn(()=>{if(!e.value)return;const i=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"Dark"}),r=new ei("base-layer",{source:i,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});t=new xn(e.value,{center:[113.5517,34.7931,2e3],zoom:14,viewer:{antialias:!0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[r],minLevel:2,maxLevel:19}});const s=new _7("clouds-layer",{texture:"/image/cloud.png",isSceneLayer:!0});t.addLayer(s);for(let o=0;o<20;o++){const a=34.7931+(Math.random()-.5)*.05,l=113.5517+(Math.random()-.5)*.05,c=1e3+Math.random()*500;new XA({geometry:{type:"Point",coordinates:[l,a,c]},style:{type:"cloud",hexcolor:"#FFFFFF",growth:14,segments:90,speed:.2,opacity:.25,boundstext:{x:50,y:2,z:30}}}).addTo(s)}}),Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(i,r)=>(ot(),At("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512))}}),JQ=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "Dark"
  });
  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [113.5517, 34.7931, 2000],
    zoom: 14,
    viewer: {
      antialias: true,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  

  // Clouds Layer
  const cloudsLayer = new terra.CloudsLayer('clouds-layer', { 
      texture: '/image/cloud.png', 
      isSceneLayer: true 
  });
  map.addLayer(cloudsLayer);

  // Add random clouds
  for(let i=0; i<20; i++) {
      const lat = 34.7931 + (Math.random() - 0.5) * 0.05;
      const lng = 113.5517 + (Math.random() - 0.5) * 0.05;
      const height = 1000 + Math.random() * 500;

      const cloud = new terra.ICloud({
          geometry: {
              type: "Point",
              coordinates: [lng, lat, height]
          },
          style: {
              type: 'cloud',
              hexcolor: '#FFFFFF',
              growth: 14,
              segments: 90,
              speed: 0.2,
              opacity: 0.25,
              boundstext: { x: 50, y: 2, z: 30 }
          }
      });
      cloud.addTo(cloudsLayer);
  }
});

onBeforeUnmount(() => {
  if (map) {
    if (typeof map.dispose === 'function') map.dispose();
    map = null;
  }
});
<\/script>

<template>
  <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
</template>
`,QQ=gt({__name:"VolumetricCloudsWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.volumetricClouds.title"),description:Re(e)("examples.volumetricClouds.description"),code:Re(JQ)},{default:yn(()=>[xt(KQ)]),_:1},8,["title","description","code"]))}}),$Q={class:"relative w-full h-full"},qQ={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700"},e$={class:"text-white font-bold mb-4 border-b border-gray-600 pb-2"},t$={class:"space-y-4"},n$={class:"flex items-center justify-between"},i$={class:"text-gray-300 text-sm"},r$={class:"flex gap-2"},s$={class:"flex items-center justify-between"},o$={class:"text-red-400 text-sm"},a$={class:"flex gap-2"},l$={class:"flex items-center justify-between"},c$={class:"text-blue-400 text-sm"},u$={class:"flex gap-2"},h$={class:"mt-4 text-xs text-gray-500 italic"},d$=gt({__name:"MarkerStylesExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null,r=null;const s={},o=l=>{if(!i||!s[l])return;const c=s[l].getGeometry().coordinates;i.viewer.flyToPoint({x:c[0],y:c[1],z:2e3,pitch:-45,yaw:0,duration:1500}),setTimeout(()=>{s[l].openInfoWindow()},1600)},a=l=>{var p;const c=s[l];if(!c)return;const h="#"+Math.floor(Math.random()*16777215).toString(16),d=((p=c._style)==null?void 0:p.config)||{};if(d.type==="basic-point")c.setStyle({...d,color:h});else{const m=Math.random()>.5?[48,48]:[32,32];c.setStyle({...d,size:m})}};return Dn(()=>{if(!t.value)return;const l=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),c=new ei("base-layer",{source:l,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(t.value,{center:[116.397428,39.90923,15e3],zoom:12,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[c],minLevel:2,maxLevel:19}}),r=new Ks("marker-layer"),i.addLayer(r);const h=new Ii({geometry:{type:"Point",coordinates:[116.35,39.9]},style:{type:"icon-point",url:"/image/point/fxd.png",size:[32,32],anchor:[.5,.5]},userData:{name:"Icon Marker"}});h.setInfoWindow({title:"Icon Marker",content:"This is an image-based marker."}),s.icon=h;const d=new Ii({geometry:{type:"Point",coordinates:[116.4,39.9]},style:{type:"basic-point",color:"#ff0000",size:20,outlineColor:"#ffffff",outlineWidth:2},userData:{name:"Circle Marker"}});d.setInfoWindow({title:"Circle Marker",content:"This is a vector circle marker."}),s.circle=d;const p=new Ii({geometry:{type:"Point",coordinates:[116.45,39.9]},style:{type:"basic-point",color:"#0000ff",size:15,opacity:.8},userData:{name:"Blue Marker"}});p.setInfoWindow({title:"Blue Marker",content:"Another vector marker style."}),s.blue=p,h.addTo(r),d.addTo(r),p.addTo(r)}),Vn(()=>{var l;i&&((l=i.dispose)==null||l.call(i),i=null)}),(l,c)=>(ot(),At("div",$Q,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",qQ,[ee("h3",e$,Ze(Re(e)("examples.markerStyles.panelTitle")),1),ee("div",t$,[ee("div",n$,[ee("span",i$,Ze(Re(e)("examples.markerStyles.iconMarker")),1),ee("div",r$,[ee("button",{onClick:c[0]||(c[0]=h=>o("icon")),class:"px-2 py-1 bg-blue-600 text-xs rounded hover:bg-blue-500 text-white"},Ze(Re(e)("examples.markerStyles.flyTo")),1),ee("button",{onClick:c[1]||(c[1]=h=>a("icon")),class:"px-2 py-1 bg-gray-600 text-xs rounded hover:bg-gray-500 text-white"},Ze(Re(e)("examples.markerStyles.resize")),1)])]),ee("div",s$,[ee("span",o$,Ze(Re(e)("examples.markerStyles.redCircle")),1),ee("div",a$,[ee("button",{onClick:c[2]||(c[2]=h=>o("circle")),class:"px-2 py-1 bg-blue-600 text-xs rounded hover:bg-blue-500 text-white"},Ze(Re(e)("examples.markerStyles.flyTo")),1),ee("button",{onClick:c[3]||(c[3]=h=>a("circle")),class:"px-2 py-1 bg-gray-600 text-xs rounded hover:bg-gray-500 text-white"},Ze(Re(e)("examples.markerStyles.color")),1)])]),ee("div",l$,[ee("span",c$,Ze(Re(e)("examples.markerStyles.blueDot")),1),ee("div",u$,[ee("button",{onClick:c[4]||(c[4]=h=>o("blue")),class:"px-2 py-1 bg-blue-600 text-xs rounded hover:bg-blue-500 text-white"},Ze(Re(e)("examples.markerStyles.flyTo")),1),ee("button",{onClick:c[5]||(c[5]=h=>a("blue")),class:"px-2 py-1 bg-gray-600 text-xs rounded hover:bg-gray-500 text-white"},Ze(Re(e)("examples.markerStyles.color")),1)])])]),ee("div",h$,Ze(Re(e)("examples.markerStyles.clickTip")),1)])]))}}),f$=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let markerLayer: terra.PointLayer | null = null;

// Store markers for controls
const markers: Record<string, terra.Maker> = {};

const flyToMarker = (key: string) => {
  if (!map || !markers[key]) return;
  const coords = markers[key].getGeometry().coordinates;
  
  map.viewer.flyToPoint({
    x: coords[0],
    y: coords[1],
    z: 2000,
    pitch: -45,
    yaw: 0,
    duration: 1500
  });
  
  // Open popup after fly
  setTimeout(() => {
    markers[key].openInfoWindow();
  }, 1600);
};

const changeColor = (key: string) => {
  const marker = markers[key];
  if (!marker) return;
  
  // Random color
  const color = '#' + Math.floor(Math.random()*16777215).toString(16);
  
  const currentStyle = (marker as any)._style?.config || {};
  
  // Handle different marker types
  if (currentStyle.type === 'basic-point') {
    marker.setStyle({ ...currentStyle, color });
  } else {
    const newSize = Math.random() > 0.5 ? [48, 48] : [32, 32];
    marker.setStyle({ ...currentStyle, size: newSize });
  }
};

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.397428, 39.90923, 15000],
    zoom: 12,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  markerLayer = new terra.PointLayer('marker-layer');
  map.addLayer(markerLayer);

  // 1. Icon Point
  const iconMarker = new terra.Maker({
    geometry: { type: 'Point', coordinates: [116.35, 39.90] },
    style: {
      type: 'icon-point',
      url: '/image/point/fxd.png',
      size: [32, 32],
      anchor: [0.5, 0.5]
    },
    userData: { name: 'Icon Marker' }
  });
  iconMarker.setInfoWindow({ title: 'Icon Marker', content: 'This is an image-based marker.' });
  markers['icon'] = iconMarker;
  
  // 2. Basic Point (Circle)
  const circleMarker = new terra.Maker({
    geometry: { type: 'Point', coordinates: [116.40, 39.90] },
    style: {
      type: 'basic-point',
      color: '#ff0000',
      size: 20,
      outlineColor: '#ffffff',
      outlineWidth: 2
    },
    userData: { name: 'Circle Marker' }
  });
  circleMarker.setInfoWindow({ title: 'Circle Marker', content: 'This is a vector circle marker.' });
  markers['circle'] = circleMarker;

  // 3. Blue Point
  const blueMarker = new terra.Maker({
    geometry: { type: 'Point', coordinates: [116.45, 39.90] },
    style: {
      type: 'basic-point',
      color: '#0000ff',
      size: 15,
      opacity: 0.8
    },
    userData: { name: 'Blue Marker' }
  });
  blueMarker.setInfoWindow({ title: 'Blue Marker', content: 'Another vector marker style.' });
  markers['blue'] = blueMarker;

  iconMarker.addTo(markerLayer);
  circleMarker.addTo(markerLayer);
  blueMarker.addTo(markerLayer);
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700">
       <!-- Controls... -->
    </div>
  </div>
</template>`,p$=gt({__name:"MarkerStylesExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.markerStyles.title"),description:Re(e)("examples.markerStyles.description"),code:Re(f$)},{default:yn(()=>[xt(d$)]),_:1},8,["title","description","code"]))}}),m$={class:"relative w-full h-full"},g$={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700"},y$={class:"text-white font-bold mb-4 border-b border-gray-600 pb-2"},_$={class:"mb-6"},v$={class:"text-cyan-400 font-bold text-sm mb-2"},b$={class:"mb-2"},x$={class:"block text-gray-400 text-xs mb-1"},w$={class:"block text-gray-400 text-xs mb-1"},S$={class:"text-green-400 font-bold text-sm mb-2"},M$={class:"mb-2"},T$={class:"block text-gray-400 text-xs mb-1"},E$={class:"mb-2"},L$={class:"block text-gray-400 text-xs mb-1"},A$={class:"block text-gray-400 text-xs mb-1"},C$=gt({__name:"GeometryStylesExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null,r=null,s=null,o=null,a=null;const l=xl({lineWidth:5,lineColor:"#00ffff",polyOpacity:.3,polyColor:"#00ff00",polyBorderWidth:2});return li(()=>l.lineWidth,c=>{var h;if(o){const d=((h=o._style)==null?void 0:h.config)||{};o.setStyle({...d,width:c})}}),li(()=>l.lineColor,c=>{var h;if(o){const d=((h=o._style)==null?void 0:h.config)||{};o.setStyle({...d,color:c})}}),li(()=>l.polyOpacity,c=>{var h;if(a){const d=((h=a._style)==null?void 0:h.config)||{};a.setStyle({...d,opacity:c})}}),li(()=>l.polyColor,c=>{var h;if(a){const d=((h=a._style)==null?void 0:h.config)||{};a.setStyle({...d,color:c})}}),li(()=>l.polyBorderWidth,c=>{var h;if(a){const d=((h=a._style)==null?void 0:h.config)||{};a.setStyle({...d,borderWidth:c})}}),Dn(()=>{if(!t.value)return;const c=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),h=new ei("base-layer",{source:c,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(t.value,{center:[116.375,39.9,1e4],zoom:13,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[h],minLevel:2,maxLevel:19}}),r=new Qh("line-layer",{altitude:10}),i.addLayer(r),s=new qc("polygon-layer",{altitude:5}),i.addLayer(s),o=new Ys({geometry:{type:"LineString",coordinates:[[116.35,39.92],[116.45,39.92]]},style:{type:"basic-line",color:l.lineColor,width:l.lineWidth}}),o.addTo(r),new Ys({geometry:{type:"LineString",coordinates:[[116.35,39.91],[116.45,39.91]]},style:{type:"basic-line",color:"#ff0000",width:3}}).addTo(r),a=new $s({geometry:{type:"Polygon",coordinates:[[[116.35,39.9],[116.37,39.9],[116.37,39.88],[116.35,39.88],[116.35,39.9]]]},style:{type:"basic-polygon",color:l.polyColor,opacity:l.polyOpacity,borderColor:"#ffffff",borderWidth:l.polyBorderWidth}}),a.addTo(s),new $s({geometry:{type:"Polygon",coordinates:[[[116.38,39.9],[116.4,39.9],[116.4,39.88],[116.38,39.88],[116.38,39.9]]]},style:{type:"basic-polygon",color:"#ff00ff",opacity:.8}}).addTo(s)}),Vn(()=>{var c;i&&((c=i.dispose)==null||c.call(i),i=null)}),(c,h)=>(ot(),At("div",m$,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",g$,[ee("h3",y$,Ze(Re(e)("examples.geometryStyles.panelTitle")),1),ee("div",_$,[ee("h4",v$,Ze(Re(e)("examples.geometryStyles.cyanLine")),1),ee("div",b$,[ee("label",x$,Ze(Re(e)("examples.geometryStyles.width"))+": "+Ze(l.lineWidth)+"px",1),Yn(ee("input",{"onUpdate:modelValue":h[0]||(h[0]=d=>l.lineWidth=d),type:"range",min:"1",max:"20",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,l.lineWidth,void 0,{number:!0}]])]),ee("div",null,[ee("label",w$,Ze(Re(e)("examples.geometryStyles.color")),1),Yn(ee("input",{"onUpdate:modelValue":h[1]||(h[1]=d=>l.lineColor=d),type:"color",class:"w-full h-6 bg-transparent cursor-pointer rounded"},null,512),[[Hi,l.lineColor]])])]),ee("div",null,[ee("h4",S$,Ze(Re(e)("examples.geometryStyles.greenPolygon")),1),ee("div",M$,[ee("label",T$,Ze(Re(e)("examples.geometryStyles.opacity"))+": "+Ze(l.polyOpacity),1),Yn(ee("input",{"onUpdate:modelValue":h[2]||(h[2]=d=>l.polyOpacity=d),type:"range",min:"0",max:"1",step:"0.1",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,l.polyOpacity,void 0,{number:!0}]])]),ee("div",E$,[ee("label",L$,Ze(Re(e)("examples.geometryStyles.borderWidth"))+": "+Ze(l.polyBorderWidth)+"px",1),Yn(ee("input",{"onUpdate:modelValue":h[3]||(h[3]=d=>l.polyBorderWidth=d),type:"range",min:"0",max:"10",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,l.polyBorderWidth,void 0,{number:!0}]])]),ee("div",null,[ee("label",A$,Ze(Re(e)("examples.geometryStyles.color")),1),Yn(ee("input",{"onUpdate:modelValue":h[4]||(h[4]=d=>l.polyColor=d),type:"color",class:"w-full h-6 bg-transparent cursor-pointer rounded"},null,512),[[Hi,l.polyColor]])])])])]))}}),R$=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref, reactive, watch } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let lineLayer: terra.LineLayer | null = null;
let polygonLayer: terra.PolygonLayer | null = null;

let solidLine: terra.LineString | null = null;
let poly1: terra.Polygon | null = null;

const controls = reactive({
  lineWidth: 5,
  lineColor: '#00ffff',
  polyOpacity: 0.3,
  polyColor: '#00ff00',
  polyBorderWidth: 2
});

watch(() => controls.lineWidth, (val) => {
  if (solidLine) {
    const currentStyle = (solidLine as any)._style?.config || {};
    solidLine.setStyle({ ...currentStyle, width: val });
  }
});

watch(() => controls.lineColor, (val) => {
  if (solidLine) {
    const currentStyle = (solidLine as any)._style?.config || {};
    solidLine.setStyle({ ...currentStyle, color: val });
  }
});

watch(() => controls.polyOpacity, (val) => {
  if (poly1) {
    const currentStyle = (poly1 as any)._style?.config || {};
    poly1.setStyle({ ...currentStyle, opacity: val });
  }
});

watch(() => controls.polyColor, (val) => {
  if (poly1) {
    const currentStyle = (poly1 as any)._style?.config || {};
    poly1.setStyle({ ...currentStyle, color: val });
  }
});

watch(() => controls.polyBorderWidth, (val) => {
  if (poly1) {
    const currentStyle = (poly1 as any)._style?.config || {};
    poly1.setStyle({ ...currentStyle, borderWidth: val });
  }
});

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.375, 39.90, 10000],
    zoom: 13,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  lineLayer = new terra.LineLayer('line-layer', { altitude: 10 });
  map.addLayer(lineLayer);

  polygonLayer = new terra.PolygonLayer('polygon-layer', { altitude: 5 });
  map.addLayer(polygonLayer);

  // 1. Solid Line (Controlled)
  solidLine = new terra.LineString({
    geometry: {
      type: 'LineString',
      coordinates: [[116.35, 39.92], [116.45, 39.92]]
    },
    style: {
      type: 'basic-line',
      color: controls.lineColor,
      width: controls.lineWidth
    }
  });
  solidLine.addTo(lineLayer);

  // 2. Red Line (Static)
  const redLine = new terra.LineString({
    geometry: {
      type: 'LineString',
      coordinates: [[116.35, 39.91], [116.45, 39.91]]
    },
    style: {
      type: 'basic-line',
      color: '#ff0000',
      width: 3
    }
  });
  redLine.addTo(lineLayer);

  // 3. Transparent Polygon (Controlled)
  poly1 = new terra.Polygon({
    geometry: {
      type: 'Polygon',
      coordinates: [[
        [116.35, 39.90], [116.37, 39.90], [116.37, 39.88], [116.35, 39.88], [116.35, 39.90]
      ]]
    },
    style: {
      type: 'basic-polygon',
      color: controls.polyColor,
      opacity: controls.polyOpacity,
      borderColor: '#ffffff',
      borderWidth: controls.polyBorderWidth
    }
  });
  poly1.addTo(polygonLayer);

  // 4. Solid Polygon (Static)
  const poly2 = new terra.Polygon({
    geometry: {
      type: 'Polygon',
      coordinates: [[
        [116.38, 39.90], [116.40, 39.90], [116.40, 39.88], [116.38, 39.88], [116.38, 39.90]
      ]]
    },
    style: {
      type: 'basic-polygon',
      color: '#ff00ff',
      opacity: 0.8
    }
  });
  poly2.addTo(polygonLayer);
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700">
       <!-- Controls... -->
    </div>
  </div>
</template>`,P$=gt({__name:"GeometryStylesExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.geometryStyles.title"),description:Re(e)("examples.geometryStyles.description"),code:Re(R$)},{default:yn(()=>[xt(C$)]),_:1},8,["title","description","code"]))}}),I$={class:"relative w-full h-full"},D$={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700"},N$={class:"text-white font-bold mb-4 border-b border-gray-600 pb-2"},O$={class:"mb-6"},k$={class:"text-yellow-400 font-bold text-sm mb-2"},F$={class:"mb-2"},U$={class:"block text-gray-400 text-xs mb-1"},z$={class:"block text-gray-400 text-xs mb-1"},W$={class:"text-blue-400 font-bold text-sm mb-2"},V$={class:"mb-2"},G$={class:"block text-gray-400 text-xs mb-1"},B$={class:"block text-gray-400 text-xs mb-1"},H$=gt({__name:"ModelLayerExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null,r=null,s=null;const o=xl({duckScale:100,duckRotation:0,manScale:10,manRotation:0});return li(()=>o.duckScale,a=>{var l;if(r){const c=((l=r._style)==null?void 0:l.config)||{};r.setStyle({...c,scale:a})}}),li(()=>o.duckRotation,a=>{var l;if(r){const c=((l=r._style)==null?void 0:l.config)||{};r.setStyle({...c,rotate:[90,a,0]})}}),li(()=>o.manScale,a=>{var l;if(s){const c=((l=s._style)==null?void 0:l.config)||{};s.setStyle({...c,scale:a})}}),li(()=>o.manRotation,a=>{var l;if(s){const c=((l=s._style)==null?void 0:l.config)||{};s.setStyle({...c,rotate:[90,a,0]})}}),Dn(()=>{if(!t.value)return;const a=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),l=new ei("base-layer",{source:a,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(t.value,{center:[116.397428,39.90923,2e3],zoom:16,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[l],minLevel:2,maxLevel:19}});const c=new Ks("model-layer");i.addLayer(c),r=new Vp({geometry:{type:"Point",coordinates:[116.397428,39.90923,0]},style:{url:"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Duck/glTF-Binary/Duck.glb",scale:o.duckScale,rotate:[90,0,0]},userData:{name:"Duck Model"}}),r.addTo(c),s=new Vp({geometry:{type:"Point",coordinates:[116.398428,39.90923,0]},style:{url:"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/CesiumMan/glTF-Binary/CesiumMan.glb",scale:o.manScale,rotate:[90,0,0]}}),s.addTo(c)}),Vn(()=>{var a;i&&((a=i.dispose)==null||a.call(i),i=null)}),(a,l)=>(ot(),At("div",I$,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",D$,[ee("h3",N$,Ze(Re(e)("examples.modelLayer.panelTitle")),1),ee("div",O$,[ee("h4",k$,Ze(Re(e)("examples.modelLayer.duckModel")),1),ee("div",F$,[ee("label",U$,Ze(Re(e)("examples.modelLayer.scale"))+": "+Ze(o.duckScale),1),Yn(ee("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>o.duckScale=c),type:"range",min:"10",max:"300",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,o.duckScale,void 0,{number:!0}]])]),ee("div",null,[ee("label",z$,Ze(Re(e)("examples.modelLayer.rotation"))+": "+Ze(o.duckRotation)+"",1),Yn(ee("input",{"onUpdate:modelValue":l[1]||(l[1]=c=>o.duckRotation=c),type:"range",min:"0",max:"360",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,o.duckRotation,void 0,{number:!0}]])])]),ee("div",null,[ee("h4",W$,Ze(Re(e)("examples.modelLayer.cesiumMan")),1),ee("div",V$,[ee("label",G$,Ze(Re(e)("examples.modelLayer.scale"))+": "+Ze(o.manScale),1),Yn(ee("input",{"onUpdate:modelValue":l[2]||(l[2]=c=>o.manScale=c),type:"range",min:"1",max:"50",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,o.manScale,void 0,{number:!0}]])]),ee("div",null,[ee("label",B$,Ze(Re(e)("examples.modelLayer.rotation"))+": "+Ze(o.manRotation)+"",1),Yn(ee("input",{"onUpdate:modelValue":l[3]||(l[3]=c=>o.manRotation=c),type:"range",min:"0",max:"360",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,o.manRotation,void 0,{number:!0}]])])])])]))}}),Z$=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref, reactive, watch } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let duckModel: terra.Model | null = null;
let cesiumMan: terra.Model | null = null;

const controls = reactive({
  duckScale: 100,
  duckRotation: 0,
  manScale: 10,
  manRotation: 0
});

watch(() => controls.duckScale, (val) => {
  if (duckModel) {
    const currentStyle = (duckModel as any)._style?.config || {};
    duckModel.setStyle({ ...currentStyle, scale: val });
  }
});

watch(() => controls.duckRotation, (val) => {
  if (duckModel) {
    const currentStyle = (duckModel as any)._style?.config || {};
    duckModel.setStyle({ ...currentStyle, rotate: [90, val, 0] });
  }
});

watch(() => controls.manScale, (val) => {
  if (cesiumMan) {
    const currentStyle = (cesiumMan as any)._style?.config || {};
    cesiumMan.setStyle({ ...currentStyle, scale: val });
  }
});

watch(() => controls.manRotation, (val) => {
  if (cesiumMan) {
    const currentStyle = (cesiumMan as any)._style?.config || {};
    cesiumMan.setStyle({ ...currentStyle, rotate: [90, val, 0] });
  }
});

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.397428, 39.90923, 2000],
    zoom: 16,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  // Model Layer
  const modelLayer = new terra.PointLayer('model-layer');
  map.addLayer(modelLayer);

  // 1. Duck
  duckModel = new terra.Model({
    geometry: { 
      type: 'Point', 
      coordinates: [116.397428, 39.90923, 0] 
    },
    style: {
      url: 'https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Duck/glTF-Binary/Duck.glb',
      scale: controls.duckScale,
      rotate: [90, 0, 0]
    },
    userData: { name: 'Duck Model' }
  });
  duckModel.addTo(modelLayer);
  
  // 2. Cesium Man
  cesiumMan = new terra.Model({
    geometry: { 
      type: 'Point', 
      coordinates: [116.398428, 39.90923, 0]
    },
    style: {
      url: 'https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/CesiumMan/glTF-Binary/CesiumMan.glb',
      scale: controls.manScale,
      rotate: [90, 0, 0]
    }
  });
  cesiumMan.addTo(modelLayer);
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700">
      <h3 class="text-white font-bold mb-4 border-b border-gray-600 pb-2">Model Controls</h3>
      
      <!-- Duck Controls -->
      <div class="mb-6">
        <h4 class="text-yellow-400 font-bold text-sm mb-2">Duck Model</h4>
        <div class="mb-2">
          <label class="block text-gray-400 text-xs mb-1">Scale: {{ controls.duckScale }}</label>
          <input v-model.number="controls.duckScale" type="range" min="10" max="300" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
        </div>
        <div>
          <label class="block text-gray-400 text-xs mb-1">Rotation: {{ controls.duckRotation }}</label>
          <input v-model.number="controls.duckRotation" type="range" min="0" max="360" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
        </div>
      </div>

      <!-- Cesium Man Controls -->
      <div>
        <h4 class="text-blue-400 font-bold text-sm mb-2">Cesium Man</h4>
        <div class="mb-2">
          <label class="block text-gray-400 text-xs mb-1">Scale: {{ controls.manScale }}</label>
          <input v-model.number="controls.manScale" type="range" min="1" max="50" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
        </div>
        <div>
          <label class="block text-gray-400 text-xs mb-1">Rotation: {{ controls.manRotation }}</label>
          <input v-model.number="controls.manRotation" type="range" min="0" max="360" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
        </div>
      </div>
    </div>
  </div>
</template>`,X$=gt({__name:"ModelLayerExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.modelLayer.title"),description:Re(e)("examples.modelLayer.description"),code:Re(Z$)},{default:yn(()=>[xt(H$)]),_:1},8,["title","description","code"]))}}),j$={class:"relative w-full h-full"},Y$={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 flex flex-col gap-2 w-64 border border-gray-700"},K$={class:"text-white font-bold mb-2 border-b border-gray-600 pb-2"},J$={class:"space-y-2"},Q$={class:"grid grid-cols-2 gap-2"},$$={class:"mt-4"},q$={class:"text-gray-400 text-xs font-bold mb-1 uppercase"},eq={class:"bg-black/50 p-2 rounded h-24 overflow-y-auto custom-scrollbar"},tq={key:0,class:"text-gray-600 text-xs italic text-center py-2"},nq=gt({__name:"LayerOperationsExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null;const r=zt(0),s=zt([]),o=h=>{s.value.unshift(`${new Date().toLocaleTimeString()} - ${h}`),s.value.length>5&&s.value.pop()},a=()=>{if(!i)return;const h=`random-layer-${r.value++}`,d=new Ks(h);i.addLayer(d);const p=39.9+(Math.random()-.5)*.1,m=116.4+(Math.random()-.5)*.1;new Ii({geometry:{type:"Point",coordinates:[m,p]},style:{type:"basic-point",color:"#"+Math.floor(Math.random()*16777215).toString(16),size:15}}).addTo(d),o(`Added layer: ${h}`)},l=()=>{if(!i||r.value===0)return;const h=`random-layer-${r.value-1}`;i.getLayer(h)?(i.removeLayer(h),r.value--,o(`Removed layer: ${h}`)):o(`Layer not found: ${h}`)},c=()=>{if(!i||r.value===0)return;const h=`random-layer-${r.value-1}`,d=i.getLayer(h);if(d){const p=d.visible;d.visible=!p,o(`Toggled visibility for ${h}`)}};return Dn(()=>{if(!t.value)return;const h=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),d=new ei("base-layer",{source:h,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(t.value,{center:[116.4,39.9,1e4],zoom:12,viewer:{antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[d],minLevel:2,maxLevel:19}})}),Vn(()=>{var h;i&&((h=i.dispose)==null||h.call(i),i=null)}),(h,d)=>(ot(),At("div",j$,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",Y$,[ee("h3",K$,Ze(Re(e)("examples.layerOperations.panelTitle")),1),ee("div",J$,[ee("button",{onClick:a,class:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-500 transition-colors text-sm font-medium"},Ze(Re(e)("examples.layerOperations.addRandomLayer")),1),ee("div",Q$,[ee("button",{onClick:c,class:"px-3 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors text-xs"},Ze(Re(e)("examples.layerOperations.toggleLast")),1),ee("button",{onClick:l,class:"px-3 py-2 bg-red-600/80 text-white rounded hover:bg-red-500 transition-colors text-xs"},Ze(Re(e)("examples.layerOperations.removeLast")),1)])]),ee("div",$$,[ee("h4",q$,Ze(Re(e)("examples.layerOperations.operationLogs")),1),ee("div",eq,[s.value.length===0?(ot(),At("div",tq,Ze(Re(e)("examples.layerOperations.noOperationsYet")),1)):qp("",!0),(ot(!0),At(Un,null,Cc(s.value,(p,m)=>(ot(),At("div",{key:m,class:"text-xs font-mono text-gray-300 mb-1 border-b border-gray-800/50 pb-1 last:border-0 last:pb-0"},Ze(p),1))),128))])])])]))}}),iq=Vh(nq,[["__scopeId","data-v-fd7722ea"]]),rq=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;

const layerCount = ref(0);
const logs = ref<string[]>([]);

const log = (msg: string) => {
  logs.value.unshift(\`\${new Date().toLocaleTimeString()} - \${msg}\`);
  if (logs.value.length > 5) logs.value.pop();
};

const addLayer = () => {
  if (!map) return;
  const id = \`random-layer-\${layerCount.value++}\`;
  const layer = new terra.PointLayer(id);
  map.addLayer(layer);
  
  // Add a random point
  const lat = 39.90 + (Math.random() - 0.5) * 0.1;
  const lng = 116.40 + (Math.random() - 0.5) * 0.1;
  
  const point = new terra.Maker({
    geometry: { type: 'Point', coordinates: [lng, lat] },
    style: {
      type: 'basic-point',
      color: '#' + Math.floor(Math.random()*16777215).toString(16),
      size: 15
    }
  });
  point.addTo(layer);
  
  log(\`Added layer: \${id}\`);
};

const removeLastLayer = () => {
  if (!map || layerCount.value === 0) return;
  const id = \`random-layer-\${layerCount.value - 1}\`;
  
  const layer = map.getLayer(id);
  if (layer) {
    map.removeLayer(id);
    layerCount.value--;
    log(\`Removed layer: \${id}\`);
  } else {
    log(\`Layer not found: \${id}\`);
  }
};

const toggleVisibility = () => {
  if (!map || layerCount.value === 0) return;
  const id = \`random-layer-\${layerCount.value - 1}\`;
  const layer = map.getLayer(id);
  if (layer) {
    const isVisible = layer.visible;
    layer.visible = !isVisible;
    log(\`Toggled visibility for \${id}\`);
  }
};

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.40, 39.90, 10000],
    zoom: 12,
    viewer: {
      antialias: true,
      polarDeg: 70,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 flex flex-col gap-2 w-64 border border-gray-700">
      <!-- Controls -->
    </div>
  </div>
</template>`,sq=gt({__name:"LayerOperationsExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.layerOperations.title"),description:Re(e)("examples.layerOperations.description"),code:Re(rq)},{default:yn(()=>[xt(iq)]),_:1},8,["title","description","code"]))}}),oq={class:"relative w-full h-full"},aq={class:"absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700"},lq={class:"text-white font-bold mb-4 border-b border-gray-600 pb-2"},cq={class:"mb-4"},uq={class:"block text-gray-400 text-sm mb-1"},hq={class:"block text-gray-400 text-sm mb-1"},dq=gt({__name:"LayerPropertiesExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null,r=null;const s=zt(.8),o=zt(100);return li(s,a=>{r&&r.setOpacity(a)}),li(o,a=>{r&&r.setAltitude(a)}),Dn(()=>{if(!t.value)return;const a=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),l=new ei("base-layer",{source:a,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(t.value,{center:[116.397428,39.90923,2e3],zoom:15,viewer:{antialias:!0,polarDeg:60,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[l],minLevel:2,maxLevel:19}}),r=new qc("test-layer",{altitude:o.value}),i.addLayer(r),r.setOpacity(s.value),new $s({geometry:{type:"Polygon",coordinates:[[[116.390428,39.91423],[116.404428,39.91423],[116.404428,39.90423],[116.390428,39.90423],[116.390428,39.91423]]]},style:{type:"basic-polygon",color:"#00ff00",opacity:1,borderColor:"#ffff00",borderWidth:2}}).addTo(r)}),Vn(()=>{var a;i&&((a=i.dispose)==null||a.call(i),i=null)}),(a,l)=>(ot(),At("div",oq,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",aq,[ee("h3",lq,Ze(Re(e)("examples.layerProperties.panelTitle")),1),ee("div",cq,[ee("label",uq,Ze(Re(e)("examples.layerProperties.opacity"))+": "+Ze(s.value),1),Yn(ee("input",{type:"range","onUpdate:modelValue":l[0]||(l[0]=c=>s.value=c),min:"0",max:"1",step:"0.1",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,s.value,void 0,{number:!0}]])]),ee("div",null,[ee("label",hq,Ze(Re(e)("examples.layerProperties.altitude"))+": "+Ze(o.value)+"m",1),Yn(ee("input",{type:"range","onUpdate:modelValue":l[1]||(l[1]=c=>o.value=c),min:"0",max:"1000",step:"10",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,o.value,void 0,{number:!0}]])])])]))}}),fq=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref, watch } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let testLayer: terra.PolygonLayer | null = null;

const opacity = ref(0.8);
const altitude = ref(100);

watch(opacity, (val) => {
  if (testLayer) testLayer.setOpacity(val);
});

watch(altitude, (val) => {
  if (testLayer) testLayer.setAltitude(val);
});

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.397428, 39.90923, 2000],
    zoom: 15,
    viewer: {
      antialias: true,
      polarDeg: 60,
      azimuthDeg: 0,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  // Create a polygon layer
  testLayer = new terra.PolygonLayer('test-layer', { altitude: altitude.value });
  map.addLayer(testLayer);
  testLayer.setOpacity(opacity.value);

  const polygon = new terra.Polygon({
    geometry: {
      type: 'Polygon',
      coordinates: [[
        [116.390428, 39.91423],
        [116.404428, 39.91423],
        [116.404428, 39.90423],
        [116.390428, 39.90423],
        [116.390428, 39.91423]
      ]]
    },
    style: {
      type: 'basic-polygon',
      color: '#00ff00',
      opacity: 1.0, 
      borderColor: '#ffff00',
      borderWidth: 2
    }
  });
  polygon.addTo(testLayer);
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    
    <div class="absolute top-4 right-4 bg-gray-800 p-4 rounded-lg shadow-lg z-10 w-64 border border-gray-700">
      <h3 class="text-white font-bold mb-4 border-b border-gray-600 pb-2">Layer Properties</h3>
      
      <div class="mb-4">
        <label class="block text-gray-400 text-sm mb-1">Opacity: {{ opacity }}</label>
        <input type="range" v-model.number="opacity" min="0" max="1" step="0.1" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
      </div>
      
      <div>
        <label class="block text-gray-400 text-sm mb-1">Altitude: {{ altitude }}m</label>
        <input type="range" v-model.number="altitude" min="0" max="1000" step="10" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
      </div>
    </div>
  </div>
</template>`,pq=gt({__name:"LayerPropertiesExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.layerProperties.title"),description:Re(e)("examples.layerProperties.description"),code:Re(fq)},{default:yn(()=>[xt(dq)]),_:1},8,["title","description","code"]))}}),mq={class:"relative w-full h-full"},gq={class:"absolute top-4 right-4 bg-gray-800 p-5 rounded-lg shadow-xl z-10 w-72 border border-gray-700"},yq={class:"text-white font-bold mb-4 border-b border-gray-600 pb-2"},_q={class:"space-y-4"},vq={class:"block text-gray-400 text-xs mb-1"},bq={class:"block text-gray-400 text-xs mb-1"},xq={class:"flex gap-4"},wq={class:"flex-1"},Sq={class:"block text-gray-400 text-xs mb-1"},Mq={class:"flex-1"},Tq={class:"block text-gray-400 text-xs mb-1"},Eq={class:"block text-gray-400 text-xs mb-1"},Lq={class:"flex items-center justify-between"},Aq={class:"text-gray-400 text-sm"},Cq={class:"relative inline-flex items-center cursor-pointer"},Rq=gt({__name:"LabelExample",setup(n){const{t:e}=Ht(),t=zt(null);let i=null,r=null,s=null;const o=xl({text:"Hello Terra-GL",fontSize:24,textColor:"#ffffff",bgColor:"#3b82f6",showBackground:!0,rotation:0});li(o,()=>{a()});const a=()=>{s&&s.setStyle({type:"canvas-label-fixed",text:o.text,fontFamily:"'Microsoft YaHei', sans-serif",fontWeight:"bold",fontSizeDpi:48,textColor:o.textColor,strokeColor:"#000000",strokeWidth:2,showBackground:o.showBackground,bgColor:o.bgColor,bgOpacity:.8,roundRectRadius:5,screenSpaceSize:o.fontSize,rotation:o.rotation,pixelOffset:[0,-30]})};return Dn(()=>{if(!t.value)return;const l=new qn({urlTemplate:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",minLevel:0,maxLevel:19,attribution:"&copy; OpenStreetMap &copy; CARTO"}),c=new ei("base-layer",{source:l,projection:$n.createFromID("3857",0),layerName:"dark-layer",style:"default",matrixSet:"EPSG:3857"});i=new xn(t.value,{center:[116.397428,39.90923,5e3],zoom:14,viewer:{antialias:!0,polarDeg:60,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[c],minLevel:2,maxLevel:19}}),r=new Ks("label-layer"),i.addLayer(r),s=new jA({geometry:{type:"Point",coordinates:[116.397428,39.90923,0]},style:{type:"canvas-label-fixed",text:o.text,fontFamily:"Arial",fontWeight:"bold",fontSizeDpi:48,textColor:o.textColor,strokeColor:"#000000",strokeWidth:2,showBackground:o.showBackground,bgColor:o.bgColor,bgOpacity:.8,roundRectRadius:5,screenSpaceSize:o.fontSize,pixelOffset:[0,-30]}}),s.addTo(r),new Ii({geometry:{type:"Point",coordinates:[116.397428,39.90923,0]},style:{type:"basic-point",color:"#ff0000",size:10}}).addTo(r)}),Vn(()=>{var l;i&&((l=i.dispose)==null||l.call(i),i=null)}),(l,c)=>(ot(),At("div",mq,[ee("div",{ref_key:"mapContainer",ref:t,class:"w-full h-full bg-gray-900"},null,512),ee("div",gq,[ee("h3",yq,Ze(Re(e)("examples.labelExample.panelTitle")),1),ee("div",_q,[ee("div",null,[ee("label",vq,Ze(Re(e)("examples.labelExample.content")),1),Yn(ee("input",{"onUpdate:modelValue":c[0]||(c[0]=h=>o.text=h),type:"text",class:"w-full bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white text-sm focus:border-blue-500 focus:outline-none"},null,512),[[Hi,o.text]])]),ee("div",null,[ee("label",bq,Ze(Re(e)("examples.labelExample.size"))+": "+Ze(o.fontSize)+"px",1),Yn(ee("input",{"onUpdate:modelValue":c[1]||(c[1]=h=>o.fontSize=h),type:"range",min:"12",max:"64",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,o.fontSize,void 0,{number:!0}]])]),ee("div",xq,[ee("div",wq,[ee("label",Sq,Ze(Re(e)("examples.labelExample.textColor")),1),Yn(ee("input",{"onUpdate:modelValue":c[2]||(c[2]=h=>o.textColor=h),type:"color",class:"w-full h-8 bg-transparent cursor-pointer rounded"},null,512),[[Hi,o.textColor]])]),ee("div",Mq,[ee("label",Tq,Ze(Re(e)("examples.labelExample.bgColor")),1),Yn(ee("input",{"onUpdate:modelValue":c[3]||(c[3]=h=>o.bgColor=h),type:"color",class:"w-full h-8 bg-transparent cursor-pointer rounded"},null,512),[[Hi,o.bgColor]])])]),ee("div",null,[ee("label",Eq,Ze(Re(e)("examples.labelExample.rotation"))+": "+Ze(o.rotation)+"",1),Yn(ee("input",{"onUpdate:modelValue":c[4]||(c[4]=h=>o.rotation=h),type:"range",min:"0",max:"360",class:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[Hi,o.rotation,void 0,{number:!0}]])]),ee("div",Lq,[ee("span",Aq,Ze(Re(e)("examples.labelExample.background")),1),ee("label",Cq,[Yn(ee("input",{type:"checkbox","onUpdate:modelValue":c[5]||(c[5]=h=>o.showBackground=h),class:"sr-only peer"},null,512),[[p0,o.showBackground]]),c[6]||(c[6]=ee("div",{class:"w-9 h-5 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"},null,-1))])])]),c[7]||(c[7]=ee("div",{class:"mt-4 text-xs text-gray-500 italic"}," * Use Label class with PointLayer ",-1))])]))}}),Pq=`<script setup lang="ts">
import { onMounted, onBeforeUnmount, ref, reactive, watch } from 'vue';
import * as terra from '@terra.gl/core';

const mapContainer = ref<HTMLElement | null>(null);
let map: terra.Map | null = null;
let labelLayer: terra.PointLayer | null = null;
let currentLabel: terra.Label | null = null;

const controls = reactive({
  text: 'Hello Terra-GL',
  fontSize: 24,
  textColor: '#ffffff',
  bgColor: '#3b82f6',
  showBackground: true,
  rotation: 0
});

watch(controls, () => {
  updateLabelStyle();
});

const updateLabelStyle = () => {
  if (!currentLabel) return;
  
  currentLabel.setStyle({
    type: 'canvas-label-fixed',
    text: controls.text,
    fontFamily: "'Microsoft YaHei', sans-serif",
    fontWeight: 'bold',
    fontSizeDpi: 48,
    textColor: controls.textColor,
    strokeColor: '#000000',
    strokeWidth: 2,
    showBackground: controls.showBackground,
    bgColor: controls.bgColor,
    bgOpacity: 0.8,
    roundRectRadius: 5,
    screenSpaceSize: controls.fontSize,
    rotation: controls.rotation,
    pixelOffset: [0, -30]
  });
};

onMounted(() => {
  if (!mapContainer.value) return;

  const osmSource = new terra.WMTSSource({
    urlTemplate: "https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",
    minLevel: 0,
    maxLevel: 19,
    attribution: "&copy; OpenStreetMap &copy; CARTO"
  });

  const baseLayer = new terra.WMTSTileLayer("base-layer", {
    source: osmSource,
    projection: terra.ProjectFactory.createFromID("3857", 0),
    layerName: "dark-layer",
    style: "default",
    matrixSet: "EPSG:3857"
  });

  map = new terra.Map(mapContainer.value, {
    center: [116.397428, 39.90923, 5000],
    zoom: 14,
    viewer: {
      antialias: true,
      skybox: {
        path: "/image/skyboxall/onemap/",
        files: ["posx.jpg", "negx.jpg", "posy.jpg", "negy.jpg", "posz.jpg", "negz.jpg"],
        defaultColor: '#121E3A'
      }
    },
    basemap: {
      Baselayers: [baseLayer],
      minLevel: 2,
      maxLevel: 19
    }
  });

  labelLayer = new terra.PointLayer('label-layer');
  map.addLayer(labelLayer);

  currentLabel = new terra.Label({
    geometry: {
      type: 'Point',
      coordinates: [116.397428, 39.90923, 0]
    },
    style: {
      type: 'canvas-label-fixed',
      text: controls.text,
      fontFamily: "Arial",
      fontWeight: 'bold',
      fontSizeDpi: 48,
      textColor: controls.textColor,
      strokeColor: '#000000',
      strokeWidth: 2,
      showBackground: controls.showBackground,
      bgColor: controls.bgColor,
      bgOpacity: 0.8,
      roundRectRadius: 5,
      screenSpaceSize: controls.fontSize,
      pixelOffset: [0, -30]
    }
  });
  
  currentLabel.addTo(labelLayer);
});

onBeforeUnmount(() => {
  if (map) {
    map.dispose?.();
    map = null;
  }
});
<\/script>

<template>
  <div class="relative w-full h-full">
    <div ref="mapContainer" class="w-full h-full bg-gray-900"></div>
    <div class="absolute top-4 right-4 bg-gray-800 p-5 rounded-lg shadow-xl z-10 w-72 border border-gray-700">
       <!-- Controls ... -->
    </div>
  </div>
</template>`,Iq=gt({__name:"LabelExampleWrapper",setup(n){const{t:e}=Ht();return(t,i)=>(ot(),Cn(pi,{title:Re(e)("examples.labelExample.title"),description:Re(e)("examples.labelExample.description"),code:Re(Pq)},{default:yn(()=>[xt(Rq)]),_:1},8,["title","description","code"]))}}),Dq="/image/point/fxd.png",Nq={class:"relative w-full h-full"},Oq=gt({__name:"ZhengzhouNightWrapper",setup(n){const e=zt(null);let t=null;Dn(()=>{e.value&&(t=new xn(e.value,{center:[113.55175280557246,34.793170730802366,2e3],viewer:{debug:!1,antialias:!0,polarDeg:70,azimuthDeg:0,skybox:{path:"/image/skyboxall/onemap/",files:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"],defaultColor:"#121E3A"}},basemap:{Baselayers:[]}}),i(),s("/geojson/.json"),r("/geojson/public.gsgx_pipe.json","#0068F8"),r("/geojson/public.wsgx_pipe.json","#f85700"),o("/geojson/public.gsss_fireplug.json","lightlayer"),l())});function i(){if(!t)return;let c=new Ks("modelLayer",{isSceneLayer:!0});t.addLayer(c);for(let h=0;h<1;h++){let d=new Vp({geometry:{coordinates:[113.55175280557246,34.793170730802366,1],type:"Point"},iscity:!0,style:{type:"fbx",url:"/model/52603.FBX",scale:{x:.01,y:.01,z:.01},shadows:{cast:!0,receive:!0},dracoOptions:{enable:!1,decoderPath:"/draco/"}}});d.addTo(c),d.setShadows&&d.setShadows({cast:!0,receive:!0})}}function r(c,h){if(!t)return;let d=new Qh("pipeline"+Math.random());t.addLayer(d),fetch(c).then(p=>p.json()).then(p=>{p.features.forEach(m=>{if(m.geometry&&m.geometry.coordinates){if(m.geometry&&m.geometry.type==="MultiLineString"){const b=m.geometry.coordinates;b.length===1&&(m={...m,geometry:{type:"LineString",coordinates:b[0]}})}m.geometry.coordinates=m.geometry.coordinates.map(b=>typeof b[0]=="number"?[...b,1]:b.map(v=>typeof v[0]=="number"?[...v,1]:v.map(g=>[...g,1])))}new Zv({geometry:m.geometry,style:{type:"basic-line",color:h,width:2}}).addTo(d)})}).catch(p=>{console.error("geojson:",p)})}function s(c,h){if(!t)return;let d=new qc("waterpolygon",{isSceneLayer:!0,altitude:1});t.addLayer(d),fetch(c).then(p=>p.json()).then(p=>{p.features.forEach(m=>{if(m.geometry&&m.geometry.coordinates){const b=m.geometry,v=1;b.type==="Polygon"?Array.isArray(b.coordinates[0][0])&&(b.coordinates=b.coordinates.map(g=>g.map(x=>[x[0],x[1],v]))):b.type==="MultiPolygon"&&(b.coordinates=b.coordinates.map(g=>g.map(x=>x.map(w=>[w[0],w[1],v]))))}new $s({geometry:m.geometry,style:{type:"base-water",normalMap:"/image/waternormals.jpg",color:"#0c99e5",sunColor:"#FF0597",opacity:.5}}).addTo(d)})}).catch(p=>{console.error("geojson:",p)})}function o(c,h){if(!t)return;let d=new Ks(h);t.addLayer(d),fetch(c).then(p=>p.json()).then(p=>{p.features.forEach(b=>{b.geometry&&b.geometry.coordinates&&(b.geometry.coordinates=[...b.geometry.coordinates,1])});const m=p.features.map(b=>b.geometry);new YA({geometry:{type:"Point",coordinates:[113.66547375795346,34.75655850019979]},geometries:m,style:{type:"light",color:"#000000",icon:"/image/lensflare2_alpha.png"}}).addTo(d)}).catch(p=>{console.error("geojson:",p)})}function a(c,h,d){if(!t)return;let p=new Ks(d,{collision:!0});t.addLayer(p),fetch(c).then(m=>m.json()).then(m=>{m.features.forEach(y=>{y.geometry&&y.geometry.coordinates&&(y.geometry.coordinates=[...y.geometry.coordinates,1]),new Ii({geometry:y.geometry,style:{type:"icon-point",url:h,size:[.03,.03],rotation:Math.PI/4,anchor:[0,0],zIndex:10,sizeAttenuation:!1}}).addTo(p)})}).catch(m=>{console.error("geojson:",m)})}function l(){let c=["public.gsss_valve.json"];for(let h=0;h<c.length;h++){const d=c[h];a("/geojson/"+d,"/image/point/fxd.png",d)}}return Vn(()=>{t&&(typeof t.dispose=="function"&&t.dispose(),t=null)}),(c,h)=>(ot(),At("div",Nq,[ee("div",{ref_key:"mapContainer",ref:e,class:"w-full h-full bg-gray-900"},null,512),h[0]||(h[0]=ek('<div class="absolute top-4 right-4 bg-gray-800/80 backdrop-blur p-4 rounded-lg shadow-lg border border-gray-700 max-w-xs"><h3 class="text-white font-bold mb-3 border-b border-gray-600 pb-2"></h3><div class="space-y-2 text-sm text-gray-300"><div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-[#0068F8]"></span><span></span></div><div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-[#f85700]"></span><span></span></div><div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-[#0c99e5]"></span><span></span></div><div class="flex items-center gap-2"><img src="'+Dq+'" class="w-4 h-4 object-contain"><span></span></div></div></div>',1))]))}}),kq=[{path:"/",name:"home",component:v9},{path:"/gallery",redirect:"/examples/basic-map"},{path:"/examples",component:dW,children:[{path:"terrain-3d",name:"terrain-3d",component:HJ},{path:"basic-map",name:"basic-map",component:jJ},{path:"map-events",name:"map-events",component:tQ},{path:"tile-layer",name:"tile-layer",component:lQ},{path:"marker-example",name:"marker-example",component:hQ},{path:"vector-shapes",name:"vector-shapes",component:pQ},{path:"draw-tool",name:"draw-tool",component:xQ},{path:"camera-control",name:"camera-control",component:CQ},{path:"layer-management",name:"layer-management",component:zQ},{path:"ui-components",name:"ui-components",component:GQ},{path:"pipeline-network",name:"pipeline-network",component:ZQ},{path:"realistic-water",name:"realistic-water",component:YQ},{path:"volumetric-clouds",name:"volumetric-clouds",component:QQ},{path:"marker-styles",name:"marker-styles",component:p$},{path:"geometry-styles",name:"geometry-styles",component:P$},{path:"model-layer",name:"model-layer",component:X$},{path:"layer-operations",name:"layer-operations",component:sq},{path:"layer-properties",name:"layer-properties",component:pq},{path:"label-example",name:"label-example",component:Iq},{path:"zhengzhou-night",name:"zhengzhou-night",component:Oq}]}],Fq=ZF({history:SF(),routes:kq}),Uq={nav:{home:"Home",examples:"Examples"},home:{title:"Terra-GL",subtitle:"A powerful 3D map engine for the web",description:"Build high-performance, immersive 3D geographic visualizations with ease. Terra-GL leverages WebGL to render massive terrain and map data directly in the browser.",getStarted:"Get Started",examplesTitle:"Explore Examples",examplesSubtitle:"Explore the possibilities of Terra-GL with these interactive demos.",viewExample:"View Example"},sidebar:{title:"Terra-GL",subtitle:"Examples",footer:"Powered by {'@'}terra.gl/core",backToHome:"Back to Home",categories:{mapControl:"Map Control",layers:"Layers",geometryInteraction:"Geometry & Interaction",advancedVisuals:"Advanced Visuals"}},examples:{terrain3d:{title:"3D Terrain",description:"Rendering 3D terrain with elevation data. Use right-click or Ctrl+drag to tilt the camera."},cameraControl:{title:"Camera Control",description:"Control camera flight, rotation, and perspective switching."},layerManagement:{title:"Layer Management",description:"Add, remove layers, and control layer visibility."},uiComponents:{title:"UI Components",description:"InfoWindows and custom HTML Markers (UIMarker)."},pipelineNetwork:{title:"Pipeline Network",description:"Load and visualize underground pipeline GeoJSON data with valves."},realisticWater:{title:"Realistic Water",description:"Render realistic water surfaces with normal maps and reflections."},volumetricClouds:{title:"Volumetric Clouds",description:"Generate dynamic volumetric cloud layers in the sky."},basicMap:{title:"Basic Map",description:"A simple 2D map using OpenStreetMap raster tiles."},mapEvents:{title:"Map Events",description:"Listen to and handle map interaction events like click, zoom, and move.",panelTitle:"Event Logs",placeholder:"Interact with map to see events..."},tileLayer:{title:"Tile Layer Switching",description:"Switch between different basemap services (Dark, Light, Satellite).",panelTitle:"Base Layer",layers:{dark:"Carto Dark",light:"Carto Light",osm:"OpenStreetMap",satellite:"ArcGIS Satellite"}},markerExample:{title:"Markers & Popups",description:"Add icon markers to the map and configure custom click popups."},vectorShapes:{title:"Vector Shapes",description:"Draw polygons and lines to demonstrate basic vector layer usage."},drawTool:{title:"Draw Tool",description:"Interactively draw points, lines, and polygons.",panelTitle:"Draw Tool",mode:{polygon:"Polygon",line:"Line",point:"Point"},clear:"Clear All"},labelExample:{title:"Text Labels",description:"Display and customize text labels on the map.",panelTitle:"Label Controls",content:"Content",size:"Size",textColor:"Text Color",bgColor:"Bg Color",rotation:"Rotation",background:"Background"},markerStyles:{title:"Marker Styles",description:"Showcase different marker styles like icons and basic points.",panelTitle:"Marker Controls",flyTo:"Fly To",resize:"Resize",color:"Color",iconMarker:"Icon Marker",redCircle:"Red Circle",blueDot:"Blue Dot",clickTip:'* Click "Fly To" to navigate and open popup'},geometryStyles:{title:"Geometry Styles",description:"Demonstrate various styles for lines and polygons.",panelTitle:"Style Controls",cyanLine:"Cyan Line",greenPolygon:"Green Polygon",width:"Width",color:"Color",opacity:"Opacity",borderWidth:"Border Width"},modelLayer:{title:"3D Models",description:"Load and render 3D GLTF models on the map.",panelTitle:"Model Controls",duckModel:"Duck Model",cesiumMan:"Cesium Man",scale:"Scale",rotation:"Rotation"},layerOperations:{title:"Layer Operations",description:"Dynamically add, remove, and toggle layers by ID.",panelTitle:"Layer Operations",addRandomLayer:"Add Random Layer",toggleLast:"Toggle Last",removeLast:"Remove Last",operationLogs:"Operation Logs",noOperationsYet:"No operations yet"},layerProperties:{title:"Layer Properties",description:"Adjust layer opacity and altitude in real-time.",panelTitle:"Layer Properties",opacity:"Opacity",altitude:"Altitude"},zhengzhouNight:{title:"Zhengzhou Night",description:"A comprehensive demo of Zhengzhou city night scene with pipelines, models and lighting."}},viewer:{preview:"Preview",code:"Code",copy:"Copy",copied:"Copied!"}},zq={nav:{home:"",examples:""},home:{title:"Terra-GL",subtitle:" Web 3D ",description:" 3D Terra-GL  WebGL ",getStarted:"",examplesTitle:"",examplesSubtitle:" Terra-GL ",viewExample:""},sidebar:{title:"Terra-GL",subtitle:"",footer:" {'@'}terra.gl/core",backToHome:"",categories:{mapControl:"",layers:"",geometryInteraction:"",advancedVisuals:""}},examples:{terrain3d:{title:"3D ",description:" 3D  Ctrl+"},cameraControl:{title:"",description:""},layerManagement:{title:"",description:""},uiComponents:{title:"UI ",description:" (InfoWindow)   HTML  (UIMarker)"},pipelineNetwork:{title:"",description:" GeoJSON "},realisticWater:{title:"",description:""},volumetricClouds:{title:"",description:""},basicMap:{title:"",description:" OpenStreetMap  2D "},mapEvents:{title:"",description:"",panelTitle:"",placeholder:"..."},tileLayer:{title:"",description:"",panelTitle:"",layers:{dark:"Carto ",light:"Carto ",osm:"OpenStreetMap",satellite:"ArcGIS "}},markerExample:{title:"",description:""},vectorShapes:{title:"",description:""},drawTool:{title:"",description:"",panelTitle:"",mode:{polygon:"",line:"",point:""},clear:""},labelExample:{title:"",description:""},zhengzhouNight:{title:"",description:"3D"},markerStyles:{title:"",description:"",panelTitle:"",flyTo:"",resize:"",color:"",iconMarker:"",redCircle:"",blueDot:"",clickTip:"* "},geometryStyles:{title:"",description:"",panelTitle:"",cyanLine:"",greenPolygon:"",width:"",color:"",opacity:"",borderWidth:""},modelLayer:{title:"3D ",description:" 3D GLTF ",panelTitle:"",duckModel:"",cesiumMan:"Cesium ",scale:"",rotation:""},layerOperations:{title:"",description:" ID ",panelTitle:"",addRandomLayer:"",toggleLast:"",removeLast:"",operationLogs:"",noOperationsYet:""},layerProperties:{title:"",description:"",panelTitle:"",opacity:"",altitude:""}},viewer:{preview:"",code:"",copy:"",copied:"!"}},Wq=Oz({legacy:!1,globalInjection:!0,locale:"zh",fallbackLocale:"en",messages:{en:Uq,zh:zq}}),Qv=Nk(zk);Qv.use(Fq);Qv.use(Wq);Qv.mount("#app");
